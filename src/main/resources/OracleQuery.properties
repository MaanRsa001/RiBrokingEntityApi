GET_SEQUENCE=select Fn_get_SeqNo(?,?,?,?,?,?) AS SEQUENCE_NO from dual
PAYMENT_INSERT_RECEIPT=INSERT INTO TTRN_PAYMENT_RECEIPT (PAYMENT_RECEIPT_NO,BROKER_ID,CEDING_ID,CURRENCY_ID,PAID_AMT,EXCHANGE_RATE,RECEIPT_BANK,PRODUCT_ID,DEPT_ID,STATUS,TRANS_DATE,TRANS_TYPE,TRANSCATIONTYPE,BRANCH_CODE,BANK_CHARGES,NET_AMT,REMARKS,WH_TAX,AMEND_ID,LOGIN_ID,SYS_DATE,PREMIUM_LAVY) VALUES(?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,'0',?,SYSDATE,?)
payment.update.allocatedDtls=UPDATE TTRN_ALLOCATED_TRANSACTION SET STATUS=?,REVERSAL_DATE=TO_DATE(?,'DD/MM/YYYY'),REVERSAL_AMOUNT=?,PAID_AMOUNT=?,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE TRANSACTION_NO=? AND SNO= ?
payment.update.claimPymtDtls=UPDATE TTRN_CLAIM_PAYMENT SET  SETTLEMENT_STATUS=?,ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)-( ? )),SYS_DATE=SYSDATE,BRANCH_CODE=?,LOGIN_ID=? WHERE CONTRACT_NO = ? AND CLAIM_PAYMENT_NO = ?
 GET_AMENDMENT_DATE=select to_char (AMENDMENT_DATE,'DD/MM/YYYY') from TTRN_PAYMENT_RECEIPT R where PAYMENT_RECEIPT_NO=? AND R.AMEND_ID=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT  WHERE   PAYMENT_RECEIPT_NO = R.PAYMENT_RECEIPT_NO AND BRANCH_CODE = R.BRANCH_CODE)
payment.update.allocatedtls1=UPDATE TTRN_ALLOCATED_TRANSACTION SET STATUS=?,REVERSAL_DATE=TO_DATE(?,'DD/MM/YYYY'),REVERSAL_AMOUNT=?,PAID_AMOUNT=? ,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RECEIPT_NO=? AND SNO= ?
payment.update.rskPremDtls1=UPDATE RSK_PREMIUM_DETAILS SET SETTLEMENT_STATUS=?,ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)-( ? )),LOGIN_ID=?,BRANCH_CODE=?,ENTRY_DATE=sysdate WHERE CONTRACT_NO = ? AND TRANSACTION_NO = ?
payment.select.getRskPremDtls=SELECT (NVL (NETDUE_OC, 0) - NVL (ALLOCATED_TILL_DATE, 0)) NETDUE FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO = ? AND TRANSACTION_NO = ?
payment.select.getClaimPymtDtls=SELECT (NVL (PAID_AMOUNT_OC, 0)- NVL (ALLOCATED_TILL_DATE, 0)) PAID_AMOUNT FROM TTRN_CLAIM_PAYMENT WHERE CONTRACT_NO = ? AND CLAIM_PAYMENT_NO = ?
payment.update.retro.payment=UPDATE TTRN_RETRO_SOA SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)-( ? )),ALLOCATION_STATUS='Pending' WHERE RETRO_CONTRACT_NUMBER = ? AND TRANSACTION_NO = ?
payment.update.pymtRetDtls=UPDATE TTRN_PAYMENT_RECEIPT_DETAILS R SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)-( ? )),LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ?  AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.get.retro.payment=SELECT (NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)) NETDUE FROM TTRN_RETRO_SOA WHERE RETRO_CONTRACT_NUMBER \= ? AND TRANSACTION_NO \= ?
payment.select.getPymtRetDtls=SELECT (NVL(AMOUNT,0) - NVL (ALLOCATED_TILL_DATE, 0)) AMOUNT FROM TTRN_PAYMENT_RECEIPT_DETAILS WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ?


payment.select.getPymtRetStatus=SELECT   distinct B.SHORT_NAME CURRENCY_NAME, A.AMOUNT ALLOCATED, NVL (A.ALLOCATED_TILL_DATE, 0) UTILIZED, (A.AMOUNT - NVL (A.ALLOCATED_TILL_DATE, 0)) NOTUTILIZED, CASE WHEN (A.AMOUNT - NVL (A.ALLOCATED_TILL_DATE, 0) = '0') THEN 'Fully Allocated' WHEN (NVL (A.ALLOCATED_TILL_DATE, 0) > '0') THEN 'Partially Allocated' WHEN (NVL (A.ALLOCATED_TILL_DATE, 0) = '0') THEN 'Pending' END STATUS, TO_CHAR (TAT.TRANS_DATE, 'DD/MM/YYYY') PAYMANT_DATE, (Select COMPANY_NAME from personal_info pi where pi.customer_id=TAT.CEDING_ID and  PI.branch_code=tat.BRANCH_CODE) Ceding_company, (Select BANK_NAME from bank_master bm where bm.bank_id=tat.RECEIPT_BANK and bm.Branch_code=tat.BRANCH_CODE) Bank_name, (Select FIRST_NAME from personal_info pi where pi.customer_id=TAT.broker_ID and  PI.branch_code=tat.BRANCH_CODE) broker_name FROM   TTRN_PAYMENT_RECEIPT_DETAILS A, CURRENCY_MASTER B,TTRN_PAYMENT_RECEIPT TAT WHERE   B.CURRENCY_ID = A.CURRENCY_ID AND B.BRANCH_CODE = ? and A.RECEIPT_SL_NO=tat.PAYMENT_RECEIPT_NO  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=A.RECEIPT_NO AND RECEIPT_SL_NO = A.RECEIPT_SL_NO) AND B.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE   CURRENCY_ID = B.CURRENCY_ID AND BRANCH_CODE = B.BRANCH_CODE)  And TAT.AMEND_ID=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.RECEIPT_SL_NO) AND A.RECEIPT_SL_NO =?
payment.select.getPymtRetStatus1=SELECT   distinct B.SHORT_NAME CURRENCY_NAME, A.AMOUNT ALLOCATED, NVL (A.ALLOCATED_TILL_DATE, 0) UTILIZED, (A.AMOUNT - NVL (A.ALLOCATED_TILL_DATE, 0)) NOTUTILIZED, CASE WHEN (A.AMOUNT - NVL (A.ALLOCATED_TILL_DATE, 0) = '0') THEN 'Fully Allocated' WHEN (NVL (A.ALLOCATED_TILL_DATE, 0) > '0') THEN 'Partially Allocated' WHEN (NVL (A.ALLOCATED_TILL_DATE, 0) = '0') THEN 'Pending' END STATUS, TO_CHAR (TAT.TRANS_DATE, 'DD/MM/YYYY') PAYMANT_DATE, (Select COMPANY_NAME from personal_info pi where pi.customer_id=TAT.CEDING_ID and  PI.branch_code=tat.BRANCH_CODE) Ceding_company, (Select BANK_NAME from bank_master bm where bm.bank_id=tat.RECEIPT_BANK and bm.Branch_code=tat.BRANCH_CODE) Bank_name, (Select FIRST_NAME from personal_info pi where pi.customer_id=TAT.broker_ID and  PI.branch_code=tat.BRANCH_CODE) broker_name FROM   TTRN_PAYMENT_RECEIPT_DETAILS A, CURRENCY_MASTER B,TTRN_PAYMENT_RECEIPT TAT WHERE   B.CURRENCY_ID = A.CURRENCY_ID AND B.BRANCH_CODE = ? and A.RECEIPT_SL_NO=tat.PAYMENT_RECEIPT_NO  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=A.RECEIPT_NO AND RECEIPT_SL_NO = A.RECEIPT_SL_NO) AND B.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE   CURRENCY_ID = B.CURRENCY_ID AND BRANCH_CODE = B.BRANCH_CODE)  And TAT.AMEND_ID=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.RECEIPT_SL_NO) AND A.RECEIPT_SL_NO =? AND A.CURRENCY_ID =? 
common.select.getCompName=SELECT CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END COMPNAY FROM PERSONAL_INFO P WHERE P.BRANCH_CODE=? AND P.CUSTOMER_ID=? AND P.CUSTOMER_TYPE=? AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE=P.BRANCH_CODE AND CUSTOMER_ID=P.CUSTOMER_ID AND CUSTOMER_TYPE=P.CUSTOMER_TYPE) 
payment.select.getAlloTransDtls=SELECT SNO,TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,TO_CHAR(REVERSAL_DATE,'DD/MM/YYYY') REVERSAL_DATE,case sign(REVERSAL_AMOUNT) when -1 then 'C' else 'P' end REVERSAL_AMOUNT_SIGN,abs(REVERSAL_AMOUNT)REVERSAL_AMOUNT,TRANSACTION_NO,CONTRACT_NO, PRODUCT_NAME,TYPE,case sign(PAID_AMOUNT) when -1 then 'C' else 'P' end PAID_AMOUNT_SIGN,PAID_AMOUNT PAID_AMOUNT,PAID_AMOUNT RETRO_PAID_AMOUNT,CURRENCY_ID,STATUS,RECEIPT_NO,DECODE(ADJUSTMENT_TYPE,'W','Write Off','R','Round Off')ADJUSTMENT_TYPE FROM TTRN_ALLOCATED_TRANSACTION WHERE RECEIPT_NO = ? AND SNO= ? ORDER BY SNO DESC
payment.select.getAlloTransDtls1=SELECT SNO,TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,TO_CHAR(REVERSAL_DATE,'DD/MM/YYYY') REVERSAL_DATE,case sign(REVERSAL_AMOUNT) when -1 then 'C' else 'P' end REVERSAL_AMOUNT_SIGN,abs(REVERSAL_AMOUNT)REVERSAL_AMOUNT,TRANSACTION_NO,CONTRACT_NO, PRODUCT_NAME,TYPE,case sign(PAID_AMOUNT) when -1 then 'C' else 'P' end PAID_AMOUNT_SIGN,PAID_AMOUNT PAID_AMOUNT,PAID_AMOUNT RETRO_PAID_AMOUNT,CURRENCY_ID,STATUS,RECEIPT_NO,DECODE(ADJUSTMENT_TYPE,'W','Write Off','R','Round Off')ADJUSTMENT_TYPE FROM TTRN_ALLOCATED_TRANSACTION WHERE RECEIPT_NO = ?  ORDER BY SNO DESC
payment.select.getBroCedingIds=SELECT BROKER_ID,CEDING_ID FROM TTRN_PAYMENT_RECEIPT A WHERE PAYMENT_RECEIPT_NO=? AND BRANCH_CODE=? AND A.AMEND_ID=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.PAYMENT_RECEIPT_NO AND BRANCH_CODE = A.BRANCH_CODE)
payment.select.getPymtRetDtls=SELECT (NVL(AMOUNT,0) - NVL (ALLOCATED_TILL_DATE, 0)) AMOUNT FROM TTRN_PAYMENT_RECEIPT_DETAILS R WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ? AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.select.getAlloAmt=SELECT (AMOUNT - NVL (ALLOCATED_TILL_DATE, 0)) AMOUNT FROM TTRN_PAYMENT_RECEIPT_DETAILS R WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ? AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.select.getExchRate=SELECT EXCHANGE_RATE FROM TTRN_PAYMENT_RECEIPT_DETAILS R WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ? AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.select.getRetDtls=SELECT PAYMENT_RECEIPT_NO,CEDING_ID,BROKER_ID,RECEIPT_BANK,TO_CHAR(TRANS_DATE,'DD/MM/YYYY') TRANS_DATE,PAID_AMT,CURRENCY_ID,EXCHANGE_RATE,TRANSCATIONTYPE,BANK_CHARGES,NET_AMT,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,REMARKS,PAID_AMT / EXCHANGE_RATE PAID_AMOUNTDC,BANK_CHARGES/EXCHANGE_RATE BankDC,NET_AMT/EXCHANGE_RATE NET_AMTDC,WH_TAX,PREMIUM_LAVY FROM TTRN_PAYMENT_RECEIPT R WHERE PAYMENT_RECEIPT_NO\=? AND BRANCH_CODE\=? AND R.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= R.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= R.BRANCH_CODE)
payment.select.getDirBroDtls=SELECT   A.COMPANY_NAME,B.FIRST_NAME || B.LAST_NAME AS BROKER,C.CURRENCY_NAME,R.PAID_AMT, TO_CHAR (TRANS_DATE, 'DD/MM/YYYY') AS TRANSDATE,PAYMENT_RECEIPT_NO,R.EXCHANGE_RATE,ROUND((R.PAID_AMT / R.EXCHANGE_RATE),2) TOT_EXC_AMT, R.BROKER_ID,R.DIFF_AMT,R.TRANSCATIONTYPE,R.CURRENCY_ID,R.REVERSALTRANSNO,R.BANK_CHARGES,R.NET_AMT,R.CONVERTED_DIFF_AMT,BM.BANK_NAME,WH_TAX,R.REMARKS,R.PREMIUM_LAVY FROM TTRN_PAYMENT_RECEIPT R INNER JOIN PERSONAL_INFO A ON R.CEDING_ID \= A.CUSTOMER_ID AND A.BRANCH_CODE\=? AND A.CUSTOMER_TYPE\='C' AND R.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= R.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= R.BRANCH_CODE) AND A.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=A.CUSTOMER_ID AND BRANCH_CODE\=A.BRANCH_CODE) INNER JOIN PERSONAL_INFO B ON B.CUSTOMER_ID \= R.BROKER_ID AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='B' AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\=B.BRANCH_CODE) INNER JOIN CURRENCY_MASTER C ON C.CURRENCY_ID \= R.CURRENCY_ID AND C.BRANCH_CODE\=? AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=C.CURRENCY_ID AND BRANCH_CODE\=C.BRANCH_CODE) INNER JOIN BANK_MASTER BM ON BM.BANK_ID\=R.RECEIPT_BANK AND BM.BRANCH_CODE\=R.BRANCH_CODE AND BM.STATUS\='Y' WHERE   R.PAYMENT_RECEIPT_NO \=? AND R.BRANCH_CODE\=?
payment.select.getBroDtls=SELECT   '' COMPANY_NAME,B.FIRST_NAME || B.LAST_NAME AS BROKER,C.SHORT_NAME CURRENCY_NAME,R.PAID_AMT,  TO_CHAR (TRANS_DATE, 'DD/MM/YYYY') AS TRANSDATE,PAYMENT_RECEIPT_NO,R.EXCHANGE_RATE,ROUND((R.PAID_AMT / R.EXCHANGE_RATE),2) TOT_EXC_AMT, R.BROKER_ID,R.DIFF_AMT,R.TRANSCATIONTYPE,R.CURRENCY_ID,R.REVERSALTRANSNO,R.BANK_CHARGES,R.NET_AMT,R.CONVERTED_DIFF_AMT,BM.BANK_NAME,WH_TAX,R.REMARKS,R.PREMIUM_LAVY FROM TTRN_PAYMENT_RECEIPT R INNER JOIN PERSONAL_INFO B ON B.CUSTOMER_ID \= R.BROKER_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='B' AND R.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= R.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= R.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\=B.BRANCH_CODE) INNER JOIN CURRENCY_MASTER C ON C.CURRENCY_ID \= R.CURRENCY_ID AND C.BRANCH_CODE\=? AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=C.CURRENCY_ID AND BRANCH_CODE\=C.BRANCH_CODE) INNER JOIN BANK_MASTER BM ON BM.BANK_ID\=R.RECEIPT_BANK AND BM.BRANCH_CODE\=R.BRANCH_CODE AND BM.STATUS\='Y' WHERE   R.PAYMENT_RECEIPT_NO \=? AND R.BRANCH_CODE\=?
GET_TRANSACTION_DATE=select to_char (TRANS_DATE,'DD/MM/YYYY') from TTRN_PAYMENT_RECEIPT R where PAYMENT_RECEIPT_NO\=? AND R.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT  WHERE   PAYMENT_RECEIPT_NO \= R.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= R.BRANCH_CODE)
payment.select.getReversalInfo= SELECT   DECODE (PI.COMPANY_NAME, 'DIRECT', NULL, PI.COMPANY_NAME)COMPANY_NAME, PIB.FIRST_NAME || ' ' || PIB.LAST_NAME broker, AB.BROKER_ID, CM.SHORT_NAME CURRENCY_NAME,AB.EXCHANGE_RATE,AB.PAYMENT_RECEIPT_NO, AB.PAID_AMT, Ab.CEDING_ID, AB.STATUS From  (Select A.Amend_id,A.STATUS,A.BRANCH_CODE,A.EXCHANGE_RATE, A.PAYMENT_RECEIPT_NO,A.CEDING_ID,A.BROKER_ID,A.PAID_AMT,A.TRANS_TYPE,A.CURRENCY_ID from TTRN_PAYMENT_RECEIPT A LEFT OUTER JOIN(  SELECT   RECEIPT_SL_NO, NVL (SUM (ALLOCATED_TILL_DATE), '0') ALLOCATED_TILL_DATE FROM   TTRN_PAYMENT_RECEIPT_DETAILS GROUP BY   RECEIPT_SL_NO) B ON A.PAYMENT_RECEIPT_NO = b.RECEIPT_SL_NO AND B.ALLOCATED_TILL_DATE = 0 Where  A.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.PAYMENT_RECEIPT_NO AND BRANCH_CODE = A.BRANCH_CODE)) AB JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = CASE WHEN AB.BROKER_ID = 63 THEN AB.CEDING_ID ELSE 63 END AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) JOIN PERSONAL_INFO PIB ON PIB.CUSTOMER_ID = AB.BROKER_ID AND PIB.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PIB.CUSTOMER_ID AND BRANCH_CODE = PIB.BRANCH_CODE) JOIN CURRENCY_MASTER CM ON CM.CURRENCY_ID = AB.CURRENCY_ID WHERE AB.TRANS_TYPE = ? AND AB.PAID_AMT = ? AND AB.CURRENCY_ID = ? AND AB.BRANCH_CODE = ? AND PI.BRANCH_CODE = ? AND PIB.BRANCH_CODE = ? AND CM.BRANCH_CODE = ?  AND CM.STATUS = 'Y' AND TRUNC (CM.EFFECTIVE_DATE) <= TRUNC (SYSDATE) AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND AB.PAYMENT_RECEIPT_NO =? AND AB.STATUS =?
payment.select.getReversalInfoStatus=SELECT   DECODE (PI.COMPANY_NAME, 'DIRECT', NULL, PI.COMPANY_NAME)COMPANY_NAME, PIB.FIRST_NAME || ' ' || PIB.LAST_NAME broker, AB.BROKER_ID, CM.SHORT_NAME CURRENCY_NAME,AB.EXCHANGE_RATE,AB.PAYMENT_RECEIPT_NO, AB.PAID_AMT, Ab.CEDING_ID, AB.STATUS From  (Select A.Amend_id,A.STATUS,A.BRANCH_CODE,A.EXCHANGE_RATE, A.PAYMENT_RECEIPT_NO,A.CEDING_ID,A.BROKER_ID,A.PAID_AMT,A.TRANS_TYPE,A.CURRENCY_ID from TTRN_PAYMENT_RECEIPT A LEFT OUTER JOIN(  SELECT   RECEIPT_SL_NO, NVL (SUM (ALLOCATED_TILL_DATE), '0') ALLOCATED_TILL_DATE FROM   TTRN_PAYMENT_RECEIPT_DETAILS GROUP BY   RECEIPT_SL_NO) B ON A.PAYMENT_RECEIPT_NO = b.RECEIPT_SL_NO AND B.ALLOCATED_TILL_DATE = 0 Where  A.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.PAYMENT_RECEIPT_NO AND BRANCH_CODE = A.BRANCH_CODE)) AB JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = CASE WHEN AB.BROKER_ID = 63 THEN AB.CEDING_ID ELSE 63 END AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) JOIN PERSONAL_INFO PIB ON PIB.CUSTOMER_ID = AB.BROKER_ID AND PIB.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PIB.CUSTOMER_ID AND BRANCH_CODE = PIB.BRANCH_CODE) JOIN CURRENCY_MASTER CM ON CM.CURRENCY_ID = AB.CURRENCY_ID WHERE AB.TRANS_TYPE = ? AND AB.PAID_AMT = ? AND AB.CURRENCY_ID = ? AND AB.BRANCH_CODE = ? AND PI.BRANCH_CODE = ? AND PIB.BRANCH_CODE = ? AND CM.BRANCH_CODE = ?  AND CM.STATUS = 'Y' AND TRUNC (CM.EFFECTIVE_DATE) <= TRUNC (SYSDATE) AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND AB.STATUS =?
payment.select.getPymtRetCurrDtls=SELECT B.CURRENCY_ID,B.SHORT_NAME CURRENCY_NAME,(A.AMOUNT-NVL(A.ALLOCATED_TILL_DATE,0)) AMOUNT FROM TTRN_PAYMENT_RECEIPT_DETAILS A,CURRENCY_MASTER B WHERE B.CURRENCY_ID=A.CURRENCY_ID AND B.BRANCH_CODE=?  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=A.RECEIPT_NO AND RECEIPT_SL_NO = A.RECEIPT_SL_NO) AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE  CURRENCY_ID=B.CURRENCY_ID AND BRANCH_CODE=B.BRANCH_CODE) AND A.RECEIPT_SL_NO = ?
GET_ALLOCATION_STATUS =SELECT COUNT(*) FROM TTRN_ALLOCATED_TRANSACTION  WHERE BRANCH_CODE\=?  and RECEIPT_NO\=?  AND STATUS\='Y'
payment.select.getAllTranDtls=SELECT SNO, TO_CHAR(INCEPTION_DATE, 'DD/MM/YYYY') ALLOCATION_DATE, TO_CHAR(REVERSAL_DATE, 'DD/MM/YYYY') REVERSAL_DATE1,CONTRACT_NO,PRODUCT_NAME,RECEIPT_NO,TRANSACTION_NO,CURRENCY_ID,REVERSAL_AMOUNT,TYPE,Decode(STATUS,'Y','Allocated','R','Reverted')STATUS FROM TTRN_ALLOCATED_TRANSACTION WHERE RECEIPT_NO =?  ORDER BY SNO DESC
getReversaltLists=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? )
getReversaltLists1=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? ) WHERE BRANCH_CODE=?  ORDER BY  PAYMENT_RECEIPT_NO DESC
getReversaltLists2=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? ) WHERE BRANCH_CODE=? AND PAYMENT_RECEIPT_NO like ? ORDER BY  PAYMENT_RECEIPT_NO DESC
getReversaltLists3=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? ) WHERE BRANCH_CODE=? AND UPPER(BROKER) like UPPER ? ORDER BY  PAYMENT_RECEIPT_NO DESC
getReversaltLists4=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? ) WHERE BRANCH_CODE=? AND UPPER(COMPANY_NAME) like UPPER ? ORDER BY  PAYMENT_RECEIPT_NO DESC
getReversaltLists5=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? AND A.STATUS\=? ) WHERE BRANCH_CODE=? AND UPPER(REMARKS) like UPPER ? ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getTotCount=SELECT COUNT(*) FROM TTRN_ALLOCATED_TRANSACTION WHERE RECEIPT_NO=? AND STATUS=?
PAYMENT_SELECT_GETREVERSALINFO_TREASURY =SELECT   DECODE (PI.COMPANY_NAME, 'DIRECT', NULL, PI.COMPANY_NAME)COMPANY_NAME, PIB.FIRST_NAME || ' ' || PIB.LAST_NAME broker, AB.BROKER_ID, CM.SHORT_NAME CURRENCY_NAME,AB.EXCHANGE_RATE,AB.PAYMENT_RECEIPT_NO, AB.PAID_AMT, Ab.CEDING_ID, AB.STATUS From  (Select A.Amend_id,A.STATUS,A.BRANCH_CODE,A.EXCHANGE_RATE, A.PAYMENT_RECEIPT_NO,A.CEDING_ID,A.BROKER_ID,A.PAID_AMT,A.TRANS_TYPE,A.CURRENCY_ID from TTRN_PAYMENT_RECEIPT A LEFT OUTER JOIN(  SELECT   RECEIPT_SL_NO, NVL (SUM (ALLOCATED_TILL_DATE), '0') ALLOCATED_TILL_DATE FROM   TTRN_PAYMENT_RECEIPT_DETAILS GROUP BY   RECEIPT_SL_NO) B ON A.PAYMENT_RECEIPT_NO = b.RECEIPT_SL_NO AND B.ALLOCATED_TILL_DATE = 0 Where  A.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.PAYMENT_RECEIPT_NO AND BRANCH_CODE = A.BRANCH_CODE)) AB JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = CASE WHEN AB.BROKER_ID = 63 THEN AB.CEDING_ID ELSE 63 END AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) JOIN PERSONAL_INFO PIB ON PIB.CUSTOMER_ID = AB.BROKER_ID AND PIB.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PIB.CUSTOMER_ID AND BRANCH_CODE = PIB.BRANCH_CODE) JOIN CURRENCY_MASTER CM ON CM.CURRENCY_ID = AB.CURRENCY_ID WHERE AB.TRANS_TYPE = ? AND AB.PAID_AMT = ? AND AB.CURRENCY_ID = ? AND AB.BRANCH_CODE = ? AND PI.BRANCH_CODE = ? AND PIB.BRANCH_CODE = ? AND CM.BRANCH_CODE = ? AND AB.BROKER_ID = ? And Decode(?,'-1','A', AB.CEDING_ID)=Decode(?,'-1','A',?) AND CM.STATUS = 'Y' AND TRUNC (CM.EFFECTIVE_DATE) <= TRUNC (SYSDATE) AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND AB.STATUS =? 
PAYMENT_SELECT_GETREVERSALINFO_TREASURY1 =SELECT   DECODE (PI.COMPANY_NAME, 'DIRECT', NULL, PI.COMPANY_NAME)COMPANY_NAME, PIB.FIRST_NAME || ' ' || PIB.LAST_NAME broker, AB.BROKER_ID, CM.SHORT_NAME CURRENCY_NAME,AB.EXCHANGE_RATE,AB.PAYMENT_RECEIPT_NO, AB.PAID_AMT, Ab.CEDING_ID, AB.STATUS From  (Select A.Amend_id,A.STATUS,A.BRANCH_CODE,A.EXCHANGE_RATE, A.PAYMENT_RECEIPT_NO,A.CEDING_ID,A.BROKER_ID,A.PAID_AMT,A.TRANS_TYPE,A.CURRENCY_ID from TTRN_PAYMENT_RECEIPT A LEFT OUTER JOIN(  SELECT   RECEIPT_SL_NO, NVL (SUM (ALLOCATED_TILL_DATE), '0') ALLOCATED_TILL_DATE FROM   TTRN_PAYMENT_RECEIPT_DETAILS GROUP BY   RECEIPT_SL_NO) B ON A.PAYMENT_RECEIPT_NO = b.RECEIPT_SL_NO AND B.ALLOCATED_TILL_DATE = 0 Where  A.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.PAYMENT_RECEIPT_NO AND BRANCH_CODE = A.BRANCH_CODE)) AB JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = CASE WHEN AB.BROKER_ID = 63 THEN AB.CEDING_ID ELSE 63 END AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) JOIN PERSONAL_INFO PIB ON PIB.CUSTOMER_ID = AB.BROKER_ID AND PIB.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PIB.CUSTOMER_ID AND BRANCH_CODE = PIB.BRANCH_CODE) JOIN CURRENCY_MASTER CM ON CM.CURRENCY_ID = AB.CURRENCY_ID WHERE AB.TRANS_TYPE = ? AND AB.PAID_AMT = ? AND AB.CURRENCY_ID = ? AND AB.BRANCH_CODE = ? AND PI.BRANCH_CODE = ? AND PIB.BRANCH_CODE = ? AND CM.BRANCH_CODE = ? AND AB.BROKER_ID = ? And Decode(?,'-1','A', AB.CEDING_ID)=Decode(?,'-1','A',?) AND CM.STATUS = 'Y' AND TRUNC (CM.EFFECTIVE_DATE) <= TRUNC (SYSDATE) AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND AB.PAYMENT_RECEIPT_NO =? AND AB.STATUS =?
payment.select.getReversalInfoPayNo=AND AB.PAYMENT_RECEIPT_NO =?

payment.update.rskPremChkyn=UPDATE RSK_PREMIUM_DETAILS SET CHECKYN\='',ACC_PREMIUM\=''
payment.update.claimPymtChkyn=UPDATE TTRN_CLAIM_PAYMENT SET CHECKYN\='',ACC_CLAIM\=''
payment.select.getRetAlloDtls=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?)
payment.select.getRetAlloDtls1=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?) WHERE BRANCH_CODE=? ORDER BY PAYMENT_RECEIPT_NO DESC
payment.select.getRetAlloDtls2=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?) WHERE BRANCH_CODE=? AND PAYMENT_RECEIPT_NO like ? ORDER BY PAYMENT_RECEIPT_NO DESC 
payment.select.getRetAlloDtls3=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?) WHERE BRANCH_CODE=? AND UPPER(BROKER) like UPPER (?) ORDER BY PAYMENT_RECEIPT_NO DESC 
payment.select.getRetAlloDtls4=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?) WHERE BRANCH_CODE=? AND UPPER(COMPANY_NAME) like UPPER (?) ORDER BY PAYMENT_RECEIPT_NO DESC
payment.select.getRetAlloDtls5=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?) WHERE BRANCH_CODE=? AND UPPER(REMARKS) like UPPER (?) ORDER BY PAYMENT_RECEIPT_NO DESC
payment.select.getRetAlloDtls6=SELECT * FROM (SELECT DISTINCT A.PAYMENT_RECEIPT_NO,A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME, C.COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER,C.CUSTOMER_ID AS CEDDINGID, D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A,CURRENCY_MASTER B, PERSONAL_INFO C,PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.CEDING_ID \= C.CUSTOMER_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID \= '63' AND A.BRANCH_CODE\=? AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= C.BRANCH_CODE  AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=C.BRANCH_CODE AND CUSTOMER_ID\=C.CUSTOMER_ID ) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID ) AND A.STATUS\='Y' AND A.TRANS_TYPE\=? UNION ALL SELECT DISTINCT A.PAYMENT_RECEIPT_NO, A.PAID_AMT,B.SHORT_NAME CURRENCY_NAME,'' COMPANY_NAME,D.FIRST_NAME || D.LAST_NAME AS BROKER, 0 AS CEDDINGID,D.CUSTOMER_ID AS BROKERID,A.REMARKS,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, CURRENCY_MASTER B, PERSONAL_INFO D WHERE A.CURRENCY_ID \= B.CURRENCY_ID AND A.BROKER_ID \= D.CUSTOMER_ID AND A.BROKER_ID <>'63' AND A.BRANCH_CODE\=?   AND A.BRANCH_CODE \= B.BRANCH_CODE AND A.BRANCH_CODE \= D.BRANCH_CODE AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND D.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE\=D.BRANCH_CODE AND CUSTOMER_ID\=D.CUSTOMER_ID) AND A.STATUS\='Y' AND A.TRANS_TYPE\=?) WHERE BRANCH_CODE=? AAND UPPER(CURRENCY_NAME) like UPPER (?) ORDER BY PAYMENT_RECEIPT_NO DESC
TREASURY_PAYMENT_SELECT_GETALLOCATEDTLS = SELECT   DISTINCT SNO,CURRENCY_ID,TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,ADJUSTMENT_TYPE  FROM   TTRN_ALLOCATED_TRANSACTION WHERE   RECEIPT_NO = ? AND STATUS = 'Y' ORDER BY   SNO DESC
payment.select.getSelCurrency=SELECT C.SHORT_NAME CURRENCY_NAME FROM CURRENCY_MASTER C WHERE C.BRANCH_CODE\=? AND C.CURRENCY_ID \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=C.CURRENCY_ID AND BRANCH_CODE\=C.BRANCH_CODE)
GET_ALOCATION_TYPE = SELECT TYPE FROM TTRN_ALLOCATED_TRANSACTION WHERE SNO=? AND STATUS = 'Y'
payment.select.getRetAmtDtls=SELECT (SELECT NVL(SUM(PAID_AMOUNT),'0') PAID_AMOUNT FROM TTRN_ALLOCATED_TRANSACTION WHERE SNO = ? AND (TYPE='P' OR TYPE = 'PT'))-(SELECT NVL(SUM(PAID_AMOUNT),'0') FROM TTRN_ALLOCATED_TRANSACTION WHERE SNO = ? AND (TYPE='C'  OR TYPE = 'RT')) AMT FROM DUAL
payment.select.getRetAmtDtls1=SELECT NVL(SUM(PAID_AMOUNT),'0') PAID_AMOUNT FROM TTRN_ALLOCATED_TRANSACTION WHERE SNO = ? and SNO = ? AND TYPE = 'RE'
payment.select.getTranContDtls=SELECT * FROM (SELECT distinct B.TRANSACTION_NO,A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,  TO_CHAR (B.ENTRY_DATE_TIME, 'DD/MM/YYYY') AS ADATE,(NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) NETDUE, NULL PAID_AMOUNT_OC,B.ACC_PREMIUM,NULL ACC_CLAIM,NVL (B.CHECKYN, 'N') CHECKYN,'P' BUSINESS_TYPE,(Select COMPANY_NAME from  personal_info pi where pi.customer_id=A.CEDING_COMPANY_ID and pi.branch_code=A.BRANCH_CODE and AMEND_ID = (select max(AMEND_ID) from personal_info per where per.customer_id = A.CEDING_COMPANY_ID AND per.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name,A.DEPT_ID,A.PROPOSAL_NO FROM POSITION_MASTER A,RSK_PREMIUM_DETAILS B WHERE B.RECEIPT_NO IS NULL AND B.CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (B.LAYER_NO, 0) AND A.DEPT_ID=B.SUB_CLASS AND A.BRANCH_CODE=? AND (NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) !=0 AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM WHERE CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (PM.LAYER_NO, 0) AND A.DEPT_ID=PM.DEPT_ID AND B.CURRENCY_ID = ? AND CASE WHEN '63' = ? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ? AND A.CONTRACT_NO LIKE ? AND A.PRODUCT_ID LIKE ?) UNION ALL SELECT distinct CP.CLAIM_PAYMENT_NO,A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS ADATE, NULL NETDUE_OC,(NVL (CP.PAID_AMOUNT_OC, 0)- NVL (CP.ALLOCATED_TILL_DATE, 0)) PAID_AMOUNT, NULL ACC_PREMIUM, CP.ACC_CLAIM,NVL (CP.CHECKYN, 'N'),'C' BUSINESS_TYPE,(Select COMPANY_NAME from  personal_info pi where pi.customer_id=A.CEDING_COMPANY_ID and pi.branch_code=A.BRANCH_CODE and AMEND_ID = (select max(AMEND_ID) from personal_info per where per.customer_id = A.CEDING_COMPANY_ID AND per.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name ,A.DEPT_ID,A.PROPOSAL_NO FROM POSITION_MASTER A, TTRN_CLAIM_DETAILS C,TTRN_CLAIM_PAYMENT CP WHERE A.CONTRACT_NO = C.CONTRACT_NO AND C.CONTRACT_NO=CP.CONTRACT_NO AND C.CLAIM_NO=CP.CLAIM_NO AND NVL (A.LAYER_NO, 0) = NVL (C.LAYER_NO, 0) AND A.DEPT_ID=C.SUB_CLASS  AND A.BRANCH_CODE=? AND (NVL (CP.PAID_AMOUNT_OC, 0) - NVL (CP.ALLOCATED_TILL_DATE, 0)) != 0 AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (LAYER_NO, 0)) AND A.DEPT_ID=DEPT_ID AND C.CURRENCY = ? AND CASE WHEN '63' =? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ? AND A.CONTRACT_NO LIKE ? AND A.PRODUCT_ID LIKE ?) WHERE BUSINESS_TYPE LIKE ? ORDER BY CONTRACT_NO, TRANSACTION_NO,NETDUE NULLS LAST
payment.insert.receipt=INSERT INTO TTRN_PAYMENT_RECEIPT (PAYMENT_RECEIPT_NO,BROKER_ID,CEDING_ID,CURRENCY_ID,PAID_AMT,EXCHANGE_RATE,RECEIPT_BANK,PRODUCT_ID,DEPT_ID,STATUS,TRANS_DATE,TRANS_TYPE,TRANSCATIONTYPE,BRANCH_CODE,BANK_CHARGES,NET_AMT,REMARKS,WH_TAX,AMEND_ID,LOGIN_ID,SYS_DATE,PREMIUM_LAVY) VALUES(?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,'0',?,SYSDATE,?)
payment.update.pymtRetData=INSERT INTO TTRN_PAYMENT_RECEIPT (PAYMENT_RECEIPT_NO,BROKER_ID,CEDING_ID,CURRENCY_ID,PAID_AMT,EXCHANGE_RATE,RECEIPT_BANK,PRODUCT_ID,DEPT_ID,STATUS,TRANS_DATE,TRANS_TYPE,TRANSCATIONTYPE,BRANCH_CODE,BANK_CHARGES,NET_AMT,REMARKS,WH_TAX,AMEND_ID,AMENDMENT_DATE,LOGIN_ID,SYS_DATE,PREMIUM_LAVY) VALUES(?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM TTRN_PAYMENT_RECEIPT WHERE PAYMENT_RECEIPT_NO = ? AND BRANCH_CODE=?),TO_DATE(?,'DD/MM/YYYY'),?,SYSDATE,?)
payment.select.getTranContDtls=SELECT * FROM (SELECT distinct B.TRANSACTION_NO,A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,  TO_CHAR (B.ENTRY_DATE_TIME, 'DD/MM/YYYY') AS ADATE,(NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) NETDUE, NULL PAID_AMOUNT_OC,B.ACC_PREMIUM,NULL ACC_CLAIM,NVL (B.CHECKYN, 'N') CHECKYN,'P' BUSINESS_TYPE,(Select COMPANY_NAME from  personal_info pi where pi.customer_id=A.CEDING_COMPANY_ID and pi.branch_code=A.BRANCH_CODE and AMEND_ID = (select max(AMEND_ID) from personal_info per where per.customer_id = A.CEDING_COMPANY_ID AND per.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name,A.DEPT_ID,A.PROPOSAL_NO FROM POSITION_MASTER A,RSK_PREMIUM_DETAILS B WHERE B.RECEIPT_NO IS NULL AND B.CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (B.LAYER_NO, 0) AND A.DEPT_ID=B.SUB_CLASS AND A.BRANCH_CODE=? AND (NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) !=0 AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM WHERE CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (PM.LAYER_NO, 0) AND A.DEPT_ID=PM.DEPT_ID AND B.CURRENCY_ID = ? AND CASE WHEN '63' = ? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ? AND A.CONTRACT_NO LIKE ? AND A.PRODUCT_ID LIKE ?) UNION ALL SELECT distinct CP.CLAIM_PAYMENT_NO,A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS ADATE, NULL NETDUE_OC,(NVL (CP.PAID_AMOUNT_OC, 0)- NVL (CP.ALLOCATED_TILL_DATE, 0)) PAID_AMOUNT, NULL ACC_PREMIUM, CP.ACC_CLAIM,NVL (CP.CHECKYN, 'N'),'C' BUSINESS_TYPE,(Select COMPANY_NAME from  personal_info pi where pi.customer_id=A.CEDING_COMPANY_ID and pi.branch_code=A.BRANCH_CODE and AMEND_ID = (select max(AMEND_ID) from personal_info per where per.customer_id = A.CEDING_COMPANY_ID AND per.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name ,A.DEPT_ID,A.PROPOSAL_NO FROM POSITION_MASTER A, TTRN_CLAIM_DETAILS C,TTRN_CLAIM_PAYMENT CP WHERE A.CONTRACT_NO = C.CONTRACT_NO AND C.CONTRACT_NO=CP.CONTRACT_NO AND C.CLAIM_NO=CP.CLAIM_NO AND NVL (A.LAYER_NO, 0) = NVL (C.LAYER_NO, 0) AND A.DEPT_ID=C.SUB_CLASS  AND A.BRANCH_CODE=? AND (NVL (CP.PAID_AMOUNT_OC, 0) - NVL (CP.ALLOCATED_TILL_DATE, 0)) != 0 AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (LAYER_NO, 0)) AND A.DEPT_ID=DEPT_ID AND C.CURRENCY = ? AND CASE WHEN '63' =? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ? AND A.CONTRACT_NO LIKE ? AND A.PRODUCT_ID LIKE ?) WHERE BUSINESS_TYPE LIKE ? ORDER BY CONTRACT_NO, TRANSACTION_NO,NETDUE NULLS LAST
ceding.select.direct=select p.CUSTOMER_ID as ID, CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END as NAME from PERSONAL_INFO p where p.BRANCH_CODE = ? AND p.CUSTOMER_ID <> '63' AND P.CUSTOMER_TYPE = 'C' ORDER BY NAME
GET_SHORT_NAME= SELECT (SELECT SHORT_NAME FROM Currency_Master CM WHERE CM.CURRENCY_ID= TBM.BASE_CURRENCY_ID AND CM.BRANCH_CODE = TBM.BRANCH_CODE and cm.amend_id=(select max(NVL(amend_id,0)) SHORT_NAME from currency_master where currency_id=cm.currency_id and BRANCH_CODE = cm.BRANCH_CODE)) COUNTRY_SHORT_NAME FROM TMAS_BRANCH_MASTER TBM WHERE  TBM.BRANCH_CODE=? AND TBM.STATUS='Y'

treasury.journal.view=Select  To_Char(Startdate) Startdate , Reference, Ledger, Uwy, Spc, Currency, To_Number(Debitoc) Debitoc, To_Number(Creditoc) Creditoc, To_Number(Debitugx) Debitugx,To_Number(Creditugx) Creditugx, Narration, To_Char(Product_Id) Product_Id,To_Char(End_Date) End_Date From Journel_Format WHERE   TRANSACTION_NO\=?  Union All Select '','','Total',to_number(''),'','',Sum(Debitoc) Debitoc,Sum(Creditoc) Creditoc,Sum(Debitugx) Debitugx,Sum(Creditugx) Creditugx,'','','' From Journel_Format WHERE   TRANSACTION_NO\=?
treasury.journal.view1 = Select  To_Char(STARTDATE) STARTDATE, REFERENCE, LEDGER, UWY, SPC, CURRENCY, To_Number(DEBITOC) DEBITOC, To_Number(CREDITOC) CREDITOC, To_Number(DEBITUGX) DEBITUGX,To_Number(CREDITUGX) CREDITUGX, NARRATION, To_Char(PRODUCT_ID) PRODUCT_ID,To_Char(END_DATE) END_DATE From Journel_Format WHERE   TRANSACTION_NO\=?  Union All Select '','','Total',to_number(''),'','',Sum(DEBITOC) DEBITOC,Sum(CREDITOC) CREDITOC,Sum(DEBITUGX) DEBITUGX,Sum(CREDITUGX) CREDITUGX,'','','' From Journel_Format WHERE   TRANSACTION_NO\=?
dropdowm.getseqno=select Fn_get_SeqNo(?,?,?,?,?,?) SEQNO from dual
payment.select.getDirBroDtls.retro=select RETRO_CONTRACT_NUMBER,TRANSACTION_NO,RETROCESSIONAIRE,TO_CHAR (TRANSACTION_DATE, 'DD/MM/YYYY')TRANSACTION_DATE,'RE'TYPE, abs((NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)))NETDUE,case sign(NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)) when -1 then 'C' else 'P' end sign,(SELECT   COMPANY_NAME FROM   personal_info pi WHERE   pi.customer_id = RETROCESSIONAIRE AND pi.branch_code = A.BRANCH_CODE) CEDING_COMPANY_name from ttrn_retro_soa A where branch_code=? and RETRO_CURRENCY_ID=? AND CASE WHEN '63' = ? THEN A.RETROCESSIONAIRE ELSE A.RETRO_BROKER END = ?  AND (NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)) !=0  ORDER BY RETRO_CONTRACT_NUMBER, TRANSACTION_NO,NET_DUE_RCP NULLS LAST
payment.update.retro.details=UPDATE TTRN_RETRO_SOA SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)+( ? )) WHERE RETRO_CONTRACT_NUMBER = ? AND TRANSACTION_NO = ?
payment.update.retro.status=UPDATE TTRN_RETRO_SOA SET ALLOCATION_STATUS\=? WHERE  (NVL(NET_DUE_RCP,'0')-NVL(ALLOCATED_TILL_DATE,'0'))\='0' AND RETRO_CONTRACT_NUMBER\=? AND TRANSACTION_NO\=?
payment.insert.alloTran=INSERT INTO TTRN_ALLOCATED_TRANSACTION(SNO,CONTRACT_NO,LAYER_NO,PRODUCT_NAME,TRANSACTION_NO,INCEPTION_DATE,PAID_AMOUNT,TYPE,STATUS,AMEND_ID,RECEIPT_NO,CURRENCY_ID,process_type,SUB_CLASS,LOGIN_ID,BRANCH_CODE,SYS_DATE,PROPOSAL_NO) VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,? ,?,?,?,?,SYSDATE,?)
payment.update.AlloTranDtls=UPDATE TTRN_PAYMENT_RECEIPT_DETAILS R SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)+( ? )),LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ?  AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.select.getReversalInfo1= SELECT   DECODE (PI.COMPANY_NAME, 'DIRECT', NULL, PI.COMPANY_NAME)COMPANY_NAME, PIB.FIRST_NAME || ' ' || PIB.LAST_NAME broker, AB.BROKER_ID, CM.SHORT_NAME CURRENCY_NAME,AB.EXCHANGE_RATE,AB.PAYMENT_RECEIPT_NO, AB.PAID_AMT, Ab.CEDING_ID, AB.STATUS From  (Select A.Amend_id,A.STATUS,A.BRANCH_CODE,A.EXCHANGE_RATE, A.PAYMENT_RECEIPT_NO,A.CEDING_ID,A.BROKER_ID,A.PAID_AMT,A.TRANS_TYPE,A.CURRENCY_ID from TTRN_PAYMENT_RECEIPT A LEFT OUTER JOIN(  SELECT   RECEIPT_SL_NO, NVL (SUM (ALLOCATED_TILL_DATE), '0') ALLOCATED_TILL_DATE FROM   TTRN_PAYMENT_RECEIPT_DETAILS GROUP BY   RECEIPT_SL_NO) B ON A.PAYMENT_RECEIPT_NO = b.RECEIPT_SL_NO AND B.ALLOCATED_TILL_DATE = 0 Where  A.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = A.PAYMENT_RECEIPT_NO AND BRANCH_CODE = A.BRANCH_CODE)) AB JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = CASE WHEN AB.BROKER_ID = 63 THEN AB.CEDING_ID ELSE 63 END AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) JOIN PERSONAL_INFO PIB ON PIB.CUSTOMER_ID = AB.BROKER_ID AND PIB.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PIB.CUSTOMER_ID AND BRANCH_CODE = PIB.BRANCH_CODE) JOIN CURRENCY_MASTER CM ON CM.CURRENCY_ID = AB.CURRENCY_ID WHERE AB.TRANS_TYPE = ? AND AB.PAID_AMT = ? AND AB.CURRENCY_ID = ? AND AB.BRANCH_CODE = ? AND PI.BRANCH_CODE = ? AND PIB.BRANCH_CODE = ? AND CM.BRANCH_CODE = ?  AND CM.STATUS = 'Y' AND TRUNC (CM.EFFECTIVE_DATE) <= TRUNC (SYSDATE) AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND AB.PAYMENT_RECEIPT_NO =? AND AB.STATUS =?

payment.select.getRetLists=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?) ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getRetLists1=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?) WHERE BRANCH_CODE=? ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getRetLists2=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?) AND PAYMENT_RECEIPT_NO like WHERE BRANCH_CODE=? ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getRetLists3=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?) AND UPPER(BROKER) like UPPER WHERE BRANCH_CODE=? ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getRetLists4=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?) AND UPPER(COMPANY_NAME) like UPPER WHERE BRANCH_CODE=? ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getRetLists5=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?) AND UPPER(REMARKS) like UPPER WHERE BRANCH_CODE=? ORDER BY  PAYMENT_RECEIPT_NO DESC
payment.select.getRetLists.paymentno=SELECT * FROM (SELECT A.PAYMENT_RECEIPT_NO,B.COMPANY_NAME,C.FIRST_NAME || C.LAST_NAME AS BROKER, A.PAYMENT_RESPONSE,A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO B, PERSONAL_INFO C WHERE B.CUSTOMER_ID \= A.CEDING_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='C' AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\= B.BRANCH_CODE AND CUSTOMER_TYPE\= B.CUSTOMER_TYPE) AND C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID \= '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=? UNION ALL SELECT A.PAYMENT_RECEIPT_NO,'' COMPANY_NAME, C.FIRST_NAME || C.LAST_NAME AS BROKER,A.PAYMENT_RESPONSE, A.PAID_AMT,A.BROKER_ID,A.REVERSALTRANSNO,A.REMARKS, A.TRANSCATIONTYPE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY')TRANS_DATE,A.BRANCH_CODE FROM TTRN_PAYMENT_RECEIPT A, PERSONAL_INFO C WHERE C.CUSTOMER_ID \= A.BROKER_ID AND C.BRANCH_CODE\=? AND C.CUSTOMER_TYPE\='B'  AND A.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= A.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= A.BRANCH_CODE) AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\= C.BRANCH_CODE AND CUSTOMER_TYPE\= C.CUSTOMER_TYPE) AND A.BROKER_ID <> '63' AND A.TRANS_TYPE \= ? AND A.BRANCH_CODE\=?)
payment.select.getTotCount=SELECT COUNT(*)COUNT FROM TTRN_ALLOCATED_TRANSACTION WHERE RECEIPT_NO=? AND STATUS=?
payment.select.getTotCount=SELECT COUNT(*)COUNT FROM TTRN_ALLOCATED_TRANSACTION WHERE RECEIPT_NO=? AND STATUS=?
payment_amount_details=SELECT (A.AMOUNT-NVL(A.ALLOCATED_TILL_DATE,0)) AMOUNT FROM TTRN_PAYMENT_RECEIPT_DETAILS A,CURRENCY_MASTER B WHERE B.CURRENCY_ID=A.CURRENCY_ID AND B.BRANCH_CODE=?  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=A.RECEIPT_NO AND RECEIPT_SL_NO = A.RECEIPT_SL_NO) AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE  CURRENCY_ID=B.CURRENCY_ID AND BRANCH_CODE=B.BRANCH_CODE) AND A.RECEIPT_SL_NO = ?
payment.select.getDirBroDtls.retro=select RETRO_CONTRACT_NUMBER,TRANSACTION_NO,RETROCESSIONAIRE,TO_CHAR (TRANSACTION_DATE, 'DD/MM/YYYY')TRANSACTION_DATE,'RE'TYPE, abs((NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)))NETDUE,case sign(NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)) when -1 then 'C' else 'P' end sign,(SELECT   COMPANY_NAME FROM   personal_info pi WHERE   pi.customer_id = RETROCESSIONAIRE AND pi.branch_code = A.BRANCH_CODE) CEDING_COMPANY_name from ttrn_retro_soa A where branch_code=? and RETRO_CURRENCY_ID=? AND CASE WHEN '63' = ? THEN A.RETROCESSIONAIRE ELSE A.RETRO_BROKER END = ?  AND (NVL (NET_DUE_RCP, 0) - NVL (ALLOCATED_TILL_DATE, 0)) !=0  ORDER BY RETRO_CONTRACT_NUMBER, TRANSACTION_NO,NET_DUE_RCP NULLS LAST
payment.select.getDirBroDtls=SELECT   A.COMPANY_NAME,B.FIRST_NAME || B.LAST_NAME AS BROKER,C.CURRENCY_NAME,R.PAID_AMT, TO_CHAR (TRANS_DATE, 'DD/MM/YYYY') AS TRANSDATE,PAYMENT_RECEIPT_NO,R.EXCHANGE_RATE,ROUND((R.PAID_AMT / R.EXCHANGE_RATE),2) TOT_EXC_AMT, R.BROKER_ID,R.DIFF_AMT,R.TRANSCATIONTYPE,R.CURRENCY_ID,R.REVERSALTRANSNO,R.BANK_CHARGES,R.NET_AMT,R.CONVERTED_DIFF_AMT,BM.BANK_NAME,WH_TAX,R.REMARKS,R.PREMIUM_LAVY FROM TTRN_PAYMENT_RECEIPT R INNER JOIN PERSONAL_INFO A ON R.CEDING_ID \= A.CUSTOMER_ID AND A.BRANCH_CODE\=? AND A.CUSTOMER_TYPE\='C' AND R.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= R.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= R.BRANCH_CODE) AND A.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=A.CUSTOMER_ID AND BRANCH_CODE\=A.BRANCH_CODE) INNER JOIN PERSONAL_INFO B ON B.CUSTOMER_ID \= R.BROKER_ID AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='B' AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\=B.BRANCH_CODE) INNER JOIN CURRENCY_MASTER C ON C.CURRENCY_ID \= R.CURRENCY_ID AND C.BRANCH_CODE\=? AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=C.CURRENCY_ID AND BRANCH_CODE\=C.BRANCH_CODE) INNER JOIN BANK_MASTER BM ON BM.BANK_ID\=R.RECEIPT_BANK AND BM.BRANCH_CODE\=R.BRANCH_CODE AND BM.STATUS\='Y' WHERE   R.PAYMENT_RECEIPT_NO \=? AND R.BRANCH_CODE\=?
payment.select.getBroDtls=SELECT   '' COMPANY_NAME,B.FIRST_NAME || B.LAST_NAME AS BROKER,C.SHORT_NAME CURRENCY_NAME,R.PAID_AMT,  TO_CHAR (TRANS_DATE, 'DD/MM/YYYY') AS TRANSDATE,PAYMENT_RECEIPT_NO,R.EXCHANGE_RATE,ROUND((R.PAID_AMT / R.EXCHANGE_RATE),2) TOT_EXC_AMT, R.BROKER_ID,R.DIFF_AMT,R.TRANSCATIONTYPE,R.CURRENCY_ID,R.REVERSALTRANSNO,R.BANK_CHARGES,R.NET_AMT,R.CONVERTED_DIFF_AMT,BM.BANK_NAME,WH_TAX,R.REMARKS,R.PREMIUM_LAVY FROM TTRN_PAYMENT_RECEIPT R INNER JOIN PERSONAL_INFO B ON B.CUSTOMER_ID \= R.BROKER_ID  AND B.BRANCH_CODE\=? AND B.CUSTOMER_TYPE\='B' AND R.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO \= R.PAYMENT_RECEIPT_NO AND BRANCH_CODE \= R.BRANCH_CODE) AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID AND BRANCH_CODE\=B.BRANCH_CODE) INNER JOIN CURRENCY_MASTER C ON C.CURRENCY_ID \= R.CURRENCY_ID AND C.BRANCH_CODE\=? AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=C.CURRENCY_ID AND BRANCH_CODE\=C.BRANCH_CODE) INNER JOIN BANK_MASTER BM ON BM.BANK_ID\=R.RECEIPT_BANK AND BM.BRANCH_CODE\=R.BRANCH_CODE AND BM.STATUS\='Y' WHERE   R.PAYMENT_RECEIPT_NO \=? AND R.BRANCH_CODE\=?
payment.select.getRetViewDtls=SELECT  A.RECEIPT_NO,A.RECEIPT_SL_NO,A.AMOUNT,A.EXCHANGE_RATE,TO_CHAR(A.TRANS_DATE,'DD/MM/YYYY') AS IDATE,B.SHORT_NAME CURRENCY_NAME,A.TOT_AMT,A.SETTLED_EXCRATE,A.CONVERTED_RECCUR  FROM TTRN_PAYMENT_RECEIPT_DETAILS A,CURRENCY_MASTER B  WHERE B.CURRENCY_ID=A.CURRENCY_ID  AND  B.BRANCH_CODE=? AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=B.CURRENCY_ID AND BRANCH_CODE=B.BRANCH_CODE)  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS WHERE RECEIPT_NO=A.RECEIPT_NO AND RECEIPT_SL_NO = A.RECEIPT_SL_NO) AND A.RECEIPT_SL_NO=? ORDER BY A.RECEIPT_NO
payment.select.currencyAmt=SELECT (AMOUNT-NVL(ALLOCATED_TILL_DATE,0)) AMOUNT,SHORT_NAME CURRENCY_NAME FROM TTRN_PAYMENT_RECEIPT_DETAILS R INNER JOIN CURRENCY_MASTER C ON C.CURRENCY_ID=R.CURRENCY_ID AND C.BRANCH_CODE=? AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO) AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE  CURRENCY_ID=C.CURRENCY_ID AND BRANCH_CODE=C.BRANCH_CODE) WHERE RECEIPT_SL_NO=? AND R.CURRENCY_ID=?
payment.select.getSecondPageDtls=SELECT CURRENCY_ID,EXCHANGE_RATE,AMOUNT,TOT_AMT,RECEIPT_NO,SETTLED_EXCRATE,CONVERTED_RECCUR FROM TTRN_PAYMENT_RECEIPT_DETAILS A WHERE RECEIPT_SL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS WHERE RECEIPT_NO=A.RECEIPT_NO AND RECEIPT_SL_NO = A.RECEIPT_SL_NO) ORDER BY RECEIPT_NO
payment.select.getDiffAmt=SELECT NVL(DIFF_AMT,'0') DIFF_AMT FROM TTRN_PAYMENT_RECEIPT TPR WHERE PAYMENT_RECEIPT_NO = ? AND BRANCH_CODE=? and amend_id=(select max(amend_id) from TTRN_PAYMENT_RECEIPT where PAYMENT_RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO AND BRANCH_CODE=TPR.BRANCH_CODE)
payment.update.diffAmt=UPDATE TTRN_PAYMENT_RECEIPT R SET DIFF_AMT = ?,CONVERTED_DIFF_AMT=?,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE PAYMENT_RECEIPT_NO = ? AND BRANCH_CODE=? and R.AMEND_ID=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = R.PAYMENT_RECEIPT_NO AND BRANCH_CODE = R.BRANCH_CODE)
payment.update.reversalPayment=UPDATE TTRN_PAYMENT_RECEIPT R SET STATUS=?,REVTRANSALTYPE=?,REVERSALTRANSNO=?,REVERSALDATE=SYSDATE,REVERSELLOGINID=?,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE PAYMENT_RECEIPT_NO=? AND BRANCH_CODE=? AND R.AMEND_ID=(SELECT   MAX (AMEND_ID) FROM   TTRN_PAYMENT_RECEIPT WHERE   PAYMENT_RECEIPT_NO = R.PAYMENT_RECEIPT_NO AND BRANCH_CODE = R.BRANCH_CODE)
payment.update.reversalPaymentDetails=UPDATE TTRN_PAYMENT_RECEIPT_DETAILS R SET STATUS='R',ALLOCATED_TILL_DATE=AMOUNT,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RECEIPT_SL_NO=? AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.select.getNextRetDtlsNo=SELECT NVL(MAX(RECEIPT_NO),0)+1 AS RECEIPT FROM TTRN_PAYMENT_RECEIPT_DETAILS
payment.update.payRetDtls=INSERT INTO TTRN_PAYMENT_RECEIPT_DETAILS (CURRENCY_ID,AMOUNT,EXCHANGE_RATE,TRANS_DATE,STATUS,TOT_AMT,SETTLED_EXCRATE,CONVERTED_RECCUR,RECEIPT_NO,RECEIPT_SL_NO,AMEND_ID,LOGIN_ID,BRANCH_CODE,SYS_DATE)VALUES(?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM TTRN_PAYMENT_RECEIPT_DETAILS WHERE RECEIPT_NO\=? AND RECEIPT_SL_NO\=?),?,?,SYSDATE)
payment.insert.payRetDtls=INSERT INTO TTRN_PAYMENT_RECEIPT_DETAILS (RECEIPT_NO,RECEIPT_SL_NO,CURRENCY_ID,AMOUNT,EXCHANGE_RATE,TRANS_DATE,STATUS,TOT_AMT,SETTLED_EXCRATE,CONVERTED_RECCUR,AMEND_ID,LOGIN_ID,BRANCH_CODE,SYS_DATE) VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,(SELECT nvl(MAX(AMEND_ID),0) FROM TTRN_PAYMENT_RECEIPT_DETAILS WHERE  RECEIPT_SL_NO=?),?,?,SYSDATE)
payment.update.rskPremAlloDtls=UPDATE RSK_PREMIUM_DETAILS SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)+( ? )),LOGIN_ID=?,BRANCH_CODE=?,ENTRY_DATE=sysdate WHERE CONTRACT_NO = ? AND TRANSACTION_NO = ?
payment.update.preSetStatus=UPDATE RSK_PREMIUM_DETAILS SET SETTLEMENT_STATUS=? WHERE  (NVL(NETDUE_OC,'0')-NVL(ALLOCATED_TILL_DATE,'0'))='0' and LOGIN_ID=? and BRANCH_CODE=? AND CONTRACT_NO=? AND TRANSACTION_NO=?
payment.update.claimPymtAlloDtls=UPDATE TTRN_CLAIM_PAYMENT SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)+( ? )),SYS_DATE=SYSDATE,BRANCH_CODE=?,LOGIN_ID=? WHERE CONTRACT_NO = ? AND CLAIM_PAYMENT_NO = ?
payment.update.claimSetStatus=UPDATE TTRN_CLAIM_PAYMENT SET SETTLEMENT_STATUS=?,SYS_DATE=SYSDATE,BRANCH_CODE=?,LOGIN_ID=?  WHERE (NVL(PAID_AMOUNT_OC,'0')-NVL(ALLOCATED_TILL_DATE,'0'))='0' AND CONTRACT_NO = ? AND CLAIM_PAYMENT_NO = ?
payment.insert.alloTran=INSERT INTO TTRN_ALLOCATED_TRANSACTION(SNO,CONTRACT_NO,LAYER_NO,PRODUCT_NAME,TRANSACTION_NO,INCEPTION_DATE,PAID_AMOUNT,TYPE,STATUS,AMEND_ID,RECEIPT_NO,CURRENCY_ID,process_type,SUB_CLASS,LOGIN_ID,BRANCH_CODE,SYS_DATE,PROPOSAL_NO) VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,? ,?,?,?,?,SYSDATE,?)
payment.update.AlloTranDtls=UPDATE TTRN_PAYMENT_RECEIPT_DETAILS R SET ALLOCATED_TILL_DATE=(NVL((ALLOCATED_TILL_DATE),0)+( ? )),LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RECEIPT_SL_NO = ? AND CURRENCY_ID = ?  AND R.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS  WHERE RECEIPT_NO=R.RECEIPT_NO AND RECEIPT_SL_NO = R.RECEIPT_SL_NO)
payment.update.rskPremChkyn=UPDATE RSK_PREMIUM_DETAILS SET CHECKYN\='',ACC_PREMIUM\='' 
payment.select.getTranContDtls=SELECT * FROM (SELECT distinct B.TRANSACTION_NO,A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,  TO_CHAR (B.ENTRY_DATE_TIME, 'DD/MM/YYYY') AS ADATE,(NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) NETDUE, NULL PAID_AMOUNT_OC,B.ACC_PREMIUM,NULL ACC_CLAIM,NVL (B.CHECKYN, 'N') CHECKYN,'P' BUSINESS_TYPE,(Select COMPANY_NAME from  personal_info pi where pi.customer_id=A.CEDING_COMPANY_ID and pi.branch_code=A.BRANCH_CODE and AMEND_ID = (select max(AMEND_ID) from personal_info per where per.customer_id = A.CEDING_COMPANY_ID AND per.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name,A.DEPT_ID,A.PROPOSAL_NO FROM POSITION_MASTER A,RSK_PREMIUM_DETAILS B WHERE B.RECEIPT_NO IS NULL AND B.CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (B.LAYER_NO, 0) AND A.DEPT_ID=B.SUB_CLASS AND A.BRANCH_CODE=? AND (NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) !=0 AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM WHERE CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (PM.LAYER_NO, 0) AND A.DEPT_ID=PM.DEPT_ID AND B.CURRENCY_ID = ? AND CASE WHEN '63' = ? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ? AND A.CONTRACT_NO LIKE ? AND A.PRODUCT_ID LIKE ?) UNION ALL SELECT distinct CP.CLAIM_PAYMENT_NO,A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS ADATE, NULL NETDUE_OC,(NVL (CP.PAID_AMOUNT_OC, 0)- NVL (CP.ALLOCATED_TILL_DATE, 0)) PAID_AMOUNT, NULL ACC_PREMIUM, CP.ACC_CLAIM,NVL (CP.CHECKYN, 'N'),'C' BUSINESS_TYPE,(Select COMPANY_NAME from  personal_info pi where pi.customer_id=A.CEDING_COMPANY_ID and pi.branch_code=A.BRANCH_CODE and AMEND_ID = (select max(AMEND_ID) from personal_info per where per.customer_id = A.CEDING_COMPANY_ID AND per.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name ,A.DEPT_ID,A.PROPOSAL_NO FROM POSITION_MASTER A, TTRN_CLAIM_DETAILS C,TTRN_CLAIM_PAYMENT CP WHERE A.CONTRACT_NO = C.CONTRACT_NO AND C.CONTRACT_NO=CP.CONTRACT_NO AND C.CLAIM_NO=CP.CLAIM_NO AND NVL (A.LAYER_NO, 0) = NVL (C.LAYER_NO, 0) AND A.DEPT_ID=C.SUB_CLASS  AND A.BRANCH_CODE=? AND (NVL (CP.PAID_AMOUNT_OC, 0) - NVL (CP.ALLOCATED_TILL_DATE, 0)) != 0 AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (LAYER_NO, 0)) AND A.DEPT_ID=DEPT_ID AND C.CURRENCY = ? AND CASE WHEN '63' =? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ? AND A.CONTRACT_NO LIKE ? AND A.PRODUCT_ID LIKE ?) WHERE BUSINESS_TYPE LIKE ? ORDER BY CONTRACT_NO, TRANSACTION_NO,NETDUE NULLS LAST

GET_FAC_PROPOSAL_NO=SELECT PROPOSAL_NO,DEPT_ID FROM POSITION_MASTER PM WHERE CONTRACT_NO=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO )
GET_PRO_PROPOSAL_NO=SELECT PROPOSAL_NO,DEPT_ID FROM POSITION_MASTER PM WHERE CONTRACT_NO=? AND DEPT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO AND DEPT_ID=PM.DEPT_ID)
GET_XOL_PROPOSAL_NO=SELECT PROPOSAL_NO,DEPT_ID FROM POSITION_MASTER PM WHERE CONTRACT_NO=? AND LAYER_NO=NVL(?,0) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO AND LAYER_NO=PM.LAYER_NO)
claim.select.sumPaidAmt1=SELECT SUM(PAID_AMOUNT_OC) PAID_AMOUNT_OC  FROM TTRN_CLAIM_PAYMENT WHERE  CLAIM_NO\=? and CONTRACT_NO\=?
claim.select.revSumPaidAmt1=SELECT NVL(SUM(CP.PAID_AMOUNT_OC),'0') PAID_AMT FROM TTRN_CLAIM_PAYMENT CP WHERE CP.CLAIM_NO=? AND CP.CONTRACT_NO=? AND CP.RESERVE_ID=(SELECT NVL(MAX(SL_NO),'1') MAXID FROM TTRN_CLAIM_UPDATION WHERE  CLAIM_NO=CP.CLAIM_NO AND CONTRACT_NO=CP.CONTRACT_NO)
claim.select.sumPaidAmt=SELECT SUM(PAID_AMOUNT_OC) PAID_AMOUNT_OC FROM TTRN_CLAIM_PAYMENT WHERE  CLAIM_NO\=? and CONTRACT_NO\=?
claim.select.revSumPaidAmt=SELECT NVL(SUM(CP.PAID_AMOUNT_OC),'0') PAID_AMT FROM TTRN_CLAIM_PAYMENT CP WHERE CP.CLAIM_NO=? AND CP.CONTRACT_NO=? AND CP.RESERVE_ID=(SELECT NVL(MAX(SL_NO),'1') MAXID FROM TTRN_CLAIM_UPDATION WHERE  CLAIM_NO=CP.CLAIM_NO AND CONTRACT_NO=CP.CONTRACT_NO)
claim.select.facGetCliamQuery=SELECT   (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RK.RSK_PRODUCTID AND PERSONAL.BRANCH_CODE = SPFC.BRANCH_CODE)TMAS_SPFC_NAME,RK.RSK_CONTRACT_NO,RK.RSK_ORIGINAL_CURR,RK.RSK_ENDORSEMENT_NO,PERSONAL.COMPANY_NAME CEDING_COMPANY,RK.RSK_CEDINGID, RK.RSK_PROPOSAL_NUMBER, RP.SHARE_SIGNED, SUM_INSURED_OUR_SHARE_DC, SUM_INSURED_OUR_SHARE_OC, RP.RSK_CEDANT_RETENTION, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INCP_DATE,TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE, RK.RSK_TREATYID, PI.FIRST_NAME||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_BROKERID, RK.RSK_INSURED_NAME, RK.RSK_PROPOSAL_NUMBER,RK.RSK_SPFCID,RK.RSK_DEPTID FROM   TTRN_RISK_DETAILS RK, PERSONAL_INFO PERSONAL, TTRN_FAC_RISK_PROPOSAL RP,PERSONAL_INFO PI WHERE RK.RSK_PROPOSAL_NUMBER = ? AND RK.RSK_PRODUCTID = ? AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID AND PERSONAL.BRANCH_CODE=? AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PERSONAL.CUSTOMER_ID AND BRANCH_CODE=PERSONAL.BRANCH_CODE AND CUSTOMER_TYPE=PERSONAL.CUSTOMER_TYPE) AND RK.RSK_BROKERID = PI.CUSTOMER_ID AND PI.BRANCH_CODE=? AND PI.CUSTOMER_TYPE='B' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO  WHERE CUSTOMER_ID=PI.CUSTOMER_ID AND BRANCH_CODE=PI.BRANCH_CODE AND CUSTOMER_TYPE=PI.CUSTOMER_TYPE) AND RP.RSK_PROPOSAL_NUMBER = RK.RSK_PROPOSAL_NUMBER AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID AND RK.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_PROPOSAL_NUMBER =? ) AND RP.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_FAC_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER = RK.RSK_PROPOSAL_NUMBER)
claim.select.xolOrTeatyGetClimeQuery=SELECT   (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RK.RSK_PRODUCTID AND PERSONAL.BRANCH_CODE = SPFC.BRANCH_CODE)TMAS_SPFC_NAME,RK.RSK_CONTRACT_NO,RK.RSK_ENDORSEMENT_NO,  PERSONAL.COMPANY_NAME CEDING_COMPANY,  RK.RSK_CEDINGID,   RK.RSK_PROPOSAL_NUMBER, RP.RSK_SHARE_SIGNED,  RP.RSK_LIMIT_OC,  RP.RSK_LIMIT_DC,  RP.RSK_LIMIT_OS_OC,RP.RSK_LIMIT_OS_DC,  RP.RSK_CEDANT_RETENTION,  TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INCP_DATE,TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE,  TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,  RK.RSK_TREATYID,  RP.RSK_PF_COVERED,  RK.RSK_INSURED_NAME,  RK.RSK_RISK_COVERED,  PI.FIRST_NAME||' '||PI.LAST_NAME BROKER_NAME,  RK.RSK_BROKERID, RK.RSK_PROPOSAL_TYPE,RK.RSK_BASIS, RC.RSK_CASHLOSS_LMT_OC,RC.RSK_CASHLOSS_LMT_DC,(select TMAS_DEPARTMENT_NAME from TMAS_DEPARTMENT_MASTER where TMAS_DEPARTMENT_ID=RK.RSK_DEPTID AND RK.RSK_PRODUCTID=TMAS_PRODUCT_ID and Branch_code=PERSONAL.BRANCH_CODE and TMAS_STATUS='Y') TMAS_DEPARTMENT_NAME,RK.RSK_SPFCID,RK.RSK_DEPTID,RK.RSK_UWYEAR ,RC.RSK_REINSTATEMENT_PREMIUM  FROM TTRN_RISK_DETAILS RK, PERSONAL_INFO PERSONAL, TTRN_RISK_PROPOSAL RP,PERSONAL_INFO PI,TTRN_RISK_COMMISSION RC  WHERE RK.RSK_PROPOSAL_NUMBER = ?  AND RK.RSK_PRODUCTID = ?  AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID  AND PERSONAL.BRANCH_CODE=? AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PERSONAL.CUSTOMER_ID  AND BRANCH_CODE=PERSONAL.BRANCH_CODE AND CUSTOMER_TYPE=PERSONAL.CUSTOMER_TYPE)  AND RK.RSK_BROKERID = PI.CUSTOMER_ID  AND PI.BRANCH_CODE=? AND PI.CUSTOMER_TYPE='B' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO  WHERE CUSTOMER_ID=PI.CUSTOMER_ID  AND BRANCH_CODE=PI.BRANCH_CODE AND CUSTOMER_TYPE=PI.CUSTOMER_TYPE)  AND RP.RSK_PROPOSAL_NUMBER = RK.RSK_PROPOSAL_NUMBER  AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID  AND RK.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_DETAILS  WHERE   RSK_PROPOSAL_NUMBER =? )  AND RP.RSK_ENDORSEMENT_NO =  (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_PROPOSAL  WHERE   RSK_PROPOSAL_NUMBER = RK.RSK_PROPOSAL_NUMBER) AND RC.RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER AND RC.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=RC.RSK_PROPOSAL_NUMBER)
claim.select.claimEdit=SELECT CLAIM_NO,STATUS_OF_CLAIM,TO_CHAR(DATE_OF_LOSS,'DD/MM/YYYY') LOSS_DATE,TO_CHAR(RES_POS_DATE,'DD/MM/YYYY') RES_POS_DATE,TO_CHAR(REPORT_DATE,'DD/MM/YYYY') REP_DATE,LOSS_DETAILS,CAUSE_OF_LOSS,LOCATION,LOSS_ESTIMATE_OC,LOSS_ESTIMATE_OS_OC,EXCHANGE_RATE,LOSS_ESTIMATE_OS_DC,ADVICE_UW,ADVICE_MANAGEMENT,RI_RECOVERY,RI_RECOVERY_AMOUNT_DC,RECOVERY_FROM,CREATED_BY,TO_CHAR(CREATED_DATE,'DD/MM/YYYY') CREATED_DT,MODIFIED_BY,TO_CHAR(MODIFIED_DATE,'DD/MM/YYYY') MODIFIED_DT,UPDATED_BY,TO_CHAR(UPDATED_DATE,'DD/MM/YYYY') UPDATED_DT,TO_CHAR(REOPENED_DATE,'DD/MM/YYYY') REOPENED_DATE,CURRENCY,(SELECT SHORT_NAME FROM CURRENCY_MASTER CM WHERE CURRENCY_ID\=TC.CURRENCY AND BRANCH_CODE\= TC.BRANCH_CODE AND STATUS\='Y' AND AMEND_ID\= (SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER C WHERE C.CURRENCY_ID\=CM.CURRENCY_ID AND C.BRANCH_CODE\=CM.BRANCH_CODE AND C.STATUS\='Y')) CURRENCY_NAME,REMARKS,ADVICE_UW_EMAILID,ADVICE_MGT_EMAILID,RISK_CODE,ACCUMULATION_CODE,EVENT_CODE,LAYER_NO,insured_name,RECORD_FEES_CRE_RESERVE, SAF_100_OC, SAF_100_DC,OTH_FEE_100_OC, OTH_FEE_100_DC, C_IBNR_100_OC, C_IBNR_100_DC,RECORD_IBNR,CEDENT_CLAIM_NO,SAF_OS_DC,OTH_FEE_OS_DC,C_IBNR_OS_DC,SAF_OS_OC,OTH_FEE_OS_OC,C_IBNR_OS_OC,GROSSLOSS_FGU_OC,CLAIM_CLASS,CLAIM_SUBCLASS,COVER_LIMIT_DEPTID FROM TTRN_CLAIM_DETAILS TC WHERE CLAIM_NO\=? AND CONTRACT_NO\=?
GET_EDIT_ACC_DATA =SELECT RISK_CODE,AGGREGATE_CODE,EVENT_CODE FROM TTRN_CLAIM_ACC TCA WHERE CLAIM_NO\=? AND CONTRACT_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_CLAIM_ACC TCS WHERE TCS.CLAIM_NO\=TCA.CLAIM_NO AND TCS.CONTRACT_NO\=TCA.CONTRACT_NO)
claim.select.tmasDeptName=SELECT   (TMAS_DEPARTMENT_NAME)TMAS_NAME FROM   TMAS_DEPARTMENT_MASTER WHERE TMAS_DEPARTMENT_ID = ? AND TMAS_PRODUCT_ID = ? AND Branch_code = ? and TMAS_STATUS ='Y'
claim.select.coreCompanyName=SELECT CORE_COMPANY_CODE FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE =? AND TMAS_PRODUCT_ID=? AND  TMAS_STATUS='Y' AND CORE_COMPANY_CODE IS NOT NULL AND TMAS_DEPARTMENT_ID IN(?)
claim.select.getClaimReserveList=SELECT SL_NO,PAID_AMOUNT_OC,PAYMENT_REQUEST_NO,LOSS_ESTIMATE_REVISED_OC ,CLAIM_NOTE_RECOMM,PAYMENT_REFERENCE,ADVICE_TREASURY,TO_CHAR(p.INCEPTION_DATE,'DD/MM/YYYY') AS INCEPTION_DT,PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC,CLAIM_PAYMENT_NO,RESERVE_ID,SETTLEMENT_STATUS,t.RECEIPT_NO TRANSACTION_NO,Decode(r.TRANS_TYPE,'PT','PAYMENT','RT','RECEIPT','ADJUSTMENT') TRANS_TYPE FROM TTRN_CLAIM_PAYMENT p left join TTRN_ALLOCATED_TRANSACTION t on t.CONTRACT_NO \= p.CONTRACT_NO AND t.PAID_AMOUNT \= p.PAID_AMOUNT_OC AND t.TYPE \= 'C' AND T.TRANSACTION_NO\=P.CLAIM_PAYMENT_NO left join TTRN_PAYMENT_RECEIPT r on t.RECEIPT_NO \= r.PAYMENT_RECEIPT_NO WHERE p.CLAIM_NO\=? AND p.CONTRACT_NO\=?   and  decode(r.AMEND_ID,'',1,r.AMEND_ID) \= (case when r.AMEND_ID is not null then  (select max(AMEND_ID) from  TTRN_PAYMENT_RECEIPT pr where pr.PAYMENT_RECEIPT_NO\= r.PAYMENT_RECEIPT_NO)  else 1 end) ORDER BY CLAIM_PAYMENT_NO DESC
claim.select.lossEstimateRevisedOc=SELECT LOSS_ESTIMATE_REVISED_OC FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=? AND CONTRACT_NO=? AND SL_NO=(SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=? AND CONTRACT_NO=? )
claim.select.getClaimUpdateList=SELECT A.LOSS_ESTIMATE_REVISED_OC,A.LOSS_ESTIMATE_REVISED_DC,TO_CHAR(A.INCEPTION_DATE,'DD/MM/YYYY') AS INCEPTION_DT,A.SL_NO,A.CLAIM_NO,A.CONTRACT_NO,A.UPDATE_REFERENCE,NVL((SELECT SUM(PAID_AMOUNT_OC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID=A.SL_NO AND CONTRACT_NO =A.CONTRACT_NO AND CLAIM_NO = A.CLAIM_NO ),'0') PAIDAMTOC,NVL((SELECT SUM(PAID_AMOUNT_DC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID=A.SL_NO AND CONTRACT_NO =A.CONTRACT_NO AND CLAIM_NO = A.CLAIM_NO ),'0') PAIDAMTUSD FROM TTRN_CLAIM_UPDATION A WHERE A.CLAIM_NO=? AND A.CONTRACT_NO=? AND A.SL_NO=(SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO = A.CLAIM_NO AND CONTRACT_NO = A.CONTRACT_NO)
claim.select.getClaimReviewQuery=SELECT TO_CHAR(REVIEW_DATE,'DD/MM/YYYY') REVIEW_DT,REVIEW_DONE_BY FROM TTRN_CLAIM_DETAILS WHERE CLAIM_NO\=? AND CONTRACT_NO\=?
claim_allocation_list=SELECT   * FROM   ( (SELECT   SNO,TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,TRANSACTION_NO,PRODUCT_NAME,DECODE (TYPE,'C','CLAIM') TYPE,PAID_AMOUNT,TAT.CURRENCY_ID, SIGN (PAID_AMOUNT) sign,DECODE (TAT.STATUS,'R','Reverted','Y','Allocated') STATUS, RECEIPT_NO, DECODE (TRANS_TYPE,'PT','PAYMENT','RT','RECEIPT')TRANS_TYPE  FROM   TTRN_ALLOCATED_TRANSACTION TAT, TTRN_PAYMENT_RECEIPT TPR WHERE   TAT.RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO AND CONTRACT_NO = ? AND TAT.TRANSACTION_NO=? AND TYPE = 'C' AND TAT.STATUS = 'Y' AND tpr.amend_id =(SELECT   MAX (amend_id) FROM   Ttrn_Payment_Receipt WHERE   PAYMENT_RECEIPT_NO = tpr.PAYMENT_RECEIPT_NO AND branch_code = tpr.branch_code)) UNION ALL(SELECT   SNO,TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,TRANSACTION_NO, PRODUCT_NAME,DECODE (TYPE,'C','CLAIM') TYPE, PAID_AMOUNT,TAT.CURRENCY_ID,SIGN (PAID_AMOUNT) sign,'Adjusted' STATUS,RECEIPT_NO,DECODE (ADJUSTMENT_TYPE,'W','Write Off','R','Round Off')TRANS_TYPE FROM   TTRN_ALLOCATED_TRANSACTION TAT WHERE       CONTRACT_NO = ? AND TAT.TRANSACTION_NO=? AND TYPE = 'C' AND  TAT.STATUS = 'Y' AND TAT.RECEIPT_NO NOT IN(SELECT   TPR.PAYMENT_RECEIPT_NO FROM   TTRN_PAYMENT_RECEIPT TPR  WHERE   TAT.RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO)))ORDER BY   SNO DESC
claim.select.claim.claimmaster=SELECT DISTINCT TCD.CLAIM_NO,TO_CHAR (TCD.DATE_OF_LOSS, 'DD/MM/YYYY') AS DATE_OF_LOSS,TO_CHAR (TCD.CREATED_DATE, 'DD/MM/YYYY') AS CREATED_DATE,TCD.STATUS_OF_CLAIM,TCD.CONTRACT_NO,(TCD.TOTAL_AMT_PAID_TILL_DATE - TCD.LOSS_ESTIMATE_OS_OC) AS EDITVIEW,pm.Product_id,TPM.TMAS_PRODUCT_NAME,TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,(SELECT COMPANY_NAME  FROM personal_info Pi WHERE     CUSTOMER_TYPE \= 'C' AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \=(SELECT MAX (Amend_id) FROM personal_info p WHERE     p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code)) Customer_name,(SELECT FIRST_NAME FROM personal_info Pi  WHERE     CUSTOMER_TYPE \= 'B' AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code AND amend_id \=  (SELECT MAX (Amend_id) FROM personal_info p WHERE     p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE    AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code)) Broker_name, Pm.Proposal_no,Pm.layer_no,PM.DEPT_ID FROM TTRN_CLAIM_DETAILS TCD, POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No and nvl(tcd.layer_no,0)\=nvl(pm.layer_no,0) and Pm.branch_code\=? and TPM.BRANCH_CODE\=Pm.branch_code AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \= (SELECT MAX (Amend_Id) FROM Position_Master P WHERE P.Contract_No \= Pm.Contract_No and nvl(P.layer_no,0)\=nvl(pm.layer_no,0)) ORDER BY CLAIM_NO DESC
claim.select.count=select (count(*))TOTAL from TTRN_CLAIM_PAYMENT where claim_no=? and CONTRACT_NO =?
GET_OPEN_PERIOD_DATE=select to_char(start_date,'DD/MM/YYYY')start_date,to_char(end_date,'DD/MM/YYYY')end_date From tmas_open_period where status\='Y' and branch_code\=?
GET_OPEN_PERIOD_VALIDATE=select (count(*))TOTAL from dual where to_date(?,'dd/mm/yyyy') between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')
claim.select.date=SELECT CLAIM_NO,TO_CHAR(DATE_OF_LOSS,'DD/MM/YYYY') AS DATE_OF_LOSS ,TO_CHAR(CREATED_DATE,'DD/MM/YYYY') AS CREATED_DATE,LAYER_NO,STATUS_OF_CLAIM,CONTRACT_NO,(TOTAL_AMT_PAID_TILL_DATE-LOSS_ESTIMATE_OS_OC) AS EDITVIEW FROM TTRN_CLAIM_DETAILS  ORDER BY CLAIM_NO DESC
POS_MAS_ED_MODE_SELECT = SELECT NVL(EDIT_MODE,'N') FROM POSITION_MASTER P WHERE PROPOSAL_NO = ?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO = P.PROPOSAL_NO )
GET_OPEN_PERIOD_DATE=select to_char(start_date,'DD/MM/YYYY')start_date,to_char(end_date,'DD/MM/YYYY')end_date From tmas_open_period where status\='Y' and branch_code\=?
FAC_PREMIUM_SELECT_PREMIUMEDLIST_TEMP = SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.REQUEST_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TO_CHAR (TRA.STATEMENT_DATE, 'DD/MM/YYYY')STA_DATE,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS_TEMP TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=? ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO AND TRANS_STATUS\='P' ORDER BY TRA.REQUEST_NO DESC
premium.select.PremiumedList1=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TO_CHAR (TRA.STATEMENT_DATE, 'DD/MM/YYYY')STATEMENT_DATE,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?
premium.select.PremiumedList2= ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO
premium.select.PremiumedList3= SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO ORDER BY TRA.TRANSACTION_NO DESC
premium.select.count=select Decode (count(*),0,'Y','N') allocatedYN from TTRN_ALLOCATED_TRANSACTION where CONTRACT_NO =? and TRANSACTION_NO=? and LAYER_NO=? and TYPE='P' and STATUS='Y'
allocation.status=select COUNT(*) COUNT from  ttrn_allocated_transaction where transaction_no=? AND STATUS='Y'
retro.status=select COUNT(*) COUNT from ttrn_retro_prcl trp where transaction_no\=? 
retro.status1=select COUNT(*) COUNT from ttrn_retro_prcl trp where transaction_no=? AND process_id IS NOT NULL and trp.amend_id=(select max(amend_id) from ttrn_retro_prcl tr where trp.transaction_no=tr.transaction_no)
premium.select.facTreatyPreList= SELECT A.CONTRACT_NO,A.PROPOSAL_NO, B.TMAS_DEPARTMENT_NAME,A.PRODUCT_ID, A.CEDING_COMPANY_ID, A.UW_YEAR, C.COMPANY_NAME, A.LAYER_NO,A.DEPT_ID, (select FIRST_NAME from personal_info pi where pi.customer_id=A.broker_id and customer_type='B' and pi.branch_code=A.branch_code and rownum=1) Broker_name FROM POSITION_MASTER A, TMAS_DEPARTMENT_MASTER B, PERSONAL_INFO C WHERE A.CONTRACT_NO = ? AND DEPT_ID=? AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO = A.CONTRACT_NO AND  DEPT_ID=A.DEPT_ID) AND A.DEPT_ID = B.TMAS_DEPARTMENT_ID AND B.BRANCH_CODE = A.BRANCH_CODE AND B.TMAS_PRODUCT_ID = A.PRODUCT_ID AND C.CUSTOMER_ID = A.CEDING_COMPANY_ID AND C.BRANCH_CODE = A.BRANCH_CODE AND C.CUSTOMER_TYPE = 'C'AND C.AMEND_ID =(SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE)
premium.select.ceasestatus=select (CEASE_STATUS) status from position_master pm where CONTRACT_NO=?  and  pm.amend_id=(Select Max(Amend_id) From Position_master p where p.CONTRACT_NO=pm.CONTRACT_NO )

claim.select.sumPaidAmt1=SELECT SUM(PAID_AMOUNT_OC) FROM TTRN_CLAIM_PAYMENT WHERE  CLAIM_NO\=? and CONTRACT_NO\=?
claim.select.sumPaidAmt=SELECT SUM(PAID_AMOUNT_OC) PAID_AMOUNT_OC FROM TTRN_CLAIM_PAYMENT WHERE  CLAIM_NO\=? and CONTRACT_NO\=?
claim.select.claimTableList=SELECT CLAIM_NO,TO_CHAR(DATE_OF_LOSS,'DD/MM/YYYY') AS DATE_OF_LOSS ,TO_CHAR(CREATED_DATE,'DD/MM/YYYY') AS CREATED_DATE,STATUS_OF_CLAIM,CONTRACT_NO,(TOTAL_AMT_PAID_TILL_DATE-LOSS_ESTIMATE_OS_OC) AS EDITVIEW FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO=? AND nvl(LAYER_NO,0)=nvl(?,0) AND SUB_CLASS=? ORDER BY CLAIM_NO DESC
getCliampaymnetCount=select count(*) count from TTRN_CLAIM_PAYMENT where claim_no=? and CONTRACT_NO =?
setCeaseStatus=select CEASE_STATUS from position_master pm where PROPOSAL_NO=? and  pm.amend_id=(Select Max(Amend_id) From Position_master p where p.PROPOSAL_NO=pm.PROPOSAL_NO)
claim.select.getClaimUpdateList=SELECT A.LOSS_ESTIMATE_REVISED_OC,A.LOSS_ESTIMATE_REVISED_DC,TO_CHAR(A.INCEPTION_DATE,'DD/MM/YYYY') AS INCEPTION_DT,A.SL_NO,A.CLAIM_NO,A.CONTRACT_NO,A.UPDATE_REFERENCE,NVL((SELECT SUM(PAID_AMOUNT_OC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID=A.SL_NO AND CONTRACT_NO =A.CONTRACT_NO AND CLAIM_NO = A.CLAIM_NO ),'0') PAIDAMTOC,NVL((SELECT SUM(PAID_AMOUNT_DC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID=A.SL_NO AND CONTRACT_NO =A.CONTRACT_NO AND CLAIM_NO = A.CLAIM_NO ),'0') PAIDAMTUSD FROM TTRN_CLAIM_UPDATION A WHERE A.CLAIM_NO=? AND A.CONTRACT_NO=? AND A.SL_NO=(SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO = A.CLAIM_NO AND CONTRACT_NO = A.CONTRACT_NO)
premium.select.currecy.name=SELECT COUNTRY_SHORT_NAME FROM TMAS_BRANCH_MASTER WHERE  BRANCH_CODE=?
clime.select.getClaimRESERVEList=SELECT  TC.LOSS_ESTIMATE_REVISED_OC, TC.LOSS_ESTIMATE_REVISED_DC, TC.UPDATE_REFERENCE, TO_CHAR (TC.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  TC.SL_NO, TC.CLAIM_NO,TC.CONTRACT_NO,TC.C_IBNR_100_OC,TC.C_IBNR_OS_OC, NVL ((SELECT SUM (REINSPREMIUM_OURSHARE_OC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID = TC.SL_NO AND CONTRACT_NO = TC.CONTRACT_NO AND CLAIM_NO = TC.CLAIM_NO),'0') REINSPREMIUM_OURSHARE_OC,NVL((SELECT SUM(PAID_AMOUNT_OC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID=TC.SL_NO AND CONTRACT_NO =TC.CONTRACT_NO AND CLAIM_NO = TC.CLAIM_NO ),'0') PAIDAMTOC, NVL((SELECT SUM(PAID_AMOUNT_DC) FROM TTRN_CLAIM_PAYMENT WHERE RESERVE_ID=TC.SL_NO AND CONTRACT_NO =TC.CONTRACT_NO AND CLAIM_NO = TC.CLAIM_NO ),'0') PAIDAMTUSD  , NVL(loss_Estimate_Revised_OC,0) loss_Estimate_Revised_OC_2A , NVL(TP.PAID_CLAIM_OS_OC,0) PAID_CLAIM_OS_OC_2B , NVL(loss_Estimate_Revised_OC,0)-NVL(TP.PAID_CLAIM_OS_OC,0) OC_OS_Amount_2C, NVL(tc.SAF_OS_OC,0) SAF_OS_OC_3A, NVL(TP.SAF_OS_OC,0) SAF_OS_OC_3B, NVL(tc.SAF_OS_OC,0)-NVL(TP.SAF_OS_OC,0) Surveyor_OS_AMT_3C, NVL(tc.OTH_FEE_OS_OC,0) OTH_FEE_OS_OC_4A, NVL(TP.OTH_FEE_OS_OC,0) OTH_FEE_OS_OC_4B, NVL(tc.OTH_FEE_OS_OC,0)-NVL(TP.OTH_FEE_OS_OC,0) Other_Profess_OS_AMT_4C, NVL(loss_Estimate_Revised_OC,0)+NVL(tc.SAF_OS_OC,0)+NVL(tc.OTH_FEE_OS_OC,0) Total_A , NVL(TP.PAID_CLAIM_OS_OC,0)+NVL(TP.SAF_OS_OC,0) + NVL(TP.OTH_FEE_OS_OC,0) Total_b, (NVL(loss_Estimate_Revised_OC,0)-NVL(TP.PAID_CLAIM_OS_OC,0))+(NVL(tc.SAF_OS_OC,0)-NVL(TP.SAF_OS_OC,0))+(NVL(tc.OTH_FEE_OS_OC,0)-NVL(TP.OTH_FEE_OS_OC,0)) TOTAL_C FROM TTRN_CLAIM_UPDATION tc left outer join (SELECT   reserve_id,NVL (SUM (NVL (PAID_CLAIM_OS_OC, 0)), 0) PAID_CLAIM_OS_OC, NVL (SUM (NVL (SAF_OS_OC, 0)), 0) SAF_OS_OC, NVL (SUM (NVL (OTH_FEE_OS_OC, 0)), 0) OTH_FEE_OS_OC FROM   ttrn_claim_payment Tcp WHERE   CONTRACT_NO = ? AND CLAIM_NO = ? group by reserve_id) TP on ( tp.reserve_id=tc.SL_NO)  WHERE   TC.CONTRACT_NO = ? AND TC.CLAIM_NO = ? order by SL_NO
claim.select.getClaimList=SELECT CD.CLAIM_NO,TO_CHAR(CD.DATE_OF_LOSS ,'DD/MM/YYYY') AS DATEOFLOSS,CD.LOSS_ESTIMATE_OS_OC,CD.CURRENCY,TO_CHAR(CD.CREATED_DATE,'DD/MM/YYYY') AS CREATEDDATE,CM.SHORT_NAME CURRENCY_NAME FROM TTRN_CLAIM_DETAILS CD,CURRENCY_MASTER CM WHERE CD.CLAIM_NO =? AND CD.CONTRACT_NO =? AND CM.BRANCH_CODE=? AND CM.CURRENCY_ID=CD.CURRENCY AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER c WHERE  c.BRANCH_CODE=cm.BRANCH_CODE AND c.CURRENCY_ID=CM.CURRENCY_ID)
claim.select.getClaimReserveList=SELECT SL_NO,PAID_AMOUNT_OC,PAYMENT_REQUEST_NO,LOSS_ESTIMATE_REVISED_OC ,CLAIM_NOTE_RECOMM,PAYMENT_REFERENCE,ADVICE_TREASURY,TO_CHAR(p.INCEPTION_DATE,'DD/MM/YYYY') AS INCEPTION_DT,PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC,CLAIM_PAYMENT_NO,RESERVE_ID,SETTLEMENT_STATUS,t.RECEIPT_NO TRANSACTION_NO,Decode(r.TRANS_TYPE,'PT','PAYMENT','RT','RECEIPT','ADJUSTMENT') TRANS_TYPE FROM TTRN_CLAIM_PAYMENT p left join TTRN_ALLOCATED_TRANSACTION t on t.CONTRACT_NO \= p.CONTRACT_NO AND t.PAID_AMOUNT \= p.PAID_AMOUNT_OC AND t.TYPE \= 'C' AND T.TRANSACTION_NO\=P.CLAIM_PAYMENT_NO left join TTRN_PAYMENT_RECEIPT r on t.RECEIPT_NO \= r.PAYMENT_RECEIPT_NO WHERE p.CLAIM_NO\=? AND p.CONTRACT_NO\=?   and  decode(r.AMEND_ID,'',1,r.AMEND_ID) \= (case when r.AMEND_ID is not null then  (select max(AMEND_ID) from  TTRN_PAYMENT_RECEIPT pr where pr.PAYMENT_RECEIPT_NO\= r.PAYMENT_RECEIPT_NO)  else 1 end) ORDER BY CLAIM_PAYMENT_NO DESC
payment.select.maxno=SELECT MAX(SL_NO) MAX_NO FROM TTRN_CLAIM_UPDATION WHERE  CLAIM_NO=? AND  CONTRACT_NO=?
payment.select.count.allocatedYN=select count(*) allocatedYN from TTRN_ALLOCATED_TRANSACTION where CONTRACT_NO =? and TRANSACTION_NO=? and LAYER_NO=?  and STATUS='Y'
GET_STATUS_OF_CLAIM =SELECT STATUS_OF_CLAIM FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO \=? AND CLAIM_NO\=? AND LAYER_NO\=?
claim.select.getClaimPaymentList=SELECT PAID_AMOUNT_OC,PAYMENT_REQUEST_NO,LOSS_ESTIMATE_REVISED_OC,CLAIM_NOTE_RECOMM,PAYMENT_REFERENCE,ADVICE_TREASURY,TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY') AS INCEPTION_DATE,PAID_AMOUNT_DC,LOSS_ESTIMATE_REVISED_DC,RESERVE_ID,CLAIM_PAYMENT_NO, SETTLEMENT_STATUS FROM TTRN_CLAIM_PAYMENT WHERE CLAIM_NO=? AND CONTRACT_NO=? ORDER BY CLAIM_PAYMENT_NO DESC
claim.select.getClaimReviewList=SELECT SNO,TO_CHAR(REVIEW_DATE,'DD/MM/YYYY') REVIEW_DATE,REVIEW_DONE_BY,REMARKS FROM TTRN_CLAIM_REVIEW WHERE CONTRACT_NO=? AND CLAIM_NO=?
GET_CONTRACT_NUMBER =SELECT CONTRACT_NO,CLAIM_CLASS FROM  TTRN_CLAIM_DETAILS  WHERE CLAIM_NO\=?
GET_CONTRACT_NUMBER1 =SELECT CONTRACT_NO,CLAIM_CLASS FROM  TTRN_CLAIM_DETAILS  WHERE CLAIM_NO\=? And  CONTRACT_NO =?
GET_CLAIM_PAYMENT_DATA = SELECT  REINSPREMIUM_OURSHARE_OC,REINSTATEMENT_TYPE,decode(REINSTATEMENT_TYPE,'MDP','On M&D Premium','ADP','On Adjusted Premium','FDP','On Final Adjusted Premium','NA','Not Applicable') REINSTATEMENT_TYPE_NAME,CLAIM_PAYMENT_NO,PAYMENT_REQUEST_NO,PAID_AMOUNT_OC,PAID_CLAIM_OS_OC,LOSS_ESTIMATE_REVISED_OC,PAYMENT_REFERENCE,to_char(INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,REMARKS,PAID_CLAIM_OS_DC,SAF_OS_OC,OTH_FEE_OS_OC,PAYMENT_TYPE FROM TTRN_CLAIM_PAYMENT WHERE CLAIM_NO=? AND CONTRACT_NO=? AND LAYER_NO=? and CLAIM_PAYMENT_NO=?
claim_allocation_list=SELECT   * FROM   ( (SELECT   SNO,TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,TRANSACTION_NO,PRODUCT_NAME,DECODE (TYPE,'C','CLAIM') TYPE,PAID_AMOUNT,TAT.CURRENCY_ID, SIGN (PAID_AMOUNT) sign,DECODE (TAT.STATUS,'R','Reverted','Y','Allocated') STATUS, RECEIPT_NO, DECODE (TRANS_TYPE,'PT','PAYMENT','RT','RECEIPT')TRANS_TYPE  FROM   TTRN_ALLOCATED_TRANSACTION TAT, TTRN_PAYMENT_RECEIPT TPR WHERE   TAT.RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO AND CONTRACT_NO = ? AND TAT.TRANSACTION_NO=? AND TYPE = 'C' AND TAT.STATUS = 'Y' AND tpr.amend_id =(SELECT   MAX (amend_id) FROM   Ttrn_Payment_Receipt WHERE   PAYMENT_RECEIPT_NO = tpr.PAYMENT_RECEIPT_NO AND branch_code = tpr.branch_code)) UNION ALL(SELECT   SNO,TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,TRANSACTION_NO, PRODUCT_NAME,DECODE (TYPE,'C','CLAIM') TYPE, PAID_AMOUNT,TAT.CURRENCY_ID,SIGN (PAID_AMOUNT) sign,'Adjusted' STATUS,RECEIPT_NO,DECODE (ADJUSTMENT_TYPE,'W','Write Off','R','Round Off')TRANS_TYPE FROM   TTRN_ALLOCATED_TRANSACTION TAT WHERE       CONTRACT_NO = ? AND TAT.TRANSACTION_NO=? AND TYPE = 'C' AND  TAT.STATUS = 'Y' AND TAT.RECEIPT_NO NOT IN(SELECT   TPR.PAYMENT_RECEIPT_NO FROM   TTRN_PAYMENT_RECEIPT TPR  WHERE   TAT.RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO)))ORDER BY   SNO DESC
GET_PRODUC_ID_LIST=select TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME from  tmas_product_master WHERE  BRANCH_CODE\=? AND TMAS_PRODUCT_ID IN (1,2,3)
contract.identifier.list=SELECT distinct A.PROPOSAL_NO,A.DEPT_ID,A.CONTRACT_NO,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,B.TMAS_DEPARTMENT_NAME,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,A.BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(CD.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,CD.CLAIM_NO,CD.COUNT,A.AMEND_ID FROM   POSITION_MASTER A JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO AND A.LAYER_NO=D.RSK_LAYER_NO AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO AND A.DEPT_ID = D.RSK_DEPTID JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO,CLAIM_NO, COUNT(CLAIM_NO) COUNT FROM   TTRN_CLAIM_DETAILS group by CONTRACT_NO, LAYER_NO ,CLAIM_NO) CD ON A.CONTRACT_NO = CD.CONTRACT_NO AND A.LAYER_NO=CD.LAYER_NO  WHERE  A.PRODUCT_ID = ?  AND A.CONTRACT_STATUS = 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE) AND E.BRANCH_CODE = ? AND A.BRANCH_CODE = ? AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO AND A.LAYER_NO=LAYER_NO AND A.BRANCH_CODE = BRANCH_CODE AND CONTRACT_STATUS = 'A') AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) and D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD  WHERE RD.BRANCH_CODE=D.BRANCH_CODE AND RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) ORDER BY A.CONTRACT_NO DESC
contract.identifier.list1=SELECT distinct A.PROPOSAL_NO,A.DEPT_ID,A.CONTRACT_NO,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,B.TMAS_DEPARTMENT_NAME,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,A.BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(CD.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,CD.CLAIM_NO,CD.COUNT,A.AMEND_ID FROM   POSITION_MASTER A JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO AND A.LAYER_NO=D.RSK_LAYER_NO AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO AND A.DEPT_ID = D.RSK_DEPTID JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO,CLAIM_NO, COUNT(CLAIM_NO) COUNT FROM   TTRN_CLAIM_DETAILS group by CONTRACT_NO, LAYER_NO ,CLAIM_NO) CD ON A.CONTRACT_NO = CD.CONTRACT_NO AND A.LAYER_NO=CD.LAYER_NO  WHERE  A.PRODUCT_ID = ?  AND A.CONTRACT_STATUS = 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE) AND E.BRANCH_CODE = ? AND A.BRANCH_CODE = ? AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO AND A.LAYER_NO=LAYER_NO AND A.BRANCH_CODE = BRANCH_CODE AND CONTRACT_STATUS = 'A') AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) and D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD  WHERE RD.BRANCH_CODE=D.BRANCH_CODE AND RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND D.RSK_CEDINGID = ? ORDER BY A.CONTRACT_NO DESC
contract.identifier.list2=SELECT distinct A.PROPOSAL_NO,A.DEPT_ID,A.CONTRACT_NO,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,B.TMAS_DEPARTMENT_NAME,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,A.BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(CD.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,CD.CLAIM_NO,CD.COUNT,A.AMEND_ID FROM   POSITION_MASTER A JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO AND A.LAYER_NO=D.RSK_LAYER_NO AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO AND A.DEPT_ID = D.RSK_DEPTID JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO,CLAIM_NO, COUNT(CLAIM_NO) COUNT FROM   TTRN_CLAIM_DETAILS group by CONTRACT_NO, LAYER_NO ,CLAIM_NO) CD ON A.CONTRACT_NO = CD.CONTRACT_NO AND A.LAYER_NO=CD.LAYER_NO  WHERE  A.PRODUCT_ID = ?  AND A.CONTRACT_STATUS = 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE) AND E.BRANCH_CODE = ? AND A.BRANCH_CODE = ? AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO AND A.LAYER_NO=LAYER_NO AND A.BRANCH_CODE = BRANCH_CODE AND CONTRACT_STATUS = 'A') AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) and D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD  WHERE RD.BRANCH_CODE=D.BRANCH_CODE AND RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND D.RSK_BROKERID =? ORDER BY A.CONTRACT_NO DESC
contract.identifier.list3=SELECT distinct A.PROPOSAL_NO,A.DEPT_ID,A.CONTRACT_NO,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,B.TMAS_DEPARTMENT_NAME,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,A.BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(CD.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,CD.CLAIM_NO,CD.COUNT,A.AMEND_ID FROM   POSITION_MASTER A JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO AND A.LAYER_NO=D.RSK_LAYER_NO AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO AND A.DEPT_ID = D.RSK_DEPTID JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO,CLAIM_NO, COUNT(CLAIM_NO) COUNT FROM   TTRN_CLAIM_DETAILS group by CONTRACT_NO, LAYER_NO ,CLAIM_NO) CD ON A.CONTRACT_NO = CD.CONTRACT_NO AND A.LAYER_NO=CD.LAYER_NO  WHERE  A.PRODUCT_ID = ?  AND A.CONTRACT_STATUS = 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE) AND E.BRANCH_CODE = ? AND A.BRANCH_CODE = ? AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO AND A.LAYER_NO=LAYER_NO AND A.BRANCH_CODE = BRANCH_CODE AND CONTRACT_STATUS = 'A') AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) and D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD  WHERE RD.BRANCH_CODE=D.BRANCH_CODE AND RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND D.RSK_UWYEAR =? ORDER BY A.CONTRACT_NO DESC
contract.identifier.list4=SELECT distinct A.PROPOSAL_NO,A.DEPT_ID,A.CONTRACT_NO,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,B.TMAS_DEPARTMENT_NAME,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,A.BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(CD.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,CD.CLAIM_NO,CD.COUNT,A.AMEND_ID FROM   POSITION_MASTER A JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO AND A.LAYER_NO=D.RSK_LAYER_NO AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO AND A.DEPT_ID = D.RSK_DEPTID JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO,CLAIM_NO, COUNT(CLAIM_NO) COUNT FROM   TTRN_CLAIM_DETAILS group by CONTRACT_NO, LAYER_NO ,CLAIM_NO) CD ON A.CONTRACT_NO = CD.CONTRACT_NO AND A.LAYER_NO=CD.LAYER_NO  WHERE  A.PRODUCT_ID = ?  AND A.CONTRACT_STATUS = 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE) AND E.BRANCH_CODE = ? AND A.BRANCH_CODE = ? AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO AND A.LAYER_NO=LAYER_NO AND A.BRANCH_CODE = BRANCH_CODE AND CONTRACT_STATUS = 'A') AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) and D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD  WHERE RD.BRANCH_CODE=D.BRANCH_CODE AND RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND D.RSK_DEPTID=? ORDER BY A.CONTRACT_NO DESC
GET_RIP_VALUES =SELECT REINST_TYPE,AMOUNT_PERCENT,MIN_AMOUNT_PERCENT,MIN_TIME_PERCENT,count(*)  OVER(PARTITION By PROPOSAL_NO) COUNT from TTRN_RIP P where P.PROPOSAL_NO\=? and P.CONTRACT_NO\=? AND P.LAYER_NO\=? AND P.BRANCH_CODE\=? and P.SECTION_TYPE\='A' AND REINST_NO\=? AND P.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM  TTRN_RIP T WHERE T.PROPOSAL_NO\=P.PROPOSAL_NO and T.CONTRACT_NO\=P.CONTRACT_NO AND T.LAYER_NO\=P.LAYER_NO AND T.BRANCH_CODE\=P.BRANCH_CODE)
COVER_SUM_INSURED_VAL =WITH E1 AS (SELECT NVL(RSK_SHARE_SIGNED,0) RSK_SHARE_SIGNED FROM TTRN_RISK_PROPOSAL R WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_LAYER_NO\=? AND BRANCH_CODE\=?  AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL P WHERE  P.RSK_PROPOSAL_NUMBER\=R.RSK_PROPOSAL_NUMBER  AND P.RSK_LAYER_NO\=R.RSK_LAYER_NO AND P.BRANCH_CODE\=R.BRANCH_CODE)),E2 AS(SELECT SUM(NVL(RSK_COVER_LIMT,0)) COVER_LIMIT  FROM TTRN_RSK_CLASS_LIMITS RC WHERE  RC.RSK_PROPOSAL_NUMBER\=?  AND RC.RSK_LAYER_NO\=? AND RC.RSK_CONTRACT_NO\=? AND RC.BRANCH_CODE\=? AND RC.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM  TTRN_RSK_CLASS_LIMITS L WHERE L.RSK_PROPOSAL_NUMBER\=RC.RSK_PROPOSAL_NUMBER))SELECT (COVER_LIMIT*RSK_SHARE_SIGNED)/100 SUM_INSURED_VAL FROM E1,E2


claim.select.getpaymentlist=Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) ORDER BY   CLAIM_NO DESC  
claim.select.getpaymentlist1=Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) where UPPER(CUSTOMER_NAME) LIKE UPPER (?) ORDER BY   CLAIM_NO DESC
claim.select.getpaymentlist2= Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) where UPPER(BROKER_NAME) LIKE UPPER (?) ORDER BY   CLAIM_NO DESC
claim.select.getpaymentlist3= Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) where CONTRACT_NO LIKE ? ORDER BY   CLAIM_NO DESC
claim.select.getpaymentlist4= Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) where  CLAIM_NO LIKE ? ORDER BY   CLAIM_NO DESC
claim.select.getpaymentlist5= Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) where  CLAIM_PAYMENT_NO LIKE ? ORDER BY   CLAIM_NO DESC
claim.select.getpaymentlist6= Select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0))) where  INCEPTION_DT LIKE ? ORDER BY   CLAIM_NO DESC
claim.select.maxno=SELECT MAX(SL_NO) MAXNO FROM TTRN_CLAIM_UPDATION WHERE  CLAIM_NO=? AND  CONTRACT_NO=?


partial.claim.select.getpaymentlist=select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 
partial.claim.select.getpaymentlist1=select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 AND UPPER(CUSTOMER_NAME) LIKE UPPER (?)
partial.claim.select.getpaymentlist2= select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 AND UPPER(BROKER_NAME) LIKE UPPER (?)
partial.claim.select.getpaymentlist3=select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 AND CONTRACT_NO LIKE ?
partial.claim.select.getpaymentlist4=select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 AND CLAIM_NO LIKE ?
partial.claim.select.getpaymentlist5=select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 AND AND CLAIM_PAYMENT_NO  LIKE ?
partial.claim.select.getpaymentlist6=select * from (SELECT   DISTINCT PAID_AMOUNT_OC,TCD.CLAIM_NO,TCD.CONTRACT_NO, PAYMENT_REQUEST_NO, LOSS_ESTIMATE_REVISED_OC,TO_CHAR (TCD.INCEPTION_DATE, 'DD/MM/YYYY') AS INCEPTION_DT,  CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_DC, CLAIM_PAYMENT_NO, RESERVE_ID,SETTLEMENT_STATUS,  pm.Product_id, TPM.TMAS_PRODUCT_NAME, TO_CHAR (PM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (PM.Expiry_date, 'DD/MM/YYYY') Expiry_date,  (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE       CUSTOMER_TYPE \= 'C'  AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Customer_name,(SELECT   FIRST_NAME  FROM   personal_info Pi  WHERE       CUSTOMER_TYPE \= 'B'    AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \=  (SELECT   MAX (Amend_id)   FROM   personal_info p WHERE       p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id   AND p.branch_code \= pm.branch_code))   Broker_name,  Pm.Proposal_no, Pm.layer_no,PM.DEPT_ID  FROM   TTRN_CLAIM_PAYMENT TCD,   POSITION_MASTER PM, TMAS_PRODUCT_MASTER TPM WHERE      TCD.Contract_No \= Pm.Contract_No   AND NVL (tcd.layer_no, 0) \= NVL (pm.layer_no, 0)   AND Pm.branch_code \= ?  AND TPM.BRANCH_CODE \= Pm.branch_code  AND TPM.Tmas_Product_id \= pm.Product_id AND Pm.Amend_Id \=  (SELECT   MAX (Amend_Id)  FROM   Position_Master P   WHERE   P.Contract_No \= Pm.Contract_No AND NVL (P.layer_no, 0) \= NVL (pm.layer_no, 0)) ORDER BY   CLAIM_NO DESC)where  rownum<\=100 AND INCEPTION_DT LIKE ?
GET_DATE_OF_LOSS = SELECT TO_CHAR(DATE_OF_LOSS,'DD/MM/YYYY') DATE_OF_LOSS FROM TTRN_CLAIM_DETAILS WHERE CLAIM_NO=? AND CONTRACT_NO=? AND LAYER_NO=? and BRANCH_CODE=?
POS_MAS_ED_MODE_SELECT = SELECT NVL(EDIT_MODE,'N') EDIT_MODE FROM POSITION_MASTER P WHERE PROPOSAL_NO = ?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO = P.PROPOSAL_NO )
GET_CLAIM_COVERLIMIT_FAC = SELECT NVL((SELECT SUM(NVL(RSK_COVERLIMIT_OC,0)) FROM TTRN_FAC_SI S WHERE S.PROPOSAL_NO\=?  AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_FAC_SI I WHERE I.PROPOSAL_NO\=S.PROPOSAL_NO)),0) RSK_COVERLIMIT_OC FROM DUAL
GET_CLAIM_COVERLIMIT=SELECT NVL(RSK_COVER_LIMT,0) RSK_COVER_LIMT FROM TTRN_RSK_CLASS_LIMITS TL WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_COVER_CLASS\=? AND  RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RSK_CLASS_LIMITS WHERE RSK_PROPOSAL_NUMBER\=TL.RSK_PROPOSAL_NUMBER AND RSK_LAYER_NO\=TL.RSK_LAYER_NO AND RSK_COVER_CLASS\= TL.RSK_COVER_CLASS)

common.select.getCurrencyList=SELECT DISTINCT CM.CURRENCY_ID,CM.SHORT_NAME CURRENCY_NAME FROM CURRENCY_MASTER CM WHERE CM.BRANCH_CODE=? AND CM.COUNTRY_ID=? and CM.STATUS=? AND CM.AMEND_ID=(select MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE BRANCH_CODE=CM.BRANCH_CODE AND  COUNTRY_ID=CM.COUNTRY_ID and STATUS=CM.STATUS AND CURRENCY_ID=CM.CURRENCY_ID) ORDER BY CURRENCY_ID
common.select.getDeptName=SELECT TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_DEPARTMENT_ID=? AND TMAS_STATUS='Y'
common.select.getCoreCompanyName=SELECT CORE_COMPANY_CODE FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE =? AND TMAS_PRODUCT_ID=? AND  TMAS_STATUS='Y' AND CORE_COMPANY_CODE IS NOT NULL AND TMAS_DEPARTMENT_ID IN(?)
common.department.combined.premiumclaim=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS='Y'  and TMAS_DEPARTMENT_ID in((select * from table(SPLIT_TEXT_FN(replace(?,' ', ''))))) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList.preClaim=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? and TMAS_DEPARTMENT_ID in(select RSK_COVER_CLASS from  TTRN_RSK_CLASS_LIMITS t where RSK_CONTRACT_NO=? and RSK_LAYER_NO=? and RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO)from TTRN_RSK_CLASS_LIMITS where RSK_PROPOSAL_NUMBER=t.RSK_PROPOSAL_NUMBER)) ORDER BY  TMAS_DEPARTMENT_NAME ASC
DEPARTMENT_VALUE= SELECT   DISTINCT TMAS_DEPARTMENT_ID, TMAS_DEPARTMENT_NAME     FROM   TMAS_DEPARTMENT_MASTER    WHERE   BRANCH_CODE \= ? AND TMAS_PRODUCT_ID \= ? AND TMAS_STATUS \= ?            AND TMAS_DEPARTMENT_ID IN   (SELECT   DEPT_ID   FROM   POSITION_MASTER t WHERE   CONTRACT_NO \= ? AND LAYER_NO \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID)FROM   POSITION_MASTER WHERE   PROPOSAL_NO \=  t.PROPOSAL_NO)) ORDER BY   TMAS_DEPARTMENT_NAME ASC
common.select.getspfcName=SELECT DISTINCT TMAS_SPFC_ID ,TMAS_SPFC_NAME  FROM  TMAS_SPFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? and TMAS_DEPARTMENT_ID=? AND TMAS_STATUS=? ORDER BY TMAS_SPFC_NAME ASC
common.select.getspfcName1=SELECT DISTINCT TMAS_SPFC_ID ,TMAS_SPFC_NAME  FROM  TMAS_SPFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? and TMAS_DEPARTMENT_ID=? AND TMAS_STATUS=?  and TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(?,' ', '')))) ORDER BY TMAS_SPFC_NAME ASC
claim.insert.cliamDetails=INSERT INTO TTRN_CLAIM_DETAILS (STATUS_OF_CLAIM,DATE_OF_LOSS,REPORT_DATE,LOSS_DETAILS,CAUSE_OF_LOSS,CURRENCY,LOSS_ESTIMATE_OC,LOSS_ESTIMATE_OS_OC,EXCHANGE_RATE,LOSS_ESTIMATE_OS_DC,ADVICE_UW,ADVICE_MANAGEMENT,RI_RECOVERY,RI_RECOVERY_AMOUNT_DC,RECOVERY_FROM,CREATED_BY,CREATED_DATE,LOCATION,REMARKS,ADVICE_UW_EMAILID, ADVICE_MGT_EMAILID,INCEPTION_DATE,STATUS,RISK_CODE,ACCUMULATION_CODE,EVENT_CODE,insured_name,SUB_CLASS,BRANCH_CODE, LOGIN_ID, RECORD_FEES_CRE_RESERVE, SAF_100_OC, SAF_100_DC,OTH_FEE_100_OC, OTH_FEE_100_DC, C_IBNR_100_OC, C_IBNR_100_DC,RECORD_IBNR,CEDENT_CLAIM_NO,SAF_OS_OC,OTH_FEE_OS_OC,C_IBNR_OS_OC,SAF_OS_DC,OTH_FEE_OS_DC,C_IBNR_OS_DC,Loss_Estimate_DC,REOPENED_DATE,GROSSLOSS_FGU_OC,CLAIM_CLASS,CLAIM_SUBCLASS,RES_POS_DATE,COVER_LIMIT_DEPTID,PROPOSAL_NO,PRODUCT_ID,REPUDATE_DATE,CONTRACT_NO,CLAIM_NO,LAYER_NO) VALUES (?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,SYSDATE,'Y',?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?)
claim.select.maxSnoDTB1=SELECT NVL(MAX(SL_NO),'0')+1 FROM
claim.select.maxSnoDTB2=WHERE CLAIM_NO=? AND CONTRACT_NO=?
claim.select.maxSnoDTB3=SELECT NVL(MAX(SL_NO),'0')+1 SL_NO FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=? AND CONTRACT_NO=?
claim.insert.getUpdationQuery=INSERT INTO TTRN_CLAIM_UPDATION (SL_NO,LAYER_NO,LOSS_ESTIMATE_REVISED_OC,LOSS_ESTIMATE_REVISED_DC,UPDATE_REFERENCE,INCEPTION_DATE,CLAIM_NO,CONTRACT_NO,STATUS,REMARKS,BRANCH_CODE, LOGIN_ID, SAF_100_OC, SAF_100_DC, OTH_FEE_100_OC, OTH_FEE_100_DC, C_IBNR_100_OC, C_IBNR_100_DC, SAF_OS_OC,OTH_FEE_OS_OC,C_IBNR_OS_OC,SAF_OS_DC, OTH_FEE_OS_DC, C_IBNR_OS_DC, LOSS_ESTIMATE_100_OC, LOSS_ESTIMATE_100_DC,RESERVE_FEES,RESERVE_IBNR,EXCHANGE_RATE,TOT_RES_AMOUNT_OC ,TOT_RES_AMOUNT_DC,RES_POS_DATE,SYS_DATE) VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,'Y',? ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),sysdate)
INSERT_ACCUMULATION_DATA = INSERT INTO TTRN_CLAIM_ACC(CLAIM_NO,CONTRACT_NO ,LAYER_NO,SUB_CLASS ,RISK_CODE ,AGGREGATE_CODE ,EVENT_CODE ,AMEND_ID ,CREATED_DATE ,BRANCH_CODE,LOGIN_ID ) VALUES (?,?,?,?,?,?,?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM TTRN_CLAIM_ACC WHERE CLAIM_NO=? AND CONTRACT_NO=?AND LAYER_NO=? AND SUB_CLASS=?),SYSDATE,?,?)
claim.update.cliamDetailsUpdate=UPDATE TTRN_CLAIM_DETAILS SET STATUS_OF_CLAIM\=?,DATE_OF_LOSS\=TO_DATE(?,'DD/MM/YYYY'),REPORT_DATE\=TO_DATE(?,'DD/MM/YYYY'),LOSS_DETAILS\=?,CAUSE_OF_LOSS\=?,CURRENCY\=?,LOSS_ESTIMATE_OC\=?,LOSS_ESTIMATE_OS_OC\=?,EXCHANGE_RATE\=?,LOSS_ESTIMATE_OS_DC\=?,ADVICE_UW\=?,ADVICE_MANAGEMENT\=?,RI_RECOVERY\=?,RI_RECOVERY_AMOUNT_DC\=?,RECOVERY_FROM\=?,CREATED_BY\=?,CREATED_DATE\=TO_DATE(?,'DD/MM/YYYY'),INCEPTION_DATE\=SYSDATE,LOCATION\=?,REMARKS\=?,ADVICE_UW_EMAILID\=?,ADVICE_MGT_EMAILID\=?,RISK_CODE\=?,ACCUMULATION_CODE\=?,EVENT_CODE\=?,insured_name\=?,SUB_CLASS\=?,BRANCH_CODE\=?, LOGIN_ID\=?, RECORD_FEES_CRE_RESERVE\=?, SAF_100_OC\=?, SAF_100_DC\=?,OTH_FEE_100_OC\=?, OTH_FEE_100_DC\=?, C_IBNR_100_OC\=?, C_IBNR_100_DC\=?,RECORD_IBNR\=?,CEDENT_CLAIM_NO\=?,SAF_OS_OC\=?,OTH_FEE_OS_OC\=?,C_IBNR_OS_OC\=?,SAF_OS_DC\=?,OTH_FEE_OS_DC\=?,C_IBNR_OS_DC\=?,Loss_Estimate_DC\=?,REOPENED_DATE\=TO_DATE(?,'DD/MM/YYYY'),GROSSLOSS_FGU_OC\=?,CLAIM_CLASS\=?,CLAIM_SUBCLASS\=?,RES_POS_DATE\=TO_DATE(?,'DD/MM/YYYY') , COVER_LIMIT_DEPTID\=?,PROPOSAL_NO\=?,PRODUCT_ID\=?,REPUDATE_DATE\=TO_DATE(?,'DD/MM/YYYY')  WHERE CONTRACT_NO\=? AND CLAIM_NO\=? AND LAYER_NO\=?
GET_DUPLICATE_CEDENT_NO_LIST=SELECT CLAIM_NO FROM TTRN_CLAIM_DETAILS C,POSITION_MASTER P WHERE  C.BRANCH_CODE=? AND P.PROPOSAL_NO=? AND C.CEDENT_CLAIM_NO=?  AND C.CONTRACT_NO=P.CONTRACT_NO AND C.BRANCH_CODE=P.BRANCH_CODE AND C.LAYER_NO=P.LAYER_NO AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER CP WHERE  CP.CONTRACT_NO=P.CONTRACT_NO AND  CP.LAYER_NO=P.LAYER_NO) ORDER BY CLAIM_NO DESC
GET_DUPLICATE_CEDENT_NO_LIST1=SELECT CLAIM_NO FROM TTRN_CLAIM_DETAILS C,POSITION_MASTER P WHERE  C.BRANCH_CODE=? AND P.PROPOSAL_NO=? AND C.CEDENT_CLAIM_NO=?  AND C.CONTRACT_NO=P.CONTRACT_NO AND C.BRANCH_CODE=P.BRANCH_CODE AND C.LAYER_NO=P.LAYER_NO AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER CP WHERE  CP.CONTRACT_NO=P.CONTRACT_NO AND  CP.LAYER_NO=P.LAYER_NO) AND C.CLAIM_NO != ? ORDER BY CLAIM_NO DESC
GET_PRE_REOPEN_DATE=SELECT to_char (REOPENED_DATE ,'DD/MM/YYYY')REOPENED_DATE FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO = ? AND CLAIM_NO = ?
GET_PRE_REOPEN_DATE_RETRO=SELECT to_char (REOPENED_DATE ,'DD/MM/YYYY')REOPENED_DATE FROM TTRN_RETRO_CLAIM_DETAILS WHERE CONTRACT_NO = ? AND CLAIM_NO = ?
GET_PRE_REPUTED_DATE=SELECT to_char (REPUDATE_DATE ,'DD/MM/YYYY')REPUDATE_DATE FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO = ? AND CLAIM_NO = ?
claim.select.getContInsDate=SELECT TO_CHAR(RSK_INCEPTION_DATE,'DD/MM/YYYY') INS_DATE FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?)
claim.select.excRate=SELECT EXCHANGE_RATE FROM TTRN_CLAIM_DETAILS WHERE CLAIM_NO=? AND CONTRACT_NO=?
claim.insert.getUpdationQuery=INSERT INTO TTRN_CLAIM_UPDATION (SL_NO,LAYER_NO,LOSS_ESTIMATE_REVISED_OC,LOSS_ESTIMATE_REVISED_DC,UPDATE_REFERENCE,INCEPTION_DATE,CLAIM_NO,CONTRACT_NO,STATUS,REMARKS,BRANCH_CODE, LOGIN_ID, SAF_100_OC, SAF_100_DC, OTH_FEE_100_OC, OTH_FEE_100_DC, C_IBNR_100_OC, C_IBNR_100_DC, SAF_OS_OC,OTH_FEE_OS_OC,C_IBNR_OS_OC,SAF_OS_DC, OTH_FEE_OS_DC, C_IBNR_OS_DC, LOSS_ESTIMATE_100_OC, LOSS_ESTIMATE_100_DC,RESERVE_FEES,RESERVE_IBNR,EXCHANGE_RATE,TOT_RES_AMOUNT_OC ,TOT_RES_AMOUNT_DC,RES_POS_DATE,SYS_DATE) VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,'Y',? ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),sysdate)
claim.update.closeClaim=UPDATE TTRN_CLAIM_DETAILS SET STATUS_OF_CLAIM=?,CLAIM_CLOSED_DATE=TO_DATE(?,'DD/MM/YYYY') WHERE CONTRACT_NO=? AND CLAIM_NO=?
claim.select.Ri_recovery=select RI_RECOVERY from TTRN_CLAIM_DETAILS where CLAIM_NO=? and CONTRACT_NO=?
claim.select.claimstatus=SELECT STATUS_OF_CLAIM	 FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO=? AND CLAIM_NO=?
claim.select.getInsDate=SELECT TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY') INS_DATE FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=? AND SL_NO=(SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=?)
claim.select.getLossDate=SELECT  TO_CHAR(DATE_OF_LOSS,'DD/MM/YYYY') LOSS_DATE FROM  TTRN_CLAIM_DETAILS WHERE CLAIM_NO=?
claim.select.getLastPayDt=SELECT   TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS PAY_DT FROM   TTRN_CLAIM_PAYMENT CP WHERE   CP.CLAIM_NO = ? AND CP.CONTRACT_NO = ? AND CP.CLAIM_PAYMENT_NO=(SELECT MAX(CLAIM_PAYMENT_NO) FROM TTRN_CLAIM_PAYMENT WHERE CLAIM_NO = CP.CLAIM_NO AND CONTRACT_NO=CP.CONTRACT_NO)
claim.lost.reserve.updateDate=SELECT TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY')INCEPTION_DATE FROM  TTRN_CLAIM_UPDATION TU WHERE CONTRACT_NO=? AND CLAIM_NO=?aND BRANCH_CODE=? AND SL_NO=(SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION WHERE CONTRACT_NO=TU.CONTRACT_NO AND CLAIM_NO=TU.CLAIM_NO AND BRANCH_CODE=TU.BRANCH_CODE)
GET_CLAIM_CURRENCY_RETRO =SELECT CURRENCY FROM TTRN_RETRO_CLAIM_DETAILS WHERE CLAIM_NO\=? AND CONTRACT_NO\=? AND LAYER_NO\=?
GET_CLAIM_CURRENCY =  SELECT CURRENCY FROM TTRN_CLAIM_DETAILS WHERE CLAIM_NO=? AND CONTRACT_NO=? AND LAYER_NO=?
premium.select.PremiumedList1=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?
premium.select.PremiumedList2= ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO 

premium.select.PremiumedList=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=? AND RSK_DEPTID =  TRA.SUB_CLASS) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO  AND RSK_DEPTID=? AND TRA.SUB_CLASS=RSK_DEPTID ORDER BY TRA.TRANSACTION_NO DESC
PTTY_PREMIUM_LIST_TEMP = SELECT REQUEST_NO,RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID=49 AND TYPE=TRA.ACCOUNT_PERIOD_QTR and STATUS='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS_TEMP TRA WHERE RK.RSK_CONTRACT_NO=? AND RK.RSK_CEDINGID=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID = PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE=? AND PERSONAL.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE = PERSONAL.BRANCH_CODE AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=? AND RSK_DEPTID =  TRA.SUB_CLASS ) AND TRA.CONTRACT_NO=RK.RSK_CONTRACT_NO  AND RSK_DEPTID=? AND TRA.SUB_CLASS=RSK_DEPTID and TRANS_STATUS='P' ORDER BY TRA.TRANSACTION_NO DESC
premium.select.allocatedYN=select Decode (count(*),0,'Y','N') allocatedYN from TTRN_ALLOCATED_TRANSACTION where CONTRACT_NO =? and TRANSACTION_NO=? and LAYER_NO=? and TYPE='P' and STATUS='Y'
allocation.status=select COUNT(*) COUNT from  ttrn_allocated_transaction where transaction_no=? AND STATUS='Y'
retro.status=select COUNT(*) COUNT from ttrn_retro_prcl trp where transaction_no\=?
retro.status1=select COUNT(*) COUNT from ttrn_retro_prcl trp where transaction_no=? AND process_id IS NOT NULL and trp.amend_id=(select max(amend_id) from ttrn_retro_prcl tr where trp.transaction_no=tr.transaction_no)
GET_SECTION_LIST=SELECT SECTION_NO,SECTION_NAME FROM TTRN_PTTY_SECTION TPS WHERE CONTRACT_NO=? AND DEPT_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  TTRN_PTTY_SECTION WHERE CONTRACT_NO=TPS.CONTRACT_NO AND DEPT_ID=TPS.DEPT_ID AND BRANCH_CODE=TPS.BRANCH_CODE )
premium.select.facTreatyPreList= SELECT A.CONTRACT_NO,A.PROPOSAL_NO, B.TMAS_DEPARTMENT_NAME,A.PRODUCT_ID, A.CEDING_COMPANY_ID, A.UW_YEAR, C.COMPANY_NAME, A.LAYER_NO,A.DEPT_ID, (select FIRST_NAME from personal_info pi where pi.customer_id=A.broker_id and customer_type='B' and pi.branch_code=A.branch_code and rownum=1) Broker_name FROM POSITION_MASTER A, TMAS_DEPARTMENT_MASTER B, PERSONAL_INFO C WHERE A.CONTRACT_NO = ? AND DEPT_ID=? AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO = A.CONTRACT_NO AND  DEPT_ID=A.DEPT_ID) AND A.DEPT_ID = B.TMAS_DEPARTMENT_ID AND B.BRANCH_CODE = A.BRANCH_CODE AND B.TMAS_PRODUCT_ID = A.PRODUCT_ID AND C.CUSTOMER_ID = A.CEDING_COMPANY_ID AND C.BRANCH_CODE = A.BRANCH_CODE AND C.CUSTOMER_TYPE = 'C'AND C.AMEND_ID =(SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE)
premium.select.CEASE_STATUS = select CEASE_STATUS from position_master pm where PROPOSAL_NO=? and  pm.amend_id=(Select Max(Amend_id) From Position_master p where p.PROPOSAL_NO=pm.PROPOSAL_NO)
GET_ACC_PERIOD =  SELECT RSK_ACCOUNTING_PERIOD FROM TTRN_RISK_DETAILS R WHERE R.RSK_PROPOSAL_NUMBER=? AND R.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS D WHERE D.RSK_PROPOSAL_NUMBER=R.RSK_PROPOSAL_NUMBER)
COMMON_SELECT_GETCONSTDET_PTTY =SELECT   DISTINCT TYPE, DETAIL_NAME FROM   CONSTANT_DETAIL WHERE   CATEGORY_ID \= ? AND STATUS \= ?
COMMON_SELECT_GETCONSTDET_PTTY1 =SELECT   DISTINCT TYPE, DETAIL_NAME FROM   CONSTANT_DETAIL WHERE   CATEGORY_ID \= ? AND STATUS \= ? AND REMARKS IN ('P','Q') ORDER BY   DETAIL_NAME
COMMON_SELECT_GETCONSTDET_PTTY2 =SELECT   DISTINCT TYPE, DETAIL_NAME FROM   CONSTANT_DETAIL WHERE   CATEGORY_ID \= ? AND STATUS \= ? AND REMARKS IN ('P','H') ORDER BY   DETAIL_NAME
COMMON_SELECT_GETCONSTDET_PTTY3 =SELECT   DISTINCT TYPE, DETAIL_NAME FROM   CONSTANT_DETAIL WHERE   CATEGORY_ID \= ? AND STATUS \= ? AND REMARKS IN ('P','Y') ORDER BY   DETAIL_NAME
GET_BASE_LAYER = SELECT NVL(BASE_LAYER,'0') BASE_LAYER,PROPOSAL_NO  FROM Position_Master P  WHERE CONTRACT_NO=? AND DEPT_ID= ?  AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO = P.CONTRACT_NO AND DEPT_ID = P.DEPT_ID  and PROPOSAL_NO=P.PROPOSAL_NO)
GET_SLIDE_COMM_VALUE = SELECT RSK_SLIDE_COMBIN_SUB_CLASS,RSK_SLADSCALE_COMM,RSK_PROFIT_COMM,RSK_COMBIN_SUB_CLASS,RSK_LOSS_PART_CARRIDOR,RSK_LOSS_COMBIN_SUB_CLASS FROM TTRN_RISK_COMMISSION P WHERE RSK_PROPOSAL_NUMBER\=? AND SUB_CLASS \=? AND RSK_ENDORSEMENT_NO \= (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION R WHERE R.RSK_PROPOSAL_NUMBER \= P.RSK_PROPOSAL_NUMBER and R.SUB_CLASS\= P.SUB_CLASS )
GET_DEPT_ID = SELECT DEPT_ID  FROM Position_Master P  WHERE PROPOSAL_NO=?  AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO = P.PROPOSAL_NO)
GET_SLIDE_COMM_VALUE1 = SELECT RSK_SLADSCALE_COMM,RSK_SLIDE_COMBIN_SUB_CLASS,RSK_PROFIT_COMM,RSK_COMBIN_SUB_CLASS,RSK_LOSS_PART_CARRIDOR,RSK_LOSS_COMBIN_SUB_CLASS FROM TTRN_RISK_COMMISSION P WHERE RSK_PROPOSAL_NUMBER=? and SUB_CLASS = ? AND RSK_ENDORSEMENT_NO = (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION R WHERE R.RSK_PROPOSAL_NUMBER = P.RSK_PROPOSAL_NUMBER and R.SUB_CLASS= P.SUB_CLASS )
GET_SLIDE_COMM_VALUE2 = SELECT RSK_SLADSCALE_COMM,RSK_PROFIT_COMM FROM TTRN_RISK_COMMISSION P WHERE RSK_PROPOSAL_NUMBER=? and SUB_CLASS = ? AND RSK_ENDORSEMENT_NO = (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION R WHERE R.RSK_PROPOSAL_NUMBER = P.RSK_PROPOSAL_NUMBER and R.SUB_CLASS= P.SUB_CLASS )
select.premium.sum = select nvl(sum(PREMIUM_QUOTASHARE_OC+PREMIUM_SURPLUS_OC),0) premium from rsk_premium_details where CONTRACT_NO= ? 
GET_CONT_PREM = select nvl(RSK_EPI_OSOE_OC,0) RSK_EPI_OSOE_OC from  TTRN_RISK_PROPOSAL TRP where RSK_PROPOSAL_NUMBER=(SELECT PROPOSAL_NO FROM POSITION_MASTER PM WHERE CONTRACT_NO=? AND DEPT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO AND DEPT_ID=PM.DEPT_ID)) and TRP.BRANCH_CODE=?  and RSK_ENDORSEMENT_NO=(select max(RSK_ENDORSEMENT_NO) from TTRN_RISK_PROPOSAL p where p.RSK_PROPOSAL_NUMBER=TRP.RSK_PROPOSAL_NUMBER and p.BRANCH_CODE = TRP.BRANCH_CODE)
GET_CON_DEPT_ID_LAYER = SELECT NVL(LAYER_NO,'') LAYER_NO FROM POSITION_MASTER P WHERE CONTRACT_NO \= ? AND LAYER_NO \=? AND  BRANCH_CODE\=? AND CONTRACT_STATUS\='A' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE    CONTRACT_NO \= P.CONTRACT_NO AND LAYER_NO \= P.LAYER_NO AND BRANCH_CODE \= P.BRANCH_CODE  AND CONTRACT_STATUS \= P.CONTRACT_STATUS)
GET_CON_DEPT_ID = SELECT NVL(DEPT_ID,0) DEPT_ID FROM POSITION_MASTER P WHERE CONTRACT_NO \= ? AND DEPT_ID \=? AND  BRANCH_CODE\=?  AND CONTRACT_STATUS\='A'  AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE    CONTRACT_NO \= P.CONTRACT_NO AND DEPT_ID \= P.DEPT_ID AND BRANCH_CODE \= P.BRANCH_CODE  AND CONTRACT_STATUS \= P.CONTRACT_STATUS)
GET_CON_DETAILS =SELECT NVL(CONTRACT_NO,'') GET_CON_DEPT_ID FROM POSITION_MASTER P WHERE CONTRACT_NO \= ?  AND  BRANCH_CODE\=? AND CONTRACT_STATUS\='A' and AMEND_ID \= (select max(AMEND_ID) from position_master where CONTRACT_NO \= P.CONTRACT_NO  AND  BRANCH_CODE\=P.BRANCH_CODE AND CONTRACT_STATUS\=P.CONTRACT_STATUS)
premium.select.getClaimNoDropdown=SELECT CLAIM_NO FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO\=? ORDER BY CLAIM_NO
premium.select.treatyContDet= SELECT   RK.TREATYTYPE,RK.RSK_DEPTID,RK.RSK_SPFCID,RK.RSK_CONTRACT_NO,RK.RSK_ENDORSEMENT_NO, PFC.TMAS_PFC_NAME,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RK.RSK_PRODUCTID AND PFC.BRANCH_CODE \= SPFC.BRANCH_CODE)TMAS_SPFC_NAME, PERSONAL.COMPANY_NAME COMPANY, RK.RSK_TREATYID, PI.FIRST_NAME || ' ' || PI.LAST_NAME BROKER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE,TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,TO_CHAR(RK.RSK_MONTH,'DD/MM/YYYY') MONTH, BRANCH.TMAS_POL_BRANCH_NAME,RK.RSK_PROPOSAL_NUMBER, RK.RSK_UWYEAR, RK.RSK_LAYER_NO,RK.RSK_ORIGINAL_CURR,CM.SHORT_NAME CURRENCY_NAME,PERSONAL.ADDRESS1 || ' ' || PERSONAL.ADDRESS2 Address,RK.INWARD_BUS_TYPE,(select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=RK.RSK_DEPTID and branch_code\=RK.branch_code  and TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME FROM   TTRN_RISK_DETAILS RK,TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL, TMAS_POLICY_BRANCH BRANCH,PERSONAL_INFO PI,CURRENCY_MASTER CM  WHERE RK.RSK_CONTRACT_NO \= ? AND RK.RSK_DEPTID=? AND PFC.TMAS_PFC_ID \= RK.RSK_PFCID AND PFC.BRANCH_CODE \= ? AND RK.BRANCH_CODE \= ? AND RK.RSK_PRODUCTID \= ? AND RK.RSK_CEDINGID \= PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE\='C' AND PERSONAL.BRANCH_CODE \= ? AND PERSONAL.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PERSONAL.CUSTOMER_ID AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND   PI.CUSTOMER_TYPE\='B' AND PI.BRANCH_CODE \= ? AND PI.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO \=? and RSK_DEPTID=RK.RSK_DEPTID )AND RK.RSK_POLBRANCH = BRANCH.TMAS_POL_BRANCH_ID AND BRANCH.BRANCH_CODE = ? AND CM.CURRENCY_ID=RK.RSK_ORIGINAL_CURR AND CM.BRANCH_CODE=PI.BRANCH_CODE AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=CM.CURRENCY_ID AND BRANCH_CODE=CM.BRANCH_CODE )

premium.select.CORE_COMPANY_CODE=SELECT CORE_COMPANY_CODE FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE =? AND TMAS_PRODUCT_ID=? AND  TMAS_STATUS='Y' AND CORE_COMPANY_CODE IS NOT NULL AND TMAS_DEPARTMENT_ID IN(?)

premium.select.treatyProposalDetails=SELECT RSK_PREMIUM_QUOTA_SHARE,RSK_PREMIUM_SURPULS,RSK_XLCOST_OS_OC,RSK_SHARE_SIGNED,RSK_EPI_OSOF_OC,RSK_MD_PREM_OS_OC,NVL(RSK_EPI_OSOF_OC,'0')-NVL(RSK_MD_PREM_OS_OC,'0')  ADJ_PRE,RSK_EPI_OSOE_OC,NVL(D.RSK_EXCHANGE_RATE,0) RSK_EXCHANGE_RATE  FROM TTRN_RISK_PROPOSAL F,TTRN_RISK_DETAILS D   WHERE F.RSK_PROPOSAL_NUMBER=? AND  F.RSK_ENDORSEMENT_NO IS NOT NULL AND D.RSK_PROPOSAL_NUMBER=F.RSK_PROPOSAL_NUMBER AND D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND F.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM  TTRN_RISK_PROPOSAL WHERE  RSK_PROPOSAL_NUMBER=? AND RSK_PREMIUM_QUOTA_SHARE IS NOT NULL)
premium.select.getOsClaimLossUpdate=SELECT CM.SHORT_NAME CURRENCY_NAME ,PD.OSCLAIM_LOSSUPDATE_OC FROM RSK_PREMIUM_DETAILS PD,CURRENCY_MASTER CM WHERE CM.CURRENCY_ID = PD.CURRENCY_ID AND CM.BRANCH_CODE = ? AND CM.STATUS = 'Y' AND TRUNC(CM.EFFECTIVE_DATE) <= TRUNC(SYSDATE) AND CM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC(EFFECTIVE_DATE) <= TRUNC(SYSDATE)) AND PD.CONTRACT_NO = ? AND PD.TRANSACTION_NO IN (SELECT DISTINCT MAX(transaction_no) KEEP (DENSE_RANK LAST ORDER BY transaction_no) OVER (PARTITION BY contract_no,currency_id) RNK FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND NVL(osclaim_lossupdate_oc,0) > 0)
premium.select.getOsClaimLossUpdateEdit=AND TRANSACTION_NO < ?
premium.select.getOsClaimLossUpdate1=SELECT CM.SHORT_NAME CURRENCY_NAME ,PD.OSCLAIM_LOSSUPDATE_OC FROM RSK_PREMIUM_DETAILS PD,CURRENCY_MASTER CM WHERE CM.CURRENCY_ID = PD.CURRENCY_ID AND CM.BRANCH_CODE = ? AND CM.STATUS = 'Y' AND TRUNC(CM.EFFECTIVE_DATE) <= TRUNC(SYSDATE) AND CM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC(EFFECTIVE_DATE) <= TRUNC(SYSDATE)) AND PD.CONTRACT_NO = ? AND PD.TRANSACTION_NO IN (SELECT DISTINCT MAX(transaction_no) KEEP (DENSE_RANK LAST ORDER BY transaction_no) OVER (PARTITION BY contract_no,currency_id) RNK FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND NVL(osclaim_lossupdate_oc,0) > 0 AND TRANSACTION_NO < ?)
premium.select.getOsClaimLossUpdateNew=)
premium.select.getOsClaimLossUpdate2=SELECT CM.SHORT_NAME CURRENCY_NAME ,PD.OSCLAIM_LOSSUPDATE_OC FROM RSK_PREMIUM_DETAILS PD,CURRENCY_MASTER CM WHERE CM.CURRENCY_ID = PD.CURRENCY_ID AND CM.BRANCH_CODE = ? AND CM.STATUS = 'Y' AND TRUNC(CM.EFFECTIVE_DATE) <= TRUNC(SYSDATE) AND CM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND BRANCH_CODE = CM.BRANCH_CODE AND STATUS = 'Y' AND TRUNC(EFFECTIVE_DATE) <= TRUNC(SYSDATE)) AND PD.CONTRACT_NO = ? AND PD.TRANSACTION_NO IN (SELECT DISTINCT MAX(transaction_no) KEEP (DENSE_RANK LAST ORDER BY transaction_no) OVER (PARTITION BY contract_no,currency_id) RNK FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND NVL(osclaim_lossupdate_oc,0) > 0)
premium.select.cashLossCreditUpdate=SELECT LU.CLAIM_NO,LU.CURRENCY_ID,LU.CASH_LOSS_CREDIT_OC,CASH_LOSS_CREDIT_DC FROM  TTRN_CASH_LOSS_CREDIT_UPDATE LU where LU.CONTRACT_NO\=? AND LU.TRANSACTION_NO\=? AND AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM TTRN_CASH_LOSS_CREDIT_UPDATE WHERE CONTRACT_NO \= LU.CONTRACT_NO AND TRANSACTION_NO \= LU.TRANSACTION_NO AND CLAIM_NO \= LU.CLAIM_NO) order by LU.CLAIM_NO
premium.select.currecy.name=SELECT COUNTRY_SHORT_NAME FROM TMAS_BRANCH_MASTER WHERE  BRANCH_CODE=?
premium.select.sumOfPaidPremium=SELECT NVL(SUM(PREMIUM_QUOTASHARE_OC),'0') PREMIUM_QUOTASHARE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=?
GETSETTLEMET_STATUS = SELECT ALLOCATED_TILL_DATE,NETDUE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=?
common.select.getDepartmentList.preClaim=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? and TMAS_DEPARTMENT_ID in(select RSK_COVER_CLASS from  TTRN_RSK_CLASS_LIMITS t where RSK_CONTRACT_NO=? and RSK_LAYER_NO=? and RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO)from TTRN_RSK_CLASS_LIMITS where RSK_PROPOSAL_NUMBER=t.RSK_PROPOSAL_NUMBER)) ORDER BY  TMAS_DEPARTMENT_NAME ASC
DEPARTMENT_VALUE= SELECT   DISTINCT TMAS_DEPARTMENT_ID, TMAS_DEPARTMENT_NAME     FROM   TMAS_DEPARTMENT_MASTER    WHERE   BRANCH_CODE \= ? AND TMAS_PRODUCT_ID \= ? AND TMAS_STATUS \= ?            AND TMAS_DEPARTMENT_ID IN   (SELECT   DEPT_ID   FROM   POSITION_MASTER t WHERE   CONTRACT_NO \= ? AND LAYER_NO \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID)FROM   POSITION_MASTER WHERE   PROPOSAL_NO \=  t.PROPOSAL_NO)) ORDER BY   TMAS_DEPARTMENT_NAME ASC
common.select.subProfitCenterList=SELECT DISTINCT TMAS_SPFC_ID ,TMAS_SPFC_NAME  FROM  TMAS_SPFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? and TMAS_DEPARTMENT_ID=? AND TMAS_STATUS=?
common.select.subProfitCenterList1=SELECT DISTINCT TMAS_SPFC_ID ,TMAS_SPFC_NAME  FROM  TMAS_SPFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? and TMAS_DEPARTMENT_ID=? AND TMAS_STATUS=? and TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(?,' ', '')))) ORDER BY TMAS_SPFC_NAME ASC 
common.select.subProfitCenterList2=SELECT DISTINCT TMAS_SPFC_ID ,TMAS_SPFC_NAME  FROM  TMAS_SPFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? and TMAS_DEPARTMENT_ID=? AND TMAS_STATUS=? ORDER BY TMAS_SPFC_NAME ASC
GET_CLEAN_CUT_CONT_COUNT=SELECT  COUNT(RSK_CONTRACT_NO) RSK_CONTRACT_NO FROM  TTRN_RISK_DETAILS RD WHERE RSK_PROPOSAL_TYPE='C' AND RSK_CONTRACT_NO=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_TYPE='C' AND RSK_CONTRACT_NO=RD.RSK_CONTRACT_NO)
GET_CLEAN_CUT_COUNT=SELECT COUNT(*) COUNT FROM RSK_PREMIUM_DETAILS WHERE ACCOUNT_PERIOD_QTR='5' AND CONTRACT_NO IN (SELECT  RSK_CONTRACT_NO FROM  TTRN_RISK_DETAILS RD WHERE RSK_PROPOSAL_TYPE='C' AND RSK_CONTRACT_NO=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_TYPE='C' AND RSK_CONTRACT_NO=RD.RSK_CONTRACT_NO))
GET_CASHLOSS_COUNT =SELECT COUNT(*) COUNT FROM   TTRN_CLAIM_PAYMENT TCP, TTRN_Claim_Details TCD WHERE   NVL (PAID_AMOUNT_OC, 0) - NVL (CASH_LOSS_SETTLED_TILLDATE, 0) > 0 AND  TCP.CONTRACT_NO \= ? AND SUB_CLASS \=? AND TCD.CONTRACT_NO \= TCP.CONTRACT_NO AND TCD.CLAIM_NO \= TCP.CLAIM_NO
premium.select.getTreatySPRetro=SELECT   RP.RSK_SP_RETRO, RP.RSK_NO_OF_INSURERS,RP.RSK_PROPOSAL_NUMBER FROM   TTRN_RISK_PROPOSAL RP, TTRN_RISK_DETAILS RD WHERE   RP.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO =?  AND RD.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO = RD.RSK_CONTRACT_NO)
premium.select.getNoRetroCess=SELECT RD.RETRO_CESSIONARIES FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_CONTRACT_NO=? AND RD.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=RD.RSK_CONTRACT_NO)
premium.select.getSumOfShareSign=SELECT NVL(SUM(A.SHARE_SIGNED),0) SHARE_SIGNED FROM TTRN_RETRO_CESSIONARY A WHERE AMEND_ID = (SELECT MAX (AMEND_ID) FROM  TTRN_RETRO_CESSIONARY WHERE  A.CONTRACT_NO = CONTRACT_NO AND A.PROPOSAL_STATUS=PROPOSAL_STATUS AND A.SNO=SNO) AND A.CONTRACT_NO=? AND A.PROPOSAL_STATUS='A' AND A.SNO BETWEEN 0 AND ? ORDER BY A.SNO
GET_DEPARTMENT_NO =SELECT  RSK_DEPTID FROM TTRN_RISK_DETAILS D WHERE  RSK_CONTRACT_NO\=? AND RSK_ENDORSEMENT_NO \= (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS T WHERE T.RSK_CONTRACT_NO\=D.RSK_CONTRACT_NO AND T.RSK_PROPOSAL_NUMBER \= D.RSK_PROPOSAL_NUMBER)
GET_OBS_LIST=SELECT CONTRACT_NO,LAYER_NO, RSK_INSURED_NAME DEPTID,TRANSACTION_NO,ACCOUNT_PERIOD_QTR ,STATEMENT_DATE STATEMENT_DATE ,RSK_SPFCID SUB_CLASS,COMPANY_CODE CURRENCY_ID,BROKER_CODE SECTION_NAME,to_number(AMOUNT_OC) OSCLAIM_LOSSUPDATE_OC,TRANSACTION_DATE,ACCOUNTING_PERIOD_DATE FROM TABLE(FN_RENEWAL_STATISTICS(? ,'','','',?,?,'OSLR') ) ORDER BY CURRENCY
PREMIUM_INSERT_TREATYPREMIUM_TEMP=INSERT INTO RSK_PREMIUM_DETAILS_TEMP ( CONTRACT_NO,REQUEST_NO,TRANSACTION_MONTH_YEAR ,ACCOUNT_PERIOD_QTR,ACCOUNT_PERIOD_YEAR,CURRENCY_ID ,EXCHANGE_RATE,BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME, PREMIUM_QUOTASHARE_OC,COMMISSION_QUOTASHARE_OC,PREMIUM_SURPLUS_OC,COMMISSION_SURPLUS_OC, PREMIUM_PORTFOLIOIN_OC,CLAIM_PORTFOLIOIN_OC,PREMIUM_PORTFOLIOOUT_OC,LOSS_RESERVE_RELEASED_OC ,PREMIUMRESERVE_QUOTASHARE_OC,CASH_LOSS_CREDIT_OC,LOSS_RESERVERETAINED_OC,PROFIT_COMMISSION_OC, CASH_LOSSPAID_OC, STATUS,ENTERING_MODE,RECEIPT_NO,CLAIMS_PAID_OC,SETTLEMENT_STATUS,XL_COST_OC,CLAIM_PORTFOLIO_OUT_OC,PREMIUM_RESERVE_REALSED_OC,NETDUE_OC,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,PREMIUM_QUOTASHARE_DC,COMMISSION_QUOTASHARE_DC,PREMIUM_SURPLUS_DC,COMMISSION_SURPLUS_DC, PREMIUM_PORTFOLIOIN_DC,CLAIM_PORTFOLIOIN_DC,PREMIUM_PORTFOLIOOUT_DC,LOSS_RESERVE_RELEASED_DC  ,PREMIUMRESERVE_QUOTASHARE_DC,CASH_LOSS_CREDIT_DC,LOSS_RESERVERETAINED_DC,PROFIT_COMMISSION_DC, CASH_LOSSPAID_DC,CLAIMS_PAID_DC,XL_COST_DC, CLAIM_PORTFOLIO_OUT_DC,PREMIUM_RESERVE_REALSED_DC,NETDUE_DC,OTHER_COST_DC,COMMISSION,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,INTEREST_OC,INTEREST_DC,OSCLAIM_LOSSUPDATE_OC,OSCLAIM_LOSSUPDATE_DC,ENTRY_DATE,OVERRIDER_AMT_OC,OVERRIDER_AMT_DC,OVERRIDER,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,RI_CESSION,LOGIN_ID,BRANCH_CODE,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC, SC_COMM_OC,SC_COMM_DC,PREMIUM_CLASS,PREMIUM_SUBCLASS,ACCOUNTING_PERIOD_DATE,STATEMENT_DATE,OSBYN,LPC_OC,LPC_DC,SECTION_NAME, PROPOSAL_NO,PRODUCT_ID,TRANS_STATUS,TRANS_TYPE) values (?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?)
GET_SEQ_NAME =SELECT  SEQ_NAME FROM SEQUENCE_MASTER WHERE BRANCH_CODE\=? AND SEQ_ID\='20'
FAC_TEMP_STATUS_UPDATE = UPDATE RSK_PREMIUM_DETAILS_TEMP SET TRANS_STATUS=?,REVIEWER_ID=?,REVIEW_DATE=SYSDATE,TRANSACTION_NO=? WHERE REQUEST_NO=? AND BRANCH_CODE=?
FAC_PREMIUM_TEMP_TO_MAIN = INSERT INTO RSK_PREMIUM_DETAILS (CONTRACT_NO, TRANSACTION_NO, TRANSACTION_MONTH_YEAR, ACCOUNT_PERIOD_QTR, ACCOUNT_PERIOD_YEAR,     CURRENCY_ID, EXCHANGE_RATE, BROKERAGE, BROKERAGE_AMT_OC, BROKERAGE_AMT_DC,     TAX, TAX_AMT_OC, TAX_AMT_DC, ENTRY_DATE_TIME, COMMISSION,     PREMIUM_QUOTASHARE_OC, PREMIUM_QUOTASHARE_DC, COMMISSION_QUOTASHARE_OC, COMMISSION_QUOTASHARE_DC, PREMIUM_SURPLUS_OC,     PREMIUM_SURPLUS_DC, COMMISSION_SURPLUS_OC, COMMISSION_SURPLUS_DC, PREMIUM_PORTFOLIOIN_OC, PREMIUM_PORTFOLIOIN_DC,     CLAIM_PORTFOLIOIN_OC, CLAIM_PORTFOLIOIN_DC, PREMIUM_PORTFOLIOOUT_OC, PREMIUM_PORTFOLIOOUT_DC, LOSS_RESERVE_RELEASED_OC,     LOSS_RESERVE_RELEASED_DC, PREMIUMRESERVE_QUOTASHARE_OC, PREMIUMRESERVE_QUOTASHARE_DC, CASH_LOSS_CREDIT_OC, CASH_LOSS_CREDIT_DC,     LOSS_RESERVERETAINED_OC, LOSS_RESERVERETAINED_DC, PROFIT_COMMISSION_OC, PROFIT_COMMISSION_DC, CASH_LOSSPAID_OC,     CASH_LOSSPAID_DC, STATUS, REMARKS, NETDUE_OC, NETDUE_DC,     LAYER_NO, M_DPREMIUM_OC, M_DPREMIUM_DC, ADJUSTMENT_PREMIUM_OC, ADJUSTMENT_PREMIUM_DC,     REC_PREMIUM_OC, REC_PREMIUM_DC, ENTERING_MODE, RECEIPT_NO, CLAIMS_PAID_OC,     CLAIMS_PAID_DC, SETTLEMENT_STATUS, PAYMENT_NO, INSTALMENT_NUMBER, PREMIUM_RESERVE_RELEASE_OC,     PREMIUM_RESERVE_RELEASE_DC, PREMIUM_RESERVE_RETAINED_OC, PREMIUM_RESERVE_RETAINED_DC, INTEREST_OC, INTEREST_DC,     UW_MONTH, UW_YEAR, XL_COST_OC, XL_COST_DC, CLAIM_PORTFOLIO_OUT_OC,     CLAIM_PORTFOLIO_OUT_DC, PREMIUM_RESERVE_REALSED_OC, PREMIUM_RESERVE_REALSED_DC, OTHER_COST_OC, OTHER_COST_DC,     ALLOCATED_TILL_DATE, CEDANT_REFERENCE, ACC_PREMIUM, CHECKYN, TOTAL_CR_OC,     TOTAL_CR_DC, TOTAL_DR_OC, TOTAL_DR_DC, OSCLAIM_LOSSUPDATE_OC, OSCLAIM_LOSSUPDATE_DC,     PROPOSAL_NO, ENTRY_DATE, OVERRIDER, OVERRIDER_AMT_OC, OVERRIDER_AMT_DC,     MOVEMENT_YN, MOVMENT_TRANID, AMENDMENT_DATE, WITH_HOLDING_TAX_DC, WITH_HOLDING_TAX_OC,     AMEND_ID, RI_CESSION, SUB_CLASS, LOGIN_ID, BRANCH_CODE,     TDS_OC, TDS_DC, ST_OC, ST_DC, SC_COMM_OC,     SC_COMM_DC, BONUS_OC, BONUS_DC, PREMIUM_CLASS, PREMIUM_SUBCLASS,     PRD_ALLOCATED_TILL_DATE, LRD_ALLOCATED_TILL_DATE, GNPI_ENDT_NO, ACCOUNTING_PERIOD_DATE, STATEMENT_DATE,     OSBYN, LPC_OC, LPC_DC, SECTION_NAME, PRODUCT_ID,     REVERSE_TRANSACTION_NO, REVERSEL_STATUS, REQUEST_NO, TRANS_TYPE) SELECT CONTRACT_NO, TRANSACTION_NO, TRANSACTION_MONTH_YEAR, ACCOUNT_PERIOD_QTR, ACCOUNT_PERIOD_YEAR,     CURRENCY_ID, EXCHANGE_RATE, BROKERAGE, BROKERAGE_AMT_OC, BROKERAGE_AMT_DC,     TAX, TAX_AMT_OC, TAX_AMT_DC, ENTRY_DATE_TIME, COMMISSION,     PREMIUM_QUOTASHARE_OC, PREMIUM_QUOTASHARE_DC, COMMISSION_QUOTASHARE_OC, COMMISSION_QUOTASHARE_DC, PREMIUM_SURPLUS_OC,     PREMIUM_SURPLUS_DC, COMMISSION_SURPLUS_OC, COMMISSION_SURPLUS_DC, PREMIUM_PORTFOLIOIN_OC, PREMIUM_PORTFOLIOIN_DC,     CLAIM_PORTFOLIOIN_OC, CLAIM_PORTFOLIOIN_DC, PREMIUM_PORTFOLIOOUT_OC, PREMIUM_PORTFOLIOOUT_DC, LOSS_RESERVE_RELEASED_OC,     LOSS_RESERVE_RELEASED_DC, PREMIUMRESERVE_QUOTASHARE_OC, PREMIUMRESERVE_QUOTASHARE_DC, CASH_LOSS_CREDIT_OC, CASH_LOSS_CREDIT_DC,     LOSS_RESERVERETAINED_OC, LOSS_RESERVERETAINED_DC, PROFIT_COMMISSION_OC, PROFIT_COMMISSION_DC, CASH_LOSSPAID_OC,     CASH_LOSSPAID_DC, STATUS, REMARKS, NETDUE_OC, NETDUE_DC,     LAYER_NO, M_DPREMIUM_OC, M_DPREMIUM_DC, ADJUSTMENT_PREMIUM_OC, ADJUSTMENT_PREMIUM_DC,     REC_PREMIUM_OC, REC_PREMIUM_DC, ENTERING_MODE, RECEIPT_NO, CLAIMS_PAID_OC,     CLAIMS_PAID_DC, SETTLEMENT_STATUS, PAYMENT_NO, INSTALMENT_NUMBER, PREMIUM_RESERVE_RELEASE_OC,     PREMIUM_RESERVE_RELEASE_DC, PREMIUM_RESERVE_RETAINED_OC, PREMIUM_RESERVE_RETAINED_DC, INTEREST_OC, INTEREST_DC,     UW_MONTH, UW_YEAR, XL_COST_OC, XL_COST_DC, CLAIM_PORTFOLIO_OUT_OC,     CLAIM_PORTFOLIO_OUT_DC, PREMIUM_RESERVE_REALSED_OC, PREMIUM_RESERVE_REALSED_DC, OTHER_COST_OC, OTHER_COST_DC,     ALLOCATED_TILL_DATE, CEDANT_REFERENCE, ACC_PREMIUM, CHECKYN, TOTAL_CR_OC,     TOTAL_CR_DC, TOTAL_DR_OC, TOTAL_DR_DC, OSCLAIM_LOSSUPDATE_OC, OSCLAIM_LOSSUPDATE_DC,     PROPOSAL_NO, ENTRY_DATE, OVERRIDER, OVERRIDER_AMT_OC, OVERRIDER_AMT_DC,     MOVEMENT_YN, MOVMENT_TRANID, AMENDMENT_DATE, WITH_HOLDING_TAX_DC, WITH_HOLDING_TAX_OC,     AMEND_ID, RI_CESSION, SUB_CLASS, LOGIN_ID, BRANCH_CODE,     TDS_OC, TDS_DC, ST_OC, ST_DC, SC_COMM_OC,     SC_COMM_DC, BONUS_OC, BONUS_DC, PREMIUM_CLASS, PREMIUM_SUBCLASS,     PRD_ALLOCATED_TILL_DATE, LRD_ALLOCATED_TILL_DATE, GNPI_ENDT_NO, ACCOUNTING_PERIOD_DATE, STATEMENT_DATE,     OSBYN, LPC_OC, LPC_DC, SECTION_NAME, PRODUCT_ID,     REVERSE_TRANSACTION_NO, REVERSEL_STATUS, REQUEST_NO, TRANS_TYPE FROM RSK_PREMIUM_DETAILS_TEMP WHERE REQUEST_NO=? AND BRANCH_CODE = ?
premium.sp.retroSplit={CALL RetroPremium_Split_claim(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?)}
premium.select.MAXRLNo=(SELECT nvl(MAX(RL_NO),5001)+1 RL_NO FROM TTRN_DEPOSIT_RELEASE WHERE BRANCH_CODE=?)
INSERT_PREMIUM_RESERVE=INSERT INTO TTRN_DEPOSIT_RELEASE (PROPOSAL_NO,CONTRACT_NO,DEPT_ID,RELEASE_TYPE,RL_NO,RL_TRANSACTION_NO,RL_TRANSACTION_DATE,RT_TRANSACTION_NO,RT_TRANSACTION_DATE,RL_CURRENCY_ID,RT_CURRENCY_ID,RL_AMOUNT_IN_RL_CURR,RL_AMOUNT_IN_RT_CURR,EXCHANGE_RATE,LOGIN_ID,BRANCH_CODE,SYS_DATE,TABLE_MOVE_STATUS,TEMP_REQUEST_NO) VALUES(?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?,to_date(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,SYSDATE,?,?)
UPDATE_PREMIUM_RESERVE=UPDATE RSK_PREMIUM_DETAILS SET PRD_ALLOCATED_TILL_DATE=nvl(PRD_ALLOCATED_TILL_DATE,0)+(SELECT NVL(SUM(RL_AMOUNT_IN_RT_CURR),0) FROM TTRN_DEPOSIT_RELEASE where CONTRACT_NO=? and TEMP_REQUEST_NO=?  AND TABLE_MOVE_STATUS=? AND RELEASE_TYPE='PRR') WHERE CONTRACT_NO=? AND TRANSACTION_NO=?
INSERT_PREMIUM_RESERVE=INSERT INTO TTRN_DEPOSIT_RELEASE (PROPOSAL_NO,CONTRACT_NO,DEPT_ID,RELEASE_TYPE,RL_NO,RL_TRANSACTION_NO,RL_TRANSACTION_DATE,RT_TRANSACTION_NO,RT_TRANSACTION_DATE,RL_CURRENCY_ID,RT_CURRENCY_ID,RL_AMOUNT_IN_RL_CURR,RL_AMOUNT_IN_RT_CURR,EXCHANGE_RATE,LOGIN_ID,BRANCH_CODE,SYS_DATE,TABLE_MOVE_STATUS,TEMP_REQUEST_NO) VALUES(?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?,to_date(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,SYSDATE,?,?)
UPDATE_LOSS_RESERVE=UPDATE RSK_PREMIUM_DETAILS SET LRD_ALLOCATED_TILL_DATE=nvl(LRD_ALLOCATED_TILL_DATE,0)+(SELECT NVL(SUM(RL_AMOUNT_IN_RT_CURR),0) FROM  TTRN_DEPOSIT_RELEASE WHERE CONTRACT_NO=? AND TEMP_REQUEST_NO=? AND TABLE_MOVE_STATUS=? AND RELEASE_TYPE='LRR') WHERE CONTRACT_NO=? AND TRANSACTION_NO=?
GET_PREMIUM_RESERVED_DETAILS=SELECT ROWNUM sno,CONTRACT_NO,TRANSACTION_NO,TO_CHAR (TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY') TRANSACTION_MONTH_YEAR,CURRENCY_ID,(nvl(PREMIUMRESERVE_QUOTASHARE_OC,0)-nvl(PRD_ALLOCATED_TILL_DATE,0))PREMIUMRESERVE_QUOTASHARE_OC ,nvl(PRD_ALLOCATED_TILL_DATE,0)ALLOCATE_TILLDATE from RSK_PREMIUM_DETAILS where  (nvl(PREMIUMRESERVE_QUOTASHARE_OC,0))<>nvl(PRD_ALLOCATED_TILL_DATE,0) AND  CONTRACT_NO\=? and SUB_CLASS\=? and TRANSACTION_MONTH_YEAR<\=trunc(to_date(?,'DD/MM/YYYY'))
GET_LOSS_RESERVED_DETAILS=SELECT ROWNUM sno,CONTRACT_NO,TRANSACTION_NO,TO_CHAR (TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY') TRANSACTION_MONTH_YEAR,CURRENCY_ID,(nvl(LOSS_RESERVERETAINED_OC,0)-nvl(LRD_ALLOCATED_TILL_DATE,0))PREMIUMRESERVE_QUOTASHARE_OC ,nvl(LRD_ALLOCATED_TILL_DATE,0)ALLOCATE_TILLDATE from RSK_PREMIUM_DETAILS where  (nvl(LOSS_RESERVERETAINED_OC,0))<>nvl(LRD_ALLOCATED_TILL_DATE,0) AND  CONTRACT_NO\=? and SUB_CLASS\=? and TRANSACTION_MONTH_YEAR<\=trunc(to_date(?,'DD/MM/YYYY'))
GET_CURRENCY_NAME = SELECT SHORT_NAME FROM  CURRENCY_MASTER CD WHERE BRANCH_CODE=? AND CURRENCY_ID=? AND STATUS='Y' AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER C WHERE C.BRANCH_CODE=CD.BRANCH_CODE AND C.CURRENCY_ID=CD.CURRENCY_ID AND C.STATUS='Y')
premium.select.RL_NO=(SELECT nvl(MAX(RL_NO),5001)+1 FROM TTRN_DEPOSIT_RELEASE WHERE BRANCH_CODE=?)
common.select.getStartDTOfMonth=SELECT '01/'||TO_CHAR(TO_DATE(?,'DD/MM/YYYY'),'MM/YYYY') STDATE FROM DUAL
common.select.getExRate=SELECT EXCHANGE_RATE FROM EXCHANGE_MASTER E WHERE CURRENCY_ID\=? AND COUNTRY_ID\=? AND TRUNC(INCEPTION_DATE) <\= TO_DATE(?,'DD-MM-YYYY') AND BRANCH_CODE\=? and E.AMEND_ID\=(select max(AMEND_ID) from EXCHANGE_MASTER M WHERE M.CURRENCY_ID\=E.CURRENCY_ID AND M.COUNTRY_ID\=E.COUNTRY_ID AND TRUNC(INCEPTION_DATE) <\= TO_DATE(?,'DD-MM-YYYY') AND M.BRANCH_CODE\=E.BRANCH_CODE) ORDER BY INCEPTION_DATE DESC
PREMIUM_SELECT_TREATYPREMIUMVIEW_TEMP = SELECT OSBYN,CONTRACT_NO,TRANSACTION_NO,(SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID \= '49' AND TYPE \= PD.ACCOUNT_PERIOD_QTR) ACCOUNT_PERIOD_QTR,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,EXCHANGE_RATE,BROKERAGE ,BROKERAGE_AMT_OC, TAX, TAX_AMT_OC, PREMIUM_QUOTASHARE_OC, COMMISSION_QUOTASHARE_OC ,PREMIUM_SURPLUS_OC, COMMISSION_SURPLUS_OC, PREMIUM_PORTFOLIOIN_OC,CLAIM_PORTFOLIOIN_OC, PREMIUM_PORTFOLIOOUT_OC ,LOSS_RESERVE_RELEASED_OC, PREMIUMRESERVE_QUOTASHARE_OC, CASH_LOSS_CREDIT_OC, LOSS_RESERVERETAINED_OC ,PROFIT_COMMISSION_OC, CASH_LOSSPAID_OC, NETDUE_OC,RECEIPT_NO,SETTLEMENT_STATUS,CLAIMS_PAID_OC,XL_COST_OC,CLAIM_PORTFOLIO_OUT_OC,PREMIUM_RESERVE_REALSED_OC,ACCOUNT_PERIOD_YEAR,CURRENCY_ID,OTHER_COST_OC, BROKERAGE_AMT_DC,TAX_AMT_DC,PREMIUM_QUOTASHARE_DC,COMMISSION_QUOTASHARE_DC,PREMIUM_SURPLUS_DC,COMMISSION_SURPLUS_DC, PREMIUM_PORTFOLIOIN_DC,CLAIM_PORTFOLIOIN_DC,PREMIUM_PORTFOLIOOUT_DC,LOSS_RESERVE_RELEASED_DC ,PREMIUMRESERVE_QUOTASHARE_DC,CASH_LOSS_CREDIT_DC,LOSS_RESERVERETAINED_DC,PROFIT_COMMISSION_DC, CASH_LOSSPAID_DC,CLAIMS_PAID_DC,XL_COST_DC,CLAIM_PORTFOLIO_OUT_DC,PREMIUM_RESERVE_REALSED_DC, NETDUE_DC,OTHER_COST_DC,COMMISSION,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,INTEREST_OC,INTEREST_DC,OSCLAIM_LOSSUPDATE_OC,OSCLAIM_LOSSUPDATE_DC,OVERRIDER_AMT_OC,OVERRIDER_AMT_DC,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (ACCOUNTING_PERIOD_DATE+30, 'DD/MM/YYYY') due_date,RI_CESSION,TDS_OC,TDS_DC,ST_OC,ST_DC,SC_COMM_OC,SC_COMM_DC,LPC_OC,LPC_DC,PREMIUM_CLASS,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(PD.PREMIUM_SUBCLASS,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= '2' AND PD.BRANCH_CODE \= SPFC.BRANCH_CODE)PREMIUM_SUBCLASS,PD.PREMIUM_SUBCLASS SUB,(select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=PD.PREMIUM_CLASS and branch_code\=PD.branch_code  and TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY')STATEMENT_DATE,(SELECT SECTION_NAME FROM TTRN_PTTY_SECTION TPS WHERE CONTRACT_NO\=PD.CONTRACT_NO AND DEPT_ID\=PD.SUB_CLASS  AND SECTION_NO\=PD.SECTION_NAME AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_PTTY_SECTION WHERE CONTRACT_NO\=TPS.CONTRACT_NO AND DEPT_ID\=TPS.DEPT_ID ))SECTION_NAME from RSK_PREMIUM_DETAILS_TEMP PD WHERE CONTRACT_NO\=? and REQUEST_NO\=?
premium.select.treatyPremiumView= SELECT OSBYN,CONTRACT_NO,TRANSACTION_NO,(SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID \= '49' AND TYPE \= PD.ACCOUNT_PERIOD_QTR) ACCOUNT_PERIOD_QTR,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,EXCHANGE_RATE,BROKERAGE ,BROKERAGE_AMT_OC, TAX, TAX_AMT_OC, PREMIUM_QUOTASHARE_OC, COMMISSION_QUOTASHARE_OC ,PREMIUM_SURPLUS_OC, COMMISSION_SURPLUS_OC, PREMIUM_PORTFOLIOIN_OC,CLAIM_PORTFOLIOIN_OC, PREMIUM_PORTFOLIOOUT_OC ,LOSS_RESERVE_RELEASED_OC, PREMIUMRESERVE_QUOTASHARE_OC, CASH_LOSS_CREDIT_OC, LOSS_RESERVERETAINED_OC ,PROFIT_COMMISSION_OC, CASH_LOSSPAID_OC, NETDUE_OC,RECEIPT_NO,SETTLEMENT_STATUS,CLAIMS_PAID_OC,XL_COST_OC,CLAIM_PORTFOLIO_OUT_OC,PREMIUM_RESERVE_REALSED_OC,ACCOUNT_PERIOD_YEAR,CURRENCY_ID,OTHER_COST_OC, BROKERAGE_AMT_DC,TAX_AMT_DC,PREMIUM_QUOTASHARE_DC,COMMISSION_QUOTASHARE_DC,PREMIUM_SURPLUS_DC,COMMISSION_SURPLUS_DC, PREMIUM_PORTFOLIOIN_DC,CLAIM_PORTFOLIOIN_DC,PREMIUM_PORTFOLIOOUT_DC,LOSS_RESERVE_RELEASED_DC ,PREMIUMRESERVE_QUOTASHARE_DC,CASH_LOSS_CREDIT_DC,LOSS_RESERVERETAINED_DC,PROFIT_COMMISSION_DC, CASH_LOSSPAID_DC,CLAIMS_PAID_DC,XL_COST_DC,CLAIM_PORTFOLIO_OUT_DC,PREMIUM_RESERVE_REALSED_DC, NETDUE_DC,OTHER_COST_DC,COMMISSION,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,INTEREST_OC,INTEREST_DC,OSCLAIM_LOSSUPDATE_OC,OSCLAIM_LOSSUPDATE_DC,OVERRIDER_AMT_OC,OVERRIDER_AMT_DC,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (ACCOUNTING_PERIOD_DATE+30, 'DD/MM/YYYY') due_date,RI_CESSION,TDS_OC,TDS_DC,ST_OC,ST_DC,SC_COMM_OC,SC_COMM_DC,LPC_OC,LPC_DC,PREMIUM_CLASS,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(PD.PREMIUM_SUBCLASS,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= '2' AND PD.BRANCH_CODE \= SPFC.BRANCH_CODE)PREMIUM_SUBCLASS,PD.PREMIUM_SUBCLASS SUB,(select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=PD.PREMIUM_CLASS and branch_code\=PD.branch_code  and TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY')STATEMENT_DATE,(SELECT SECTION_NAME FROM TTRN_PTTY_SECTION TPS WHERE CONTRACT_NO\=PD.CONTRACT_NO AND DEPT_ID\=PD.SUB_CLASS  AND SECTION_NO\=PD.SECTION_NAME AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_PTTY_SECTION WHERE CONTRACT_NO\=TPS.CONTRACT_NO AND DEPT_ID\=TPS.DEPT_ID ))SECTION_NAME from RSK_PREMIUM_DETAILS PD WHERE CONTRACT_NO\=? and TRANSACTION_NO\=?
premium.select.sumOfPaidPremium=SELECT NVL(SUM(PREMIUM_QUOTASHARE_OC),'0') PREMIUM_QUOTASHARE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=?
premium.select.currency=SELECT CM.SHORT_NAME CURRENCY_NAME FROM CURRENCY_MASTER CM WHERE CM.CURRENCY_ID=? AND CM.BRANCH_CODE=? AND CM.STATUS='Y' AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE BRANCH_CODE=CM.BRANCH_CODE AND  COUNTRY_ID=CM.COUNTRY_ID AND STATUS=CM.STATUS AND CURRENCY_ID=CM.CURRENCY_ID)
premium.select.currecy.name=SELECT COUNTRY_SHORT_NAME FROM TMAS_BRANCH_MASTER WHERE  BRANCH_CODE=?
GET_ACCOUNT_PERIOD_COUNT=SELECT COUNT(*) COUNT FROM RSK_PREMIUM_DETAILS WHERE BRANCH_CODE=? AND ACCOUNTING_PERIOD_DATE=ADD_MONTHS(TO_DATE(?,'DD/MM/YYYY'),(SELECT (CASE RSK_ACCOUNTING_PERIOD WHEN  1  THEN -3  WHEN 2 THEN -6 WHEN 3  THEN 12  ELSE 0  END) FROM TTRN_RISK_DETAILS TR WHERE RSK_CONTRACT_NO=? AND RSK_DEPTID=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=TR.RSK_CONTRACT_NO AND RSK_DEPTID=TR.RSK_DEPTID))) AND CONTRACT_NO=? AND  SUB_CLASS=? and ACCOUNT_PERIOD_QTR!='5'
GET_ACCOUNT_PERIOD_COUNT1=SELECT (CASE WHEN TO_DATE(?,'DD/MM/YYYY')=END_DT THEN 1 ELSE 0 END) ACCOUNT_PERIOD_COUNT1 FROM (SELECT ADD_MONTHS(TRUNC(INCP_DATE,'YY'), RSK_ACCOUNTING_PERIOD  * (LEVEL ))-1  END_DT,B.INCP_DATE FROM (SELECT  DECODE(RSK_ACCOUNTING_PERIOD,1,3,2,6,3,12,RSK_ACCOUNTING_PERIOD) RSK_ACCOUNTING_PERIOD,trunc(RSK_INCEPTION_DATE) INCP_DATE FROM TTRN_RISK_DETAILS TR WHERE RSK_CONTRACT_NO=? AND RSK_DEPTID=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=TR.RSK_CONTRACT_NO AND RSK_DEPTID=TR.RSK_DEPTID))B  CONNECT BY     LEVEL<=1+ FLOOR(MONTHS_BETWEEN(add_months(TRUNC(INCP_DATE,'YY'),12),TRUNC(INCP_DATE,'YY'))/ RSK_ACCOUNTING_PERIOD) ) WHERE END_DT>=INCP_DATE AND ROWNUM=1
common.select.getPersonalInfoList=SELECT DISTINCT P.CUSTOMER_ID, CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END NAME FROM PERSONAL_INFO P WHERE P.BRANCH_CODE=? AND P.CUSTOMER_TYPE=? AND STATUS=?  AND CUSTOMER_ID NOT IN('64')   AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE=P.BRANCH_CODE AND CUSTOMER_TYPE=P.CUSTOMER_TYPE AND STATUS=P.STATUS AND CUSTOMER_ID=P.CUSTOMER_ID) ORDER BY NAME
GET_ITI_BROKER=UNION ALL SELECT DISTINCT P.CUSTOMER_ID, CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END NAME FROM PERSONAL_INFO P WHERE P.BRANCH_CODE=? AND P.CUSTOMER_TYPE=? AND STATUS=? AND P.CUSTOMER_ID=?  AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE=P.BRANCH_CODE AND CUSTOMER_TYPE=P.CUSTOMER_TYPE AND STATUS=P.STATUS AND CUSTOMER_ID=P.CUSTOMER_ID)
common.select.getPersonalInfoList1=SELECT DISTINCT P.CUSTOMER_ID, CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END NAME FROM PERSONAL_INFO P WHERE P.BRANCH_CODE=? AND P.CUSTOMER_TYPE=? AND STATUS=?  AND CUSTOMER_ID NOT IN('64')   AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE=P.BRANCH_CODE AND CUSTOMER_TYPE=P.CUSTOMER_TYPE AND STATUS=P.STATUS AND CUSTOMER_ID=P.CUSTOMER_ID) UNION ALL SELECT DISTINCT P.CUSTOMER_ID, CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END NAME FROM PERSONAL_INFO P WHERE P.BRANCH_CODE=? AND P.CUSTOMER_TYPE=? AND STATUS=? AND P.CUSTOMER_ID=?  AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE=P.BRANCH_CODE AND CUSTOMER_TYPE=P.CUSTOMER_TYPE AND STATUS=P.STATUS AND CUSTOMER_ID=P.CUSTOMER_ID) ORDER BY NAME
common.select.getBankMasterList=SELECT BANK_ID,BANK_NAME FROM BANK_MASTER WHERE BRANCH_CODE=? AND STATUS=? ORDER BY BANK_NAME
COM_SELECT_PERILS =SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? ORDER BY TYPE
common.select.getConstDet=SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=?
common.select.getConstDet1=SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? order by TYPE
broker.ceding.name =SELECT PI.CUSTOMER_ID,PI.COMPANY_NAME BROKER, PI.ADDRESS1 || ' ' || PI.ADDRESS2 Address FROM TTRN_RISK_DETAILS RK, PERSONAL_INFO PI WHERE RK.RSK_CONTRACT_NO \= ? AND RK.RSK_CEDINGID \= PI.CUSTOMER_ID AND PI.BRANCH_CODE \= ? AND CUSTomer_TYPE\='C' AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT  MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS TP WHERE   RK.RSK_CONTRACT_NO \= TP.RSK_CONTRACT_NO) union all Select  PERSONAL.CUSTOMER_ID,PERSONAL.FIRST_NAME || ' ' || PERSONAL.LAST_NAME BROKER, PERSONAL.ADDRESS1 || ' ' || PERSONAL.ADDRESS2 Address  From PERSONAL_INFO PERSONAL,TTRN_RISK_DETAILS RK Where  RK.RSK_CONTRACT_NO \= ? AND RK.RSK_BROKERID \= PERSONAL.CUSTOMER_ID AND PERSONAL.BRANCH_CODE \= ? AND CUSTOMER_TYPE\='B' AND PERSONAL.CUSTOMER_ID \!\='63' AND PERSONAL.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PERSONAL.CUSTOMER_ID AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS TP WHERE   RK.RSK_CONTRACT_NO \= TP.RSK_CONTRACT_NO)
payment.select.getAlloTransaction =select * from  ((SELECT   SNO,TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TRANSACTION_NO,PRODUCT_NAME,TYPE,PAID_AMOUNT,TAT.CURRENCY_ID,decode(TAT.STATUS,'R','Reverted','Y','Allocated') STATUS,RECEIPT_NO,DECODE (TRANS_TYPE,'PT','PAYMENT','RT','RECEIPT') TRANS_TYPE ,TRANS_TYPE ALLOCATE_TYPE FROM   TTRN_ALLOCATED_TRANSACTION TAT, TTRN_PAYMENT_RECEIPT TPR WHERE       TAT.RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO AND CONTRACT_NO = ? AND TAT.TRANSACTION_NO = ? AND TAT.TYPE = 'P'  AND TAT.STATUS = 'Y' AND tpr.amend_id = (SELECT   MAX (amend_id)  FROM   Ttrn_Payment_Receipt WHERE   PAYMENT_RECEIPT_NO = tpr.PAYMENT_RECEIPT_NO AND branch_code = tpr.branch_code)) union all (SELECT   SNO, TO_CHAR (INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE,TRANSACTION_NO, PRODUCT_NAME,TYPE, PAID_AMOUNT,TAT.CURRENCY_ID,'Adjusted' STATUS,RECEIPT_NO, DECODE(ADJUSTMENT_TYPE,'W','Write Off','R','Round Off') TRANS_TYPE,'' ALLOCATE_TYPE FROM   TTRN_ALLOCATED_TRANSACTION TAT Where  CONTRACT_NO = ? AND TAT.TRANSACTION_NO = ? AND TAT.TYPE = 'P' AND TAT.STATUS = 'Y' and TAT.RECEIPT_NO not in (Select TPR.PAYMENT_RECEIPT_NO from   TTRN_PAYMENT_RECEIPT TPR where TAT.RECEIPT_NO = TPR.PAYMENT_RECEIPT_NO))) ORDER BY SNO DESC
currency.list=select CURRENCY_ID,SHORT_NAME from currency_master where BRANCH_CODE=? and CURRENCY_ID in (SELECT Distinct(REGEXP_SUBSTR(BANK_CURRENCY,'[^,]+',1,LEVEL)) lc_login FROM (SELECT DISTINCT BANK_CURRENCY FROM bank_master WHERE BRANCH_CODE=? AND STATUS='Y') B CONNECT BY LEVEL <= LENGTH(BANK_CURRENCY) - LENGTH(REPLACE(BANK_CURRENCY,',',''))+1 and BANK_CURRENCY is not null)
GET_CASH_LOSS_CREADIT = SELECT   ROWNUM sno, TCP.CONTRACT_NO, TCP.CLAIM_NO, CLAIM_PAYMENT_NO, TO_CHAR (TCP.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, NVL (PAID_AMOUNT_OC, 0) - NVL (CASH_LOSS_SETTLED_TILLDATE, 0)PAID_AMOUNT_OC,CURRENCY CURRENCY_ID  FROM   TTRN_CLAIM_PAYMENT TCP,TTRN_Claim_Details TCD WHERE   NVL (PAID_AMOUNT_OC, 0) - NVL (CASH_LOSS_SETTLED_TILLDATE, 0) > 0 AND TCP.CONTRACT_NO = ? and SUB_CLASS=?  and TCD.CONTRACT_NO = TCP.CONTRACT_NO AND TCD.CLAIM_NO = TCP.CLAIM_NO AND CLAIM_PAYMENT_NO=?
GET_EXCESS_RATE_PERCENT=SELECT PERCENT FROM  CONSTANT_DETAIL WHERE CATEGORY_ID='50' AND CATEGORY_DETAIL_ID='1'

GET_ALLOCATED_TRANS_LIST=SELECT DISTINCT CREDITTRXNNO,CONTRACT_NO FROM TTRN_CASH_LOSS_CREDIT WHERE PROPOSAL_NO=? AND STATUS='A'
GET_ALLOCATED_CASH_LOSS=SELECT CREDITTRXNNO,CONTRACT_NO,CLAIM_NO,CLAIMPAYMENT_NO,TO_CHAR(CREDITDATE,'DD/MM/YYYY'),CLDCURRENCY_ID,CLD_AMOUNT,CLCCURRENCY_ID,CREDITAMOUNTCLC,CREDITAMOUNTCLD,EXCHANGE_RATE FROM TTRN_CASH_LOSS_CREDIT WHERE PROPOSAL_NO=? AND STATUS='A'
GET_DISABLE_STATUS=SELECT   CASE WHEN (SELECT   COUNT ( * ) FROM   TTRN_ALLOCATED_TRANSACTION WHERE   CONTRACT_NO = ? AND NVL (layer_no, '0') = NVL (?, '0') and STATUS='Y') > 0 THEN 'Y'  ELSE 'N' END Status  FROM   DUAL
GET_DISABLE_STATUS1=select case when (select count(*) from ttrn_claim_details where contract_no=? and nvl(layer_no,'0')=nvl(?,'0')) > 0 then 'Y'  when (select count(*) from RSK_PREMIUM_DETAILS where contract_no=? and nvl(layer_no,'0')= nvl(?,'0'))>0 then 'Y'   else 'N' end Status from dual
POS_MAS_ED_MODE_SELECT = SELECT NVL(EDIT_MODE,'N') EDIT_MODE FROM POSITION_MASTER P WHERE PROPOSAL_NO = ?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO = P.PROPOSAL_NO )

claim.select.paymentReqNo=SELECT COUNT(*) COUNT FROM TTRN_CLAIM_PAYMENT WHERE CLAIM_NO=? AND PAYMENT_REQUEST_NO=?
claim.select.maxResvId=SELECT NVL(MAX(SL_NO),'1') MAXID FROM TTRN_CLAIM_UPDATION WHERE  CLAIM_NO=? AND CONTRACT_NO=?
claim.insert.payment=INSERT INTO TTRN_CLAIM_PAYMENT (SL_NO,LAYER_NO,PAYMENT_REQUEST_NO,PAID_AMOUNT_OC,PAID_AMOUNT_DC,LOSS_ESTIMATE_REVISED_OC,LOSS_ESTIMATE_REVISED_DC,CLAIM_NOTE_RECOMM,PAYMENT_REFERENCE,ADVICE_TREASURY,INCEPTION_DATE,CLAIM_NO,CONTRACT_NO,STATUS,CLAIM_PAYMENT_NO,REMARKS,ADVICE_TREASURY_EMAILID,RESERVE_ID,SETTLEMENT_STATUS,REINSTATEMENT_TYPE,REINSPREMIUM_OURSHARE_OC,REINSPREMIUM_OURSHARE_DC,PAID_CLAIM_OS_OC,PAID_CLAIM_OS_DC,SAF_OS_OC,SAF_OS_DC,OTH_FEE_OS_OC,OTH_FEE_OS_DC,BRANCH_CODE,LOGIN_ID,EXCHANGE_RATE,SYS_DATE,PAYMENT_TYPE) VALUES(?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,'Y',?,?,?,?,'Pending',?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?)
CLAIN_ARCH_INSERT = INSERT INTO TTRN_CLAIM_PAYMENT_ARCHIVE (SL_NO, CLAIM_NO, CONTRACT_NO, LAYER_NO, PAYMENT_REQUEST_NO, PAID_AMOUNT_OC, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_OC, LOSS_ESTIMATE_REVISED_DC, CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, INCEPTION_DATE, EXPIRY_DATE, REMARKS, STATUS, CLAIM_PAYMENT_NO, ADVICE_TREASURY_EMAILID, ALLOCATED_TILL_DATE, ACC_CLAIM, CHECKYN, RESERVE_ID, SETTLEMENT_STATUS, REINSTATEMENT_TYPE, REINSPREMIUM_OURSHARE_OC, REINSPREMIUM_OURSHARE_DC, NETCLAIMAMT_OURSHARE_OC, NETCLAIMAMT_OURSHARE_DC, EXCHANGE_RATE, INSURED_NAME, CASH_LOSS_SETTLED_TILLDATE, BRANCH_CODE, LOGIN_ID, PAID_CLAIM_OS_OC, PAID_CLAIM_OS_DC, SAF_OS_OC, SAF_OS_DC, OTH_FEE_OS_OC, OTH_FEE_OS_DC, SYS_DATE,AMEND_ID)SELECT SL_NO, CLAIM_NO, CONTRACT_NO, LAYER_NO, PAYMENT_REQUEST_NO, PAID_AMOUNT_OC, PAID_AMOUNT_DC, LOSS_ESTIMATE_REVISED_OC, LOSS_ESTIMATE_REVISED_DC, CLAIM_NOTE_RECOMM, PAYMENT_REFERENCE, ADVICE_TREASURY, INCEPTION_DATE, EXPIRY_DATE, REMARKS, STATUS, CLAIM_PAYMENT_NO, ADVICE_TREASURY_EMAILID, ALLOCATED_TILL_DATE, ACC_CLAIM, CHECKYN, RESERVE_ID, SETTLEMENT_STATUS, REINSTATEMENT_TYPE, REINSPREMIUM_OURSHARE_OC, REINSPREMIUM_OURSHARE_DC, NETCLAIMAMT_OURSHARE_OC, NETCLAIMAMT_OURSHARE_DC, EXCHANGE_RATE, INSURED_NAME, CASH_LOSS_SETTLED_TILLDATE, BRANCH_CODE, LOGIN_ID, PAID_CLAIM_OS_OC, PAID_CLAIM_OS_DC, SAF_OS_OC, SAF_OS_DC, OTH_FEE_OS_OC, OTH_FEE_OS_DC, sysdate,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM TTRN_CLAIM_PAYMENT_ARCHIVE WHERE CONTRACT_NO=? AND CLAIM_NO=? AND LAYER_NO=? and CLAIM_PAYMENT_NO=?)  FROM TTRN_CLAIM_PAYMENT WHERE CONTRACT_NO=? AND CLAIM_NO=? AND LAYER_NO=? and CLAIM_PAYMENT_NO=?
CLAIM_UPDATE_PAYMENT = UPDATE TTRN_CLAIM_PAYMENT SET  INCEPTION_DATE=TO_DATE(?,'DD/MM/YYYY'),PAYMENT_REFERENCE=?,PAYMENT_REQUEST_NO=?,PAID_CLAIM_OS_OC=?,PAID_CLAIM_OS_DC=?,SAF_OS_OC=?,SAF_OS_DC=?,OTH_FEE_OS_OC=?,OTH_FEE_OS_DC=?,BRANCH_CODE=?,LOGIN_ID=?,SYS_DATE=SYSDATE,PAID_AMOUNT_OC=?,PAID_AMOUNT_DC=?,REMARKS=?,REINSTATEMENT_TYPE=?,REINSPREMIUM_OURSHARE_OC=?,REINSPREMIUM_OURSHARE_DC=?,PAYMENT_TYPE=? WHERE CONTRACT_NO=? AND CLAIM_NO=? AND LAYER_NO=? and CLAIM_PAYMENT_NO=?
claim.update.totalAmtPaidTillDate=UPDATE TTRN_CLAIM_DETAILS SET TOTAL_AMT_PAID_TILL_DATE=? where CLAIM_NO=? and CONTRACT_NO=?
premium.sp.retroSplit={CALL RetroPremium_Split_claim(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?)}
claim.insert.getUpdationQuery=INSERT INTO TTRN_CLAIM_UPDATION (SL_NO,LAYER_NO,LOSS_ESTIMATE_REVISED_OC,LOSS_ESTIMATE_REVISED_DC,UPDATE_REFERENCE,INCEPTION_DATE,CLAIM_NO,CONTRACT_NO,STATUS,REMARKS,BRANCH_CODE, LOGIN_ID, SAF_100_OC, SAF_100_DC, OTH_FEE_100_OC, OTH_FEE_100_DC, C_IBNR_100_OC, C_IBNR_100_DC, SAF_OS_OC,OTH_FEE_OS_OC,C_IBNR_OS_OC,SAF_OS_DC, OTH_FEE_OS_DC, C_IBNR_OS_DC, LOSS_ESTIMATE_100_OC, LOSS_ESTIMATE_100_DC,RESERVE_FEES,RESERVE_IBNR,EXCHANGE_RATE,TOT_RES_AMOUNT_OC ,TOT_RES_AMOUNT_DC,RES_POS_DATE,SYS_DATE) VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,'Y',? ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),sysdate)
claim.update.closeClaim=UPDATE TTRN_CLAIM_DETAILS SET STATUS_OF_CLAIM=?,CLAIM_CLOSED_DATE=TO_DATE(?,'DD/MM/YYYY') WHERE CONTRACT_NO=? AND CLAIM_NO=?
CLAIM_LOSS_ESTIMATE_PAID_DIFFERENCE_EDIT = SELECT NVL(loss_Estimate_Revised_OC,0) -TP.PAID_CLAIM_OS_OC LOSS_ESTIMATE_DIFF  FROM   TTRN_CLAIM_UPDATION tc,(SELECT nvl(SUM(NVL(PAID_CLAIM_OS_OC,0)),0) PAID_CLAIM_OS_OC from ttrn_claim_payment Tcp  WHERE CONTRACT_NO=? AND CLAIM_NO=?  AND CLAIM_PAYMENT_NO!= ? and  reserve_id =(SELECT   MAX (sl_no)  FROM   TTRN_CLAIM_UPDATION WHERE   CONTRACT_NO = ? AND CLAIM_NO = ?))TP  WHERE TC.CONTRACT_NO=?  AND TC.CLAIM_NO=? AND tc.SL_NO=(select max(sl_no)  from TTRN_CLAIM_UPDATION where CONTRACT_NO=tc.CONTRACT_NO AND CLAIM_NO=tc.CLAIM_NO )
claim.loss.estimate.paid.difference = SELECT NVL(loss_Estimate_Revised_OC,0) -TP.PAID_CLAIM_OS_OC LOSS_ESTIMATE_DIFF  FROM   TTRN_CLAIM_UPDATION tc,(SELECT nvl(SUM(NVL(PAID_CLAIM_OS_OC,0)),0) PAID_CLAIM_OS_OC from ttrn_claim_payment Tcp  WHERE CONTRACT_NO=? AND CLAIM_NO=?  and  reserve_id =(SELECT   MAX (sl_no)  FROM   TTRN_CLAIM_UPDATION WHERE   CONTRACT_NO = ? AND CLAIM_NO = ?))TP  WHERE TC.CONTRACT_NO=?  AND TC.CLAIM_NO=? AND tc.SL_NO=(select max(sl_no)  from TTRN_CLAIM_UPDATION where CONTRACT_NO=tc.CONTRACT_NO AND CLAIM_NO=tc.CLAIM_NO )
CLAIM_SAF_OS_SUM_DIFFERENCE_EDIT =SELECT NVL(tc.SAF_OS_OC,0) -TP.SAF_OS_OC SAF_OS_DIFF  FROM   TTRN_CLAIM_UPDATION tc,(SELECT  nvl(SUM(NVL(SAF_OS_OC,0)),0) SAF_OS_OC from ttrn_claim_payment Tcp WHERE CONTRACT_NO=? AND CLAIM_NO=? AND CLAIM_PAYMENT_NO!=? and  reserve_id =(SELECT   MAX (sl_no)  FROM   TTRN_CLAIM_UPDATION WHERE   CONTRACT_NO = ? AND CLAIM_NO = ?))TP  WHERE TC.CONTRACT_NO=?  AND TC.CLAIM_NO=? AND tc.SL_NO=(select max(sl_no)  from TTRN_CLAIM_UPDATION where  CONTRACT_NO=tc.CONTRACT_NO AND CLAIM_NO=TC.CLAIM_NO )
claim.saf.os.sum.difference = SELECT NVL(tc.SAF_OS_OC,0) -TP.SAF_OS_OC SAF_OS_DIFF  FROM   TTRN_CLAIM_UPDATION tc,(SELECT  nvl(SUM(NVL(SAF_OS_OC,0)),0) SAF_OS_OC from ttrn_claim_payment Tcp WHERE CONTRACT_NO=? AND CLAIM_NO=?  and  reserve_id =(SELECT   MAX (sl_no)  FROM   TTRN_CLAIM_UPDATION WHERE   CONTRACT_NO = ? AND CLAIM_NO = ?))TP  WHERE TC.CONTRACT_NO=?  AND TC.CLAIM_NO=? AND tc.SL_NO=(select max(sl_no)  from TTRN_CLAIM_UPDATION where  CONTRACT_NO=tc.CONTRACT_NO AND CLAIM_NO=TC.CLAIM_NO )
CLAIM_OTHER_FEE_OS_SUM_EDIT =  SELECT NVL(tc.OTH_FEE_OS_OC,0) -TP.OTH_FEE_OS_OC OTH_FEE_DIFF  FROM   TTRN_CLAIM_UPDATION tc,(SELECT nvl(SUM(NVL(OTH_FEE_OS_OC,0)),0) OTH_FEE_OS_OC from ttrn_claim_payment Tcp WHERE CONTRACT_NO=? AND CLAIM_NO=? AND CLAIM_PAYMENT_NO!=? and  reserve_id =(SELECT   MAX (sl_no)  FROM   TTRN_CLAIM_UPDATION WHERE   CONTRACT_NO = ? AND CLAIM_NO = ?))TP  WHERE TC.CONTRACT_NO=?  AND TC.CLAIM_NO=? AND tc.SL_NO=(select max(sl_no)  from TTRN_CLAIM_UPDATION where CONTRACT_NO=tc.CONTRACT_NO AND CLAIM_NO=TC.CLAIM_NO )
claim.other.fee.os.sum.difference = SELECT NVL(tc.OTH_FEE_OS_OC,0) -TP.OTH_FEE_OS_OC OTH_FEE_DIFF  FROM   TTRN_CLAIM_UPDATION tc,(SELECT nvl(SUM(NVL(OTH_FEE_OS_OC,0)),0) OTH_FEE_OS_OC from ttrn_claim_payment Tcp WHERE CONTRACT_NO=? AND CLAIM_NO=?  and  reserve_id =(SELECT   MAX (sl_no)  FROM   TTRN_CLAIM_UPDATION WHERE   CONTRACT_NO = ? AND CLAIM_NO = ?))TP  WHERE TC.CONTRACT_NO=?  AND TC.CLAIM_NO=? AND tc.SL_NO=(select max(sl_no)  from TTRN_CLAIM_UPDATION where CONTRACT_NO=tc.CONTRACT_NO AND CLAIM_NO=TC.CLAIM_NO )
claim.select.getInsDate=SELECT TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY') INS_DATE FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=? AND SL_NO=(SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION WHERE CLAIM_NO=?)
claim.select.getLastPayDt=SELECT   TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS PAY_DT FROM   TTRN_CLAIM_PAYMENT CP WHERE   CP.CLAIM_NO = ? AND CP.CONTRACT_NO = ? AND CP.CLAIM_PAYMENT_NO=(SELECT MAX(CLAIM_PAYMENT_NO) FROM TTRN_CLAIM_PAYMENT WHERE CLAIM_NO = CP.CLAIM_NO AND CONTRACT_NO=CP.CONTRACT_NO)
GET_BASE_PROPOSAL_NO =select nvl((SELECT DISTINCT nvl(PROPOSAL_NO,0) FROM POSITION_MASTER P WHERE BASE_LAYER IS NULL AND CONTRACT_NO \= (SELECT distinct OLD_CONTRACTNO FROM POSITION_MASTER R WHERE PROPOSAL_NO\=? AND  AMEND_ID \=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER F WHERE F.PROPOSAL_NO\= R.PROPOSAL_NO ))  AND AMEND_ID \=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO \= P.PROPOSAL_NO )),0) PROPOSAL_NO from dual
UPDATE_SUB_ENDT_STATUS = UPDATE POSITION_MASTER P SET EDIT_MODE\=? WHERE PROPOSAL_NO IN(SELECT PROPOSAL_NO FROM POSITION_MASTER R WHERE BASE_LAYER\=? AND  AMEND_ID \=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER F WHERE F.PROPOSAL_NO\= R.PROPOSAL_NO and CONTRACT_STATUS \!\='C' ))  AND AMEND_ID \=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO \= P.PROPOSAL_NO )
POS_MAS_ED_MODE_UPDT = UPDATE POSITION_MASTER P SET EDIT_MODE\=? WHERE PROPOSAL_NO \= ?  AND AMEND_ID \=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO \= P.PROPOSAL_NO )

risk.select.getRskProNO=SELECT NVL(RSK_PROPOSAL_NUMBER,'') FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER = ?
GET_MAX_AMEND_RISK_PROPOSAL=SELECT NVL(MAX(RSK_ENDORSEMENT_NO),'0')RSK_ENDORSEMENT_NO FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?
risk.select.getMaxEndorseNo=SELECT NVL(MAX(RSK_ENDORSEMENT_NO),'0')RSK_ENDORSEMENT_NO FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?
risk.insert.isAmendIDProTreaty=INSERT INTO TTRN_RISK_DETAILS(RSK_PROPOSAL_NUMBER, RSK_ENDORSEMENT_NO, RSK_LAYER_NO, RSK_PRODUCTID,RSK_DEPTID, RSK_PFCID, RSK_SPFCID, RSK_POLBRANCH, RSK_CEDINGID,RSK_BROKERID, RSK_TREATYID, RSK_MONTH, RSK_UWYEAR, RSK_UNDERWRITTER,RSK_INCEPTION_DATE, RSK_EXPIRY_DATE, RSK_ACCOUNT_DATE, RSK_ORIGINAL_CURR, RSK_EXCHANGE_RATE,RSK_BASIS, RSK_PERIOD_OF_NOTICE, RSK_RISK_COVERED, RSK_TERRITORY_SCOPE, RSK_TERRITORY,RSK_ENTRY_DATE, RSK_END_DATE, RSK_STATUS,RSK_REMARKS,RSK_CONTRACT_NO,RSK_PROPOSAL_TYPE,RSK_ACCOUNTING_PERIOD,RSK_RECEIPT_STATEMENT,RSK_RECEIPT_PAYEMENT,MND_INSTALLMENTS,RETRO_CESSIONARIES,RSK_RETRO_TYPE,RSK_INSURED_NAME,OLD_CONTRACTNO,INWARD_BUS_TYPE,TREATYTYPE,RSK_BUSINESS_TYPE,RSK_EXCHANGE_TYPE,RSK_PERILS_COVERED,RSK_LOC_ISSUED,RSK_UMBRELLA_XL,LOGIN_ID,BRANCH_CODE,SYS_DATE,COUNTRIES_INCLUDE,COUNTRIES_EXCLUDE,RSK_NO_OF_LINE,RS_ENDORSEMENT_TYPE,RSK_RUN_OFF_YEAR,RSK_LOC_BNK_NAME,RSK_LOC_CRDT_PRD,RSK_LOC_CRDT_AMT,RSK_LOC_BENFCRE_NAME,RSK_CESSION_EXG_RATE,RSK_FIXED_RATE,RETENTIONYN,RSK_ACCOUNT_PERIOD_NOTICE,RSK_STATEMENT_CONFIRM) VALUES (?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD-MM-YYYY'),?,?,TO_DATE(?,'DD-MM-YYYY'),TO_DATE(?,'DD-MM-YYYY'),TO_DATE(?,'DD-MM-YYYY'),?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
risk.update.rskDtls=UPDATE TTRN_RISK_DETAILS SET RSK_DEPTID\=?, RSK_PFCID\=?, RSK_SPFCID\=?, RSK_POLBRANCH\=?, RSK_CEDINGID\=?, RSK_BROKERID\=?, RSK_TREATYID\=?, RSK_MONTH\=TO_DATE(?,'DD/MM/YYYY'), RSK_UWYEAR\=?, RSK_UNDERWRITTER\=?, RSK_INCEPTION_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_EXPIRY_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_ACCOUNT_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_ORIGINAL_CURR\=?, RSK_EXCHANGE_RATE\=?, RSK_BASIS\=?, RSK_PERIOD_OF_NOTICE\=?, RSK_RISK_COVERED\=?, RSK_TERRITORY_SCOPE\=?, RSK_TERRITORY\=?, RSK_STATUS\=?,RSK_PROPOSAL_TYPE\=?,RSK_ACCOUNTING_PERIOD\=? ,RSK_RECEIPT_STATEMENT\=? , RSK_RECEIPT_PAYEMENT\=?,MND_INSTALLMENTS\=?,RETRO_CESSIONARIES\=?,RSK_RETRO_TYPE\=?,RSK_INSURED_NAME\=?,INWARD_BUS_TYPE\=?,TREATYTYPE\=?,RSK_BUSINESS_TYPE\=?,RSK_EXCHANGE_TYPE\=?,RSK_PERILS_COVERED\=?,RSK_LOC_ISSUED\=?,RSK_UMBRELLA_XL\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=sysdate,COUNTRIES_INCLUDE\=?,COUNTRIES_EXCLUDE\=?,RSK_NO_OF_LINE\=?,RS_ENDORSEMENT_TYPE\=?,RSK_RUN_OFF_YEAR\=?,RSK_LOC_BNK_NAME\=?,RSK_LOC_CRDT_PRD\=?,RSK_LOC_CRDT_AMT\=?,RSK_LOC_BENFCRE_NAME\=?,RSK_CESSION_EXG_RATE\=?,RSK_FIXED_RATE\=?,RETENTIONYN\=?,RSK_ACCOUNT_PERIOD_NOTICE=?,RSK_STATEMENT_CONFIRM=? WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=?

risk.select.maxEndom=SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?
risk.update.pro24FirPageRskPro=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OC=?,RSK_LIMIT_DC=?,RSK_EPI_OFFER_OC=?,RSK_EPI_OFFER_DC=?,RSK_EPI_ESTIMATE=?, RSK_EPI_EST_OC=?,RSK_EPI_EST_DC=?,RSK_XLCOST_OC=?,RSK_XLCOST_DC=?,RSK_CEDANT_RETENTION=?,RSK_SHARE_WRITTEN=?,RSK_SHARE_SIGNED=?,RSK_CEDRET_TYPE=?,RSK_SP_RETRO=?,RSK_NO_OF_INSURERS=?,RSK_MAX_LMT_COVER=?,RSK_LIMIT_OS_OC=?,RSK_LIMIT_OS_DC=?,RSK_EPI_OSOF_OC=?,RSK_EPI_OSOF_DC=?,RSK_EPI_OSOE_OC=?,RSK_EPI_OSOE_DC=?,RSK_XLCOST_OS_OC=?,RSK_XLCOST_OS_DC=?,LIMIT_PER_VESSEL_OC=?,LIMIT_PER_VESSEL_DC=?,LIMIT_PER_LOCATION_OC=?,LIMIT_PER_LOCATION_DC=?,RSK_TREATY_SURP_LIMIT_OC=?,RSK_TREATY_SURP_LIMIT_DC=?,RSK_TREATY_SURP_LIMIT_OS_OC=?,RSK_TREATY_SURP_LIMIT_OS_DC=?,RSK_TRTY_LMT_PML_OC=?,RSK_TRTY_LMT_PML_DC=?,RSK_TRTY_LMT_PML_OS_OC=?,RSK_TRTY_LMT_PML_OS_DC=?,RSK_TRTY_LMT_SUR_PML_OC=?,RSK_TRTY_LMT_SUR_PML_DC=?,RSK_TRTY_LMT_SUR_PML_OS_OC=?,RSK_TRTY_LMT_SUR_PML_OS_DC=?,RSK_TRTY_LMT_OURASS_PML_OC=?,RSK_TRTY_LMT_OURASS_PML_DC=?,RSK_TRTY_LMT_OURASS_PML_OS_OC=?,RSK_TRTY_LMTOUR_ASS_PML_OS_DC=?,SUB_CLASS=?,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE, RSK_PML=?, RSK_PML_PERCENT=? WHERE RSK_PROPOSAL_NUMBER =? AND RSK_ENDORSEMENT_NO=?
UPDATE_RISK_PROPOSAL_DETAILS=UPDATE TTRN_RISK_PROPOSAL SET RSK_EVENT_LIMIT_OC=?,RSK_EVENT_LIMIT_DC=?,RSK_EVENT_LIMIT_OS_OC=?,RSK_EVENT_LIMIT_OS_DC=?,RSK_COVER_LIMIT_UXL_OC=?,RSK_COVER_LIMIT_UXL_DC=?,RSK_COVER_LIMIT_UXL_OS_OC=?,RSK_COVER_LIMIT_UXL_OS_DC=?,RSK_DEDUCTABLE_UXL_OC=?,RSK_DEDUCTABLE_UXL_DC=?,RSK_DEDUCTABLE_UXL_OS_OC=?,RSK_DEDUCTABLE_UXL_OS_DC=?,RSK_PML=?,RSK_PML_PERCENT=?,RSK_EGNPI_PML_OC=?,RSK_EGNPI_PML_DC=?,RSK_EGNPI_PML_OS_OC=?,RSK_EGNPI_PML_OS_DC=?,RSK_PREMIUM_BASIS=?,RSK_MINIMUM_RATE=?,RSK_MAXIIMUM_RATE=?,RSK_BURNING_COST_LF=?,RSK_MINIMUM_PREMIUM_OC=?,RSK_MINIMUM_PREMIUM_DC=?,RSK_MINIMUM_PREMIUM_OS_OC=?,RSK_MINIMUM_PREMIUM_OS_DC=?,RSK_PAYMENT_DUE_DAYS=?,RSK_TRTY_LMT_PML_OC=?,RSK_TRTY_LMT_PML_DC=?,RSK_TRTY_LMT_PML_OS_OC=?,RSK_TRTY_LMT_PML_OS_DC=?,RSK_TRTY_LMT_SUR_PML_OC=?,RSK_TRTY_LMT_SUR_PML_DC=?,RSK_TRTY_LMT_SUR_PML_OS_OC=?,RSK_TRTY_LMT_SUR_PML_OS_DC=?,RSK_TRTY_LMT_OURASS_PML_OC=?,RSK_TRTY_LMT_OURASS_PML_DC=?,RSK_TRTY_LMT_OURASS_PML_OS_OC=?,RSK_TRTY_LMTOUR_ASS_PML_OS_DC=?,RISK_DET_YN=?,BROKER_DET_YN=?,COVER_DET_YN=?,PREMIUM_DET_YN=?,ACQCOST_DET_YN=?,COMM_DET_YN=?,DEPOSIT_DET_YN=?,LOSS_DET_YN=?,DOC_DET_YN=?,PAYMENT_PARTNER=?,INTALL_DET_YN=?,REINST_DET_YN=?,RATE_ON_LINE=?,QUOTESHARE_PERCENT=? WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=?
risk.update.positionMaster=UPDATE POSITION_MASTER SET LAYER_NO=?,REINSURANCE_ID=?,PRODUCT_ID=?,DEPT_ID=?,CEDING_COMPANY_ID=?,UW_YEAR=?,UW_MONTH=TO_DATE(?,'DD/MM/YYYY'),ACCOUNT_DATE=TO_DATE(?,'DD/MM/YYYY'),INCEPTION_DATE=TO_DATE(?,'DD/MM/YYYY'),EXPIRY_DATE=TO_DATE(?,'DD/MM/YYYY'),PROPOSAL_STATUS=?,ENTRY_DATE=SYSDATE,CONTRACT_STATUS=?,BROKER_ID=?,RETRO_TYPE=?,UPDATE_LOGIN_ID=?,RSK_DUMMY_CONTRACT=?,DATA_MAP_CONT_NO=?,Bouquet_Mode_YN=?,Bouquet_No=?,UW_YEAR_TO=?,SECTION_NO=? WHERE PROPOSAL_NO=? AND AMEND_ID=?
risk.insert.pro24RskProposal=INSERT INTO TTRN_RISK_PROPOSAL(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_LAYER_NO,RSK_LIMIT_OC,RSK_LIMIT_DC,RSK_EPI_OFFER_OC,RSK_EPI_OFFER_DC,RSK_EPI_ESTIMATE,RSK_EPI_EST_OC,RSK_EPI_EST_DC,RSK_XLCOST_OC,RSK_XLCOST_DC,RSK_CEDANT_RETENTION,RSK_SHARE_WRITTEN,RSK_SHARE_SIGNED,RSK_CEDRET_TYPE,RSK_SP_RETRO,RSK_NO_OF_INSURERS,RSK_MAX_LMT_COVER,RSK_LIMIT_OS_OC,RSK_LIMIT_OS_DC,RSK_EPI_OSOF_OC,RSK_EPI_OSOF_DC,RSK_EPI_OSOE_OC,RSK_EPI_OSOE_DC,RSK_XLCOST_OS_OC,RSK_XLCOST_OS_DC,LIMIT_PER_VESSEL_OC,LIMIT_PER_VESSEL_DC,LIMIT_PER_LOCATION_OC,LIMIT_PER_LOCATION_DC,RSK_TREATY_SURP_LIMIT_OC,RSK_TREATY_SURP_LIMIT_DC,RSK_TREATY_SURP_LIMIT_OS_OC,RSK_TREATY_SURP_LIMIT_OS_DC,SUB_CLASS,LOGIN_ID,BRANCH_CODE,SYS_DATE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
risk.select.getRenewalStatus=SELECT NVL(PM.RENEWAL_STATUS,'0') RENEWAL_STATUS FROM POSITION_MASTER PM WHERE PM.PROPOSAL_NO=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.insert.positionMaster=INSERT INTO POSITION_MASTER(PROPOSAL_NO,CONTRACT_NO,AMEND_ID,LAYER_NO,REINSURANCE_ID,PRODUCT_ID,DEPT_ID,CEDING_COMPANY_ID,UW_YEAR,UW_MONTH,ACCOUNT_DATE,INCEPTION_DATE,EXPIRY_DATE,PROPOSAL_STATUS,ENTRY_DATE,CONTRACT_STATUS,LOGIN_ID,BASE_LAYER,OLD_CONTRACTNO,RENEWAL_STATUS,BROKER_ID,BRANCH_CODE,RETRO_TYPE,UPDATE_LOGIN_ID,ENDT_STATUS,RSK_DUMMY_CONTRACT,DATA_MAP_CONT_NO,Bouquet_Mode_YN,Bouquet_No,UW_YEAR_TO,SECTION_NO,OFFER_NO) VALUES(?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
DELETE_REMARKS_DETAILS=DELETE TTRN_RISK_REMARKS TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RISK_REMARKS WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO)
INSERT_REMARKS_DETAILS=INSERT INTO TTRN_RISK_REMARKS (PROPOSAL_NO,CONTRACT_NO,LAYER_NO,DEPT_ID,PRODUCT_ID,AMEND_ID,RSK_SNO,RSK_DESCRIPTION,RSK_REMARK1,RSK_REMARK2,LOGIN_ID,BRANCH_CODE,SYS_DATE)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
GET_AMEND_REMARKS=SELECT NVL(MAX(AMEND_ID)+1,0)AMEND_ID FROM TTRN_RISK_REMARKS WHERE PROPOSAL_NO=?
DELETE_RET_DETAILS=DELETE TTRN_CEDENT_RET TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RISK_REMARKS WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO)
GET_AMEND_RETENT=SELECT NVL(MAX(AMEND_ID)+1,0) FROM TTRN_CEDENT_RET WHERE PROPOSAL_NO=?
GET_BASE_PROPOSAL =SELECT BASE_LAYER FROM POSITION_MASTER P  WHERE PROPOSAL_NO \=?  AND AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE   PROPOSAL_NO \= P.PROPOSAL_NO)
GET_SHORT_NAME= SELECT (SELECT SHORT_NAME FROM Currency_Master CM WHERE CM.CURRENCY_ID= TBM.BASE_CURRENCY_ID AND CM.BRANCH_CODE = TBM.BRANCH_CODE and cm.amend_id=(select max(NVL(amend_id,0))  from currency_master where currency_id=cm.currency_id and BRANCH_CODE = cm.BRANCH_CODE)) COUNTRY_SHORT_NAME FROM TMAS_BRANCH_MASTER TBM WHERE  TBM.BRANCH_CODE=? AND TBM.STATUS='Y'
RISK_SELECT_GETRSKCONTRACTNO = SELECT MAX(RSK_ENDORSEMENT_NO) RSK_ENDORSEMENT_NO FROM TTRN_RISK_DETAILS   WHERE RSK_PROPOSAL_NUMBER=?
risk.select.getEditModeData= SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID , DE.RSK_POLBRANCH, DE.RSK_CEDINGID, DE.RSK_BROKERID, DE.RSK_TREATYID, TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_PERIOD_OF_NOTICE, DE. RSK_RISK_COVERED, DE. RSK_TERRITORY_SCOPE, DE.RSK_TERRITORY,DE.RSK_ENTRY_DATE, DE. RSK_END_DATE, DE. RSK_STATUS, DE.RSK_REMARKS,PR.RSK_LIMIT_OC,PR.RSK_EPI_OFFER_OC,PR.RSK_EPI_ESTIMATE,PR.RSK_EPI_EST_OC,PR.RSK_XLCOST_OC,PR.RSK_CEDANT_RETENTION,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.RSK_RECEIPT_STATEMENT,DE.RSK_RECEIPT_PAYEMENT,DE.RETRO_CESSIONARIES,PR.RSK_CEDRET_TYPE,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,PR.RSK_MAX_LMT_COVER,DE.RSK_RETRO_TYPE,DE.RSK_INSURED_NAME,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,DE.INWARD_BUS_TYPE,DE.TREATYTYPE,PR.RSK_TREATY_SURP_LIMIT_OC,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,PR.RSK_TREATY_SURP_LIMIT_DC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RSK_NO_OF_LINE,PR.RSK_PML,PR.RSK_PML_PERCENT,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED, DE.RS_ENDORSEMENT_TYPE,DE.RSK_RUN_OFF_YEAR,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.BASE_LAYER,DE.RSK_CESSION_EXG_RATE,DE.RSK_FIXED_RATE,PM.RSK_DUMMY_CONTRACT,DE.RETENTIONYN,PM.DATA_MAP_CONT_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM
risk.select.getEditModeContCond=WHERE DE.RSK_CONTRACT_NO=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(B.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL B, TTRN_RISK_DETAILS A WHERE A.RSK_CONTRACT_NO=? AND A.RSK_PROPOSAL_NUMBER=B.RSK_PROPOSAL_NUMBER ) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeProCond=WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeData1= SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID , DE.RSK_POLBRANCH, DE.RSK_CEDINGID, DE.RSK_BROKERID, DE.RSK_TREATYID, TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_PERIOD_OF_NOTICE, DE. RSK_RISK_COVERED, DE. RSK_TERRITORY_SCOPE, DE.RSK_TERRITORY,DE.RSK_ENTRY_DATE, DE. RSK_END_DATE, DE. RSK_STATUS, DE.RSK_REMARKS,PR.RSK_LIMIT_OC,PR.RSK_EPI_OFFER_OC,PR.RSK_EPI_ESTIMATE,PR.RSK_EPI_EST_OC,PR.RSK_XLCOST_OC,PR.RSK_CEDANT_RETENTION,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.RSK_RECEIPT_STATEMENT,DE.RSK_RECEIPT_PAYEMENT,DE.RETRO_CESSIONARIES,PR.RSK_CEDRET_TYPE,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,PR.RSK_MAX_LMT_COVER,DE.RSK_RETRO_TYPE,DE.RSK_INSURED_NAME,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,DE.INWARD_BUS_TYPE,DE.TREATYTYPE,PR.RSK_TREATY_SURP_LIMIT_OC,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,PR.RSK_TREATY_SURP_LIMIT_DC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RSK_NO_OF_LINE,PR.RSK_PML,PR.RSK_PML_PERCENT,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED, DE.RS_ENDORSEMENT_TYPE,DE.RSK_RUN_OFF_YEAR,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.BASE_LAYER,DE.RSK_CESSION_EXG_RATE,DE.RSK_FIXED_RATE,PM.RSK_DUMMY_CONTRACT,DE.RETENTIONYN,PM.DATA_MAP_CONT_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM WHERE DE.RSK_CONTRACT_NO=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(B.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL B, TTRN_RISK_DETAILS A WHERE A.RSK_CONTRACT_NO=? AND A.RSK_PROPOSAL_NUMBER=B.RSK_PROPOSAL_NUMBER ) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeData2= SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID , DE.RSK_POLBRANCH, DE.RSK_CEDINGID, DE.RSK_BROKERID, DE.RSK_TREATYID, TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_PERIOD_OF_NOTICE, DE. RSK_RISK_COVERED, DE. RSK_TERRITORY_SCOPE, DE.RSK_TERRITORY,DE.RSK_ENTRY_DATE, DE. RSK_END_DATE, DE. RSK_STATUS, DE.RSK_REMARKS,PR.RSK_LIMIT_OC,PR.RSK_EPI_OFFER_OC,PR.RSK_EPI_ESTIMATE,PR.RSK_EPI_EST_OC,PR.RSK_XLCOST_OC,PR.RSK_CEDANT_RETENTION,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.RSK_RECEIPT_STATEMENT,DE.RSK_RECEIPT_PAYEMENT,DE.RETRO_CESSIONARIES,PR.RSK_CEDRET_TYPE,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,PR.RSK_MAX_LMT_COVER,DE.RSK_RETRO_TYPE,DE.RSK_INSURED_NAME,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,DE.INWARD_BUS_TYPE,DE.TREATYTYPE,PR.RSK_TREATY_SURP_LIMIT_OC,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,PR.RSK_TREATY_SURP_LIMIT_DC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RSK_NO_OF_LINE,PR.RSK_PML,PR.RSK_PML_PERCENT,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED, DE.RS_ENDORSEMENT_TYPE,DE.RSK_RUN_OFF_YEAR,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.BASE_LAYER,DE.RSK_CESSION_EXG_RATE,DE.RSK_FIXED_RATE,PM.RSK_DUMMY_CONTRACT,DE.RETENTIONYN,PM.DATA_MAP_CONT_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
common.select.getPRCLCount=SELECT PR+CL COUNT FROM (SELECT COUNT(*) PR  FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND LAYER_NO=?),(SELECT COUNT(*) CL  FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO=? AND LAYER_NO=?)
risk.select.getRiskComMaxAmendId=SELECT NVL(MAX(RSK_ENDORSEMENT_NO),'0') RSK_ENDORSEMENT_NO FROM  TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?
GET_RET_DETAILS=SELECT  RSK_SNO,RSK_CLASS,RSK_SUBCLASS,RSK_TYPE,RSK_RETTYPE,RSK_BASISTYPE,RSK_FIRST_RET_OC,RSK_SECOND_RET_OC,RSK_RET_TL_FST_OC,RSK_RET_TL_SST_OC,RSK_RET_EL_FST_OC,RSK_RET_EL_SST_OC FROM TTRN_CEDENT_RET TRR WHERE PROPOSAL_NO\=? AND LAYER_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_CEDENT_RET WHERE  PROPOSAL_NO\=TRR.PROPOSAL_NO) order by RSK_SNO
common.select.getSubProfitCenterList=SELECT DISTINCT TMAS_SPFC_ID ,TMAS_SPFC_NAME  FROM  TMAS_SPFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_PRODUCT_ID=? and TMAS_DEPARTMENT_ID=? AND TMAS_STATUS=? ORDER BY TMAS_SPFC_NAME ASC
GET_BASE_LAYER_DETAILS=SELECT PROPOSAL_NO,BASE_LAYER,CONTRACT_NO,CONTRACT_STATUS FROM POSITION_MASTER PM WHERE PRODUCT_ID=? AND BRANCH_CODE=? AND PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeSecPageData=SELECT PR.RSK_LIMIT_OS_OC,PR.RSK_LIMIT_OS_DC,PR.RSK_EPI_OSOF_OC,PR.RSK_EPI_OSOF_DC,PR.RSK_EPI_OSOE_OC,PR.RSK_EPI_OSOE_DC,PR.RSK_XLCOST_OS_OC,PR.RSK_XLCOST_OS_DC,COM.RSK_COMM_QUOTASHARE,COM.RSK_COMM_SURPLUS,COM.RSK_OVERRIDER_PERC,COM.RSK_BROKERAGE,COM.RSK_TAX,COM.RSK_ACQUISTION_COST_OC,COM.RSK_PROFIT_COMM,COM.RSK_COMBIN_SUB_CLASS,COM.RSK_PREMIUM_RESERVE,COM.RSK_LOSS_RESERVE,COM.RSK_INTEREST,COM.RSK_CASHLOSS_LMT_OC,COM.RSK_PF_INOUT_PREM,COM.RSK_PF_INOUT_LOSS,COM.RSK_LOSSADVICE,COM.RSK_LEAD_UW,COM.RSK_LEAD_UW_SHARE,COM.RSK_ACCOUNTS,COM.RSK_EXCLUSION,COM.RSK_REMARKS,COM.RSK_UW_RECOMM,COM.RSK_GM_APPROVAL,COM.RSK_SLADSCALE_COMM,COM.RSK_LOSS_PART_CARRIDOR,PR.RSK_PREMIUM_QUOTA_SHARE,PR.RSK_PREMIUM_SURPULS,COM.RSK_OTHER_COST,COM.RSK_CREASTA_STATUS,COM.RSK_EVENT_LIMIT_OC,COM.RSK_EVENT_LIMIT_DC,COM.RSK_AGGREGATE_LIMIT_OC,COM.RSK_AGGREGATE_LIMIT_DC,COM.RSK_OCCURRENT_LIMIT_OC,COM.RSK_OCCURRENT_LIMIT_DC,COM.RSK_LEAD_UNDERWRITER_COUNTRY,COM.RSK_INCLUDE_ACQ_COST,COM.RSK_OUR_ASS_ACQ_COST,COM.RSK_OUR_ACQ_OUR_SHARE_OC,COM.RSK_LOSS_COMBIN_SUB_CLASS,COM.RSK_SLIDE_COMBIN_SUB_CLASS,COM.RSK_CRESTA_COMBIN_SUB_CLASS,COM.RSK_PRO_MANAGEMENT_EXP, COM.RSK_PRO_COMM_TYPE, COM.RSK_PRO_COMM_PER, COM.RSK_PRO_SET_UP, COM.RSK_PRO_SUP_PRO_COM, COM.RSK_PRO_LOSS_CARY_TYPE, COM.RSK_PRO_LOSS_CARY_YEAR, COM.RSK_PRO_PROFIT_CARY_TYPE, COM.RSK_PRO_PROFIT_CARY_YEAR, COM.RSK_PRO_FIRST_PFO_COM, COM.RSK_PRO_FIRST_PFO_COM_PRD, COM.RSK_PRO_SUB_PFO_COM_PRD, COM.RSK_PRO_SUB_PFO_COM, COM.RSK_PRO_SUB_SEQ_CAL, COM.RSK_PRO_NOTES,COM.RSK_COMMISSION_QS_YN,COM.RSK_NOCLAIMBONUS_PRCENT,COM.RSK_BONUS_ID,COM.RSK_COMMISSION_SUR_YN,COM.RSK_OVERRIDE_YN,COM.RSK_BROKARAGE_YN,COM.RSK_TAX_YN,COM.RSK_OTHER_COST_YN,COM.RSK_CEED_ODI_YN,COM.RSK_RATE,COM.RSK_COMMISSION_TYPE FROM TTRN_RISK_PROPOSAL PR,TTRN_RISK_COMMISSION COM WHERE PR.RSK_PROPOSAL_NUMBER \=? AND PR.RSK_PROPOSAL_NUMBER\=COM.RSK_PROPOSAL_NUMBER AND PR.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER\=?) AND COM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=?)
risk.select.getQuotaShare=SELECT RP.RSK_PREMIUM_QUOTA_SHARE,RP.RSK_PREMIUM_SURPULS,RP.RSK_XLCOST_OS_OC FROM TTRN_RISK_PROPOSAL RP WHERE  RP.RSK_PROPOSAL_NUMBER=? AND  RP.RSK_PREMIUM_QUOTA_SHARE IS NOT NULL AND RP.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER AND RSK_PREMIUM_QUOTA_SHARE IS NOT NULL )
RISK_SELECT_COMM_GETQUOTASHARE = SELECT RP.COMM_QS_AMT,RP.COMM_SURPLUS_AMT FROM TTRN_RISK_PROPOSAL RP WHERE  RP.RSK_PROPOSAL_NUMBER=? AND RP.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER  )
fac.select.uwYear=SELECT DISTINCT  A.UW_YEAR CONTDET1,A.UW_YEAR CONTDET2 FROM POSITION_MASTER A WHERE A.PRODUCT_ID  =? AND A.CONTRACT_STATUS ='A' AND A.CONTRACT_NO IS NOT NULL   AND A.CONTRACT_NO !='0' AND A.RETRO_TYPE='TR' AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(A.EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = ? AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER P WHERE P.PRODUCT_ID=A.PRODUCT_ID  AND P.CONTRACT_NO = A.CONTRACT_NO AND P.RETRO_TYPE=A.RETRO_TYPE AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(EXPIRY_DATE,'DD/MM/YY') AND P.BRANCH_CODE = A.BRANCH_CODE AND P.CONTRACT_STATUS =A.CONTRACT_STATUS) ORDER BY A.UW_YEAR
risk.select.uwYear=SELECT DISTINCT  A.UW_YEAR CONTDET1,A.UW_YEAR CONTDET2 FROM POSITION_MASTER A WHERE A.PRODUCT_ID  \=? AND A.CONTRACT_STATUS \='A' AND A.CONTRACT_NO IS NOT NULL   AND A.CONTRACT_NO \!\='0' AND TRUNC(TO_DATE(EXPIRY_DATE,'DD/MM/YY'))<TRUNC(TO_DATE(?,'DD/MM/YYYY'))  AND A.BRANCH_CODE \= ? AND A.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER P WHERE P.PRODUCT_ID\=A.PRODUCT_ID  AND P.CONTRACT_NO \= A.CONTRACT_NO AND P.CONTRACT_STATUS \=A.CONTRACT_STATUS AND TRUNC(TO_DATE(EXPIRY_DATE,'DD/MM/YY'))<TRUNC(TO_DATE(?,'DD/MM/YYYY')) AND P.BRANCH_CODE \= A.BRANCH_CODE) ORDER BY A.UW_YEAR
fac.select.retroContDet=SELECT A.CONTRACT_NO,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET1,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET2 FROM POSITION_MASTER A WHERE  A.PRODUCT_ID = ? AND A.CONTRACT_STATUS ='A' AND A.CONTRACT_NO IS NOT NULL AND A.CONTRACT_NO !='0' AND NVL(A.RETRO_TYPE,'N') = CASE WHEN PRODUCT_ID='4' THEN ? ELSE 'N' END AND A.UW_YEAR =  ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(A.EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = ? AND A.RSK_DUMMY_CONTRACT ='N' AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE A.PRODUCT_ID=PRODUCT_ID AND A.CONTRACT_NO = CONTRACT_NO AND NVL(A.RETRO_TYPE,'N') = CASE WHEN PRODUCT_ID='4' THEN ? ELSE 'N'  END AND A.UW_YEAR = ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = BRANCH_CODE AND A.RSK_DUMMY_CONTRACT ='N') ORDER BY A.CONTRACT_NO
FAC_SELECT_RETRO_DUP_CONTRACT=SELECT A.CONTRACT_NO,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET1,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET2 FROM POSITION_MASTER A WHERE  A.PRODUCT_ID = ? AND A.CONTRACT_STATUS ='A' AND A.CONTRACT_NO IS NOT NULL AND A.CONTRACT_NO !='0' AND NVL(A.RETRO_TYPE,'N') = CASE WHEN PRODUCT_ID='4' THEN ? ELSE 'N' END AND A.UW_YEAR =  ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(A.EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = ? AND A.RSK_DUMMY_CONTRACT ='D' AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE A.PRODUCT_ID=PRODUCT_ID AND A.CONTRACT_NO = CONTRACT_NO AND NVL(A.RETRO_TYPE,'N') = CASE WHEN PRODUCT_ID='4' THEN ? ELSE 'N'  END AND A.UW_YEAR = ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = BRANCH_CODE AND A.RSK_DUMMY_CONTRACT ='D') ORDER BY A.CONTRACT_NO
common.select.getUWLimit1=SELECT NVL(UNDERWRITTER_LIMIT,'0') UWLIMIT FROM   UNDERWRITER_CAPACITY_MASTER WHERE  UPPER(underwriterId) = UPPER(?) AND PRODUCT_ID=? AND DEPARTMENTID=? AND STATUS='Y'
pro.select.getRenewalValidation=SELECT PM.UW_YEAR,TO_CHAR(PM.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,TO_DATE(?,'DD/MM/YYYY')-TO_DATE(TO_CHAR(PM.EXPIRY_DATE,'DD/MM/YYYY'),'DD/MM/YYYY') DIFF FROM POSITION_MASTER PM WHERE PM.CONTRACT_NO=? AND PM.RENEWAL_STATUS='0' AND DEPT_ID=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO AND RENEWAL_STATUS=PM.RENEWAL_STATUS AND DEPT_ID=PM.DEPT_ID) ORDER BY PM.UW_YEAR DESC
FAC_CONTRACT_LIST=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_FAC_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RP.TYPE\=?  and decode(RP.TYPE,'1',RP.SUM_INSURED_OC,RP.DEDUCTIBLE_FACXOL_OC)\=? and RSK_PFCID \=? and PM.BRANCH_CODE\=?  AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_FAC_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL
FAC_CONTRACT_LIST1=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_FAC_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RP.TYPE\=?  and decode(RP.TYPE,'1',RP.SUM_INSURED_OC,RP.DEDUCTIBLE_FACXOL_OC)\=? and RSK_PFCID \=? and PM.BRANCH_CODE\=?  AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_FAC_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL  and RD.RSK_CONTRACT_NO!=?

PTTY_CONTRACT_LIST=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RD.TREATYTYPE\=?   and RSK_PFCID \=?  and PM.BRANCH_CODE\=? AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL
PTTY_CONTRACT_LIST1=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RD.TREATYTYPE\=?   and RSK_PFCID \=?  and PM.BRANCH_CODE\=? AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL and RP.RSK_LIMIT_OC=?
PTTY_CONTRACT_LIST2=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RD.TREATYTYPE\=?   and RSK_PFCID \=?  and PM.BRANCH_CODE\=? AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL and RP.RSK_TREATY_SURP_LIMIT_OC=?
PTTY_CONTRACT_LIST3=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RD.TREATYTYPE\=?   and RSK_PFCID \=?  and PM.BRANCH_CODE\=? AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL and RP.RSK_LIMIT_OC=? and RP.RSK_TREATY_SURP_LIMIT_OC = ?
PTTY_CONTRACT_LIST4=SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,RD.  RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER  RSK_UNDERWRITTER, RD.RSK_INSURED_NAME  FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI,PERSONAL_INFO PE,POSITION_MASTER PM  WHERE RD.RSK_CEDINGID\=?  AND TRUNC(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND TRUNC(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY')  AND RD.RSK_UWYEAR\=?  AND RD.RSK_ORIGINAL_CURR\=?  AND RD.RSK_DEPTID\=?  AND RD.TREATYTYPE\=?   and RSK_PFCID \=?  and PM.BRANCH_CODE\=? AND RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND RD.RSK_ENDORSEMENT_NO \= (  SELECT MAX(D.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_DETAILS D  WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  AND RP.RSK_ENDORSEMENT_NO\=(  SELECT MAX(FP.RSK_ENDORSEMENT_NO)  FROM TTRN_RISK_PROPOSAL FP  WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER)  and RD.RSK_CONTRACT_NO is not null  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PI.UWR_STATUS\='Y'  AND PI.BRANCH_CODE\=RD.BRANCH_CODE  AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID  AND PE.CUSTOMER_TYPE\='B'  AND PE.BRANCH_CODE\=RD.BRANCH_CODE  AND PE.AMEND_ID\=(  SELECT MAX(AMEND_ID)  FROM PERSONAL_INFO  WHERE CUSTOMER_ID\=PE.CUSTOMER_ID  AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE  AND BRANCH_CODE\=PE.BRANCH_CODE)  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER)   AND PM.DATA_MAP_CONT_NO IS NULL  and RD.RSK_CONTRACT_NO!=?

NPTTY_CONTRACT_LIST_CON=with   e1  as (  select RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO LAYER_NO,sum(CM.RSK_COVER_LIMT) cvr_limit,  sum(CM.RSK_DEDUCTABLE_LIMT) DEDU,SUM(RSK_COVER_LIMT_PERCENTAGE) COVER_PER,SUM(RSK_DEDUCTABLE_PERCENTAGE) DED_PER from TTRN_RSK_CLASS_LIMITS CM  WHERE CM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RSK_CLASS_LIMITS L WHERE L.RSK_PROPOSAL_NUMBER\=CM.RSK_PROPOSAL_NUMBER AND L.RSK_CONTRACT_NO\=CM.RSK_CONTRACT_NO AND L.RSK_LAYER_NO \= CM.RSK_LAYER_NO)   group   by  RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO ),  E2 AS (  SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,PM.LAYER_NO,RD.RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER RSK_UNDERWRITTER, RD.RSK_INSURED_NAME FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI, PERSONAL_INFO PE,POSITION_MASTER PM where   RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PI.BRANCH_CODE\=RD.BRANCH_CODE AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID AND PE.BRANCH_CODE\=RD.BRANCH_CODE AND RD.RSK_CEDINGID\=? AND trunc(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND trunc(RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND RD.RSK_UWYEAR\=? AND RD.RSK_ORIGINAL_CURR\=? AND RD.RSK_DEPTID\=? AND RD.RSK_BUSINESS_TYPE\=? and RSK_PFCID \=? and PM.LAYER_NO \=? AND RD.RSK_CONTRACT_NO\!\=? and PM.BRANCH_CODE \=?  and PM.PRODUCT_ID\='3' and PM.LAYER_NO\=RD.RSK_LAYER_NO AND PM.LAYER_NO \= RP.RSK_LAYER_NO AND RD.RSK_ENDORSEMENT_NO \= ( SELECT MAX(D.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS D WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) AND RP.RSK_ENDORSEMENT_NO\=( SELECT MAX(FP.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL FP WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) and RD.RSK_CONTRACT_NO is not null AND PI.UWR_STATUS\='Y' AND PE.CUSTOMER_TYPE\='B' AND PE.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PE.CUSTOMER_ID AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE AND BRANCH_CODE\=PE.BRANCH_CODE) AND PM.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER) AND PM.DATA_MAP_CONT_NO IS NULL)  SELECT   * FROM  E1,E2     WHERE   E1.RSK_CONTRACT_NO\=E2.RSK_CONTRACT_NO  AND E1.RSK_PROPOSAL_NUMBER\=E2.RSK_PROPOSAL_NUMBER AND  E1.LAYER_NO\=E2.LAYER_NO
NPTTY_CONTRACT_LIST_CON1=with   e1  as (  select RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO LAYER_NO,sum(CM.RSK_COVER_LIMT) cvr_limit,  sum(CM.RSK_DEDUCTABLE_LIMT) DEDU,SUM(RSK_COVER_LIMT_PERCENTAGE) COVER_PER,SUM(RSK_DEDUCTABLE_PERCENTAGE) DED_PER from TTRN_RSK_CLASS_LIMITS CM  WHERE CM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RSK_CLASS_LIMITS L WHERE L.RSK_PROPOSAL_NUMBER\=CM.RSK_PROPOSAL_NUMBER AND L.RSK_CONTRACT_NO\=CM.RSK_CONTRACT_NO AND L.RSK_LAYER_NO \= CM.RSK_LAYER_NO)   group   by  RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO ),  E2 AS (  SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,PM.LAYER_NO,RD.RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER RSK_UNDERWRITTER, RD.RSK_INSURED_NAME FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI, PERSONAL_INFO PE,POSITION_MASTER PM where   RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PI.BRANCH_CODE\=RD.BRANCH_CODE AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID AND PE.BRANCH_CODE\=RD.BRANCH_CODE AND RD.RSK_CEDINGID\=? AND trunc(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND trunc(RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND RD.RSK_UWYEAR\=? AND RD.RSK_ORIGINAL_CURR\=? AND RD.RSK_DEPTID\=? AND RD.RSK_BUSINESS_TYPE\=? and RSK_PFCID \=? and PM.LAYER_NO \=? AND RD.RSK_CONTRACT_NO\!\=? and PM.BRANCH_CODE \=?  and PM.PRODUCT_ID\='3' and PM.LAYER_NO\=RD.RSK_LAYER_NO AND PM.LAYER_NO \= RP.RSK_LAYER_NO AND RD.RSK_ENDORSEMENT_NO \= ( SELECT MAX(D.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS D WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) AND RP.RSK_ENDORSEMENT_NO\=( SELECT MAX(FP.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL FP WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) and RD.RSK_CONTRACT_NO is not null AND PI.UWR_STATUS\='Y' AND PE.CUSTOMER_TYPE\='B' AND PE.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PE.CUSTOMER_ID AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE AND BRANCH_CODE\=PE.BRANCH_CODE) AND PM.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER) AND PM.DATA_MAP_CONT_NO IS NULL)  SELECT   * FROM  E1,E2     WHERE   E1.RSK_CONTRACT_NO\=E2.RSK_CONTRACT_NO  AND E1.RSK_PROPOSAL_NUMBER\=E2.RSK_PROPOSAL_NUMBER AND  E1.LAYER_NO\=E2.LAYER_NO and  E1.cvr_limit=? AND E1.DEDU=?
NPTTY_CONTRACT_LIST=with   e1  as (  select RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO LAYER_NO,sum(CM.RSK_COVER_LIMT) cvr_limit,  sum(CM.RSK_DEDUCTABLE_LIMT) DEDU,SUM(RSK_COVER_LIMT_PERCENTAGE) COVER_PER,SUM(RSK_DEDUCTABLE_PERCENTAGE) DED_PER from TTRN_RSK_CLASS_LIMITS CM  WHERE CM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RSK_CLASS_LIMITS L WHERE L.RSK_PROPOSAL_NUMBER\=CM.RSK_PROPOSAL_NUMBER AND L.RSK_CONTRACT_NO\=CM.RSK_CONTRACT_NO AND L.RSK_LAYER_NO \= CM.RSK_LAYER_NO)   group   by  RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO ),  E2 AS (  SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,PM.LAYER_NO,RD.RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER RSK_UNDERWRITTER, RD.RSK_INSURED_NAME FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI, PERSONAL_INFO PE,POSITION_MASTER PM where   RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PI.BRANCH_CODE\=RD.BRANCH_CODE AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID AND PE.BRANCH_CODE\=RD.BRANCH_CODE AND RD.RSK_CEDINGID\=? AND trunc(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND trunc(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND RD.RSK_UWYEAR\=? AND RD.RSK_ORIGINAL_CURR\=? AND RD.RSK_DEPTID\=? AND RD.RSK_BUSINESS_TYPE\=? and RSK_PFCID \=? and PM.LAYER_NO \=?  and PM.BRANCH_CODE \=? and PM.PRODUCT_ID\='3' and PM.LAYER_NO\=RD.RSK_LAYER_NO AND PM.LAYER_NO \= RP.RSK_LAYER_NO AND RD.RSK_ENDORSEMENT_NO \= ( SELECT MAX(D.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS D WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) AND RP.RSK_ENDORSEMENT_NO\=( SELECT MAX(FP.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL FP WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) and RD.RSK_CONTRACT_NO is not null AND PI.UWR_STATUS\='Y' AND PE.CUSTOMER_TYPE\='B' AND PE.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PE.CUSTOMER_ID AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE AND BRANCH_CODE\=PE.BRANCH_CODE) AND PM.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER) AND PM.DATA_MAP_CONT_NO IS NULL)  SELECT   * FROM  E1,E2     WHERE   E1.RSK_CONTRACT_NO\=E2.RSK_CONTRACT_NO  AND E1.RSK_PROPOSAL_NUMBER\=E2.RSK_PROPOSAL_NUMBER AND  E1.LAYER_NO\=E2.LAYER_NO
NPTTY_CONTRACT_LIST1=with   e1  as (  select RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO LAYER_NO,sum(CM.RSK_COVER_LIMT) cvr_limit,  sum(CM.RSK_DEDUCTABLE_LIMT) DEDU,SUM(RSK_COVER_LIMT_PERCENTAGE) COVER_PER,SUM(RSK_DEDUCTABLE_PERCENTAGE) DED_PER from TTRN_RSK_CLASS_LIMITS CM  WHERE CM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RSK_CLASS_LIMITS L WHERE L.RSK_PROPOSAL_NUMBER\=CM.RSK_PROPOSAL_NUMBER AND L.RSK_CONTRACT_NO\=CM.RSK_CONTRACT_NO AND L.RSK_LAYER_NO \= CM.RSK_LAYER_NO)   group   by  RSK_PROPOSAL_NUMBER,RSK_CONTRACT_NO,RSK_LAYER_NO ),  E2 AS (  SELECT  DISTINCT RD.RSK_CONTRACT_NO,RD.RSK_ENDORSEMENT_NO,PM.LAYER_NO,RD.RSK_PROPOSAL_NUMBER,PE.FIRST_NAME RSK_BROKERID,PI.UNDERWRITTER RSK_UNDERWRITTER, RD.RSK_INSURED_NAME FROM TTRN_RISK_DETAILS RD,TTRN_RISK_PROPOSAL RP,UNDERWRITTER_MASTER  PI, PERSONAL_INFO PE,POSITION_MASTER PM where   RP.RSK_PROPOSAL_NUMBER \= RD.RSK_PROPOSAL_NUMBER  AND PI.UWR_CODE \= RD.RSK_UNDERWRITTER  AND PM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER  AND PI.BRANCH_CODE\=RD.BRANCH_CODE AND  PE.CUSTOMER_ID \= RD.RSK_BROKERID AND PE.BRANCH_CODE\=RD.BRANCH_CODE AND RD.RSK_CEDINGID\=? AND trunc(RD.RSK_INCEPTION_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND trunc(RD.RSK_EXPIRY_DATE)\=TO_DATE(?,'DD/MM/YYYY') AND RD.RSK_UWYEAR\=? AND RD.RSK_ORIGINAL_CURR\=? AND RD.RSK_DEPTID\=? AND RD.RSK_BUSINESS_TYPE\=? and RSK_PFCID \=? and PM.LAYER_NO \=?  and PM.BRANCH_CODE \=? and PM.PRODUCT_ID\='3' and PM.LAYER_NO\=RD.RSK_LAYER_NO AND PM.LAYER_NO \= RP.RSK_LAYER_NO AND RD.RSK_ENDORSEMENT_NO \= ( SELECT MAX(D.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS D WHERE D.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) AND RP.RSK_ENDORSEMENT_NO\=( SELECT MAX(FP.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL FP WHERE FP.RSK_PROPOSAL_NUMBER\=RD.RSK_PROPOSAL_NUMBER) and RD.RSK_CONTRACT_NO is not null AND PI.UWR_STATUS\='Y' AND PE.CUSTOMER_TYPE\='B' AND PE.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PE.CUSTOMER_ID AND CUSTOMER_TYPE\=PE.CUSTOMER_TYPE AND BRANCH_CODE\=PE.BRANCH_CODE) AND PM.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM POSITION_MASTER POM WHERE POM.PROPOSAL_NO \=RD.RSK_PROPOSAL_NUMBER) AND PM.DATA_MAP_CONT_NO IS NULL)  SELECT   * FROM  E1,E2     WHERE   E1.RSK_CONTRACT_NO\=E2.RSK_CONTRACT_NO  AND E1.RSK_PROPOSAL_NUMBER\=E2.RSK_PROPOSAL_NUMBER AND  E1.LAYER_NO\=E2.LAYER_NO and  E1.cvr_limit=? AND E1.DEDU=? AND E1.COVER_PER =? AND E1.DED_PER = ?


GET_CURRENCY_SHORT_LIST=SELECT DISTINCT CM.CURRENCY_ID,CM.SHORT_NAME FROM CURRENCY_MASTER CM WHERE CM.BRANCH_CODE\=? AND CM.COUNTRY_ID\=? and CM.STATUS\=? AND CM.AMEND_ID\=(select MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE BRANCH_CODE\=CM.BRANCH_CODE AND  COUNTRY_ID\=CM.COUNTRY_ID and STATUS\=CM.STATUS AND CURRENCY_ID\=CM.CURRENCY_ID) ORDER BY CURRENCY_ID
common.select.getCountryList=SELECT DISTINCT CM.COUNTRY_ID,CM.COUNTRY_NAME FROM COUNTRY_MASTER CM WHERE BRANCH_CODE=? AND CM.STATUS=? AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE BRANCH_CODE=CM.BRANCH_CODE AND STATUS=CM.STATUS and COUNTRY_ID=CM.COUNTRY_ID) ORDER BY COUNTRY_NAME ASC
GET_COMMISSION_LIST = SELECT DETAIL_NAME,REMARKS FROM CONSTANT_DETAIL WHERE  CATEGORY_ID=? AND STATUS=?
GET_REINSTATEMENT_LIST =    SELECT DETAIL_NAME,REMARKS FROM CONSTANT_DETAIL WHERE  CATEGORY_ID=? AND STATUS=?

GET_Rate_FLOW=SELECT TERRITORY_ID,TERRITORY_NAME FROM TMAS_TERRITORY WHERE BRANCH_CODE=? ORDER BY CASE WHEN TERRITORY_NAME like 'India%' THEN 1 ELSE  2 END, TERRITORY_NAME 
upload.getDocTypeList=SELECT DTM.DOC_TYPE,DTM.DOC_NAME FROM TMAS_DOC_TYPE_MASTER DTM WHERE DTM.BRANCH_CODE=? AND DTM.PRODUCT_ID=? AND DTM.MODULE_TYPE=?  AND  DTM.STATUS=? AND DTM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TMAS_DOC_TYPE_MASTER WHERE DOC_TYPE=DTM.DOC_TYPE AND BRANCH_CODE=DTM.BRANCH_CODE AND PRODUCT_ID=DTM.PRODUCT_ID AND MODULE_TYPE=DTM.MODULE_TYPE) ORDER BY DOC_NAME
common.select.getPolicyBranchList=SELECT DISTINCT TMAS_POL_BRANCH_ID,TMAS_POL_BRANCH_NAME  FROM TMAS_POLICY_BRANCH WHERE BRANCH_CODE=? AND TMAS_STATUS=?  ORDER BY TMAS_POL_BRANCH_NAME ASC
common.select.departlist.premium=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_STATUS=? ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList3 = SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE PROPOSAL_NO=?   OR PROPOSAL_NO in(SELECT PROPOSAL_NO from POSITION_MASTER where CONTRACT_STATUS !='C' AND BASE_LAYER = ? AND  PROPOSAL_NO!=?)) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList1=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE CONTRACT_NO=? or BASE_LAYER = ?) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList2=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE PROPOSAL_NO=? OR PROPOSAL_NO =? OR PROPOSAL_NO in(SELECT PROPOSAL_NO from POSITION_MASTER where  BASE_LAYER = ?)) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList1=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE CONTRACT_NO=? or BASE_LAYER = ?) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getdepartment=select NETDUE_OC,ALLOCATED_TILL_DATE ,NETDUE_OC- ALLOCATED_TILL_DATE from rsk_premium_details where CONTRACT_NO=? union all select PAID_AMOUNT_OC,ALLOCATED_TILL_DATE, PAID_AMOUNT_OC-ALLOCATED_TILL_DATE from ttrn_claim_payment where CONTRACT_NO=?";
GET_UNDERWRITER_COUNTRY_LIST = SELECT COUNTRY_ID,COUNTRY_NAME FROM COUNTRY_MASTER C WHERE C.BRANCH_CODE=? AND STATUS=? AND  C.COUNTRY_ID=(SELECT COUNTRY FROM personal_info P WHERE P.CUSTOMER_ID=? AND P.COUNTRY=C.COUNTRY_ID AND P.BRANCH_CODE=C.BRANCH_CODE AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM personal_info PI WHERE PI.CUSTOMER_ID =P.CUSTOMER_ID AND PI.BRANCH_CODE = P.BRANCH_CODE))
common.select.getProfitCenterList=SELECT DISTINCT TMAS_PFC_ID ,TMAS_PFC_NAME,PRODUTID   FROM TMAS_PFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_STATUS=? ORDER BY TMAS_PFC_NAME ASC
common.select.getTerritoryList=SELECT DISTINCT TERRITORY_CODE,TERRITORY_DESC FROM  TERRITORY_MASTER WHERE BRANCH_CODE=? AND  TERRITORY_STATUS =?  ORDER BY TERRITORY_DESC ASC
GET_SIGN_SHARE_EQUAL_PRODUCT1=SELECT COUNT(*) COUNT FROM TTRN_FAC_RISK_PROPOSAL RK WHERE SHARE_SIGNED=? AND RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_FAC_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=RK.RSK_PROPOSAL_NUMBER)
GET_SIGN_SHARE_EQUAL_PRODUCT23=SELECT COUNT(*) COUNT FROM TTRN_RISK_PROPOSAL RK WHERE RSK_SHARE_SIGNED\=? AND RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER\=RK.RSK_PROPOSAL_NUMBER)
GET_CRESTA_NAME_LIST=SELECT CRESTA_ID,CRESTA_NAME FROM  TMAS_CRESTA_MASTER WHERE BRANCH_CODE=? AND STATUS='Y' AND CRESTA_ID=?
GET_CRESTAID_LIST=SELECT CRESTA_ID,CRESTA_NAME FROM  TMAS_CRESTA_MASTER WHERE BRANCH_CODE=? AND STATUS='Y' AND TERITORY_CODE=?
GET_SELECT_ORDER=select NETDUE_OC,ALLOCATED_TILL_DATE ,NETDUE_OC- ALLOCATED_TILL_DATE from rsk_premium_details where CONTRACT_NO=? union all select PAID_AMOUNT_OC,ALLOCATED_TILL_DATE, PAID_AMOUNT_OC-ALLOCATED_TILL_DATE from ttrn_claim_payment where CONTRACT_NO=?
GET_UNDERWRITER_ATTACHED=SELECT DISTINCT UWR_CODE ,UNDERWRITTER  FROM UNDERWRITTER_MASTER WHERE  BRANCH_CODE\=? AND UWR_STATUS\=? AND UWR_CODE IN(select * from table(SPLIT_TEXT_FN(?))) ORDER BY UNDERWRITTER ASC
common.select.getUWList=SELECT DISTINCT UWR_CODE ,UNDERWRITTER  FROM UNDERWRITTER_MASTER WHERE  BRANCH_CODE\=? AND UWR_STATUS\=? ORDER BY UNDERWRITTER ASC
GET_CRESTA_NAME_LIST=SELECT CRESTA_ID,CRESTA_NAME FROM  TMAS_CRESTA_MASTER WHERE BRANCH_CODE=? AND STATUS='Y' AND CRESTA_ID=?

PROFIT_COMMISSION_ENABLE =SELECT RSK_PROFIT_COMM,RSK_COMBIN_SUB_CLASS FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE  RSK_PROPOSAL_NUMBER\=?)
PROFIT_COMMISSION_ENABLE_LOSS =SELECT RSK_LOSS_PART_CARRIDOR,RSK_LOSS_COMBIN_SUB_CLASS  FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE  RSK_PROPOSAL_NUMBER\=?)
PROFIT_COMMISSION_ENABLE_CRESTA =SELECT RSK_CREASTA_STATUS,RSK_CRESTA_COMBIN_SUB_CLASS  FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE  RSK_PROPOSAL_NUMBER\=?)
PROFIT_COMMISSION_ENABLE_SLIDE =SELECT RSK_SLADSCALE_COMM,RSK_SLIDE_COMBIN_SUB_CLASS  FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE  RSK_PROPOSAL_NUMBER\=?)
GET_ACCEPTANCE_DATE=select to_char (ACCOUNT_DATE,'DD/MM/YYYY') ACCOUNT_DATE from position_master pm where proposal_no\=? and pm.amend_id\=(Select Max(Amend_id) From Position_master p where p.proposal_no\=pm.proposal_no)
GET_CRESTA_DETAIL_COUNT=SELECT COUNT(*) COUNT FROM TTRN_CRESTAZONE_DETAILS WHERE PROPOSAL_NO=? AND AMEND_ID=? AND BRANCH_CODE=?

COMMISSION_TYPE_COUNT =SELECT COUNT(*) COUNT FROM TTRN_COMMISSION_DETAILS C WHERE PROPOSAL_NO\=? AND BRANCH_CODE\=? AND COMMISSION_TYPE\=? AND ENDORSEMENT_NO \= (SELECT MAX(ENDORSEMENT_NO) FROM  TTRN_COMMISSION_DETAILS T WHERE T.PROPOSAL_NO\=C.PROPOSAL_NO AND T.BRANCH_CODE\=C.BRANCH_CODE)
GET_SIGN_SHARE_PRODUCT23=select RSK_SHARE_SIGNED from ttrn_risk_proposal rk where RSK_PROPOSAL_NUMBER=? and RSK_ENDORSEMENT_NO=(select max(RSK_ENDORSEMENT_NO) from ttrn_risk_proposal where RSK_PROPOSAL_NUMBER=rk.RSK_PROPOSAL_NUMBER)
GET_SIGN_SHARE_EQUAL_PRODUCT1=SELECT COUNT(*) COUNT FROM TTRN_FAC_RISK_PROPOSAL RK WHERE SHARE_SIGNED=? AND RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_FAC_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=RK.RSK_PROPOSAL_NUMBER)
GET_SIGN_SHARE_EQUAL_PRODUCT23=SELECT COUNT(*) COUNT FROM TTRN_RISK_PROPOSAL RK WHERE RSK_SHARE_SIGNED\=? AND RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER\=RK.RSK_PROPOSAL_NUMBER)
risk.select.getSecPageData=SELECT   RK.RSK_PROPOSAL_NUMBER, PFC.TMAS_PFC_NAME, (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND SPFC.TMAS_PRODUCT_ID \= TDM.TMAS_PRODUCT_ID AND TDM.BRANCH_CODE \= SPFC.BRANCH_CODE)TMAS_SPFC_NAME, PERSONAL.COMPANY_NAME, PI.FIRST_NAME || ' ' || PI.LAST_NAME AS BROKER, TO_CHAR (RK.RSK_MONTH, 'DD/MM/YYYY') MONTH, BRAN.TMAS_POL_BRANCH_NAME, RK.RSK_CONTRACT_NO, RK.RSK_UWYEAR, TDM.TMAS_DEPARTMENT_NAME,RK.RS_ENDORSEMENT_TYPE DETAIL_NAME FROM   TTRN_RISK_DETAILS RK, TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL, PERSONAL_INFO PI, TMAS_POLICY_BRANCH BRAN,TMAS_DEPARTMENT_MASTER TDM WHERE  RK.RSK_PROPOSAL_NUMBER \= ? AND PFC.TMAS_PFC_ID \= RSK_PFCID  AND PFC.BRANCH_CODE \= ? AND TDM.BRANCH_CODE \= ? AND TDM.TMAS_PRODUCT_ID \= ? AND TDM.TMAS_DEPARTMENT_ID \= RK.RSK_DEPTID AND RK.RSK_CEDINGID \= PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE \= 'C'  AND PERSONAL.BRANCH_CODE \= ? AND PERSONAL.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID \= PERSONAL.CUSTOMER_ID AND CUSTOMER_TYPE \= PERSONAL.CUSTOMER_TYPE AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PI.CUSTOMER_TYPE \= 'B' AND PI.BRANCH_CODE \= ? AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID AND CUSTOMER_TYPE \= PI.CUSTOMER_TYPE AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_PROPOSAL_NUMBER \= RK.RSK_PROPOSAL_NUMBER) AND RK.RSK_POLBRANCH \= BRAN.TMAS_POL_BRANCH_ID AND BRAN.BRANCH_CODE \= ?
risk.select.CEASE_STATUS=select CEASE_STATUS from position_master pm where PROPOSAL_NO=? and  pm.amend_id=(Select Max(Amend_id) From Position_master p where p.proposal_no=pm.proposal_no)
FAC_SELECT_RETRO_DUP_CONTRACT=SELECT A.CONTRACT_NO,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET1,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET2 FROM POSITION_MASTER A WHERE  A.PRODUCT_ID = ? AND A.CONTRACT_STATUS ='A' AND A.CONTRACT_NO IS NOT NULL AND A.CONTRACT_NO !='0' AND NVL(A.RETRO_TYPE,'N') = CASE WHEN PRODUCT_ID='4' THEN ? ELSE 'N' END AND A.UW_YEAR =  ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(A.EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = ? AND A.RSK_DUMMY_CONTRACT ='D' AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE A.PRODUCT_ID=PRODUCT_ID AND A.CONTRACT_NO = CONTRACT_NO AND NVL(A.RETRO_TYPE,'N') = CASE WHEN PRODUCT_ID='4' THEN ? ELSE 'N'  END AND A.UW_YEAR = ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = BRANCH_CODE AND A.RSK_DUMMY_CONTRACT ='D') ORDER BY A.CONTRACT_NO

risk.select.getBrokerage=SELECT RSK_BROKERAGE,RSK_TAX FROM TTRN_RISK_COMMISSION WHERE RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?) AND RSK_PROPOSAL_NUMBER=?
risk.select.getRskProIdByContNo=SELECT RSK_PRODUCTID FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?

GET_COUNT_CASHLOSS_PREM =SELECT COUNT(*) COUNT FROM TTRN_CASH_LOSS_CREDIT WHERE  CONTRACT_NO \=? AND BRANCH_CODE\=? AND TABLE_MOVE_STATUS\=?
GET_COUNT_DEPOSIT_PREM = SELECT COUNT(*)  COUNT FROM TTRN_DEPOSIT_RELEASE WHERE CONTRACT_NO =? AND BRANCH_CODE=? AND TABLE_MOVE_STATUS=? AND RELEASE_TYPE=?


GET_ALLOCATION_DISABLE_STATUS=select case  when count(*) > 0   then 'Y'  else 'N' end Status from TTRN_ALLOCATED_TRANSACTION where  contract_no=?  and nvl(layer_no,'0')=nvl(?,'0')
UPDATE_POSITION_MASTER_END_STATUS=update position_master pm set endt_status='Y',CONTRACT_STATUS=case when PROPOSAL_STATUS='A' then 'A' else  CONTRACT_STATUS end ,ENDORSEMENT_DATE=to_date(?,'DD/MM/YYYY'),CEASE_STATUS=? where proposal_no=? and pm.amend_id=(Select Max(Amend_id) From Position_master p where p.proposal_no=pm.proposal_no)
UPDATE_INSTALLMENT_TRANSACTION=UPDATE TTRN_MND_INSTALLMENTS MA  SET TRANSACTION_NO\=(SELECT  TRANSACTION_NO FROM TTRN_MND_INSTALLMENTS TI  WHERE INSTALLMENT_NO\=MA.INSTALLMENT_NO  AND  PROPOSAL_NO \=MA.PROPOSAL_NO  AND   CONTRACT_NO\=MA.CONTRACT_NO AND TRANSACTION_NO IS NOT NULL  AND ENDORSEMENT_NO\=(SELECT  MAX(ENDORSEMENT_NO)-1  FROM  TTRN_MND_INSTALLMENTS  WHERE PROPOSAL_NO\=TI.PROPOSAL_NO))  WHERE  PROPOSAL_NO\=? AND ENDORSEMENT_NO\=(SELECT  MAX(ENDORSEMENT_NO)  FROM  TTRN_MND_INSTALLMENTS  WHERE PROPOSAL_NO\=MA.PROPOSAL_NO)
GET_BONUS_LIST = select DETAIL_NAME,REMARKS  from CONSTANT_DETAIL where CATEGORY_ID=? and status=?
GET_REINSTATEMENT_LIST =    SELECT DETAIL_NAME,REMARKS FROM CONSTANT_DETAIL WHERE  CATEGORY_ID=? AND STATUS=?
common.select.getConstDet=SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=?
common.select.getPRoductListIE=SELECT DISTINCT '1~'||TMAS_PRODUCT_ID TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER WHERE TMAS_STATUS\='1' AND BRANCH_CODE\=? AND TMAS_PRODUCT_ID IN ('1','2','3')
GET_CONSTANT_DROPDOWN_ET=SELECT  COUNT(TRANSACTION_NO) TRANSACTION_NO,COUNT(CONTRACT_NO) CONTRACT_NO FROM TTRN_MND_INSTALLMENTS T WHERE  CONTRACT_NO=? AND ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO=T.CONTRACT_NO and PROPOSAL_NO = T.PROPOSAL_NO)
GET_CONSTANT_DROPDOWN_ET1=SELECT  COUNT(TRANSACTION_NO) TRANSACTION_NO,COUNT(CONTRACT_NO) CONTRACT_NO FROM TTRN_MND_INSTALLMENTS T WHERE  CONTRACT_NO=? AND ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO=T.CONTRACT_NO and PROPOSAL_NO = T.PROPOSAL_NO) order by TYPE
common.select.departlist.premium=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_STATUS=? ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList3 = SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE PROPOSAL_NO=?   OR PROPOSAL_NO in(SELECT PROPOSAL_NO from POSITION_MASTER where CONTRACT_STATUS !='C' AND BASE_LAYER = ? AND  PROPOSAL_NO!=?)) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList1=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE CONTRACT_NO=? or BASE_LAYER = ?) ORDER BY  TMAS_DEPARTMENT_NAME ASC
common.select.getDepartmentList2=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? AND TMAS_DEPARTMENT_ID NOT IN(SELECT DEPT_ID FROM POSITION_MASTER WHERE PROPOSAL_NO=? OR PROPOSAL_NO =? OR PROPOSAL_NO in(SELECT PROPOSAL_NO from POSITION_MASTER where  BASE_LAYER = ?)) ORDER BY  TMAS_DEPARTMENT_NAME ASC
GET_COVER_DEPT_LIST =SELECT   TMAS_DEPARTMENT_ID,TMAS_DEPARTMENT_NAME FROM tmas_department_master  WHERE (TMAS_DEPARTMENT_ID,BRANCH_CODE,TMAS_PRODUCT_ID) IN (select  DISTINCT regexp_substr(RM.CORE_COMPANY_CODE||','||TMAS_DEPARTMENT_ID  ,'[^,]+', 1, level) CORE_COMPANY_CODE, BRANCH_CODE,TMAS_PRODUCT_ID  from   (SELECT  CORE_COMPANY_CODE||','||TMAS_DEPARTMENT_ID  CORE_COMPANY_CODE,TMAS_DEPARTMENT_ID,BRANCH_CODE,TMAS_PRODUCT_ID FROM  tmas_department_master WHERE TMAS_DEPARTMENT_ID \=? AND BRANCH_CODE \= ? AND TMAS_PRODUCT_ID\=? ) RM connect by regexp_substr(RM.CORE_COMPANY_CODE||','||TMAS_DEPARTMENT_ID  ,'[^,]+', 1, level) is not null) and  TMAS_STATUS\='Y'

common.select.getPRoductListIE=SELECT DISTINCT '1~'||TMAS_PRODUCT_ID TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER WHERE TMAS_STATUS\='1' AND BRANCH_CODE\=? AND TMAS_PRODUCT_ID IN ('1','2','3')
GET_PRODUCTION_MODULE_DROPDOWN=SELECT DISTINCT '1~'||TMAS_PRODUCT_ID TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER WHERE TMAS_STATUS\='1' AND BRANCH_CODE\=? AND TMAS_PRODUCT_ID IN ('1','2','3')AND TMAS_PRODUCT_ID IN(Select ITEM_TYPE from TTRN_IE_MODULE where PROPOSAL_NO=? and TRANSACTION_NO=? and ITEM_NO='1' and ITEM_INCLUSION_EXCLUSION=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE TI.PROPOSAL_NO=PROPOSAL_NO AND TI.TRANSACTION_NO = ? AND TI.ITEM_NO = ITEM_NO AND TI.ITEM_INCLUSION_EXCLUSION = ITEM_INCLUSION_EXCLUSION ))


fac.select.viewInsDetails=SELECT   DECODE(A.CONTRACT_NO,'0','',A.CONTRACT_NO) CONTRACTNO,A.RETRO_PERCENTAGE RETRO_PER,TYPE,UW_YEAR,RETRO_TYPE FROM TTRN_INSURER_DETAILS A WHERE A.ENDORSEMENT_NO =?  AND A.PROPOSAL_NO = ?  AND A.INSURER_NO BETWEEN 0 AND ? ORDER BY A.INSURER_NO
fac.select.insDetails=SELECT   DECODE(A.CONTRACT_NO,'0','',A.CONTRACT_NO) CONTRACTNO,A.RETRO_PERCENTAGE RETRO_PER,TYPE,UW_YEAR,RETRO_TYPE FROM TTRN_INSURER_DETAILS A WHERE A.ENDORSEMENT_NO = (SELECT   MAX (ENDORSEMENT_NO) FROM   TTRN_INSURER_DETAILS WHERE   A.PROPOSAL_NO=PROPOSAL_NO AND A.INSURER_NO=INSURER_NO) AND A.PROPOSAL_NO = ?  AND A.INSURER_NO BETWEEN 0 AND ? ORDER BY A.INSURER_NO
GET_CRESTA_DETAIL_LIST=SELECT SNO,CRESTA_ID,CRESTA_NAME,CURRENCY,ACC_RISK,TO_CHAR(ACCUM_DATE,'dd/mm/yyyy')ACCUM_DATE,TERITORY_CODE FROM TTRN_CRESTAZONE_DETAILS WHERE PROPOSAL_NO\=? and AMEND_ID\=? AND BRANCH_CODE\=? order by SNO
DELETE_CRESTA_MAIN_DETAILS=DELETE FROM TTRN_CRESTAZONE_DETAILS WHERE PROPOSAL_NO\=? AND AMEND_ID\=? AND BRANCH_CODE\=?
MOVE_TO_CRESTA_MAIN_TABLE=INSERT INTO TTRN_CRESTAZONE_DETAILS(CONTRACT_NO,PROPOSAL_NO,AMEND_ID,SUB_CLASS,CRESTA_ID,CRESTA_NAME,Currency,ACC_RISK,ACCUM_DATE,ENTRY_DATE,STATUS,BRANCH_CODE,TERITORY_CODE,SNO)VALUES(?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),SYSDATE,'Y',?,?,?)
CANCEL_OLD_PROPOSAL =UPDATE POSITION_MASTER pm SET RENEWAL_STATUS\='1' WHERE PROPOSAL_NO\=?   and amend_id\=(select max(amend_id) from position_master p where p.PROPOSAL_NO\=pm.PROPOSAL_NO )
CANCEL_PROPOSAL = UPDATE POSITION_MASTER pm SET CONTRACT_STATUS\='C' , EDIT_MODE\='N'  WHERE PROPOSAL_NO\=?   and amend_id\=(select max(amend_id) from position_master p where p.PROPOSAL_NO\=pm.PROPOSAL_NO )
GET_RET_BASE_DETAILS=SELECT  * FROM ( SELECT RT.* ,DENSE_RANK()  OVER ( ORDER BY PROPOSAL_NO DESC) RN  FROM  TTRN_CEDENT_RET RT  WHERE  EXISTS (SELECT 'Y' FROM POSITION_MASTER PM WHERE  PM.PROPOSAL_NO\=RT.PROPOSAL_NO  AND BRANCH_CODE\=?  AND  CEDING_COMPANY_ID\=? AND UW_YEAR\=? AND PRODUCT_ID\=?  AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO\=PM.PROPOSAL_NO )) ) WHERE  RN\=1
BONUS_MAIN_SELECT = SELECT * FROM TTRN_BONUS TT WHERE PROPOSAL_NO =?  and BRANCH=? and TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.PROPOSAL_NO=TB.PROPOSAL_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE) ORDER BY LCB_ID
RISK_SELECT_GETCOMMONDATA_PTTY=SELECT RD.RSK_INSURED_NAME,RD.RSK_DEPTID,DM.TMAS_DEPARTMENT_NAME,(select detail_name from constant_detail where category_id \= '4' and type\= rd.RSK_PROPOSAL_TYPE ) proposal_type,(select detail_name from constant_detail where category_id\= '5' and type\= rd.RSK_ACCOUNTING_PERIOD ) accounting_period,rd.RSK_RECEIPT_STATEMENT,rd.RSK_RECEIPT_PAYEMENT, rd.RSK_PROPOSAL_NUMBER,PFC.TMAS_PFC_NAME,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE \= RD.BRANCH_CODE) TMAS_SPFC_NAME,RD.RSK_SPFCID,(SELECT   detail_name  FROM   constant_detail WHERE   category_id \= '37' AND TYPE \= RD.RS_ENDORSEMENT_TYPE) RS_ENDORSEMENT_TYPE,pi.COMPANY_NAME,rd.RSK_TREATYID,PIb.FIRST_NAME || ' ' || PIb.LAST_NAME BROKER,TO_CHAR (rd.RSK_MONTH, 'DD/MM/YYYY') MONTH,pb.TMAS_POL_BRANCH_NAME,rd.RSK_CONTRACT_NO,rd.RSK_UWYEAR,rd.RSK_UNDERWRITTER,TO_CHAR (rd.RSK_INCEPTION_DATE, 'DD/MM/YYYY') AS RSK_INCEPTION_DATE,TO_CHAR (rd.RSK_EXPIRY_DATE, 'DD/MM/YYYY') AS RSK_EXPIRY_DATE,TO_CHAR (rd.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') AS RSK_ACCOUNT_DATE,cm.CURRENCY_NAME,cm.SHORT_NAME,CM.CURRENCY_ID,rd.RSK_EXCHANGE_RATE,rd.RSK_BASIS,rd.RSK_PERIOD_OF_NOTICE,rd.RSK_RISK_COVERED,rd.RSK_TERRITORY_SCOPE,rd.RSK_TERRITORY,rd.RSK_STATUS,rd.RSK_LAYER_NO,TM.TERRITORY_DESC,UM.UNDERWRITTER,rd.MND_INSTALLMENTS,rd.RSK_RETRO_TYPE,rd.RETRO_CESSIONARIES,RD.RSK_BUSINESS_TYPE,RSK_NO_OF_LINE,RD.RSK_EXCHANGE_TYPE,RD.RSK_PERILS_COVERED,DECODE(RD.RSK_LOC_ISSUED,'Y','Yes','No') RSK_LOC_ISSUED,RD.RSK_UMBRELLA_XL,RD.RSK_RUN_OFF_YEAR,RD.RSK_LOC_BNK_NAME,RD.RSK_LOC_CRDT_PRD,RD.RSK_LOC_CRDT_AMT,RD.RSK_LOC_BENFCRE_NAME,(select detail_name from constant_detail where category_id \= '24' and type\= RD.INWARD_BUS_TYPE )INWARD_BUS_TYPE, (select detail_name from constant_detail where category_id \= '43' and type\= RD.TREATYTYPE )TREATYTYPE_NAME,RD.TREATYTYPE,(select detail_name from constant_detail where category_id \= '29' and CATEGORY_DETAIL_ID\= RD.RSK_BUSINESS_TYPE )RSK_BUSINESS_TYPE_Con,(select listagg(detail_name,', ') within group(order by detail_name) csv from constant_detail where category_id \= '30' and CATEGORY_DETAIL_ID in(select * from table(   split_text_fn( RD.RSK_PERILS_COVERED,',')))) RSK_PERILS_COVERED_Con,RD.COUNTRIES_INCLUDE,RD.COUNTRIES_EXCLUDE,RD.RSK_CESSION_EXG_RATE,RD.RSK_FIXED_RATE,DECODE(RD.RETENTIONYN,'Y','Yes','No') RETENTIONYN  FROM TTRN_RISK_DETAILS RD LEFT OUTER JOIN  TMAS_PFC_MASTER PFC ON PFC.TMAS_PFC_ID \= RD.RSK_PFCID AND PFC.BRANCH_CODE \= ?  LEFT OUTER JOIN  PERSONAL_INFO PIB  ON RD.RSK_BROKERID \= PIB.CUSTOMER_ID AND PIB.BRANCH_CODE \= ? LEFT OUTER JOIN  PERSONAL_INFO PI  ON RD.RSK_CEDINGID \= PI.CUSTOMER_ID  AND PI.BRANCH_CODE \= ? LEFT OUTER JOIN TMAS_POLICY_BRANCH PB ON RD.RSK_POLBRANCH \= PB.TMAS_POL_BRANCH_ID AND PB.BRANCH_CODE \= ? LEFT OUTER JOIN  CURRENCY_MASTER CM ON RD.RSK_ORIGINAL_CURR \= CM.CURRENCY_ID AND CM.BRANCH_CODE \= ? LEFT OUTER JOIN TERRITORY_MASTER TM  ON RD.RSK_TERRITORY \= TM.TERRITORY_CODE AND TM.BRANCH_CODE \= ? LEFT OUTER JOIN UNDERWRITTER_MASTER UM ON RD.RSK_UNDERWRITTER \= UM.UWR_CODE AND UM.BRANCH_CODE \= ? LEFT OUTER JOIN TMAS_DEPARTMENT_MASTER DM ON DM.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND DM.TMAS_DEPARTMENT_ID \= RD.RSK_DEPTID AND DM.BRANCH_CODE \= ? AND DM.TMAS_STATUS \= 'Y' WHERE  RD.RSK_PROPOSAL_NUMBER \= ? AND PIB.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PIB.CUSTOMER_ID AND BRANCH_CODE \= PIB.BRANCH_CODE) AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RD.RSK_ENDORSEMENT_NO \= ? AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID \= CM.CURRENCY_ID AND BRANCH_CODE \= CM.BRANCH_CODE)
risk.select.getSecondViewData=SELECT RSK_MD_INSTALLMENT_NOS,DECODE(RSK_CEDRET_TYPE,'P','Percentage','Amount') CEDRET_TYPE,RSK_LIMIT_OC,RSK_LIMIT_DC,RSK_EPI_OFFER_OC,RSK_EPI_OFFER_DC,RSK_EPI_ESTIMATE,RSK_XLPREM_OC,RSK_XLPREM_DC ,RSK_DEDUC_OC, RSK_EPI_EST_OC,RSK_EPI_EST_DC,RSK_XLCOST_OC,RSK_XLCOST_DC,RSK_CEDANT_RETENTION,RSK_SHARE_WRITTEN,RSK_SHARE_SIGNED,RSK_MD_PREM_OC,RSK_MD_PREM_DC,RSK_ADJRATE,RSK_PF_COVERED,RSK_SUBJ_PREMIUM_OC,RSK_SUBJ_PREMIUM_DC,RSK_DEDUC_DC, RSK_LIMIT_OS_OC, RSK_LIMIT_OS_DC,RSK_EPI_OSOF_OC, RSK_EPI_OSOF_DC,RSK_EPI_OSOE_OC,RSK_EPI_OSOE_DC, RSK_XLCOST_OS_OC, RSK_XLCOST_OS_DC, RSK_MD_PREM_OS_OC , RSK_MD_PREM_OS_DC,DECODE(RSK_SP_RETRO,'Y','Yes','No')  RSK_SP_RETRO,RSK_NO_OF_INSURERS,RSK_MAX_LMT_COVER,EGPNI_AS_OFFER,EGPNI_AS_OFFER_DC,OURASSESSMENT,RSK_TREATY_SURP_LIMIT_OC,RSK_TREATY_SURP_LIMIT_OS_OC,RSK_TREATY_SURP_LIMIT_OS_DC,RSK_EVENT_LIMIT_OC,RSK_EVENT_LIMIT_DC,RSK_EVENT_LIMIT_OS_OC,RSK_EVENT_LIMIT_OS_DC,RSK_COVER_LIMIT_UXL_OS_DC,RSK_DEDUCTABLE_UXL_OC,RSK_DEDUCTABLE_UXL_DC,RSK_DEDUCTABLE_UXL_OS_OC,RSK_DEDUCTABLE_UXL_OS_DC,DECODE(RSK_PML,'Y','Yes','No') RSK_PML,RSK_PML_PERCENT,RSK_EGNPI_PML_OC,RSK_EGNPI_PML_DC,RSK_EGNPI_PML_OS_OC,RSK_EGNPI_PML_OS_DC,RSK_PREMIUM_BASIS,RSK_MINIMUM_RATE,RSK_MAXIIMUM_RATE,RSK_BURNING_COST_LF,RSK_PAYMENT_DUE_DAYS,(select DETAIL_NAME from constant_detail where CATEGORY_ID\='31' and CATEGORY_DETAIL_ID\=RSK_PREMIUM_BASIS)RSK_PREMIUM_BASIS_Con, RSK_TRTY_LMT_PML_OS_OC, RSK_TRTY_LMT_PML_OS_DC,   RSK_TRTY_LMT_SUR_PML_DC, RSK_TRTY_LMT_SUR_PML_OS_OC, RSK_TRTY_LMT_SUR_PML_OS_DC,RSK_MINIMUM_PREMIUM_OC,RSK_MINIMUM_PREMIUM_DC,RSK_MINIMUM_PREMIUM_OS_OC,RSK_MINIMUM_PREMIUM_OS_DC,RSK_COVER_LIMIT_UXL_OC,RSK_COVER_LIMIT_UXL_DC,RSK_COVER_LIMIT_UXL_OS_OC,RSK_TRTY_LMT_PML_OC,RSK_TRTY_LMT_PML_DC,RSK_TRTY_LMT_SUR_PML_OC,RSK_TREATY_SURP_LIMIT_DC FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER\=?  AND RSK_ENDORSEMENT_NO \=?
risk.select.viewInstalmentData=SELECT INSTALLMENT_NO,TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') INSTALLMENT_DATE,MND_PREMIUM_OC,PAYEMENT_DUE_DAY FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO\=? AND LAYER_NO\=? AND ENDORSEMENT_NO\=? AND ENDORSEMENT_NO IS NOT NULL ORDER BY INSTALLMENT_NO
risk.select.getThirdPageData = SELECT   RC.RSK_COMMISSION_QS_YN,RC.RSK_COMMISSION_SUR_YN,RC.RSK_OVERRIDE_YN,RC.RSK_BROKARAGE_YN,RC.RSK_TAX_YN,RC.RSK_OTHER_COST_YN,RC.RSK_CEED_ODI_YN, RC.RSK_BROKERAGE,RC.RSK_INCLUDE_ACQ_COST,RC.RSK_OUR_ASS_ACQ_COST,RC.RSK_OUR_ACQ_OUR_SHARE_OC,  rc.RSK_BURNING_COST_PCT,rc.RSK_SLADSCALE_COMM,rc.RSK_LOSS_PART_CARRIDOR,  rc.RSK_REINSTATE_ADDL_PREM_PCT, RP.  RSK_PREMIUM_QUOTA_SHARE, RP.RSK_PREMIUM_SURPULS, comm_surplus_amt,   NVL (  ( ( (  NVL (RC.RSK_OVERRIDER_PERC, 0) + NVL (RC.RSK_COMM_QUOTASHARE, 0)+ NVL (RC.RSK_COMM_SURPLUS, 0)  +  NVL (RC.RSK_BROKERAGE, 0)  + NVL  (RC.RSK_TAX, 0) + NVL (RC.RSK_OTHER_COST, 0)) / 100) * RP.  RSK_EPI_EST_OC), 0) + NVL (RC.RSK_OUR_ASS_ACQ_COST, 0) OTHER_ACQ_COST_AMT  , round((NVL (( ( (  NVL (RC.  RSK_OVERRIDER_PERC, 0) +  NVL (RC.RSK_BROKERAGE, 0) + NVL (RC.RSK_COMM_QUOTASHARE, 0)+ NVL (RC.RSK_COMM_SURPLUS, 0)  + NVL (RC.RSK_TAX, 0)  + NVL (RC.RSK_OTHER_COST, 0)) / 100) * RP.RSK_EPI_EST_OC), 0 )+ NVL (RC.RSK_OUR_ASS_ACQ_COST, 0))/(  select rsk_exchange_rate  from ttrn_risk_details trd  where RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER  and RSK_ENDORSEMENT_NO=(  Select max(RSK_ENDORSEMENT_NO)  from ttrn_risk_details td  where trd.RSK_PROPOSAL_NUMBER=td.RSK_PROPOSAL_NUMBER)),2)   OTHER_ACQ_COST_AMT_UGX  ,RC.RSK_COMBIN_SUB_CLASS,RSK_TAX,RSK_PROFIT_COMM,  RSK_RESERVE_ON_LOSS,RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,  RSK_COMM_QUOTASHARE,RSK_COMM_SURPLUS,RSK_OVERRIDER_PERC,  RSK_PREMIUM_RESERVE,RSK_LOSS_RESERVE,RSK_INTEREST,RSK_PF_INOUT_PREM,  RSK_PF_INOUT_LOSS,RSK_LOSSADVICE, round(RSK_LOSSADVICE/(  select rsk_exchange_rate  from ttrn_risk_details trd  where RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER  and RSK_ENDORSEMENT_NO=(  Select max(RSK_ENDORSEMENT_NO)  from ttrn_risk_details td  where trd.RSK_PROPOSAL_NUMBER=td.RSK_PROPOSAL_NUMBER)),2)  RSK_LOSSADVICE_DC, RSK_CASHLOSS_LMT_OC, RSK_CASHLOSS_LMT_DC,  RSK_AGGREGATE_LIAB_OC,RSK_AGGREGATE_LIAB_DC, RSK_REINSTATE_NO,  RSK_REINSTATE_ADDL_PREM_OC, RSK_REINSTATE_ADDL_PREM_DC, (  SELECT   P.FIRST_NAME || ' ' || P.LAST_NAME  FROM   PERSONAL_INFO P  WHERE   P.BRANCH_CODE = ?  and CUSTOMER_ID=RSK_LEAD_UW  AND P.CUSTOMER_TYPE = 'L'  AND STATUS = 'Y'  AND P.AMEND_ID = (  SELECT   MAX (AMEND_ID)  FROM   PERSONAL_INFO  WHERE  BRANCH_CODE = P.BRANCH_CODE  AND CUSTOMER_TYPE = P.CUSTOMER_TYPE  AND STATUS = P.STATUS  AND CUSTOMER_ID = P.CUSTOMER_ID))RSK_LEAD_UW,RSK_LEAD_UW RSK_LEAD_UWID, RSK_LEAD_UW_SHARE,  RSK_ACCOUNTS, RSK_EXCLUSION,rc.RSK_REMARKS,RSK_UW_RECOMM,  RSK_GM_APPROVAL,RSK_DECISION, rc.RSK_ENTRY_DATE, rc.RSK_END_DATE,rc.  RSK_STATUS, RSK_OTHER_COST,RP.  LIMIT_PER_VESSEL_OC, RP.LIMIT_PER_VESSEL_DC, RP.LIMIT_PER_LOCATION_OC,  RP.LIMIT_PER_LOCATION_DC, RSK_PREMIUM_QUOTA_SHARE_DC,  RSK_PREMIUM_SURPLUS_DC, COMM_QS_AMT, COMM_QS_AMT_DC,  COMM_SURPLUS_AMT_DC,RC.RSK_AGGREGATE_DEDUCT_OC, RC.  RSK_AGGREGATE_DEDUCT_DC,RC.RSK_EVENT_LIMIT_OC,RC.RSK_EVENT_LIMIT_DC,RC.  RSK_AGGREGATE_LIMIT_OC,RC.RSK_AGGREGATE_LIMIT_DC,RC.  RSK_OCCURRENT_LIMIT_OC,RC.RSK_REINSTATEMENT_PREMIUM,RC.  RSK_CREASTA_STATUS,RC.RSK_LEAD_UNDERWRITER_COUNTRY,RC.  RSK_OCCURRENT_LIMIT_DC,RC.RSK_LOSS_COMBIN_SUB_CLASS,RC.  RSK_SLIDE_COMBIN_SUB_CLASS,RC.RSK_CRESTA_COMBIN_SUB_CLASS,RC.  RSK_PRO_MANAGEMENT_EXP, RC.RSK_PRO_COMM_TYPE, RC.RSK_PRO_COMM_PER, RC.  RSK_PRO_SET_UP, RC.RSK_PRO_SUP_PRO_COM, RC.RSK_PRO_LOSS_CARY_TYPE, RC.  RSK_PRO_LOSS_CARY_YEAR, RC.RSK_PRO_PROFIT_CARY_TYPE, RC.  RSK_PRO_PROFIT_CARY_YEAR,RC.RSK_NOCLAIMBONUS_PRCENT,RC.RSK_BONUS_ID , RC  .RSK_PRO_FIRST_PFO_COM, RC.RSK_PRO_FIRST_PFO_COM_PRD, RC.  RSK_PRO_SUB_PFO_COM_PRD, RC.RSK_PRO_SUB_PFO_COM, RC.RSK_PRO_SUB_SEQ_CAL,   RC.RSK_PRO_NOTES,RC.RSK_RATE,RC.  RSK_COMMISSION_TYPE,(  select to_char(endorsement_date,'DD/MM/YYYY')  from position_master pm  where pm.proposal_no=RP.RSK_PROPOSAL_NUMBER  and pm.amend_id=RP.RSK_ENDORSEMENT_NO) ENDT_DATE  FROM TTRN_RISK_PROPOSAL RP LEFT OUTER JOIN (  SELECT   *  FROM   TTRN_RISK_COMMISSION  WHERE   RSK_PROPOSAL_NUMBER = ?  AND RSK_ENDORSEMENT_NO = ?) RC ON RP.RSK_PROPOSAL_NUMBER = RC.  RSK_PROPOSAL_NUMBER  WHERE   RP.RSK_PROPOSAL_NUMBER =?  AND RP.RSK_ENDORSEMENT_NO =?
GET_POSITION_MASTER_CON_MAP =SELECT NVL(DATA_MAP_CONT_NO,'0') DATA_MAP_CONT_NO FROM POSITION_MASTER WHERE PROPOSAL_NO\=? AND AMEND_ID\=?
GET_MAPPING_PROPOSAL_NO =SELECT PROPOSAL_NO,AMEND_ID FROM POSITION_MASTER M WHERE M.CONTRACT_NO \=? AND M.LAYER_NO\=? AND M.DEPT_ID\=? AND M.UW_YEAR\=? AND M.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER P WHERE P.PROPOSAL_NO\=M.PROPOSAL_NO AND P.CONTRACT_NO\=M.CONTRACT_NO AND P.LAYER_NO\=M.LAYER_NO)
GET_BASE_LAYER_DETAILS=SELECT PROPOSAL_NO,BASE_LAYER,CONTRACT_NO,CONTRACT_STATUS FROM POSITION_MASTER PM WHERE PRODUCT_ID=? AND BRANCH_CODE=? AND PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)

common.select.getPRoductListIE=SELECT DISTINCT '1~'||TMAS_PRODUCT_ID TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER WHERE TMAS_STATUS\='1' AND BRANCH_CODE\=? AND TMAS_PRODUCT_ID IN ('1','2','3')order by TMAS_PRODUCT_ID
GET_PRODUCTION_MODULE_DROPDOWN=SELECT DISTINCT '1~'||TMAS_PRODUCT_ID TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER WHERE TMAS_STATUS\='1' AND BRANCH_CODE\=? AND TMAS_PRODUCT_ID IN ('1','2','3')AND TMAS_PRODUCT_ID IN(Select ITEM_TYPE from TTRN_IE_MODULE where PROPOSAL_NO=? and TRANSACTION_NO=? and ITEM_NO='1' and ITEM_INCLUSION_EXCLUSION=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE TI.PROPOSAL_NO=PROPOSAL_NO AND TI.TRANSACTION_NO = ? AND TI.ITEM_NO = ITEM_NO AND TI.ITEM_INCLUSION_EXCLUSION = ITEM_INCLUSION_EXCLUSION ))order by TMAS_PRODUCT_ID
common.select.getConstDetie=SELECT DISTINCT '2~'||TYPE TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=?ORDER BY DETAIL_NAME 
GET_INWARD_BUSINESS_TYPE_DROPDOWN =SELECT DISTINCT '2~'||TYPE TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? AND TYPE IN(Select ITEM_TYPE from TTRN_IE_MODULE where PROPOSAL_NO=? and TRANSACTION_NO=? and ITEM_NO='2' and ITEM_INCLUSION_EXCLUSION=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE TI.PROPOSAL_NO=PROPOSAL_NO AND TI.TRANSACTION_NO = ? AND TI.ITEM_NO = ITEM_NO AND TI.ITEM_INCLUSION_EXCLUSION = ITEM_INCLUSION_EXCLUSION ))ORDER BY DETAIL_NAME
common.select.getConstDetie1=SELECT DISTINCT '6~'||TYPE TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? ORDER BY DETAIL_NAME
GET_TREATY_TYPE_DROPDOWN=SELECT DISTINCT '6~'||TYPE TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? AND TYPE IN(Select ITEM_TYPE from TTRN_IE_MODULE where PROPOSAL_NO=? and TRANSACTION_NO=? and ITEM_NO='6' and ITEM_INCLUSION_EXCLUSION=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE TI.PROPOSAL_NO=PROPOSAL_NO AND TI.TRANSACTION_NO = ? AND TI.ITEM_NO = ITEM_NO AND TI.ITEM_INCLUSION_EXCLUSION = ITEM_INCLUSION_EXCLUSION ))ORDER BY DETAIL_NAME
common.select.getProfitCenterListIE=SELECT DISTINCT '3~'||TMAS_PFC_ID TMAS_PFC_ID ,TMAS_PFC_NAME,PRODUTID   FROM TMAS_PFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_STATUS=? ORDER BY TMAS_PFC_NAME ASC
GET_PROFIT_CENTREIE_MODULE_DROPDOWN=SELECT DISTINCT '3~'||TMAS_PFC_ID TMAS_PFC_ID ,TMAS_PFC_NAME,PRODUTID   FROM TMAS_PFC_MASTER WHERE  BRANCH_CODE=? AND TMAS_STATUS=? AND TMAS_PFC_ID IN  (Select ITEM_TYPE from TTRN_IE_MODULE where PROPOSAL_NO=? and TRANSACTION_NO=? and ITEM_NO='3' and ITEM_INCLUSION_EXCLUSION=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE TI.PROPOSAL_NO=PROPOSAL_NO AND TI.TRANSACTION_NO = ? AND TI.ITEM_NO = ITEM_NO AND TI.ITEM_INCLUSION_EXCLUSION = ITEM_INCLUSION_EXCLUSION )) ORDER BY TMAS_PFC_NAME ASC
common.select.getDepartListIE=SELECT   DISTINCT '4~'||TMAS_DEPARTMENT_ID TMAS_DEPARTMENT_ID, TMAS_DEPARTMENT_NAME FROM   TMAS_DEPARTMENT_MASTER WHERE   BRANCH_CODE = ? AND TMAS_PRODUCT_ID in('1','2','3') AND TMAS_STATUS = ?
GET_DEPARTMENTIE_MODULE_DROPDOWN=SELECT   DISTINCT '4~'||TMAS_DEPARTMENT_ID TMAS_DEPARTMENT_ID, TMAS_DEPARTMENT_NAME FROM   TMAS_DEPARTMENT_MASTER WHERE   BRANCH_CODE = ? AND TMAS_PRODUCT_ID in('1','2','3') AND TMAS_STATUS = ?  AND TMAS_DEPARTMENT_ID IN (Select ITEM_TYPE from TTRN_IE_MODULE where PROPOSAL_NO=? and TRANSACTION_NO=? and ITEM_NO='4' and ITEM_INCLUSION_EXCLUSION=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE TI.PROPOSAL_NO=PROPOSAL_NO AND TI.TRANSACTION_NO = ? AND TI.ITEM_NO = ITEM_NO AND TI.ITEM_INCLUSION_EXCLUSION = ITEM_INCLUSION_EXCLUSION ))ORDER BY   TMAS_DEPARTMENT_NAME ASC
GET_PROPO_STATUS = SELECT PROPOSAL_NO,CONTRACT_STATUS FROM POSITION_MASTER P WHERE PROPOSAL_NO IN (''{0}'') AND  PRODUCT_ID IN (''1'',''2'',''3'') AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO =P.PROPOSAL_NO)
GET_EXCLUDE_PROPOSAL =SELECT   ITEM_TYPE FROM   TTRN_IE_MODULE TI WHERE   PROPOSAL_NO = ? AND TRANSACTION_NO = ? AND BRANCH_CODE = ? AND ITEM_INCLUSION_EXCLUSION = 'E'  AND ITEM_NO ='7' AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TTRN_IE_MODULE  WHERE    TI.PROPOSAL_NO = PROPOSAL_NO AND TI.TRANSACTION_NO = TRANSACTION_NO AND TI.BRANCH_CODE = BRANCH_CODE AND TI.ITEM_INCLUSION_EXCLUSION =  ITEM_INCLUSION_EXCLUSION AND ITEM_NO='7') 
common.select.getConstDet=SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? and CATEGORY_DETAIL_ID !='7'ORDER BY TYPE
GET_CONSTANT_DROPDOWN_BUSINESS_TYPE1=SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? and  CATEGORY_DETAIL_ID !='2'ORDER BY TYPE


COMMON_SELECT_GETCONSTDET_BASIC =SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=?  ORDER BY TYPE
GET_CONSTANT_DROPDOWN_BASIS=SELECT DISTINCT TYPE,DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=? AND STATUS\=? and CATEGORY_DETAIL_ID!='3'  ORDER BY TYPE
DUPLICATE_COUNT_CHECK =SELECT COUNT(PROPOSAL_NO) FROM  POSITION_MASTER WHERE UW_YEAR\=? AND BRANCH_CODE\=? and PRODUCT_ID\=? and RSK_DUMMY_CONTRACT\=? and PROPOSAL_STATUS\='A' and CONTRACT_STATUS\='A'
DUPLICATE_COUNT_CHECK1=SELECT COUNT(PROPOSAL_NO) FROM  POSITION_MASTER WHERE UW_YEAR\=? AND BRANCH_CODE\=? and PRODUCT_ID\=? and RSK_DUMMY_CONTRACT\=? and PROPOSAL_STATUS\='A' and CONTRACT_STATUS\='A'and PROPOSAL_NO !=?
GET_CRESTA_DATE =SELECT M.CRESTA_ID,M.CRESTA_NAME,COUNTRY_NAME FROM TMAS_CRESTA_MASTER M,COUNTRY_MASTER C WHERE M.BRANCH_CODE\=? AND M.STATUS\='Y' AND C.COUNTRY_ID\=M.TERITORY_CODE AND C.BRANCH_CODE\=? AND C.STATUS\='Y'
GET_UG_UNDERWRITER=SELECT   P.FIRST_NAME || ' ' || P.LAST_NAME  RSK_LEAD_UW_UG FROM   PERSONAL_INFO P WHERE  P.BRANCH_CODE \= ? AND CUSTOMER_ID \= ? AND STATUS \= 'Y' AND P.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE BRANCH_CODE \= P.BRANCH_CODE AND CUSTOMER_TYPE \= P.CUSTOMER_TYPE AND STATUS \= P.STATUS AND CUSTOMER_ID \= P.CUSTOMER_ID)
risk.select.getDtlName=SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID='6' AND STATUS='Y' AND CATEGORY_DETAIL_ID=?
select_TERRITORY_NAME = SELECT   RTRIM(XMLAGG(XMLELEMENT(E,TERRITORY_NAME,',')).EXTRACT('//text()'),',') TERRITORY_NAME FROM   TMAS_TERRITORY  WHERE  TERRITORY_ID in ? and BRANCH_CODE=?
select_COUNTRY_NAME = SELECT   RTRIM(XMLAGG(XMLELEMENT(E,COUNTRY_NAME,',')).EXTRACT('//text()'),',') COUNTRY_NAME FROM   country_master  WHERE  COUNTRY_ID in ? and BRANCH_CODE=?
select_COUNTRY_NAME1 = SELECT   RTRIM(XMLAGG(XMLELEMENT(E,COUNTRY_NAME,',')).EXTRACT('//text()'),',') COUNTRY_NAME FROM   country_master  WHERE  COUNTRY_ID in ? and BRANCH_CODE=?
GET_REMARKS_DETAILS= SELECT  RSK_SNO,RSK_DESCRIPTION,RSK_REMARK1,RSK_REMARK2 FROM TTRN_RISK_REMARKS TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RISK_REMARKS WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO) order by RSK_SNO
SUM_COVER_LIMT = WITH T1  AS (SELECT   SUM (RSK_COVER_LIMT) sum_rsk  FROM   TTRN_RSK_CLASS_LIMITS R  WHERE   R.RSK_PROPOSAL_NUMBER = ?  AND R.BRANCH_CODE = ?  AND R.RSK_LAYER_NO = ?  and R.RSK_PRODUCTID = ?  AND RSK_ENDORSEMENT_NO =   (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RSK_CLASS_LIMITS L  WHERE   L.RSK_PROPOSAL_NUMBER =  R.RSK_PROPOSAL_NUMBER  AND L.BRANCH_CODE = R.BRANCH_CODE   AND R.RSK_LAYER_NO = L.RSK_LAYER_NO and R.RSK_PRODUCTID = L.RSK_PRODUCTID)),  t2 AS (SELECT   COUNT ( * ) + 1 AS cnt  FROM   TTRN_RIP T  WHERE T.BRANCH_CODE = ?   AND T.PROPOSAL_NO = ?  and T.PRODUCT_ID =?       AND T.SECTION_TYPE='A'    AND T.AMEND_ID = (SELECT   MAX (AMEND_ID)  FROM   TTRN_RIP P  WHERE P.BRANCH_CODE = T.BRANCH_CODE   AND P.PROPOSAL_NO = T.PROPOSAL_NO   AND P.LAYER_NO = T.LAYER_NO   and P.PRODUCT_ID = T.PRODUCT_ID AND T.SECTION_TYPE='A')) SELECT   sum_rsk * cnt SUM_VAL   FROM   t1, t2
risk.select.getBrokerage=SELECT RSK_BROKERAGE,RSK_TAX FROM TTRN_RISK_COMMISSION WHERE RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?) AND RSK_PROPOSAL_NUMBER=?
fac.select.viewInsDetails=SELECT   DECODE(A.CONTRACT_NO,'0','',A.CONTRACT_NO) CONTRACTNO,A.RETRO_PERCENTAGE RETRO_PER,TYPE,UW_YEAR,RETRO_TYPE FROM TTRN_INSURER_DETAILS A WHERE A.ENDORSEMENT_NO =?  AND A.PROPOSAL_NO = ?  AND A.INSURER_NO BETWEEN 0 AND ? ORDER BY A.INSURER_NO
fac.select.insDetails=SELECT   DECODE(A.CONTRACT_NO,'0','',A.CONTRACT_NO) CONTRACTNO,A.RETRO_PERCENTAGE RETRO_PER,TYPE,UW_YEAR,RETRO_TYPE FROM TTRN_INSURER_DETAILS A WHERE A.ENDORSEMENT_NO = (SELECT   MAX (ENDORSEMENT_NO) FROM   TTRN_INSURER_DETAILS WHERE   A.PROPOSAL_NO=PROPOSAL_NO AND A.INSURER_NO=INSURER_NO) AND A.PROPOSAL_NO = ?  AND A.INSURER_NO BETWEEN 0 AND ? ORDER BY A.INSURER_NO
FAC_SELECT_RETROCONTDET_23=SELECT A.CONTRACT_NO,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET1,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET2 FROM POSITION_MASTER A WHERE  A.PRODUCT_ID = ? AND A.CONTRACT_STATUS ='A' AND A.CONTRACT_NO IS NOT NULL AND A.CONTRACT_NO !='0' AND  NVL(A.RETRO_TYPE,'N') ! ='SR'  AND A.UW_YEAR =  ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(A.EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = ? AND A.RSK_DUMMY_CONTRACT ='N' AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE A.PRODUCT_ID=PRODUCT_ID AND A.CONTRACT_NO = CONTRACT_NO  AND NVL(A.RETRO_TYPE,'N') ! ='SR' AND A.UW_YEAR = ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = BRANCH_CODE AND A.RSK_DUMMY_CONTRACT ='N') ORDER BY A.CONTRACT_NO
risk.select.getRskProIdByProNo=SELECT RD.RSK_PRODUCTID FROM TTRN_RISK_DETAILS RD WHERE  RD.RSK_PROPOSAL_NUMBER=? AND  RD.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER= RD.RSK_PROPOSAL_NUMBER)
risk.select.getRetroCessDtls=SELECT A.SNO,A.CEDING_COMPANY_ID,A.BROKER_ID,A.SHARE_ACCEPTED,A.SHARE_SIGNED,A.COMISSION,A.PROPOSAL_STATUS FROM TTRN_RETRO_CESSIONARY A WHERE AMEND_ID = (SELECT MAX (AMEND_ID) FROM  TTRN_RETRO_CESSIONARY WHERE  A.PROPOSAL_NO = PROPOSAL_NO AND A.SNO=SNO) AND A.PROPOSAL_NO=? AND A.SNO BETWEEN 0 AND ? ORDER BY SNO
risk.select.viewRetroCessDtls=SELECT A.SNO,A.CEDING_COMPANY_ID,A.BROKER_ID,A.SHARE_ACCEPTED,A.SHARE_SIGNED,A.COMISSION,A.PROPOSAL_STATUS FROM TTRN_RETRO_CESSIONARY A WHERE AMEND_ID = ? AND A.PROPOSAL_NO=? AND A.SNO BETWEEN 0 AND ? ORDER BY SNO
update.RSK_LAYER_NO = UPDATE ttrn_risk_details SET RSK_LAYER_NO=? WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=?
DELETE_CLASS_LIMIT=DELETE TTRN_RSK_CLASS_LIMITS TRCL WHERE RSK_PROPOSAL_NUMBER=?  and RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) from TTRN_RSK_CLASS_LIMITS where  RSK_PROPOSAL_NUMBER=TRCL.RSK_PROPOSAL_NUMBER)
INSERT_CLASS_LIMIT=INSERT INTO TTRN_RSK_CLASS_LIMITS(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_CONTRACT_NO,RSK_LAYER_NO,RSK_PRODUCTID,RSK_COVER_CLASS,RSK_COVER_LIMT,RSK_COVER_LIMT_PERCENTAGE,RSK_DEDUCTABLE_LIMT,RSK_DEDUCTABLE_PERCENTAGE,ENTRY_DATE,BRANCH_CODE,STATUS,RSK_SNO,RSK_EGNPI_AS_OFF,RSK_GNPI_AS_OFF)values(?,?,?,?,?,?,?,?,?,?,sysdate,?,'Y',?,?,?)
risk.select.maxEndom=SELECT MAX(RSK_ENDORSEMENT_NO) RSK_ENDORSEMENT_NO FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?
risk.update.pro35FirPageRskPro=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OC=?,RSK_LIMIT_DC=?,RSK_EPI_EST_OC=?,RSK_EPI_EST_DC=?,RSK_SHARE_WRITTEN=?,RSK_SHARE_SIGNED=?,RSK_MAX_LMT_COVER=?,RSK_SUBJ_PREMIUM_OC=?,RSK_SUBJ_PREMIUM_DC=?,RSK_XLPREM_OC=?,RSK_XLPREM_DC=?,RSK_PF_COVERED=?,RSK_DEDUC_OC=?,RSK_DEDUC_DC=?,RSK_MD_PREM_OC=?,RSK_MD_PREM_DC=?,RSK_ADJRATE=?,RSK_SP_RETRO=?,RSK_NO_OF_INSURERS=?,RSK_LIMIT_OS_OC=?,RSK_LIMIT_OS_DC=?,RSK_EPI_OSOF_OC=?,RSK_EPI_OSOF_DC=?,RSK_MD_PREM_OS_OC=?,RSK_MD_PREM_OS_DC=?,LIMIT_PER_VESSEL_OC=?,LIMIT_PER_VESSEL_DC=?,LIMIT_PER_LOCATION_OC=?,LIMIT_PER_LOCATION_DC=?,EGPNI_AS_OFFER=?,OURASSESSMENT=? ,EGPNI_AS_OFFER_DC=?,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RSK_PROPOSAL_NUMBER =?  AND RSK_ENDORSEMENT_NO=?
RISK_LAYER_UPDATE =UPDATE TTRN_RISK_PROPOSAL SET RSK_LAYER_NO\=? WHERE RSK_PROPOSAL_NUMBER \=? AND RSK_ENDORSEMENT_NO\=?
GET_SUM_INSTALLMENT_BOOKED=SELECT SUM(MND_PREMIUM_OC) MND_PREMIUM_OC FROM  TTRN_MND_INSTALLMENTS TMI WHERE  CONTRACT_NO = ? AND LAYER_NO = ? AND TRANSACTION_NO IS NOT NULL  AND ENDORSEMENT_NO = (SELECT   MAX (ENDORSEMENT_NO) FROM   TTRN_MND_INSTALLMENTS  WHERE   CONTRACT_NO = TMI.CONTRACT_NO AND LAYER_NO = TMI.LAYER_NO AND TRANSACTION_NO IS NOT NULL)
GET_COUNT_INSTALLMENT_BOOKED=SELECT COUNT(*) COUNT FROM  TTRN_MND_INSTALLMENTS TMI WHERE  CONTRACT_NO \= ? AND LAYER_NO \= ? AND TRANSACTION_NO IS NOT NULL  AND ENDORSEMENT_NO \= (SELECT   MAX (ENDORSEMENT_NO) FROM   TTRN_MND_INSTALLMENTS  WHERE   CONTRACT_NO \= TMI.CONTRACT_NO AND LAYER_NO \= TMI.LAYER_NO AND TRANSACTION_NO IS NOT NULL)
risk.select.getLayerDupcheckByBaseLayer=SELECT LAYER_NO  FROM POSITION_MASTER WHERE  LAYER_NO=? AND BASE_LAYER=?
risk.select.getLayerDupcheckByProNo=SELECT LAYER_NO FROM POSITION_MASTER PM WHERE  LAYER_NO=? AND PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
fac.select.getRenewalValidation=SELECT PM.UW_YEAR,TO_CHAR(PM.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,TO_DATE(?,'DD/MM/YYYY')-TO_DATE(TO_CHAR(PM.EXPIRY_DATE,'DD/MM/YYYY'),'DD/MM/YYYY') DIFF FROM POSITION_MASTER PM WHERE PM.CONTRACT_NO=? AND PM.RENEWAL_STATUS='0' AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO AND RENEWAL_STATUS=PM.RENEWAL_STATUS) ORDER BY PM.UW_YEAR DESC
risk.select.getCommonData=SELECT RD.RSK_INSURED_NAME,RD.RS_ENDORSEMENT_TYPE,RD.RSK_DEPTID,DM.TMAS_DEPARTMENT_NAME,(select detail_name from constant_detail where category_id \= '4' and type\= rd.RSK_PROPOSAL_TYPE ) proposal_type,(select detail_name from constant_detail where category_id\= '5' and type\= rd.RSK_ACCOUNTING_PERIOD ) accounting_period,rd.RSK_RECEIPT_STATEMENT,rd.RSK_RECEIPT_PAYEMENT, rd.RSK_PROPOSAL_NUMBER,PFC.TMAS_PFC_NAME,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE \= RD.BRANCH_CODE) TMAS_SPFC_NAME,RD.RSK_SPFCID,pi.COMPANY_NAME,rd.RSK_TREATYID,PIb.FIRST_NAME || ' ' || PIb.LAST_NAME BROKER,TO_CHAR (rd.RSK_MONTH, 'DD/MM/YYYY') MONTH,pb.TMAS_POL_BRANCH_NAME,rd.RSK_CONTRACT_NO,rd.RSK_UWYEAR,rd.RSK_UNDERWRITTER,TO_CHAR (rd.RSK_INCEPTION_DATE, 'DD/MM/YYYY') AS RSK_INCEPTION_DATE,TO_CHAR (rd.RSK_EXPIRY_DATE, 'DD/MM/YYYY') AS RSK_EXPIRY_DATE,TO_CHAR (rd.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') AS RSK_ACCOUNT_DATE,cm.CURRENCY_NAME,cm.SHORT_NAME,CM.CURRENCY_ID,rd.RSK_EXCHANGE_RATE,rd.RSK_BASIS,rd.RSK_PERIOD_OF_NOTICE,rd.RSK_RISK_COVERED,rd.RSK_TERRITORY_SCOPE,rd.RSK_TERRITORY,rd.RSK_STATUS,rd.RSK_LAYER_NO,TM.TERRITORY_DESC,UM.UNDERWRITTER,rd.MND_INSTALLMENTS,rd.RSK_RETRO_TYPE,rd.RETRO_CESSIONARIES,RD.RSK_BUSINESS_TYPE,RSK_NO_OF_LINE,RD.RSK_EXCHANGE_TYPE,RD.RSK_PERILS_COVERED,DECODE(RD.RSK_LOC_ISSUED,'Y','Yes','No')  RSK_LOC_ISSUED,decode(RD.RSK_UMBRELLA_XL,'Y','Yes','No') RSK_UMBRELLA_XL,RD.RSK_RUN_OFF_YEAR,RD.RSK_LOC_BNK_NAME,RD.RSK_LOC_CRDT_PRD,RD.RSK_LOC_CRDT_AMT,RD.RSK_LOC_BENFCRE_NAME,(select detail_name from constant_detail where category_id \= '24' and type\= RD.INWARD_BUS_TYPE )INWARD_BUS_TYPE, (select detail_name from constant_detail where category_id \= '25' and type\= RD.TREATYTYPE )TREATYTYPE,RD.TREATYTYPE TREATYTYPEID,(select detail_name from constant_detail where category_id \= '29' and CATEGORY_DETAIL_ID\= RD.RSK_BUSINESS_TYPE )RSK_BUSINESS_TYPE_Con,(select listagg(detail_name,', ') within group(order by detail_name) csv from constant_detail where category_id \= '30' and CATEGORY_DETAIL_ID in(select * from table(   split_text_fn( RD.RSK_PERILS_COVERED,',')))) RSK_PERILS_COVERED_Con,RD.COUNTRIES_INCLUDE,RD.COUNTRIES_EXCLUDE,RD.RSK_CESSION_EXG_RATE,RD.RSK_FIXED_RATE  FROM TTRN_RISK_DETAILS RD LEFT OUTER JOIN  TMAS_PFC_MASTER PFC ON PFC.TMAS_PFC_ID \= RD.RSK_PFCID AND PFC.BRANCH_CODE \= ?  LEFT OUTER JOIN  PERSONAL_INFO PIB  ON RD.RSK_BROKERID \= PIB.CUSTOMER_ID AND PIB.BRANCH_CODE \= ? LEFT OUTER JOIN  PERSONAL_INFO PI  ON RD.RSK_CEDINGID \= PI.CUSTOMER_ID  AND PI.BRANCH_CODE \= ? LEFT OUTER JOIN TMAS_POLICY_BRANCH PB ON RD.RSK_POLBRANCH \= PB.TMAS_POL_BRANCH_ID AND PB.BRANCH_CODE \= ? LEFT OUTER JOIN  CURRENCY_MASTER CM ON RD.RSK_ORIGINAL_CURR \= CM.CURRENCY_ID AND CM.BRANCH_CODE \= ? LEFT OUTER JOIN TERRITORY_MASTER TM  ON RD.RSK_TERRITORY \= TM.TERRITORY_CODE AND TM.BRANCH_CODE \= ? LEFT OUTER JOIN UNDERWRITTER_MASTER UM ON RD.RSK_UNDERWRITTER \= UM.UWR_CODE AND UM.BRANCH_CODE \= ? LEFT OUTER JOIN TMAS_DEPARTMENT_MASTER DM ON DM.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND DM.TMAS_DEPARTMENT_ID \= RD.RSK_DEPTID AND DM.BRANCH_CODE \= ? AND DM.TMAS_STATUS \= 'Y' WHERE  RD.RSK_PROPOSAL_NUMBER \= ? AND PIB.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PIB.CUSTOMER_ID AND BRANCH_CODE \= PIB.BRANCH_CODE) AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RD.RSK_ENDORSEMENT_NO \= ? AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID \= CM.CURRENCY_ID AND BRANCH_CODE \= CM.BRANCH_CODE)
risk.select.getEditModeDataPro3=SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID,DE.RSK_POLBRANCH, DE.RSK_CEDINGID,DE.RSK_BROKERID, DE.RSK_TREATYID,TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_TERRITORY_SCOPE,DE.RSK_TERRITORY,DE.RSK_STATUS,PR.RSK_LIMIT_OC,PR.RSK_EPI_EST_OC,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,PR. RSK_MAX_LMT_COVER,PR.RSK_SUBJ_PREMIUM_OC,PR.RSK_XLPREM_OC ,PR.RSK_DEDUC_OC,RSK_MD_PREM_OC , RSK_ADJRATE ,RSK_PF_COVERED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.MND_INSTALLMENTS,DE.RETRO_CESSIONARIES,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,EGPNI_AS_OFFER,OURASSESSMENT,DE.INWARD_BUS_TYPE,DE.RSK_BUSINESS_TYPE,DE.RSK_EXCHANGE_TYPE,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED,DE.RSK_UMBRELLA_XL,PR.RSK_EVENT_LIMIT_OC,PR.RSK_COVER_LIMIT_UXL_OC,PR.RSK_DEDUCTABLE_UXL_OC,PR.RSK_PML,PR.RSK_PML_PERCENT,PR.RSK_EGNPI_PML_OC,PR.RSK_PREMIUM_BASIS,PR.RSK_MINIMUM_RATE,PR.RSK_MAXIIMUM_RATE,PR.RSK_BURNING_COST_LF,PR.RSK_MINIMUM_PREMIUM_OC,PR.RSK_PAYMENT_DUE_DAYS,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RS_ENDORSEMENT_TYPE,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PR.RSK_MINIMUM_PREMIUM_OC,PR.RSK_MINIMUM_PREMIUM_DC,PR.RSK_MINIMUM_PREMIUM_OS_OC,PR.RSK_MINIMUM_PREMIUM_OS_DC,PR.RSK_COVER_LIMIT_UXL_OC,PR.RSK_COVER_LIMIT_UXL_DC,PR.RSK_COVER_LIMIT_UXL_OS_OC,PR.RSK_COVER_LIMIT_UXL_OS_DC,PR.RSK_DEDUCTABLE_UXL_OC,PR.RSK_DEDUCTABLE_UXL_DC,PR.RSK_DEDUCTABLE_UXL_OS_OC,PR.RSK_DEDUCTABLE_UXL_OS_DC,PM.BASE_LAYER,PM.DATA_MAP_CONT_NO,PM.Bouquet_Mode_YN,PM.Bouquet_No,PM.UW_YEAR_TO,PR.PAYMENT_PARTNER,PR.RATE_ON_LINE,PR.INTALL_DET_YN,PR.ACQCOST_DET_YN,PR.REINST_DET_YN,PR.RISK_DET_YN,PR.BROKER_DET_YN,PR.PREMIUM_DET_YN,PM.OFFER_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM
risk.select.getEditModeDataPro3ContCond=WHERE DE.RSK_CONTRACT_NO=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(B.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL B, TTRN_RISK_DETAILS A WHERE A.RSK_CONTRACT_NO=? AND A.RSK_PROPOSAL_NUMBER=B.RSK_PROPOSAL_NUMBER ) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM position_master WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeDataPro3ContCond1=SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID,DE.RSK_POLBRANCH, DE.RSK_CEDINGID,DE.RSK_BROKERID, DE.RSK_TREATYID,TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_TERRITORY_SCOPE,DE.RSK_TERRITORY,DE.RSK_STATUS,PR.RSK_LIMIT_OC,PR.RSK_EPI_EST_OC,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,PR. RSK_MAX_LMT_COVER,PR.RSK_SUBJ_PREMIUM_OC,PR.RSK_XLPREM_OC ,PR.RSK_DEDUC_OC,RSK_MD_PREM_OC , RSK_ADJRATE ,RSK_PF_COVERED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.MND_INSTALLMENTS,DE.RETRO_CESSIONARIES,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,EGPNI_AS_OFFER,OURASSESSMENT,DE.INWARD_BUS_TYPE,DE.RSK_BUSINESS_TYPE,DE.RSK_EXCHANGE_TYPE,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED,DE.RSK_UMBRELLA_XL,PR.RSK_EVENT_LIMIT_OC,PR.RSK_COVER_LIMIT_UXL_OC,PR.RSK_DEDUCTABLE_UXL_OC,PR.RSK_PML,PR.RSK_PML_PERCENT,PR.RSK_EGNPI_PML_OC,PR.RSK_PREMIUM_BASIS,PR.RSK_MINIMUM_RATE,PR.RSK_MAXIIMUM_RATE,PR.RSK_BURNING_COST_LF,PR.RSK_MINIMUM_PREMIUM_OC,PR.RSK_PAYMENT_DUE_DAYS,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RS_ENDORSEMENT_TYPE,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PR.RSK_MINIMUM_PREMIUM_OC,PR.RSK_MINIMUM_PREMIUM_DC,PR.RSK_MINIMUM_PREMIUM_OS_OC,PR.RSK_MINIMUM_PREMIUM_OS_DC,PR.RSK_COVER_LIMIT_UXL_OC,PR.RSK_COVER_LIMIT_UXL_DC,PR.RSK_COVER_LIMIT_UXL_OS_OC,PR.RSK_COVER_LIMIT_UXL_OS_DC,PR.RSK_DEDUCTABLE_UXL_OC,PR.RSK_DEDUCTABLE_UXL_DC,PR.RSK_DEDUCTABLE_UXL_OS_OC,PR.RSK_DEDUCTABLE_UXL_OS_DC,PM.BASE_LAYER,PM.DATA_MAP_CONT_NO,PM.Bouquet_Mode_YN,PM.Bouquet_No,PM.UW_YEAR_TO,PR.PAYMENT_PARTNER,PR.RATE_ON_LINE,PR.INTALL_DET_YN,PR.ACQCOST_DET_YN,PR.REINST_DET_YN,PR.RISK_DET_YN,PR.BROKER_DET_YN,PR.PREMIUM_DET_YN,PM.OFFER_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM WHERE DE.RSK_CONTRACT_NO=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(B.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL B, TTRN_RISK_DETAILS A WHERE A.RSK_CONTRACT_NO=? AND A.RSK_PROPOSAL_NUMBER=B.RSK_PROPOSAL_NUMBER ) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM position_master WHERE PROPOSAL_NO=PM.PROPOSAL_NO)

risk.select.getEditModeDataPro3ProCond=WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL  WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM position_master WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeDataPro3ProCond1=SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID,DE.RSK_POLBRANCH, DE.RSK_CEDINGID,DE.RSK_BROKERID, DE.RSK_TREATYID,TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_TERRITORY_SCOPE,DE.RSK_TERRITORY,DE.RSK_STATUS,PR.RSK_LIMIT_OC,PR.RSK_EPI_EST_OC,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,PR. RSK_MAX_LMT_COVER,PR.RSK_SUBJ_PREMIUM_OC,PR.RSK_XLPREM_OC ,PR.RSK_DEDUC_OC,RSK_MD_PREM_OC , RSK_ADJRATE ,RSK_PF_COVERED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.MND_INSTALLMENTS,DE.RETRO_CESSIONARIES,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,EGPNI_AS_OFFER,OURASSESSMENT,DE.INWARD_BUS_TYPE,DE.RSK_BUSINESS_TYPE,DE.RSK_EXCHANGE_TYPE,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED,DE.RSK_UMBRELLA_XL,PR.RSK_EVENT_LIMIT_OC,PR.RSK_PML,PR.RSK_PML_PERCENT,PR.RSK_EGNPI_PML_OC,PR.RSK_PREMIUM_BASIS,PR.RSK_MINIMUM_RATE,PR.RSK_MAXIIMUM_RATE,PR.RSK_BURNING_COST_LF,PR.RSK_PAYMENT_DUE_DAYS,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RS_ENDORSEMENT_TYPE,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PR.RSK_MINIMUM_PREMIUM_OC,PR.RSK_MINIMUM_PREMIUM_DC,PR.RSK_MINIMUM_PREMIUM_OS_OC,PR.RSK_MINIMUM_PREMIUM_OS_DC,PR.RSK_COVER_LIMIT_UXL_OC,PR.RSK_COVER_LIMIT_UXL_DC,PR.RSK_COVER_LIMIT_UXL_OS_OC,PR.RSK_COVER_LIMIT_UXL_OS_DC,PR.RSK_DEDUCTABLE_UXL_OC,PR.RSK_DEDUCTABLE_UXL_DC,PR.RSK_DEDUCTABLE_UXL_OS_OC,PR.RSK_DEDUCTABLE_UXL_OS_DC,PM.BASE_LAYER,PM.DATA_MAP_CONT_NO,PM.Bouquet_Mode_YN,PM.Bouquet_No,PM.UW_YEAR_TO,PR.PAYMENT_PARTNER,PR.RATE_ON_LINE,PR.INTALL_DET_YN,PR.ACQCOST_DET_YN,PR.REINST_DET_YN,PR.RISK_DET_YN,PR.BROKER_DET_YN,PR.PREMIUM_DET_YN,PM.OFFER_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL  WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM position_master WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeDataPro3ProCond=WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL  WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM position_master WHERE PROPOSAL_NO=PM.PROPOSAL_NO)

fac.select.retroContDetTR=SELECT A.CONTRACT_NO,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET1,CASE WHEN A.PRODUCT_ID='4' THEN TO_CHAR(A.CONTRACT_NO) WHEN PRODUCT_ID='5' THEN TO_CHAR(A.CONTRACT_NO)||'-'||TO_CHAR(A.LAYER_NO) ELSE NULL END CONTDET2 FROM POSITION_MASTER A WHERE  A.PRODUCT_ID = ? AND A.CONTRACT_STATUS ='A' AND A.CONTRACT_NO IS NOT NULL AND A.CONTRACT_NO !='0' AND NVL(A.RETRO_TYPE,'N') IN('TR','FO','TO') AND A.UW_YEAR =  ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(A.EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = ? AND A.RSK_DUMMY_CONTRACT ='N' AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE A.PRODUCT_ID=PRODUCT_ID AND A.CONTRACT_NO = CONTRACT_NO AND NVL(A.RETRO_TYPE,'N') IN('TR','FO','TO')  AND A.UW_YEAR = ?  AND TO_DATE(?,'DD/MM/YYYY')<TO_DATE(EXPIRY_DATE,'DD/MM/YY') AND A.BRANCH_CODE = BRANCH_CODE AND A.RSK_DUMMY_CONTRACT ='N') ORDER BY A.CONTRACT_NO
risk.select.getRetroCessCount=SELECT COUNT(*) COUNT FROM TTRN_RETRO_CESSIONARY WHERE PROPOSAL_NO=?
risk.select.getRiskCommCount=SELECT COUNT(*) COUNT FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?
risk.update.pro35RskProposal=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC =?,RSK_LIMIT_OS_DC =?, RSK_EPI_OSOF_OC=?, RSK_EPI_OSOF_DC =?,RSK_MD_PREM_OS_OC =?,RSK_MD_PREM_OS_DC =? WHERE RSK_PROPOSAL_NUMBER =? AND RSK_LAYER_NO =? AND RSK_ENDORSEMENT_NO = ?
risk.select.maxRskStatus=SELECT RD.RSK_STATUS FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_PROPOSAL_NUMBER=? AND RD.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER)
risk.update.pro3SecComm=UPDATE TTRN_RISK_COMMISSION SET RSK_BROKERAGE\=?,RSK_TAX\=?,RSK_PROFIT_COMM\=?,RSK_ACQUISTION_COST_OC\=?,RSK_ACQUISTION_COST_DC\=?,RSK_AGGREGATE_LIAB_OC\=?,RSK_AGGREGATE_LIAB_DC\=?,RSK_REINSTATE_NO\=?,RSK_REINSTATE_ADDL_PREM_OC \=?,RSK_REINSTATE_ADDL_PREM_DC\=?,RSK_LEAD_UW\=?,RSK_LEAD_UW_SHARE\=?,RSK_ACCOUNTS\=?,RSK_EXCLUSION\=?,RSK_REMARKS\=?,RSK_UW_RECOMM\=?,RSK_GM_APPROVAL\=?,RSK_OTHER_COST\=?,RSK_REINSTATE_ADDL_PREM_PCT\=?,RSK_BURNING_COST_PCT\=?,RSK_AGGREGATE_deduct_OC\=?,RSK_AGGREGATE_deduct_DC\=?,RSK_OCCURRENT_LIMIT_OC\=?,RSK_OCCURRENT_LIMIT_DC\=?,RSK_REINSTATEMENT_PREMIUM\=?,RSK_CREASTA_STATUS\=?,RSK_LEAD_UNDERWRITER_COUNTRY\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=SYSDATE,RSK_DOC_STATUS\=?,RSK_NOCLAIMBONUS_PRCENT\=?,RSK_BONUS_ID\=?, RSK_LAYER_NO \=? WHERE RSK_PROPOSAL_NUMBER\=?  AND RSK_ENDORSEMENT_NO\=?
risk.update.pro5SecComm=UPDATE TTRN_RISK_COMMISSION SET RSK_BROKERAGE\=?,RSK_TAX\=?,RSK_PROFIT_COMM\=?,RSK_ACQUISTION_COST_OC\=?,RSK_ACQUISTION_COST_DC\=?,RSK_AGGREGATE_LIAB_OC\=?,RSK_AGGREGATE_LIAB_DC\=?,RSK_REINSTATE_NO\=?,RSK_REINSTATE_ADDL_PREM_OC \=?,RSK_REINSTATE_ADDL_PREM_DC\=?,RSK_LEAD_UW\=?,RSK_LEAD_UW_SHARE\=?,RSK_ACCOUNTS\=?,RSK_EXCLUSION\=?,RSK_REMARKS\=?,RSK_UW_RECOMM\=?,RSK_GM_APPROVAL\=?,RSK_OTHER_COST\=?,RSK_REINSTATE_ADDL_PREM_PCT\=?,RSK_BURNING_COST_PCT\=?,RSK_AGGREGATE_deduct_OC\=?,RSK_AGGREGATE_deduct_DC\=?,RSK_OCCURRENT_LIMIT_OC\=?,RSK_OCCURRENT_LIMIT_DC\=?,RSK_REINSTATEMENT_PREMIUM\=?,RSK_CREASTA_STATUS\=?,RSK_LEAD_UNDERWRITER_COUNTRY\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=SYSDATE,RSK_DOC_STATUS\=?,RSK_NOCLAIMBONUS_PRCENT\=?,RSK_BONUS_ID\=? ,RSK_LAYER_NO \=? WHERE RSK_PROPOSAL_NUMBER\=?   AND RSK_ENDORSEMENT_NO\=?
risk.update.pro35RskProposal=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC =?,RSK_LIMIT_OS_DC =?, RSK_EPI_OSOF_OC=?, RSK_EPI_OSOF_DC =?,RSK_MD_PREM_OS_OC =?,RSK_MD_PREM_OS_DC =? WHERE RSK_PROPOSAL_NUMBER =? AND RSK_LAYER_NO =? AND RSK_ENDORSEMENT_NO = ?
risk.insert.pro3SecComm=INSERT INTO TTRN_RISK_COMMISSION(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_LAYER_NO,RSK_BROKERAGE,RSK_TAX,RSK_PROFIT_COMM,RSK_RESERVE_ON_LOSS,RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,RSK_AGGREGATE_LIAB_OC,RSK_AGGREGATE_LIAB_DC,RSK_REINSTATE_NO,RSK_REINSTATE_ADDL_PREM_OC,RSK_REINSTATE_ADDL_PREM_DC,RSK_LEAD_UW,RSK_LEAD_UW_SHARE,RSK_ACCOUNTS,RSK_EXCLUSION,RSK_REMARKS,RSK_UW_RECOMM,RSK_GM_APPROVAL,RSK_DECISION,RSK_ENTRY_DATE,RSK_END_DATE,RSK_STATUS,RSK_OTHER_COST,RSK_REINSTATE_ADDL_PREM_PCT,RSK_BURNING_COST_PCT,RSK_AGGREGATE_deduct_OC,RSK_AGGREGATE_deduct_DC,RSK_OCCURRENT_LIMIT_OC,RSK_OCCURRENT_LIMIT_DC,RSK_REINSTATEMENT_PREMIUM,RSK_CREASTA_STATUS,RSK_LEAD_UNDERWRITER_COUNTRY,LOGIN_ID,BRANCH_CODE,SYS_DATE,RSK_DOC_STATUS,RSK_NOCLAIMBONUS_PRCENT,RSK_BONUS_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)
risk.insert.pro5SecComm=INSERT INTO TTRN_RISK_COMMISSION(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_LAYER_NO,RSK_BROKERAGE,RSK_TAX,RSK_PROFIT_COMM,RSK_RESERVE_ON_LOSS,RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,RSK_AGGREGATE_LIAB_OC,RSK_AGGREGATE_LIAB_DC,RSK_REINSTATE_NO,RSK_REINSTATE_ADDL_PREM_OC,RSK_REINSTATE_ADDL_PREM_DC,RSK_LEAD_UW,RSK_LEAD_UW_SHARE,RSK_ACCOUNTS,RSK_EXCLUSION,RSK_REMARKS,RSK_UW_RECOMM,RSK_GM_APPROVAL,RSK_DECISION,RSK_ENTRY_DATE,RSK_END_DATE,RSK_STATUS,RSK_OTHER_COST,RSK_REINSTATE_ADDL_PREM_PCT,RSK_BURNING_COST_PCT,RSK_AGGREGATE_deduct_OC,RSK_AGGREGATE_deduct_DC,RSK_OCCURRENT_LIMIT_OC,RSK_OCCURRENT_LIMIT_DC,RSK_REINSTATEMENT_PREMIUM,RSK_CREASTA_STATUS,RSK_LEAD_UNDERWRITER_COUNTRY,LOGIN_ID,BRANCH_CODE,SYS_DATE,RSK_DOC_STATUS,RSK_NOCLAIMBONUS_PRCENT,RSK_BONUS_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)
risk.select.chechProposalStatus=SELECT B.RSK_STATUS,A.RSK_SHARE_SIGNED,B.RSK_CONTRACT_NO FROM TTRN_RISK_PROPOSAL A, TTRN_RISK_DETAILS B WHERE A.RSK_PROPOSAL_NUMBER = B.RSK_PROPOSAL_NUMBER AND A.RSK_PROPOSAL_NUMBER =? AND A.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER =? ) AND B.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER =? )
risk.select.getRskStatus=SELECT RSK_STATUS FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?
REINSTATEMENT_COUNT_MAIN = SELECT COUNT(REINST_NO) COUNT FROM TTRN_RIP WHERE PROPOSAL_NO=? AND BRANCH_CODE=? AND AMEND_ID=?
BONUS_COUNT_MAIN = SELECT count(LCB_FROM) COUNT FROM TTRN_BONUS WHERE PROPOSAL_NO \=?  and BRANCH\=?  AND TYPE\=? and ENDORSEMENT_NO\=? and LAYERNO \=?
risk.select.getMaxEndorseNo=SELECT NVL(MAX(RSK_ENDORSEMENT_NO),'0') RSK_ENDORSEMENT_NO FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?
select_COUNTRY_NAME1 = SELECT   RTRIM(XMLAGG(XMLELEMENT(E,COUNTRY_NAME,',')).EXTRACT('//text()'),',') COUNTRY_NAME FROM   country_master  WHERE  COUNTRY_ID in ? and BRANCH_CODE=?
PROFIT_COMMISSION_DELETE =DELETE FROM TTRN_PROFIT_COMMISSION_ARCH WHERE PROPOSAL_NO \=?  and BRANCH_CODE\=? AND S_NO\=?
risk.select.getSecPageData=SELECT   RK.RSK_PROPOSAL_NUMBER, PFC.TMAS_PFC_NAME, (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND SPFC.TMAS_PRODUCT_ID \= TDM.TMAS_PRODUCT_ID AND TDM.BRANCH_CODE \= SPFC.BRANCH_CODE)TMAS_SPFC_NAME, PERSONAL.COMPANY_NAME, PI.FIRST_NAME || ' ' || PI.LAST_NAME AS BROKER, TO_CHAR (RK.RSK_MONTH, 'DD/MM/YYYY') MONTH, BRAN.TMAS_POL_BRANCH_NAME, RK.RSK_CONTRACT_NO, RK.RSK_UWYEAR, TDM.TMAS_DEPARTMENT_NAME,RK.RS_ENDORSEMENT_TYPE DETAIL_NAME FROM   TTRN_RISK_DETAILS RK, TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL, PERSONAL_INFO PI, TMAS_POLICY_BRANCH BRAN,TMAS_DEPARTMENT_MASTER TDM WHERE  RK.RSK_PROPOSAL_NUMBER \= ? AND PFC.TMAS_PFC_ID \= RSK_PFCID  AND PFC.BRANCH_CODE \= ? AND TDM.BRANCH_CODE \= ? AND TDM.TMAS_PRODUCT_ID \= ? AND TDM.TMAS_DEPARTMENT_ID \= RK.RSK_DEPTID AND RK.RSK_CEDINGID \= PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE \= 'C'  AND PERSONAL.BRANCH_CODE \= ? AND PERSONAL.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID \= PERSONAL.CUSTOMER_ID AND CUSTOMER_TYPE \= PERSONAL.CUSTOMER_TYPE AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PI.CUSTOMER_TYPE \= 'B' AND PI.BRANCH_CODE \= ? AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID AND CUSTOMER_TYPE \= PI.CUSTOMER_TYPE AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_PROPOSAL_NUMBER \= RK.RSK_PROPOSAL_NUMBER) AND RK.RSK_POLBRANCH \= BRAN.TMAS_POL_BRANCH_ID AND BRAN.BRANCH_CODE \= ?
PROFIT_COMMISSION_EDIT =SELECT S_NO, MANAGEMENT_EXPENSES, LOSS, PROFIT_COMMISSION, PROFIT_MONTHS, PROFIT_QUARTERS, PROFIT_YEAR,FIRST_PROFIT_COM_AFTER FROM TTRN_PROFIT_COMMISSION_ARCH WHERE PROPOSAL_NO=? AND BRANCH_CODE=? AND  S_NO=?
COMMISSION_TYPE_LIST = SELECT SNO,COMM_FROM,COMM_TO,PROFIT_COMM FROM TTRN_COMMISSION_DETAILS C WHERE PROPOSAL_NO\=? AND BRANCH_CODE \= ? AND COMMISSION_TYPE\=? AND ENDORSEMENT_NO \= (SELECT MAX(ENDORSEMENT_NO) FROM  TTRN_COMMISSION_DETAILS T WHERE T.PROPOSAL_NO\=C.PROPOSAL_NO AND T.BRANCH_CODE\=C.BRANCH_CODE)
COMMISSION_TYPE_LIST1 = SELECT SNO,COMM_FROM,COMM_TO,PROFIT_COMM FROM TTRN_COMMISSION_DETAILS C WHERE PROPOSAL_NO\=? AND BRANCH_CODE \= ? AND COMMISSION_TYPE\=? AND ENDORSEMENT_NO \= (SELECT MAX(ENDORSEMENT_NO) FROM  TTRN_COMMISSION_DETAILS T WHERE T.PROPOSAL_NO\=C.PROPOSAL_NO AND T.BRANCH_CODE\=C.BRANCH_CODE) AND CONTRACT_NO=?
COMMISSION_TYPE_LIST2 = SELECT SNO,COMM_FROM,COMM_TO,PROFIT_COMM FROM TTRN_COMMISSION_DETAILS C WHERE PROPOSAL_NO\=? AND BRANCH_CODE \= ? AND COMMISSION_TYPE\=? AND ENDORSEMENT_NO \= (SELECT MAX(ENDORSEMENT_NO) FROM  TTRN_COMMISSION_DETAILS T WHERE T.PROPOSAL_NO\=C.PROPOSAL_NO AND T.BRANCH_CODE\=C.BRANCH_CODE) AND CONTRACT_NO=? order by SNO
BONUS_MAIN_INSERT_PTTY = INSERT INTO ttrn_bonus(PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,LCB_FROM,LCB_TO,LCB_PERCENTAGE,USERID,BRANCH,LCB_ID,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,QUOTA_SHARE,REMARKS,FIRST_PROFIT_COMM,FPC_DURATION_TYPE,SUB__PROFIT_COMM,SPC_DURATION_TYPE,SUB_SEC_CAL)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?)
UpdateProportionalTreatyQuery = UPDATE ttrn_risk_details SET RSK_LAYER_NO=? WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=?
risk.update.rskDtls1=UPDATE TTRN_RISK_DETAILS SET RSK_DEPTID\=?, RSK_PFCID\=?, RSK_SPFCID\=?, RSK_POLBRANCH\=?, RSK_CEDINGID\=?, RSK_BROKERID\=?, RSK_TREATYID\=?, RSK_MONTH\=TO_DATE(?,'DD/MM/YYYY'), RSK_UWYEAR\=?, RSK_UNDERWRITTER\=?, RSK_INCEPTION_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_EXPIRY_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_ACCOUNT_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_ORIGINAL_CURR\=?, RSK_EXCHANGE_RATE\=?, RSK_BASIS\=?, RSK_PERIOD_OF_NOTICE\=?, RSK_RISK_COVERED\=?, RSK_TERRITORY_SCOPE\=?, RSK_TERRITORY\=?, RSK_STATUS\=?,RSK_PROPOSAL_TYPE\=?,RSK_ACCOUNTING_PERIOD\=? ,RSK_RECEIPT_STATEMENT\=? , RSK_RECEIPT_PAYEMENT\=?,MND_INSTALLMENTS\=?,RETRO_CESSIONARIES\=?,RSK_RETRO_TYPE\=?,RSK_INSURED_NAME\=?,INWARD_BUS_TYPE\=?,TREATYTYPE\=?,RSK_BUSINESS_TYPE\=?,RSK_EXCHANGE_TYPE\=?,RSK_PERILS_COVERED\=?,RSK_LOC_ISSUED\=?,RSK_UMBRELLA_XL\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=sysdate,COUNTRIES_INCLUDE\=?,COUNTRIES_EXCLUDE\=?,RSK_NO_OF_LINE\=?,RS_ENDORSEMENT_TYPE\=?,RSK_RUN_OFF_YEAR\=?,RSK_LOC_BNK_NAME\=?,RSK_LOC_CRDT_PRD\=?,RSK_LOC_CRDT_AMT\=?,RSK_LOC_BENFCRE_NAME\=?,RSK_CESSION_EXG_RATE\=?,RSK_FIXED_RATE\=?,RETENTIONYN\=? WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=? AND RSK_LAYER_NO = ?
risk.update.pro35FirPageRskPro=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OC=?,RSK_LIMIT_DC=?,RSK_EPI_EST_OC=?,RSK_EPI_EST_DC=?,RSK_SHARE_WRITTEN=?,RSK_SHARE_SIGNED=?,RSK_MAX_LMT_COVER=?,RSK_SUBJ_PREMIUM_OC=?,RSK_SUBJ_PREMIUM_DC=?,RSK_XLPREM_OC=?,RSK_XLPREM_DC=?,RSK_PF_COVERED=?,RSK_DEDUC_OC=?,RSK_DEDUC_DC=?,RSK_MD_PREM_OC=?,RSK_MD_PREM_DC=?,RSK_ADJRATE=?,RSK_SP_RETRO=?,RSK_NO_OF_INSURERS=?,RSK_LIMIT_OS_OC=?,RSK_LIMIT_OS_DC=?,RSK_EPI_OSOF_OC=?,RSK_EPI_OSOF_DC=?,RSK_MD_PREM_OS_OC=?,RSK_MD_PREM_OS_DC=?,LIMIT_PER_VESSEL_OC=?,LIMIT_PER_VESSEL_DC=?,LIMIT_PER_LOCATION_OC=?,LIMIT_PER_LOCATION_DC=?,EGPNI_AS_OFFER=?,OURASSESSMENT=? ,EGPNI_AS_OFFER_DC=?,LOGIN_ID=?,BRANCH_CODE=?,SYS_DATE=SYSDATE WHERE RSK_PROPOSAL_NUMBER =?  AND RSK_ENDORSEMENT_NO=?
GET_MAX_AMEND_RISK_PROPOSAL=SELECT NVL(MAX(RSK_ENDORSEMENT_NO),'0') RSK_ENDORSEMENT_NO FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?
risk.insert.pro35RskProposal=INSERT INTO TTRN_RISK_PROPOSAL(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_LAYER_NO,RSK_LIMIT_OC,RSK_LIMIT_DC,RSK_XLPREM_OC,RSK_XLPREM_DC,RSK_DEDUC_OC,RSK_EPI_EST_OC,RSK_EPI_EST_DC,RSK_MD_PREM_OC,RSK_MD_PREM_DC,RSK_SHARE_WRITTEN,RSK_SHARE_SIGNED,RSK_ADJRATE,RSK_PF_COVERED,RSK_SUBJ_PREMIUM_OC,RSK_SUBJ_PREMIUM_DC,RSK_MAX_LMT_COVER,RSK_DEDUC_DC,RSK_SP_RETRO,RSK_NO_OF_INSURERS,RSK_LIMIT_OS_OC,RSK_LIMIT_OS_DC,RSK_EPI_OSOF_OC,RSK_EPI_OSOF_DC,RSK_MD_PREM_OS_OC,RSK_MD_PREM_OS_DC,LIMIT_PER_VESSEL_OC,LIMIT_PER_VESSEL_DC,LIMIT_PER_LOCATION_OC,LIMIT_PER_LOCATION_DC,EGPNI_AS_OFFER,OURASSESSMENT,EGPNI_AS_OFFER_DC,LOGIN_ID,BRANCH_CODE,SYS_DATE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
risk.select.getRenewalStatus=SELECT NVL(PM.RENEWAL_STATUS,'0') RENEWAL_STATUS FROM POSITION_MASTER PM WHERE PM.PROPOSAL_NO=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
DELETE_CLASS_LIMIT=DELETE TTRN_RSK_CLASS_LIMITS TRCL WHERE RSK_PROPOSAL_NUMBER=?  and RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) from TTRN_RSK_CLASS_LIMITS where  RSK_PROPOSAL_NUMBER=TRCL.RSK_PROPOSAL_NUMBER)
INSERT_CLASS_LIMIT=INSERT INTO TTRN_RSK_CLASS_LIMITS(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_CONTRACT_NO,RSK_LAYER_NO,RSK_PRODUCTID,RSK_COVER_CLASS,RSK_COVER_LIMT,RSK_COVER_LIMT_PERCENTAGE,RSK_DEDUCTABLE_LIMT,RSK_DEDUCTABLE_PERCENTAGE,ENTRY_DATE,BRANCH_CODE,STATUS,RSK_SNO,RSK_EGNPI_AS_OFF,RSK_GNPI_AS_OFF,RSK_NET_MAX_RETENT_PERCENT)values(?,?,?,?,?,?,?,?,?,?,sysdate,?,'Y',?,?,?,?)
UPDATE_QUERY_COMMISSION=UPDATE ttrn_risk_commission SET RSK_LAYER_NO=? WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=?
risk.select.getEditModeSecPagePro3Data=SELECT PR.RSK_LIMIT_OS_OC,PR.RSK_LIMIT_OS_DC,PR.RSK_EPI_OSOF_OC,PR.RSK_EPI_OSOF_DC,COM.RSK_BROKERAGE,COM.RSK_TAX,COM.RSK_ACQUISTION_COST_OC,COM.RSK_PROFIT_COMM,RSK_MD_PREM_OS_OC,RSK_MD_PREM_OS_DC,RSK_AGGREGATE_LIAB_OC,RSK_REINSTATE_NO,RSK_REINSTATE_ADDL_PREM_OC,COM.RSK_LEAD_UW,COM.RSK_LEAD_UW_SHARE,COM.RSK_ACCOUNTS,COM.RSK_EXCLUSION,COM.RSK_REMARKS ,COM.RSK_UW_RECOMM,COM.RSK_GM_APPROVAL,COM.RSK_OTHER_COST,COM.RSK_REINSTATE_ADDL_PREM_PCT,COM.RSK_BURNING_COST_PCT,COM.RSK_AGGREGATE_DEDUCT_OC,COM.RSK_REINSTATEMENT_PREMIUM,COM.RSK_CREASTA_STATUS,COM.RSK_LEAD_UNDERWRITER_COUNTRY,COM.RSK_BONUS_ID,COM.RSK_NOCLAIMBONUS_PRCENT,COM.RSK_OCCURRENT_LIMIT_OC,COM.RSK_OCCURRENT_LIMIT_DC FROM TTRN_RISK_PROPOSAL PR,TTRN_RISK_COMMISSION COM WHERE PR.RSK_PROPOSAL_NUMBER =? AND PR.RSK_PROPOSAL_NUMBER=COM.RSK_PROPOSAL_NUMBER AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?) AND COM.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?) AND COM.RSK_LAYER_NO=?
risk.select.getRskContractNo=SELECT NVL(RC.RSK_CONTRACT_NO,'0') FROM TTRN_RISK_DETAILS RC WHERE RC.RSK_PROPOSAL_NUMBER\=? AND RC.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER\=RC.RSK_PROPOSAL_NUMBER)
risk.update.pro24RskProposal=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC =?,RSK_LIMIT_OS_DC =?, RSK_EPI_OSOF_OC=?, RSK_EPI_OSOF_DC =?,RSK_EPI_OSOE_OC=?,RSK_EPI_OSOE_DC=?,RSK_XLCOST_OS_OC=?,RSK_XLCOST_OS_DC=?, RSK_PREMIUM_QUOTA_SHARE=?,RSK_PREMIUM_SURPULS=?,RSK_PREMIUM_QUOTA_SHARE_DC=?,RSK_PREMIUM_SURPLUS_DC=?,COMM_QS_AMT=?,COMM_SURPLUS_AMT=?,COMM_QS_AMT_DC=?,COMM_SURPLUS_AMT_DC=?   WHERE RSK_PROPOSAL_NUMBER =?  AND RSK_ENDORSEMENT_NO = ?
risk.insert.pro2SecComm=INSERT INTO TTRN_RISK_COMMISSION(RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_LAYER_NO,RSK_BROKERAGE,RSK_TAX,RSK_PROFIT_COMM,RSK_RESERVE_ON_LOSS,RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,RSK_COMM_QUOTASHARE,RSK_COMM_SURPLUS,RSK_OVERRIDER_PERC,RSK_PREMIUM_RESERVE,RSK_LOSS_RESERVE,RSK_INTEREST,RSK_PF_INOUT_PREM,RSK_PF_INOUT_LOSS,RSK_LOSSADVICE,RSK_CASHLOSS_LMT_OC,RSK_CASHLOSS_LMT_DC,RSK_LEAD_UW,RSK_LEAD_UW_SHARE,RSK_ACCOUNTS,RSK_EXCLUSION,RSK_REMARKS,RSK_UW_RECOMM,RSK_GM_APPROVAL,RSK_DECISION,RSK_ENTRY_DATE,RSK_END_DATE,RSK_STATUS,RSK_OTHER_COST,RSK_CREASTA_STATUS,RSK_EVENT_LIMIT_OC,RSK_EVENT_LIMIT_DC,RSK_AGGREGATE_LIMIT_OC,RSK_AGGREGATE_LIMIT_DC,RSK_OCCURRENT_LIMIT_OC,RSK_OCCURRENT_LIMIT_DC,RSK_SLADSCALE_COMM,RSK_LOSS_PART_CARRIDOR,RSK_COMBIN_SUB_CLASS,SUB_CLASS,LOGIN_ID,BRANCH_CODE,SYS_DATE,RSK_LEAD_UNDERWRITER_COUNTRY,RSK_INCLUDE_ACQ_COST,RSK_OUR_ASS_ACQ_COST,RSK_OUR_ACQ_OUR_SHARE_OC,RSK_LOSS_COMBIN_SUB_CLASS,RSK_SLIDE_COMBIN_SUB_CLASS,RSK_CRESTA_COMBIN_SUB_CLASS,RSK_PRO_MANAGEMENT_EXP, RSK_PRO_COMM_TYPE, RSK_PRO_COMM_PER, RSK_PRO_SET_UP, RSK_PRO_SUP_PRO_COM, RSK_PRO_LOSS_CARY_TYPE, RSK_PRO_LOSS_CARY_YEAR, RSK_PRO_PROFIT_CARY_TYPE, RSK_PRO_PROFIT_CARY_YEAR, RSK_PRO_FIRST_PFO_COM, RSK_PRO_FIRST_PFO_COM_PRD, RSK_PRO_SUB_PFO_COM_PRD, RSK_PRO_SUB_PFO_COM, RSK_PRO_SUB_SEQ_CAL, RSK_PRO_NOTES,RSK_DOC_STATUS,RSK_RATE) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
risk.select.chechProposalStatus=SELECT B.RSK_STATUS,A.RSK_SHARE_SIGNED,B.RSK_CONTRACT_NO FROM TTRN_RISK_PROPOSAL A, TTRN_RISK_DETAILS B WHERE A.RSK_PROPOSAL_NUMBER = B.RSK_PROPOSAL_NUMBER AND A.RSK_PROPOSAL_NUMBER =? AND A.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER =? ) AND B.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER =? )
INSERT_SECTION_DETAILS=INSERT INTO TTRN_PTTY_SECTION(SECTION_NO,CONTRACT_NO,DEPT_ID,SECTION_NAME,AMEND_ID,BRANCH_CODE,LOGIN_ID,ENTRY_DATE) VALUES(?,?,?,?,0,?,?,SYSDATE)
risk.update.contNo=UPDATE TTRN_RISK_DETAILS SET RSK_CONTRACT_NO=? WHERE RSK_PROPOSAL_NUMBER=?
risk.update.homeContNo=UPDATE POSITION_MASTER SET CONTRACT_NO\=?,PROPOSAL_STATUS\=?,CONTRACT_STATUS\=? WHERE PROPOSAL_NO\=?
risk.select.getRskStatus=SELECT RSK_STATUS FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?
risk.update.pro2SecComm=UPDATE TTRN_RISK_COMMISSION SET RSK_BROKERAGE\=?,RSK_TAX\=?,RSK_PROFIT_COMM\=?,RSK_ACQUISTION_COST_OC\=?,RSK_ACQUISTION_COST_DC\=?,RSK_COMM_QUOTASHARE\=?,RSK_COMM_SURPLUS\=?,RSK_OVERRIDER_PERC\=?,RSK_PREMIUM_RESERVE\=?,RSK_LOSS_RESERVE\=?,RSK_INTEREST\=?,RSK_PF_INOUT_PREM\=?,RSK_PF_INOUT_LOSS\=?,RSK_LOSSADVICE\=?,RSK_CASHLOSS_LMT_OC\=?,RSK_CASHLOSS_LMT_DC\=?,RSK_LEAD_UW\=?,RSK_LEAD_UW_SHARE\=?,RSK_ACCOUNTS\=?,RSK_EXCLUSION\=?,RSK_REMARKS\=?,RSK_UW_RECOMM\=?,RSK_GM_APPROVAL\=?,RSK_OTHER_COST\=?,RSK_CREASTA_STATUS\=?,RSK_EVENT_LIMIT_OC\=?,RSK_EVENT_LIMIT_DC\=?,RSK_AGGREGATE_LIMIT_OC\=?,RSK_AGGREGATE_LIMIT_DC\=?,RSK_OCCURRENT_LIMIT_OC\=?,RSK_OCCURRENT_LIMIT_DC\=?,RSK_SLADSCALE_COMM\=?,RSK_LOSS_PART_CARRIDOR\=?,RSK_COMBIN_SUB_CLASS\=?,SUB_CLASS\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=SYSDATE,RSK_LEAD_UNDERWRITER_COUNTRY\=?,RSK_INCLUDE_ACQ_COST\=?,RSK_OUR_ASS_ACQ_COST\=?,RSK_OUR_ACQ_OUR_SHARE_OC\=?,RSK_LOSS_COMBIN_SUB_CLASS\=?,RSK_SLIDE_COMBIN_SUB_CLASS\=?,RSK_CRESTA_COMBIN_SUB_CLASS\=?,RSK_PRO_MANAGEMENT_EXP\=?, RSK_PRO_COMM_TYPE\=?, RSK_PRO_COMM_PER\=?, RSK_PRO_SET_UP\=?, RSK_PRO_SUP_PRO_COM\=?, RSK_PRO_LOSS_CARY_TYPE\=?, RSK_PRO_LOSS_CARY_YEAR\=?, RSK_PRO_PROFIT_CARY_TYPE\=?, RSK_PRO_PROFIT_CARY_YEAR\=?, RSK_PRO_FIRST_PFO_COM\=?, RSK_PRO_FIRST_PFO_COM_PRD\=?, RSK_PRO_SUB_PFO_COM_PRD\=?, RSK_PRO_SUB_PFO_COM\=?, RSK_PRO_SUB_SEQ_CAL\=?, RSK_PRO_NOTES\=?,RSK_DOC_STATUS\=?,RSK_RATE\=? WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=?
risk.select.maxRskStatus=SELECT RD.RSK_STATUS FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_PROPOSAL_NUMBER=? AND RD.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER)
risk.update.mndInstallments=UPDATE TTRN_MND_INSTALLMENTS SET  CONTRACT_NO\=? where PROPOSAL_NO\=?
risk.select.endo=SELECT  MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER \=?
risk.update.pro24ContSecPage=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC =?,RSK_LIMIT_OS_DC=?,RSK_EPI_OSOF_OC=?,RSK_EPI_OSOF_DC=?,RSK_EPI_OSOE_OC=?,RSK_EPI_OSOE_DC=?,RSK_XLCOST_OS_OC=?,RSK_XLCOST_OS_DC=?,RSK_PREMIUM_QUOTA_SHARE=?,RSK_PREMIUM_SURPULS=?,RSK_PREMIUM_QUOTA_SHARE_DC=?,RSK_PREMIUM_SURPLUS_DC=?,COMM_QS_AMT=?,COMM_SURPLUS_AMT=?,COMM_QS_AMT_DC=?,COMM_SURPLUS_AMT_DC=?  WHERE  RSK_ENDORSEMENT_NO=? AND RSK_PROPOSAL_NUMBER =?
getSOATableInsert_DELETE_QUERY=DELETE FROM TTRN_SOA_DUE WHERE PROPOSAL_NO=? AND CONTRACT_NO=? AND BRANCH_CODE=?
COMMIOSSION_DELETE =  DELETE FROM TTRN_COMMISSION_DETAILS WHERE PROPOSAL_NO=? AND BRANCH_CODE=? AND ENDORSEMENT_NO=?
COMMISSION_INSERT = INSERT INTO TTRN_COMMISSION_DETAILS(SNO,COMM_FROM,COMM_TO,PROFIT_COMM,PROPOSAL_NO,CONTRACT_NO,ENDORSEMENT_NO,PRODUCT_ID,BRANCH_CODE,SUB_CLASS,COMMISSION_TYPE,LOGIN_ID,ENTRY_DATE)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
GET_COUNT_RETENTION =  SELECT COUNT(*) FROM  TTRN_CEDENT_RET  C WHERE PROPOSAL_NO=?  AND PRODUCT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_CEDENT_RET R WHERE  C.PROPOSAL_NO=R.PROPOSAL_NO)
UPDATE_RETEN_CONTNO =UPDATE TTRN_CEDENT_RET C SET CONTRACT_NO\=? ,DEPT_ID\=?  WHERE PROPOSAL_NO\=? AND PRODUCT_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_CEDENT_RET R WHERE  C.PROPOSAL_NO\=R.PROPOSAL_NO)
REINSTATEMENT_MAIN_SELECT_A = SELECT REINSTATEMENT,REINST_NO,REINST_TYPE,AMOUNT_PERCENT,MIN_AMOUNT_PERCENT,MIN_TIME_PERCENT FROM TTRN_RIP T WHERE PROPOSAL_NO=? AND BRANCH_CODE=? AND SECTION_TYPE='A' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RIP TRA WHERE TRA.PROPOSAL_NO=T.PROPOSAL_NO AND TRA.BRANCH_CODE=T.BRANCH_CODE) ORDER BY REINST_NO
REINSTATEMENT_MAIN_SELECT_B = SELECT DEPARTMENT_CLASS,ANNUAL_AGGRE_LAIBLE FROM TTRN_RIP T WHERE PROPOSAL_NO=? AND BRANCH_CODE=? AND SECTION_TYPE='B' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RIP TRA WHERE TRA.PROPOSAL_NO=T.PROPOSAL_NO AND TRA.BRANCH_CODE=T.BRANCH_CODE)
INSERT_REINSTATEMENT_MAIN =INSERT INTO TTRN_RIP(REINST_NO,REINST_TYPE,AMOUNT_PERCENT,MIN_AMOUNT_PERCENT,MIN_TIME_PERCENT,PROPOSAL_NO,BRANCH_CODE,AMEND_ID,SUB_CLASS,CONTRACT_NO,PRODUCT_ID,LAYER_NO,REINSTATEMENT,SYS_DATE,SECTION_TYPE,REFERENCE_NO)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?)
INSERT_REINSTATEMENT_MAIN_B=INSERT INTO TTRN_RIP(DEPARTMENT_CLASS,ANNUAL_AGGRE_LAIBLE,PROPOSAL_NO,BRANCH_CODE,AMEND_ID,SUB_CLASS,CONTRACT_NO,PRODUCT_ID,LAYER_NO,SYS_DATE,SECTION_TYPE)VALUES(?,?,?,?,?,?,?,?,?,SYSDATE,?)
REINSTATEMENT_MAIN_DELETE =DELETE FROM TTRN_RIP WHERE PROPOSAL_NO=? AND BRANCH_CODE=?
REINSTATEMENT_MAIN_DELETE2 =DELETE FROM TTRN_RIP WHERE PROPOSAL_NO\=? AND AMEND_ID\=? AND BRANCH_CODE\=?
BONUS_MAIN_SELECT = SELECT * FROM TTRN_BONUS TT WHERE PROPOSAL_NO =?  and BRANCH=? and TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.PROPOSAL_NO=TB.PROPOSAL_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE) ORDER BY LCB_ID
GET_AMEND_ID =SELECT MAX(AMEND_ID) AMEND_ID FROM POSITION_MASTER WHERE PROPOSAL_NO\=?
BONUS_MAIN_INSERT = INSERT INTO ttrn_bonus(PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,LCB_FROM,LCB_TO,LCB_PERCENTAGE,USERID,BRANCH,LCB_ID,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
GET_INCLUSIONEX_LIST=SELECT DISTINCT PROPOSAL_NO,CONTRACT_NO,LAYER_NO,TRANSACTION_NO,TO_CHAR(EEFECTIVE_DATE,'DD/MM/YYYY')EEFECTIVE_DATE FROM TTRN_IE_MODULE WHERE PROPOSAL_NO=?  AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_IE_MODULE TI WHERE PROPOSAL_NO=?  AND BRANCH_CODE=TI.BRANCH_CODE)
SELECT_transaction_no = SELECT IE_RETRO_XOL_06.NEXTVAL TRANS_NO FROM DUAL
TTRN_IE_MODULE_AMEND_ID = SELECT MAX(AMEND_ID)+1 AMEND_ID  FROM TTRN_IE_MODULE WHERE PROPOSAL_NO=? AND TRANSACTION_NO=? AND BRANCH_CODE=?
INCLUSION_EXCLUSION_INSERT=INSERT INTO TTRN_IE_MODULE(PROPOSAL_NO,CONTRACT_NO,LAYER_NO,TRANSACTION_NO,ITEM_NO,ITEM_TYPE,ITEM_INCLUSION_EXCLUSION,AMEND_ID,BRANCH_CODE,EEFECTIVE_DATE,SYS_DATE,LOGIN_ID)VALUES(?,?,?,?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),SYSDATE,?)
UPDATE_LAYER_NO = UPDATE ttrn_risk_commission SET RSK_LAYER_NO=? WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=?
risk.select.getEditModeSecPagePro3Data=SELECT PR.RSK_LIMIT_OS_OC,PR.RSK_LIMIT_OS_DC,PR.RSK_EPI_OSOF_OC,PR.RSK_EPI_OSOF_DC,COM.RSK_BROKERAGE,COM.RSK_TAX,COM.RSK_ACQUISTION_COST_OC,COM.RSK_PROFIT_COMM,RSK_MD_PREM_OS_OC,RSK_MD_PREM_OS_DC,RSK_AGGREGATE_LIAB_OC,RSK_REINSTATE_NO,RSK_REINSTATE_ADDL_PREM_OC,COM.RSK_LEAD_UW,COM.RSK_LEAD_UW_SHARE,COM.RSK_ACCOUNTS,COM.RSK_EXCLUSION,COM.RSK_REMARKS ,COM.RSK_UW_RECOMM,COM.RSK_GM_APPROVAL,COM.RSK_OTHER_COST,COM.RSK_REINSTATE_ADDL_PREM_PCT,COM.RSK_BURNING_COST_PCT,COM.RSK_AGGREGATE_DEDUCT_OC,COM.RSK_REINSTATEMENT_PREMIUM,COM.RSK_CREASTA_STATUS,COM.RSK_LEAD_UNDERWRITER_COUNTRY,COM.RSK_BONUS_ID,COM.RSK_NOCLAIMBONUS_PRCENT,COM.RSK_OCCURRENT_LIMIT_OC,COM.RSK_OCCURRENT_LIMIT_DC FROM TTRN_RISK_PROPOSAL PR,TTRN_RISK_COMMISSION COM WHERE PR.RSK_PROPOSAL_NUMBER =? AND PR.RSK_PROPOSAL_NUMBER=COM.RSK_PROPOSAL_NUMBER AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?) AND COM.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?) AND COM.RSK_LAYER_NO=?
GET_INSTALMENT_COUNT=select count(*) COUNT from TTRN_MND_INSTALLMENTS TMI WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=TMI.PROPOSAL_NO AND LAYER_NO=TMI.LAYER_NO AND ENDORSEMENT_NO IS NOT NULL ) AND ENDORSEMENT_NO IS NOT NULL
risk.select.getInstalmentData=SELECT INSTALLMENT_NO,TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') INSTALLMENT_DATE,MND_PREMIUM_OC,PAYEMENT_DUE_DAY,TRANSACTION_NO FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO IS NOT NULL ) AND ENDORSEMENT_NO IS NOT NULL ORDER BY INSTALLMENT_NO
GET_CLASS_LIMIT_DETAILS=SELECT RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_CONTRACT_NO,RSK_LAYER_NO,RSK_PRODUCTID,RSK_COVER_CLASS,RSK_COVER_LIMT,RSK_COVER_LIMT_PERCENTAGE,RSK_DEDUCTABLE_LIMT,RSK_DEDUCTABLE_PERCENTAGE,ENTRY_DATE,BRANCH_CODE,STATUS,RSK_EGNPI_AS_OFF,RSK_GNPI_AS_OFF,RSK_NET_MAX_RETENT_PERCENT FROM TTRN_RSK_CLASS_LIMITS TRCL where RSK_PROPOSAL_NUMBER=? and RSK_LAYER_NO=? and RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) from TTRN_RSK_CLASS_LIMITS where  RSK_PROPOSAL_NUMBER=TRCL.RSK_PROPOSAL_NUMBER) order by RSK_SNO
risk.update.pro35RskProposal=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC =?,RSK_LIMIT_OS_DC =?, RSK_EPI_OSOF_OC=?, RSK_EPI_OSOF_DC =?,RSK_MD_PREM_OS_OC =?,RSK_MD_PREM_OS_DC =? WHERE RSK_PROPOSAL_NUMBER =? AND RSK_LAYER_NO =? AND RSK_ENDORSEMENT_NO = ?
CLASS_LIMIT_UPDATE_CONTNO=UPDATE TTRN_RSK_CLASS_LIMITS SET RSK_CONTRACT_NO=? WHERE RSK_PROPOSAL_NUMBER=?
GET_RETRO_CON_UPDATE =UPDATE TTRN_RETRO_CESSIONARY SET CONTRACT_NO\=? WHERE PROPOSAL_NO\=? AND LAYER_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_RETRO_CESSIONARY RC WHERE RC.PROPOSAL_NO\=PROPOSAL_NO AND RC.LAYER_NO\=LAYER_NO)
risk.update.homeContNo=UPDATE POSITION_MASTER SET CONTRACT_NO\=?,PROPOSAL_STATUS\=?,CONTRACT_STATUS\=? WHERE PROPOSAL_NO\=?
risk.update.contNo=UPDATE TTRN_RISK_DETAILS SET RSK_CONTRACT_NO=? WHERE RSK_PROPOSAL_NUMBER=?
risk.update.mndInstallments=UPDATE TTRN_MND_INSTALLMENTS SET  CONTRACT_NO\=? where PROPOSAL_NO\=?
risk.select.endo=SELECT  MAX(RSK_ENDORSEMENT_NO) RSK_ENDORSEMENT_NO FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER \=? 
risk.update.pro35ContSecPage=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC \=?,RSK_LIMIT_OS_DC\=?,RSK_EPI_OSOF_OC\=?,RSK_EPI_OSOF_DC\=?,RSK_MD_PREM_OS_OC \=?,RSK_MD_PREM_OS_DC \=? WHERE  RSK_ENDORSEMENT_NO\=? AND RSK_PROPOSAL_NUMBER \=? AND RSK_LAYER_NO \=?
delete_TTRN_RETRO_CESSIONARY = delete from TTRN_RETRO_CESSIONARY where PROPOSAL_NO=? and amend_id=?
risk.insert.retroCessDtls=INSERT INTO TTRN_RETRO_CESSIONARY (SNO, PROPOSAL_NO, CONTRACT_NO,CEDING_COMPANY_ID, BROKER_ID, SHARE_ACCEPTED,SHARE_SIGNED, COMISSION, PROPOSAL_STATUS,AMEND_ID,LAYER_NO,ENTRY_DATE,LOGIN_ID,BRANCH_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?)
delete.TTRN_MND_INSTALLMENTS = delete from TTRN_MND_INSTALLMENTS where PROPOSAL_NO=? and ENDORSEMENT_NO=?
risk.insert.instalPrem=INSERT INTO TTRN_MND_INSTALLMENTS(INSTALLMENT_NO,PROPOSAL_NO,CONTRACT_NO,LAYER_NO,ENDORSEMENT_NO,INSTALLMENT_DATE,MND_PREMIUM_OC,MND_PREMIUM_DC,STATUS,ENTRY_DATE,PAYEMENT_DUE_DAY,LOGIN_ID,BRANCH_CODE) VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,'Y',SYSDATE,?,?,?)
fac.insert.insDetails=INSERT INTO TTRN_INSURER_DETAILS(INSURER_NO,PROPOSAL_NO,CONTRACT_NO,ENDORSEMENT_NO,TYPE,RETRO_PERCENTAGE,STATUS,UW_YEAR,RETRO_TYPE,ENTRY_DATE,SUB_CLASS,LOGIN_ID,BRANCH_CODE) VALUES (?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)
fac.upddate.updDetails=UPDATE TTRN_INSURER_DETAILS SET CONTRACT_NO=?,TYPE=?,RETRO_PERCENTAGE=?,STATUS=?,UW_YEAR=?,RETRO_TYPE=?,LOGIN_ID=?,BRANCH_CODE=? WHERE PROPOSAL_NO=? AND INSURER_NO=? AND ENDORSEMENT_NO=?
fac.update.insDetails=UPDATE TTRN_INSURER_DETAILS ID SET ID.END_DATE=SYSDATE  WHERE ID.PROPOSAL_NO=? AND ID.INSURER_NO=? AND ID.ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_INSURER_DETAILS WHERE PROPOSAL_NO=ID.PROPOSAL_NO AND INSURER_NO=ID.INSURER_NO)
RETRO_DELETE_QUERY =DELETE FROM TTRN_INSURER_DETAILS WHERE PROPOSAL_NO\=? AND ENDORSEMENT_NO\=?
risk.select.getInstNo=SELECT COUNT(1) CNT FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO = ? AND INSTALLMENT_NO=?  AND ENDORSEMENT_NO=?
risk.select.getGetRetroCnt=SELECT COUNT(1) CNT FROM TTRN_INSURER_DETAILS WHERE PROPOSAL_NO = ? AND INSURER_NO=?  AND ENDORSEMENT_NO=?
risk.select.getRetroCessCnt=SELECT COUNT(1) CNT FROM TTRN_RETRO_CESSIONARY WHERE PROPOSAL_NO = ? AND SNO=?  AND AMEND_ID=?
UPDATE_REINSTATEMENT_TOTAL_NO =UPDATE TTRN_RISK_COMMISSION R SET RSK_TOTAL_NO_REINSTATEMENTS\=? WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION T WHERE T.RSK_PROPOSAL_NUMBER\=R.RSK_PROPOSAL_NUMBER)
RE_INSTATEMENT_UPDATE =UPDATE TTRN_RIP SET CONTRACT_NO\=?,LAYER_NO\=? WHERE PROPOSAL_NO \= ? AND BRANCH_CODE\=? AND AMEND_ID\=?
CREATA_CONTRACT_UPDATE = UPDATE TTRN_CRESTAZONE_DETAILS SET CONTRACT_NO = ? WHERE PROPOSAL_NO=? AND AMEND_ID=? AND BRANCH_CODE=?
UPDATE_CONTRACT_DETAILS =UPDATE TTRN_BONUS SET CONTRACT_NO\=? WHERE PROPOSAL_NO\=? AND BRANCH\=? AND TYPE\=? AND ENDORSEMENT_NO\=? and LAYERNO\=?
GET_AMEND_ID =SELECT MAX(AMEND_ID)  AMEND_ID FROM POSITION_MASTER WHERE PROPOSAL_NO\=?
BONUS_MAIN_INSERT = INSERT INTO ttrn_bonus(PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,LCB_FROM,LCB_TO,LCB_PERCENTAGE,USERID,BRANCH,LCB_ID,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)

premium.select.RPPremiumOC=      SELECT NVL(SUM(REC_PREMIUM_OC),'0') FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND LAYER_NO = ? AND INSTALMENT_NUMBER='RP'
XOL_PREMIUM_SELECT_RPPREMIUMOC = SELECT NVL(SUM(REC_PREMIUM_OC),'0') REC_PREMIUM_OC FROM RSK_XL_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND LAYER_NO = ? AND INSTALMENT_NUMBER='RP'
premium.select.getTreatySPRetro=SELECT RP.RSK_SP_RETRO, RP.RSK_NO_OF_INSURERS,RP.RSK_PROPOSAL_NUMBER FROM   TTRN_RISK_PROPOSAL RP, TTRN_RISK_DETAILS RD WHERE   RP.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO =?  AND RD.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO = RD.RSK_CONTRACT_NO)
premium.select.insDetails=SELECT A.CONTRACT_NO,A.RETRO_PERCENTAGE,TYPE,UW_YEAR,RETRO_TYPE FROM TTRN_INSURER_DETAILS A WHERE A.ENDORSEMENT_NO = (SELECT   MAX (ENDORSEMENT_NO) FROM   TTRN_INSURER_DETAILS WHERE   A.PROPOSAL_NO=PROPOSAL_NO AND A.INSURER_NO=INSURER_NO) AND A.PROPOSAL_NO = ?  AND A.INSURER_NO BETWEEN 0 AND ? ORDER BY A.INSURER_NO
premium.select.getNoRetroCess=   SELECT RD.RETRO_CESSIONARIES FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_CONTRACT_NO=? AND RD.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=RD.RSK_CONTRACT_NO)
premium.select.getSumOfShareSign=SELECT NVL(SUM(A.SHARE_SIGNED),0) SHARE_SIGNED FROM TTRN_RETRO_CESSIONARY A WHERE AMEND_ID = (SELECT MAX (AMEND_ID) FROM  TTRN_RETRO_CESSIONARY WHERE  A.CONTRACT_NO = CONTRACT_NO AND A.PROPOSAL_STATUS=PROPOSAL_STATUS AND A.SNO=SNO) AND A.CONTRACT_NO=? AND A.PROPOSAL_STATUS='A' AND A.SNO BETWEEN 0 AND ? ORDER BY A.SNO


fac.sp.facultativepage1={CALL FACULTATIVE_PAGE1_ORG(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
UPDATE_RISK_DETAILS = UPDATE TTRN_RISK_DETAILS SET INWARD_BUS_TYPE=?,RSK_RECEIPT_PAYEMENT=?,RSK_LOC_ISSUED=?,RSK_LATITUDE =?,RSK_LONGITUDE=?,RSK_VESSAL_TONNAGE=?,RS_ENDORSEMENT_TYPE=?,RSK_LOC_BNK_NAME=?,RSK_LOC_CRDT_PRD=?,RSK_LOC_CRDT_AMT=?,RSK_LOC_BENFCRE_NAME=? WHERE RSK_PROPOSAL_NUMBER=? and RSK_ENDORSEMENT_NO=?
UPDATE_FAC_RISK_PROPOSAL = UPDATE TTRN_FAC_RISK_PROPOSAL SET COVER_LIMIT_PML_OC=?, COVER_LIMIT_PML_DC=?,COVER_LIMIT_PML_OS_OC=?,COVER_LIMIT_PML_OS_DC=?,GWPI_PML_OC=?,GWPI_PML_DC=?, GWPI_PML_OS_OC=?,GWPI_PML_OS_DC=?, PSL_OC=?, PSL_DC=?, PSL_OS_OC=?, PSL_OS_DC=?, PLL_OC=?, PLL_DC=?, PLL_OS_OC=?, PLL_OS_DC=?,  PBL_OC=?, PBL_DC=?, PBL_OS_OC=?, PBL_OS_DC=?, PML_100_OC=?, PML_100_DC=?, PML_OS_OC=?,   PML_OS_DC=?, SUM_INS_PML_OC=?, SUM_INS_PML_DC=? ,SUM_INS_PML_OS_OC=? ,SUM_INS_PML_OS_DC=? WHERE RSK_PROPOSAL_NUMBER=? and RSK_ENDORSEMENT_NO=?
fac.select.getRenewalValidation=SELECT PM.UW_YEAR,TO_CHAR(PM.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,TO_DATE(?,'DD/MM/YYYY')-TO_DATE(TO_CHAR(PM.EXPIRY_DATE,'DD/MM/YYYY'),'DD/MM/YYYY') DIFF FROM POSITION_MASTER PM WHERE PM.CONTRACT_NO=? AND PM.RENEWAL_STATUS='0' AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO AND RENEWAL_STATUS=PM.RENEWAL_STATUS) ORDER BY PM.UW_YEAR DESC
fac.select.getSPRetroValidation=SELECT NVL(PM.FAC_CONTRACT_NO,'0') FAC_CONTRACT_NO FROM POSITION_MASTER PM WHERE PM.CONTRACT_NO=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO)
TTRN_RISK_REMARKS_AMEND_ID = SELECT NVL(MAX(AMEND_ID)+1,0) AMEND_ID FROM TTRN_RISK_REMARKS WHERE PROPOSAL_NO=?
UPDATE_UW_SHARE= UPDATE TTRN_RISK_COMMISSION SET RSK_LEAD_UW_SHARE=? WHERE RSK_PROPOSAL_NUMBER=?  AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?)
DELETE_COVERDEDUCTABLE_DETAILS=DELETE TTRN_FAC_SI TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_FAC_SI WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO)
INSERT_COVERDEDUCTABLE_DETAILS=INSERT INTO TTRN_FAC_SI (PROPOSAL_NO,CONTRACT_NO,LAYER_NO,DEPT_ID,PRODUCT_ID,AMEND_ID,RSK_SNO,RSK_CLASS,RSK_SUBCLASS,RSK_TYPE,RSK_COVERLIMIT_OC,RSK_DEDUCTABLELIMIT_OC,RSK_COVERAGE_DAYS,RSK_DEDUCTABLE_DAYS,RSK_PREMIUM_RATE,RSK_GWPI_OC,RSK_COVER_REMARKS,LOGIN_ID,BRANCH_CODE,SYS_DATE,PML_PERCENTAGE,PML_HUN_PER_OC,RSK_BUSINESS_TYPE) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)
TTRN_FAC_SI_AMEND_ID = SELECT NVL(MAX(AMEND_ID)+1,0) AMEND_ID FROM TTRN_FAC_SI WHERE PROPOSAL_NO=?
DELETE_COVERDEDUCTABLE_DETAILS=DELETE TTRN_FAC_SI TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_FAC_SI WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO)
INSERT_XOLCOVERDEDUCTABLE_DETAILS=INSERT INTO TTRN_FAC_SI (PROPOSAL_NO,CONTRACT_NO,LAYER_NO,DEPT_ID,PRODUCT_ID,AMEND_ID,RSK_SNO,RSK_CLASS,RSK_SUBCLASS,RSK_COVERLIMIT_OC,RSK_DEDUCTABLELIMIT_OC,RSK_PREMIUM_RATE,RSK_GWPI_OC,LOGIN_ID,BRANCH_CODE,SYS_DATE,RSK_BUSINESS_TYPE) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
fac.select.showSecondData=SELECT   RK.RSK_PROPOSAL_NUMBER, PFC.TMAS_PFC_NAME, (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND SPFC.TMAS_PRODUCT_ID = TDM.TMAS_PRODUCT_ID AND TDM.BRANCH_CODE = SPFC.BRANCH_CODE)TMAS_SPFC_NAME, PERSONAL.COMPANY_NAME COMPANY, PI.FIRST_NAME || '' || PI.LAST_NAME BROKER, RK.RSK_CONTRACT_NO, RK.RSK_UWYEAR, RK.RSK_INSURED_NAME, TDM.TMAS_DEPARTMENT_NAME, (SELECT   C.DETAIL_NAME FROM   CONSTANT_DETAIL C WHERE   RK.RS_ENDORSEMENT_TYPE = C.TYPE) DETAIL_NAME FROM   ttrn_risk_details RK, TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL, PERSONAL_INFO PI, TMAS_DEPARTMENT_MASTER TDM WHERE  RK.RSK_PROPOSAL_NUMBER = ? AND PFC.TMAS_PFC_ID = RSK_PFCID AND TDM.TMAS_PRODUCT_ID=? and TDM.TMAS_STATUS='Y' AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID AND PFC.BRANCH_CODE = PI.BRANCH_CODE  AND PI.BRANCH_CODE = ? AND PI.BRANCH_CODE = PERSONAL.BRANCH_CODE AND PERSONAL.BRANCH_CODE = PFC.BRANCH_CODE AND RK.RSK_BROKERID = PI.CUSTOMER_ID AND PERSONAL.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = PERSONAL.CUSTOMER_ID  AND CUSTOMER_TYPE = PERSONAL.CUSTOMER_TYPE AND BRANCH_CODE = PERSONAL.BRANCH_CODE) AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID AND CUSTOMER_TYPE = PI.CUSTOMER_TYPE AND BRANCH_CODE = PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   ttrn_risk_details WHERE   RSK_PROPOSAL_NUMBER = ?) AND RK.BRANCH_CODE = TDM.BRANCH_CODE AND RK.RSK_DEPTID = TDM.TMAS_DEPARTMENT_ID
fac.select.secondPageDet=SELECT FAC.RISK_GRADE,(select GRADE_DESC from TMAS_RISK_GRADE RG  where  fac.RISK_GRADE \= RG.GRADE_ID AND RG.STATUS \= 'Y' AND RG.BRANCH_CODE \= ?)GRADE_DESC,com.RSK_COMM+com.RSK_BROKERAGE+com.RSK_TAX+com.RSK_OTHER_COST ACC_Percentage,FAC.OCCUPATION_CODE,FAC.SUM_INSURED_OUR_SHARE_OC,FAC.GWPI_OUR_SHARE_OC,FAC.PML_OUR_SHARE_OC , FAC.TPL_OUR_SHARE_OC,FAC.RISK_DETAILS,FAC.FIRE_PORT,FAC.SCOPE,FAC.MB_IND,FAC.CATEGORY_ZONE,FAC.EARTHQUAKE_WS_IND,FAC.WS_THREAT_IND,EQ_THREAT,COM.RSK_COMM,COM.RSK_BROKERAGE,COM.RSK_TAX,COM.RSK_LOSS_RECORD,COM.RSK_DGM_APPROVAL,COM.RSK_UNDERWRITTER_CODE,COM.RSK_UW_RECOMMENDATION,COM.RSK_REMARKS,COM.RSK_OTH_ACCEP,COM.RSK_REF_TO_HO,COM.RSK_ACQUISTION_COST_OC,COM.RSK_NOCLAIMBONUS_PRCENT,COM.RSK_BONUS_ID,RSK_ACQUISTION_COST_DC,FAC.CU,FAC.CU_RSN,COM.RSK_OTHER_COST,FAC.M_LOP,FAC.A_LOP,FAC.MND_INSTALLMENTS,COM.RSK_LEAD_UNDERWRITER_COUNTRY,COM.RSK_LEAD_UW,RSK_LEAD_UW_SHARE,COM.RSK_EXCLUSION,COM.RSK_CREASTA_STATUS FROM TTRN_FAC_RISK_PROPOSAL FAC,TTRN_RISK_COMMISSION COM,TMAS_RISK_GRADE rg WHERE FAC.RSK_PROPOSAL_NUMBER\=? AND FAC.RSK_PROPOSAL_NUMBER\=COM.RSK_PROPOSAL_NUMBER AND FAC.RSK_ENDORSEMENT_NO IS NOT NULL AND COM.RSK_ENDORSEMENT_NO IS NOT NULL AND FAC.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_FAC_RISK_PROPOSAL WHERE RSK_ENDORSEMENT_NO IS NOT NULL AND  RSK_PROPOSAL_NUMBER\=? ) AND COM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_ENDORSEMENT_NO IS NOT NULL AND  RSK_PROPOSAL_NUMBER\=?)
risk.select.getInstalmentData=SELECT INSTALLMENT_NO,TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') INSTALLMENT_DATE,MND_PREMIUM_OC,PAYEMENT_DUE_DAY,TRANSACTION_NO FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO IS NOT NULL ) AND ENDORSEMENT_NO IS NOT NULL ORDER BY INSTALLMENT_NO
GET_LOSS_DETIALS = SELECT PROPOSAL_NO, CONTRACT_NO, ENDORSEMENT_NO, PRODUCT_ID, BRANCH, SYS_DATE, LAYER_NO, YEAR, LOSS_NO, INSURED_NAME, TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR(EXPIRYDATE,'DD/MM/YYYY') EXPIRYDATE,TO_CHAR(DATE_OF_LOSS,'DD/MM/YYYY') DATE_OF_LOSS, CAUSE_OF_LOSS, INSURED_CLAIM,  PREMIUM, LOSS_RATIO, LEADER, ITI_RE_SHARE FROM TTRN_LOSS_DETAILS T WHERE PROPOSAL_NO\=? AND LAYER_NO\=? AND ENDORSEMENT_NO\=( SELECT MAX(ENDORSEMENT_NO) FROM TTRN_LOSS_DETAILS D WHERE D.PROPOSAL_NO\=T.PROPOSAL_NO AND D.LAYER_NO\=T.LAYER_NO)  order by YEAR
BONUS_PREVIOUS_TYPE_CHECK = select nvl((SELECT  DISTINCT type  FROM TTRN_BONUS T WHERE PROPOSAL_NO =?  and BRANCH=? and LAYERNO =?  and ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM  TTRN_BONUS TT WHERE TT.PROPOSAL_NO =T.PROPOSAL_NO  and TT.BRANCH=T.BRANCH )),'NA') TYPE from dual
BONUS_MAIN_DELETE = DELETE FROM ttrn_bonus WHERE PROPOSAL_NO \=? and BRANCH\=? and TYPE\=? and LAYERNO \=?
BONUS_MAIN_DELETE2 = DELETE FROM ttrn_bonus WHERE PROPOSAL_NO =?  and ENDORSEMENT_NO =? and BRANCH=? and TYPE=? and LAYERNO =?
fac.sp.facultativepage2={CALL FACULTATIVE_PAGE2(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
fac.select.contGen=SELECT B.RSK_STATUS,A.SHARE_SIGNED,B.RSK_CONTRACT_NO FROM TTRN_FAC_RISK_PROPOSAL A,TTRN_RISK_DETAILS B WHERE A.RSK_PROPOSAL_NUMBER = B.RSK_PROPOSAL_NUMBER AND A.RSK_PROPOSAL_NUMBER =? AND A.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_FAC_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER =?) AND B.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER =?)
common.update.riskDetContNo=UPDATE TTRN_RISK_DETAILS SET RSK_CONTRACT_NO=?  where RSK_PROPOSAL_NUMBER=?
common.update.posMasDetContNo=UPDATE POSITION_MASTER SET CONTRACT_NO\=?,CONTRACT_STATUS\='A'  WHERE PROPOSAL_NO\=?
RISK_COM_UPDATE =UPDATE TTRN_RISK_COMMISSION SET  RSK_LEAD_UW\=?,RSK_LEAD_UW_SHARE\=?,RSK_LEAD_UNDERWRITER_COUNTRY\=?,RSK_EXCLUSION\=?,RSK_CREASTA_STATUS\=?,RSK_DOC_STATUS \= ? WHERE RSK_PROPOSAL_NUMBER \= ? AND RSK_ENDORSEMENT_NO\=?
LOSS_DELETE = DELETE FROM ttrn_loss_details T WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO=( SELECT MAX(ENDORSEMENT_NO) FROM TTRN_LOSS_DETAILS D WHERE D.PROPOSAL_NO=T.PROPOSAL_NO AND D.LAYER_NO=T.LAYER_NO)
SELECT_AMEND_ID = SELECT MAX(AMEND_ID) AMEND_ID FROM POSITION_MASTER WHERE PROPOSAL_NO=?
INSET_LOSS_REC = INSERT INTO ttrn_loss_details (PROPOSAL_NO ,   CONTRACT_NO ,   ENDORSEMENT_NO ,   PRODUCT_ID ,   BRANCH,   SYS_DATE ,   LAYER_NO,   YEAR,   LOSS_NO ,   INSURED_NAME,   INCEPTION_DATE,   EXPIRYDATE ,   DATE_OF_LOSS ,   CAUSE_OF_LOSS,   INSURED_CLAIM ,   PREMIUM ,   LOSS_RATIO ,   LEADER,   ITI_RE_SHARE)VALUES(?,?,?,?,?,SYSDATE,?,?,?,?,to_date(?,'DD/MM/YYYY'),to_date(?,'DD/MM/YYYY'),to_date(?,'DD/MM/YYYY'),?,?,?,?,?,?)
delete.facul.data=delete from TTRN_INSURER_DETAILS where PROPOSAL_NO=? and ENDORSEMENT_NO=?
fac.update.fac.contractNo=UPDATE POSITION_MASTER PM SET PM.FAC_CONTRACT_NO=? WHERE  PM.CONTRACT_NO=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO=PM.CONTRACT_NO)
fac.select.viewfirstPage=SELECT DECODE(RP.RSK_CEDRET_TYPE, 'P', 'Percentage', 'Amount') RSK_CEDRET_TYPE,RD.RS_ENDORSEMENT_TYPE,RD.RSK_PREMIUM_RATE,RD.RSK_PROPOSAL_NUMBER,RD.RSK_ENDORSEMENT_NO,RD.RSK_CONTRACT_NO, TPM.TMAS_PRODUCT_NAME,DM.TMAS_DEPARTMENT_ID,DM.TMAS_DEPARTMENT_NAME,PFC.TMAS_PFC_NAME, (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE \= RD.BRANCH_CODE) TMAS_SPFC_NAME,RD.RSK_SPFCID,PI.COMPANY_NAME COMAPNY, PIB.FIRST_NAME || PIB.LAST_NAME BROKER, RD.RSK_TREATYID, TO_CHAR(RD.RSK_MONTH, 'dd/mm/yyyy') MONTH,RD.RSK_UWYEAR, UM.UNDERWRITTER, TO_CHAR(RD.RSK_INCEPTION_DATE, 'dd/mm/yyyy') INSDATE, TO_CHAR(RD.RSK_EXPIRY_DATE, 'dd/mm/yyyy') EXPDATE,TO_CHAR(RD.RSK_ACCOUNT_DATE, 'dd/mm/yyyy') ACDATE, CM.SHORT_NAME, RD.RSK_EXCHANGE_RATE, TM.TERRITORY_DESC, RD.RSK_INSURED_NAME,RD.RSK_LOCATION, RD.RSK_CITY, RP.NR, RP.RSK_CEDANT_RETENTION, RP.MAXIMUM_LIMIT_OC,RP.DEDUCTIBLE_OC, RP.SP_RETRO, RP.PML,RP.SI_PML_OC,RP.CU, RP.CU_RSN, RP.SUM_INSURED_OC,RP.GWPI_OC, RP.PML_OC, RP.TPL_OC, RP.SHARE_WRITTEN, RP.SHARE_SIGNED, RD.RSK_PROPOSAL_TYPE,RP.RSK_INTEREST, RP.SUM_INSURED_DC, RP.GWPI_DC, RP.PML_DC, RP.TPL_DC, RP.SUM_INSURED_OUR_SHARE_DC, GWPI_OUR_SHARE_DC,PML_OUR_SHARE_DC,TPL_OUR_SHARE_DC, RP.NO_OF_INSURERS, PB.TMAS_POL_BRANCH_NAME, RP.SCOPE, RP.SUM_INSURED_OUR_SHARE_OC, RP.GWPI_OUR_SHARE_OC, RP.PML_OUR_SHARE_OC, RP.TPL_OUR_SHARE_OC,MOT.TRANSPORT_DESCRIPTION ,RP.VESSEL_NAME,RP.VESSEL_AGE,RP.LIMIT_PER_VESSEL_OC,RP.LIMIT_PER_VESSEL_DC,RP.LIMIT_PER_LOCATION_OC,RP.LIMIT_PER_LOCATION_DC,RP.MND_INSTALLMENTS,RP.DEDUCTIBLE_FACXOL_OC,RP.DEDUCTIBLE_FACXOL_DC,RP.DEDUCTIBLE_DC,RP.XOL_OC,RP.XOL_DC,RP.XOL_OURSHARE_OC,RP.XOL_OURSHARE_DC,RP.DEDUCTIBLE_OURSHARE_OC,RP.DEDUCTIBLE_OURSHARE_DC,RP.DEDUCTIBLE_FACXOL_OURSHARE_OC, RP.DEDUCTIBLE_FACXOL_OURSHARE_DC,CD.DETAIL_NAME TYPE_NAME,(select DETAIL_NAME from CONSTANT_DETAIL CD where CD.CATEGORY_ID \= '24' AND CD.TYPE \= RD.INWARD_BUS_TYPE AND CD.STATUS \= 'Y')INWARD_BUS_TYPE,RSK_LOC_ISSUED,RSK_LATITUDE,RSK_LONGITUDE,PSL_OC,PSL_DC,PSL_OS_OC,PSL_OS_DC,PLL_OC,PLL_DC,PLL_OS_OC,PLL_OS_DC,PBL_OC,PBL_DC,PBL_OS_OC,PBL_OS_DC,RSK_RECEIPT_PAYEMENT,RD.RSK_LOC_BNK_NAME,RD.RSK_LOC_CRDT_PRD,RD.RSK_LOC_CRDT_AMT,RD.RSK_LOC_BENFCRE_NAME,RD.RSK_TERRITORY,RD.COUNTRIES_INCLUDE,RD.COUNTRIES_EXCLUDE,RD.RSK_VESSAL_TONNAGE,RD.Xol_LAYER_NO, RP.PML_OS_OC,RP.PML_OS_DC,RP.PML_100_OC,RP.PML_100_DC FROM TTRN_RISK_DETAILS RD JOIN TTRN_FAC_RISK_PROPOSAL RP ON RD.RSK_PROPOSAL_NUMBER \= RP.RSK_PROPOSAL_NUMBER LEFT OUTER JOIN TMAS_PRODUCT_MASTER TPM ON TPM.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND TPM.BRANCH_CODE \= ? AND TPM.TMAS_STATUS \= '1' LEFT OUTER JOIN TMAS_PFC_MASTER PFC ON PFC.TMAS_PFC_ID \= RD.RSK_PFCID AND PFC.BRANCH_CODE \= ?  LEFT OUTER JOIN PERSONAL_INFO PIB ON RD.RSK_BROKERID \= PIB.CUSTOMER_ID AND PIB.BRANCH_CODE \= ? LEFT OUTER JOIN PERSONAL_INFO PI ON RD.RSK_CEDINGID \= PI.CUSTOMER_ID AND PI.BRANCH_CODE \= ?  LEFT OUTER JOIN TMAS_POLICY_BRANCH PB ON RD.RSK_POLBRANCH \= PB.TMAS_POL_BRANCH_ID AND PB.BRANCH_CODE \= ? LEFT OUTER JOIN CURRENCY_MASTER CM ON RD.RSK_ORIGINAL_CURR \= CM.CURRENCY_ID AND CM.BRANCH_CODE \= ? LEFT OUTER JOIN TERRITORY_MASTER TM ON RD.RSK_TERRITORY \= TM.TERRITORY_CODE AND TM.BRANCH_CODE \= ? LEFT OUTER JOIN UNDERWRITTER_MASTER UM ON RD.RSK_UNDERWRITTER \= UM.UWR_CODE AND UM.BRANCH_CODE \= ? LEFT OUTER JOIN TMAS_DEPARTMENT_MASTER DM ON DM.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND DM.TMAS_DEPARTMENT_ID \= RD.RSK_DEPTID AND DM.BRANCH_CODE \= ? AND DM.TMAS_STATUS \= 'H' LEFT OUTER JOIN TMAS_MODE_OF_TRANSPORT MOT ON MOT.MODE_TRANSPORT_ID\=RP.MODE_TRANSPORT_ID AND MOT.BRANCH_CODE\=? AND MOT.STATUS\='Y' LEFT OUTER JOIN CONSTANT_DETAIL CD ON CD.CATEGORY_ID\='13' AND CD.TYPE\=RP.TYPE AND CD.STATUS\='Y' WHERE RD.RSK_PROPOSAL_NUMBER \= ? AND PIB.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PERSONAL_INFO1 WHERE PIB.CUSTOMER_ID \= CUSTOMER_ID AND PIB.BRANCH_CODE \= BRANCH_CODE) AND PI.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PERSONAL_INFO2 WHERE PI.CUSTOMER_ID \= CUSTOMER_ID AND PI.BRANCH_CODE \= BRANCH_CODE) AND RP.RSK_ENDORSEMENT_NO \=? AND CM.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CM.CURRENCY_ID \= CURRENCY_ID  AND CM.BRANCH_CODE \= BRANCH_CODE) AND RD.RSK_ENDORSEMENT_NO \=?
SELECT_TERRITORY_NAME=SELECT   RTRIM(XMLAGG(XMLELEMENT(E,TERRITORY_NAME,',')).EXTRACT('//text()'),',') TERRITORY_NAME FROM   TMAS_TERRITORY  WHERE TERRITORY_ID in (?) and BRANCH_CODE= ?
SELECT_COUNTRY_NAME = SELECT   RTRIM(XMLAGG(XMLELEMENT(E,COUNTRY_NAME,',')).EXTRACT('//text()'),',') COUNTRY_NAME FROM   country_master  WHERE COUNTRY_ID in (?) and BRANCH_CODE= ?
SELECT_COUNTRY_NAME = SELECT   RTRIM(XMLAGG(XMLELEMENT(E,COUNTRY_NAME,',')).EXTRACT('//text()'),',') COUNTRY_NAME FROM   country_master  WHERE  COUNTRY_ID in (?) and BRANCH_CODE= ?
fac.select.viewsecondPage=SELECT FAC.RISK_GRADE,(select RG.GRADE_DESC from TMAS_RISK_GRADE RG where  fac.RISK_GRADE = RG.GRADE_ID AND RG.STATUS = 'Y' AND RG.BRANCH_CODE = ?) GRADE_DESC,com.RSK_COMM+com.RSK_BROKERAGE+com.RSK_TAX+com.RSK_OTHER_COST ACC_Percentage,FAC.OCCUPATION_CODE,FAC.SUM_INSURED_OUR_SHARE_OC,FAC.GWPI_OUR_SHARE_OC,FAC.PML_OUR_SHARE_OC ,FAC.TPL_OUR_SHARE_OC,FAC.RISK_DETAILS,FAC.FIRE_PORT,FAC.SCOPE,FAC.MB_IND,FAC.CATEGORY_ZONE,FAC.EARTHQUAKE_WS_IND,FAC.WS_THREAT_IND,EQ_THREAT,COM.RSK_COMM,COM.RSK_BROKERAGE,COM.RSK_TAX,COM.RSK_LOSS_RECORD,COM.RSK_DGM_APPROVAL,COM.RSK_UNDERWRITTER_CODE,COM.RSK_UW_RECOMMENDATION,COM.RSK_REMARKS,COM.RSK_OTH_ACCEP,COM.RSK_REF_TO_HO,COM.RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,FAC.CU, FAC.CU_RSN,COM.RSK_OTHER_COST,COM.RSK_NOCLAIMBONUS_PRCENT,COM.RSK_BONUS_ID,FAC.M_LOP,FAC.A_LOP,FAC.MND_INSTALLMENTS,TO_CHAR(pm.ENDORSEMENT_DATE,'DD/MM/YYYY') ENDORSEMENT_DATE ,RSK_LEAD_UNDERWRITER_COUNTRY,(SELECT   P.FIRST_NAME || ' ' || P.LAST_NAME FROM   PERSONAL_INFO P WHERE   P.BRANCH_CODE = ? and CUSTOMER_ID=RSK_LEAD_UW  AND STATUS = 'Y'  AND P.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE       BRANCH_CODE = P.BRANCH_CODE AND CUSTOMER_TYPE = P.CUSTOMER_TYPE AND STATUS = P.STATUS AND CUSTOMER_ID = P.CUSTOMER_ID))RSK_LEAD_UW,RSK_LEAD_UW_SHARE,(SELECT   ZONE_DESC FROM TMAS_CATEGORY_ZONE WHERE ZONE_ID=FAC.CATEGORY_ZONE  AND BRANCH_CODE=FAC.BRANCH_CODE)ZONE_DESC,RSK_CREASTA_STATUS,RSK_EXCLUSION,(SELECT DETAIL_NAME from constant_detail where CATEGORY_ID='2'  and TYPE=EARTHQUAKE_WS_IND)EARTHQUAKE_WS_IND_CON,pm.DATA_MAP_CONT_NO  FROM TTRN_FAC_RISK_PROPOSAL FAC,TTRN_RISK_COMMISSION COM,position_master pm WHERE FAC.RSK_PROPOSAL_NUMBER=? AND FAC.RSK_PROPOSAL_NUMBER=COM.RSK_PROPOSAL_NUMBER AND FAC.RSK_PROPOSAL_NUMBER=pm.PROPOSAL_NO  AND FAC.RSK_ENDORSEMENT_NO=COM.RSK_ENDORSEMENT_NO AND COM.RSK_ENDORSEMENT_NO=pm.AMEND_ID AND pm.AMEND_ID=?
GET_POSITION_MASTER_CON_MAP =SELECT NVL(DATA_MAP_CONT_NO,'0') DATA_MAP_CONT_NO FROM POSITION_MASTER WHERE PROPOSAL_NO\=? AND AMEND_ID\=?
GET_COVER_DEDUCTABLE_DETAILS=SELECT PML_PERCENTAGE,RSK_SNO,RSK_CLASS,RSK_SUBCLASS,RSK_TYPE,RSK_COVERLIMIT_OC,RSK_DEDUCTABLELIMIT_OC,RSK_COVERAGE_DAYS,RSK_DEDUCTABLE_DAYS,RSK_PREMIUM_RATE,RSK_GWPI_OC,RSK_COVER_REMARKS,PML_HUN_PER_OC FROM TTRN_FAC_SI TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND RSK_BUSINESS_TYPE='1' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_FAC_SI WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO  AND LAYER_NO=TRR.LAYER_NO AND RSK_BUSINESS_TYPE=TRR.RSK_BUSINESS_TYPE) order by RSK_SNO
GET_XOLCOVER_DEDUCTABLE_DETAILS=SELECT PML_PERCENTAGE,RSK_SNO,RSK_CLASS,RSK_SUBCLASS,RSK_TYPE,RSK_COVERLIMIT_OC,RSK_DEDUCTABLELIMIT_OC,RSK_COVERAGE_DAYS,RSK_DEDUCTABLE_DAYS,RSK_PREMIUM_RATE,RSK_GWPI_OC,RSK_COVER_REMARKS,PML_HUN_PER_OC FROM TTRN_FAC_SI TRR WHERE PROPOSAL_NO=? AND LAYER_NO=? AND RSK_BUSINESS_TYPE='2' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_FAC_SI WHERE  PROPOSAL_NO=TRR.PROPOSAL_NO AND LAYER_NO=TRR.LAYER_NO AND RSK_BUSINESS_TYPE=TRR.RSK_BUSINESS_TYPE ) order by RSK_SNO
GET_SIGN_SHARE_PRODUCT1=select nvl(SHARE_SIGNED,0) SHARE_SIGNED from ttrn_fac_risk_proposal rk where RSK_PROPOSAL_NUMBER=? and RSK_ENDORSEMENT_NO=(select max(RSK_ENDORSEMENT_NO) from ttrn_fac_risk_proposal where RSK_PROPOSAL_NUMBER=rk.RSK_PROPOSAL_NUMBER)
select_PREMIUM_QUOTASHARE_OC = select nvl(sum(PREMIUM_QUOTASHARE_OC),0) PREMIUM_QUOTASHARE_OC from rsk_premium_details where CONTRACT_NO= ?
select_GWPI_OUR_SHARE_OC = select nvl(GWPI_OUR_SHARE_OC,0) GWPI_OUR_SHARE_OC from  TTRN_FAC_RISK_PROPOSAL TFRP where RSK_PROPOSAL_NUMBER=(select PROPOSAL_NO from position_master PM where CONTRACT_NO=? and amend_id=(select max(amend_id) from position_master where CONTRACT_NO=pm.CONTRACT_NO and branch_code=?)) and RSK_ENDORSEMENT_NO=(select max(RSK_ENDORSEMENT_NO) from TTRN_FAC_RISK_PROPOSAL where RSK_PROPOSAL_NUMBER=TFRP.RSK_PROPOSAL_NUMBER)
premium.select.facContDet= SELECT RK.RSK_DEPTID,RK.RSK_CONTRACT_NO,RK.RSK_ENDORSEMENT_NO,PFC.TMAS_PFC_NAME,RK.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RK.RSK_PRODUCTID AND PFC.BRANCH_CODE = SPFC.BRANCH_CODE)TMAS_SPFC_NAME,PERSONAL.COMPANY_NAME COMPANY, RK.RSK_TREATYID ,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER,TO_CHAR(RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE,TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE,TO_CHAR(RK.RSK_EXPIRY_DATE,'DD/MM/YYYY')  EXP_DATE,TO_CHAR(RK.RSK_MONTH,'DD/MM/YYYY') MONTH,RK.RSK_PROPOSAL_NUMBER ,RK.RSK_UWYEAR,RK.RSK_LAYER_NO,RK.RSK_INSURED_NAME,RK.RSK_ORIGINAL_CURR,CM.CURRENCY_NAME,CM.SHORT_NAME,PERSONAL.ADDRESS1 || ' ' || PERSONAL.ADDRESS2 Address,PI.Special_Rate FROM TTRN_RISK_DETAILS RK ,TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,CURRENCY_MASTER CM WHERE RK.RSK_CONTRACT_NO=?    AND PFC.TMAS_PFC_ID=RSK_PFCID AND PFC.BRANCH_CODE=? AND  RK.BRANCH_CODE=? AND RK.RSK_PRODUCTID=? AND RK.RSK_CEDINGID=PERSONAL.CUSTOMER_ID AND PERSONAL.BRANCH_CODE=? AND PERSONAL.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE=PERSONAL.BRANCH_CODE ) AND RK.RSK_BROKERID=PI.CUSTOMER_ID AND PI.BRANCH_CODE=? AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID=PI.CUSTOMER_ID AND  BRANCH_CODE=PI.BRANCH_CODE ) AND RK.RSK_ENDORSEMENT_NO=( SELECT MAX( RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND CM.CURRENCY_ID=RK.RSK_ORIGINAL_CURR AND CM.BRANCH_CODE=PI.BRANCH_CODE AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=CM.CURRENCY_ID AND BRANCH_CODE=CM.BRANCH_CODE )
premium.select.commissionDetails=SELECT RSK_OUR_ASS_ACQ_COST,RSK_COMM,RSK_COMM_QUOTASHARE,RSK_COMM_SURPLUS,RSK_OVERRIDER_PERC,RSK_BROKERAGE,RSK_TAX,RSK_LOSS_RESERVE,RSK_OTHER_COST,RSK_ACQUISTION_COST_OC,RSK_MANAGEMENT_EXPENSES,RSK_PROFIT_COMM, NVL(RSK_PREMIUM_RESERVE,0) RSK_PREMIUM_RESERVE FROM  TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?)
premium.select.facProposalDetails= SELECT SHARE_SIGNED,GWPI_OUR_SHARE_OC,(NVL(GWPI_OUR_SHARE_OC,0)/NVL(D.RSK_EXCHANGE_RATE,0)) GWPI_OC,NVL(D.RSK_EXCHANGE_RATE,0) RSK_EXCHANGE_RATE FROM TTRN_FAC_RISK_PROPOSAL F,TTRN_RISK_DETAILS D  WHERE F.RSK_PROPOSAL_NUMBER=? AND  F.RSK_ENDORSEMENT_NO IS NOT NULL AND D.RSK_PROPOSAL_NUMBER=F.RSK_PROPOSAL_NUMBER AND D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND  F.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM  TTRN_FAC_RISK_PROPOSAL FP WHERE  FP.RSK_PROPOSAL_NUMBER=? AND  FP.RSK_ENDORSEMENT_NO IS NOT NULL )
premium.select.sumOfPaidPremium=SELECT NVL(SUM(PREMIUM_QUOTASHARE_OC),'0') PREMIUM_QUOTASHARE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=?
PREMIUM_MND_INS_LIST = SELECT INSTALLMENT_NO || '_'|| TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') KEY1,INSTALLMENT_NO || '\:'|| TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') VALUE,INSTALLMENT_NO FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO\=? AND LAYER_NO\=? AND ENDORSEMENT_NO\=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO\=? AND LAYER_NO\=?) AND TRANSACTION_NO IS NULL AND INSTALLMENT_NO NOT IN(SELECT INSTALMENT_NUMBER FROM RSK_PREMIUM_DETAILS_TEMP WHERE  REVERSE_TRANSACTION_NO is null AND CONTRACT_NO\=? AND LAYER_NO=? AND ACCOUNT_PERIOD_QTR IS NOT NULL) order by INSTALLMENT_NO
SELECT_DEPT_ID = SELECT DEPT_ID,PROPOSAL_NO FROM POSITION_MASTER M WHERE M.CONTRACT_NO =? AND M.PRODUCT_ID=?  AND M.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER P WHERE P.PROPOSAL_NO=M.PROPOSAL_NO)
premium.select.facPremiumEdit=SELECT TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,ACCOUNT_PERIOD_QTR,INSTALMENT_NUMBER, CURRENCY_ID ,EXCHANGE_RATE,PREMIUM_QUOTASHARE_OC,COMMISSION,COMMISSION_QUOTASHARE_OC, BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME,STATUS,RECEIPT_NO,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY') AMENDMENT_DATE,ENTERING_MODE,OTHER_COST_OC ,CEDANT_REFERENCE,REMARKS,NETDUE_OC,TOTAL_CR_OC,TOTAL_DR_OC,SETTLEMENT_STATUS, WITH_HOLDING_TAX_OC, WITH_HOLDING_TAX_DC,RI_CESSION,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,REVERSE_TRANSACTION_NO,REVERSEL_STATUS from RSK_PREMIUM_DETAILS WHERE CONTRACT_NO\=? AND TRANSACTION_NO\=?
PREMIUM_SELECT_FACPREMIUMEDIT_TEMP = SELECT TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,ACCOUNT_PERIOD_QTR,INSTALMENT_NUMBER, CURRENCY_ID ,EXCHANGE_RATE,PREMIUM_QUOTASHARE_OC,COMMISSION,COMMISSION_QUOTASHARE_OC, BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME,STATUS,RECEIPT_NO,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY') AMENDMENT_DATE,ENTERING_MODE,OTHER_COST_OC ,CEDANT_REFERENCE,REMARKS,NETDUE_OC,TOTAL_CR_OC,TOTAL_DR_OC,SETTLEMENT_STATUS, WITH_HOLDING_TAX_OC, WITH_HOLDING_TAX_DC,RI_CESSION,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,REVERSE_TRANSACTION_NO,REVERSEL_STATUS from RSK_PREMIUM_DETAILS_TEMP WHERE CONTRACT_NO=? AND REQUEST_NO=?
premium.select.sumOfPaidPremium=SELECT NVL(SUM(PREMIUM_QUOTASHARE_OC),'0') PREMIUM_QUOTASHARE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=?
premium.select.sumOfPaidPremium1 =SELECT NVL(SUM(PREMIUM_QUOTASHARE_OC),'0') PREMIUM_QUOTASHARE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? and TRANSACTION_NO != ?

premium.insert.facpremium=INSERT INTO RSK_PREMIUM_DETAILS_TEMP (RECEIPT_NO,CONTRACT_NO,REQUEST_NO,TRANSACTION_MONTH_YEAR,ACCOUNT_PERIOD_QTR,INSTALMENT_NUMBER,CURRENCY_ID ,EXCHANGE_RATE,PREMIUM_QUOTASHARE_OC,COMMISSION,COMMISSION_QUOTASHARE_OC,BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME,STATUS,NETDUE_OC,ENTERING_MODE,SETTLEMENT_STATUS,OTHER_COST_OC,PREMIUM_QUOTASHARE_DC,COMMISSION_QUOTASHARE_DC,BROKERAGE_AMT_DC,TAX_AMT_DC,NETDUE_DC,OTHER_COST_DC,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,ENTRY_DATE,RI_CESSION,LOGIN_ID,BRANCH_CODE,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,PREMIUM_CLASS,PREMIUM_SUBCLASS,STATEMENT_DATE,PROPOSAL_NO,PRODUCT_ID,REVERSEL_STATUS,TRANS_STATUS,TRANS_TYPE) VALUES(?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?)
UPDATE_MND_INSTALLMENT=UPDATE TTRN_MND_INSTALLMENTS TMI SET TRANSACTION_NO=? WHERE  CONTRACT_NO = ? AND LAYER_NO = ? and INSTALLMENT_NO=? AND ENDORSEMENT_NO = (SELECT   MAX (ENDORSEMENT_NO)  FROM   TTRN_MND_INSTALLMENTS  WHERE   CONTRACT_NO = TMI.CONTRACT_NO AND LAYER_NO = TMI.LAYER_NO and INSTALLMENT_NO=TMI.INSTALLMENT_NO)
UPDATE_REV_TRANSACTION_NO =UPDATE RSK_PREMIUM_DETAILS SET REVERSE_TRANSACTION_NO\=? WHERE TRANSACTION_NO\=?
UPDATE_REV_TRANSACTION_NO_RETRO =UPDATE RSK_XL_PREMIUM_DETAILS SET REVERSE_TRANSACTION_NO\=? WHERE TRANSACTION_NO\=?
UPDATE_MND_INSTAL =UPDATE TTRN_MND_INSTALLMENTS M SET TRANSACTION_NO\=? WHERE PROPOSAL_NO\=? AND TRANSACTION_NO\=?
premium.select.getFacSPRetro=SELECT RP.SP_RETRO,RP.NO_OF_INSURERS,RP.RSK_PROPOSAL_NUMBER FROM TTRN_FAC_RISK_PROPOSAL RP,TTRN_RISK_DETAILS RD WHERE RP.RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_FAC_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO=? AND RD.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=RD.RSK_CONTRACT_NO)
premium.select.getTreatySPRetro=SELECT   RP.RSK_SP_RETRO, RP.RSK_NO_OF_INSURERS,RP.RSK_PROPOSAL_NUMBER FROM   TTRN_RISK_PROPOSAL RP, TTRN_RISK_DETAILS RD WHERE   RP.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO =?  AND RD.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO = RD.RSK_CONTRACT_NO)
premium.select.geXOLSPRetro=SELECT RP.RSK_SP_RETRO, RP.RSK_NO_OF_INSURERS,RP.RSK_PROPOSAL_NUMBER FROM TTRN_RISK_PROPOSAL RP, TTRN_RISK_DETAILS RD WHERE   RP.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO =? AND RD.RSK_LAYER_NO=? AND RD.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO = RD.RSK_CONTRACT_NO AND RSK_LAYER_NO=RD.RSK_LAYER_NO)
premium.select.getSumOfShareSign=SELECT NVL(SUM(A.SHARE_SIGNED),0) SHARE_SIGNED FROM TTRN_RETRO_CESSIONARY A WHERE AMEND_ID = (SELECT MAX (AMEND_ID) FROM  TTRN_RETRO_CESSIONARY WHERE  A.CONTRACT_NO = CONTRACT_NO AND A.PROPOSAL_STATUS=PROPOSAL_STATUS AND A.SNO=SNO) AND A.CONTRACT_NO=? AND A.PROPOSAL_STATUS='A' AND A.SNO BETWEEN 0 AND ? ORDER BY A.SNO
premium.mov.rep.max.date=SELECT TO_CHAR(MAX(TO_DATE(B.REMARKS || '/' || A.ACCOUNT_PERIOD_DATE,'DD/MM/YYYY')),'DD/MM/YYYY') AS MAX_DATE FROM (SELECT ACCOUNT_PERIOD_QTR,MAX(ACCOUNT_PERIOD_DATE) ACCOUNT_PERIOD_DATE FROM TRANSACTION_MOVEMENT_DETAILS WHERE BRANCH_CODE =? AND REPORT_TYPE='F' GROUP BY   ACCOUNT_PERIOD_QTR ORDER BY ACCOUNT_PERIOD_QTR,ACCOUNT_PERIOD_DATE DESC) A, CONSTANT_DETAIL B WHERE A.ACCOUNT_PERIOD_QTR = B.TYPE AND B.CATEGORY_ID ='12'
PREMIUM_UPDATE_FACUPATEPRE_TEMP =UPDATE RSK_PREMIUM_DETAILS_TEMP SET ACCOUNT_PERIOD_QTR\=?,INSTALMENT_NUMBER\=?,TRANSACTION_MONTH_YEAR\=TO_DATE(?,'DD/MM/YYYY'),CURRENCY_ID\=?,EXCHANGE_RATE\=?,PREMIUM_QUOTASHARE_OC\=?,COMMISSION\=?,COMMISSION_QUOTASHARE_OC\=?,BROKERAGE\=? ,BROKERAGE_AMT_OC\=?,TAX\=?,TAX_AMT_OC\=?,ENTRY_DATE_TIME\=to_date(?,'dd/mm/yyyy'),STATUS\=?, NETDUE_OC\=?,ENTERING_MODE\=?,RECEIPT_NO\=?,OTHER_COST_OC\=?,PREMIUM_QUOTASHARE_DC\=?, COMMISSION_QUOTASHARE_DC\=?,BROKERAGE_AMT_DC\=?,TAX_AMT_DC\=?,NETDUE_DC\=?,OTHER_COST_DC\=?, CEDANT_REFERENCE\=?,REMARKS\=?,TOTAL_CR_OC\=?,TOTAL_CR_DC\=?,TOTAL_DR_OC\=?,TOTAL_DR_DC\=?,AMENDMENT_DATE\=to_date(?,'dd/mm/yyyy'),ENTRY_DATE\=SYSDATE,MOVEMENT_YN\=NULL,WITH_HOLDING_TAX_OC\=?,WITH_HOLDING_TAX_DC\=?,RI_CESSION\=?,LOGIN_ID\=?,BRANCH_CODE\=?,TDS_OC\=?,TDS_DC\=?,ST_OC\=?,ST_DC\=?,BONUS_OC\=?,BONUS_DC\=?,PREMIUM_CLASS\=?,PREMIUM_SUBCLASS\=?,STATEMENT_DATE\=TO_DATE(?,'DD/MM/YYYY'),TRANS_TYPE\=? WHERE CONTRACT_NO\=? AND REQUEST_NO\=?
premium.update.facUpdatePre=UPDATE RSK_PREMIUM_DETAILS SET ACCOUNT_PERIOD_QTR\=?,INSTALMENT_NUMBER\=?,TRANSACTION_MONTH_YEAR\=TO_DATE(?,'DD/MM/YYYY'),CURRENCY_ID\=?,EXCHANGE_RATE\=?,PREMIUM_QUOTASHARE_OC\=?,COMMISSION\=?,COMMISSION_QUOTASHARE_OC\=?,BROKERAGE\=? ,BROKERAGE_AMT_OC\=?,TAX\=?,TAX_AMT_OC\=?,ENTRY_DATE_TIME\=to_date(?,'dd/mm/yyyy'),STATUS\=?, NETDUE_OC\=?,ENTERING_MODE\=?,RECEIPT_NO\=?,OTHER_COST_OC\=?,PREMIUM_QUOTASHARE_DC\=?, COMMISSION_QUOTASHARE_DC\=?,BROKERAGE_AMT_DC\=?,TAX_AMT_DC\=?,NETDUE_DC\=?,OTHER_COST_DC\=?, CEDANT_REFERENCE\=?,REMARKS\=?,TOTAL_CR_OC\=?,TOTAL_CR_DC\=?,TOTAL_DR_OC\=?,TOTAL_DR_DC\=?,AMENDMENT_DATE\=to_date(?,'dd/mm/yyyy'),ENTRY_DATE\=SYSDATE,MOVEMENT_YN\=NULL,WITH_HOLDING_TAX_OC\=?,WITH_HOLDING_TAX_DC\=?,RI_CESSION\=?,LOGIN_ID\=?,BRANCH_CODE\=?,TDS_OC\=?,TDS_DC\=?,ST_OC\=?,ST_DC\=?,BONUS_OC\=?,BONUS_DC\=?,PREMIUM_CLASS\=?,PREMIUM_SUBCLASS\=?,STATEMENT_DATE\=TO_DATE(?,'DD/MM/YYYY'),TRANS_TYPE\=? WHERE CONTRACT_NO\=? AND TRANSACTION_NO\=?
premium.detail.archive={CALL PREMIUM_DETAIL_ARCHIVE(?,?,?,?,?,?,?,?)}
PREMIUM_SELECT_FACPREMIVIEW_TEMP = SELECT CONTRACT_NO,TRANSACTION_NO,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,EXCHANGE_RATE,BROKERAGE, BROKERAGE_AMT_OC, TAX, TAX_AMT_OC,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,NETDUE_OC, LAYER_NO,ENTERING_MODE,ENTRY_DATE_TIME,ACCOUNT_PERIOD_QTR,CURRENCY_ID,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE, CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,SETTLEMENT_STATUS,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,INSTALMENT_NUMBER,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (TRANSACTION_MONTH_YEAR+30, 'DD/MM/YYYY') due_date,RI_CESSION,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,REVERSEL_STATUS,REVERSE_TRANSACTION_NO,PREMIUM_QUOTASHARE_OC,PREMIUM_QUOTASHARE_DC,COMMISSION_QUOTASHARE_OC,COMMISSION_QUOTASHARE_DC,STATUS,RECEIPT_NO, ( select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=RK.PREMIUM_CLASS and branch_code\=RK.branch_code and TMAS_PRODUCT_ID\=?  AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME,PREMIUM_SUBCLASS, ( select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()' ),',') from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in( select * from table(SPLIT_TEXT_FN(replace(RK.PREMIUM_SUBCLASS,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= ? AND RK.BRANCH_CODE \= SPFC.BRANCH_CODE)PREMIUM_SUBCLASS_VAL from RSK_PREMIUM_DETAILS_TEMP RK where CONTRACT_NO\=? and REQUEST_NO\=?
premium.select.facPremiumView=SELECT TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,ACCOUNT_PERIOD_QTR,INSTALMENT_NUMBER, CURRENCY_ID ,EXCHANGE_RATE,PREMIUM_QUOTASHARE_OC,COMMISSION,COMMISSION_QUOTASHARE_OC, BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME,STATUS,RECEIPT_NO,NETDUE_OC ,TRANSACTION_NO,OTHER_COST_OC,PREMIUM_QUOTASHARE_DC,COMMISSION_QUOTASHARE_DC,BROKERAGE_AMT_DC,TAX_AMT_DC, NETDUE_DC,OTHER_COST_DC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,SETTLEMENT_STATUS, WITH_HOLDING_TAX_OC, WITH_HOLDING_TAX_DC,TO_CHAR (TO_DATE(ACCOUNT_PERIOD_QTR,'DD/MM/YYYY')+30, 'DD/MM/YYYY') due_date,RI_CESSION,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,(select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=RK.PREMIUM_CLASS and branch_code\=RK.branch_code  and TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME,PREMIUM_SUBCLASS, (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.PREMIUM_SUBCLASS,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= ? AND RK.BRANCH_CODE \= SPFC.BRANCH_CODE)PREMIUM_SUBCLASS_VAL,REVERSEL_STATUS,REVERSE_TRANSACTION_NO from RSK_PREMIUM_DETAILS RK WHERE CONTRACT_NO\=? AND TRANSACTION_NO\=?
premium.select.sumOfPaidPremium=SELECT NVL(SUM(PREMIUM_QUOTASHARE_OC),'0') PREMIUM_QUOTASHARE_OC FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=?
premium.select.mndPremiumOC=SELECT M.MND_PREMIUM_OC  FROM TTRN_MND_INSTALLMENTS M WHERE M.CONTRACT_NO=? AND M.LAYER_NO=? AND M.INSTALLMENT_NO=? AND M.ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO)  FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO=M.CONTRACT_NO AND LAYER_NO=M.LAYER_NO AND INSTALLMENT_NO=M.INSTALLMENT_NO)
FAC_PREMIUM_CONTRACT_DETAILS =SELECT   RK.RSK_DEPTID, RK.RSK_CONTRACT_NO, RK.RSK_ENDORSEMENT_NO, PERSONAL.COMPANY_NAME COMPANY, RK.RSK_TREATYID, PI.FIRST_NAME || ' ' || PI.LAST_NAME BROKER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE, RK.RSK_PROPOSAL_NUMBER, RK.RSK_UWYEAR, RK.RSK_LAYER_NO, RK.RSK_ORIGINAL_CURR, (select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=RK.RSK_DEPTID and branch_code\=RK.branch_code  and TMAS_PRODUCT_ID\=RK.RSK_PRODUCTID AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME , ( SELECT RSK_BONUS_ID FROM          TTRN_RISK_COMMISSION T WHERE RSK_PROPOSAL_NUMBER\=RK.RSK_PROPOSAL_NUMBER AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=T.RSK_PROPOSAL_NUMBER)) BONUS_TYPE,RK.RSK_INSURED_NAME  FROM   TTRN_RISK_DETAILS RK, PERSONAL_INFO PERSONAL, PERSONAL_INFO PI  WHERE       RK.RSK_CONTRACT_NO \= ? AND RSK_LAYER_NO \=NVL(?,0) AND RK.RSK_CEDINGID \= PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE \= 'C' AND PERSONAL.BRANCH_CODE \= ? AND PERSONAL.AMEND_ID \=       (SELECT   MAX (AMEND_ID)          FROM   PERSONAL_INFO         WHERE   CUSTOMER_ID \= PERSONAL.CUSTOMER_ID        AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PI.CUSTOMER_TYPE \= 'B' AND PI.BRANCH_CODE \= ? AND PI.AMEND_ID \=       (SELECT   MAX (AMEND_ID)          FROM   PERSONAL_INFO         WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID        AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO)        FROM   TTRN_RISK_DETAILS       WHERE   RSK_CONTRACT_NO \= ? AND RSK_LAYER_NO \=NVL(?,0))
GET_SILDE_VALUE_DEPT = SELECT   (case count(*) when  0  then 0 else  sum(nvl(LCB_PERCENTAGE,0))  end) as LCB_PERCENTAGE FROM   TTRN_BONUS T WHERE   CONTRACT_NO = ? AND PRODUCT_ID = ? AND BRANCH = ? and ?  between LCB_FROM and LCB_TO and TYPE=? and SUB_CLASS=? and PROPOSAL_NO=? AND T.ENDORSEMENT_NO =(SELECT   MAX (ENDORSEMENT_NO) FROM   TTRN_BONUS B WHERE       T.CONTRACT_NO = B.CONTRACT_NO AND T.PRODUCT_ID = B.PRODUCT_ID AND T.BRANCH = B.BRANCH)
GET_BONUS_VALUE= SELECT nvl(RSK_NOCLAIMBONUS_PRCENT,0) RSK_NOCLAIMBONUS_PRCENT FROM TTRN_RISK_COMMISSION TRC,TTRN_RISK_DETAILS TRD WHERE TRC.RSK_PROPOSAL_NUMBER=TRD.RSK_PROPOSAL_NUMBER AND TRD.RSK_CONTRACT_NO=? and TRD.RSK_LAYER_NO=NVL(?,0) AND TRC.RSK_ENDORSEMENT_NO=( SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION  WHERE RSK_PROPOSAL_NUMBER=TRC.RSK_PROPOSAL_NUMBER) AND TRD.RSK_ENDORSEMENT_NO=( SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=TRC.RSK_PROPOSAL_NUMBER)
GET_BONUS_PAID_AMOUT=SELECT CD.CURRENCY CURRENCY_ID,T.PAID_AMOUNT_OC,(select SHORT_NAME from  CURRENCY_MASTER C where CURRENCY_ID=CD.CURRENCY and BRANCH_CODE=CD.BRANCH_CODE AND STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  CURRENCY_MASTER CM WHERE CM.CURRENCY_ID=CD.CURRENCY AND  CM.BRANCH_CODE=CD.BRANCH_CODE AND CM.STATUS='Y'))SHORT_NAME,'0'PremiumOC,'0' CLAIM_PAID_AMOUNT,'0' COMMISSION_PAID_OC,'0'CliamOSOC,T.CONTRACT_NO CONTRACT_NO,TO_CHAR(T.INCEPTION_DATE,'DD/MM/YYYY') TRANSACTION_MONTH_YEAR,T.CLAIM_PAYMENT_NO TRANSACTION_NO,D.TMAS_DEPARTMENT_NAME FROM TTRN_CLAIM_PAYMENT T,TTRN_CLAIM_DETAILS CD,TMAS_DEPARTMENT_MASTER D WHERE   T.CONTRACT_NO =? AND  T.LAYER_NO=NVL(?,0) AND T.LAYER_NO= CD.LAYER_NO AND CD.CONTRACT_NO = T.CONTRACT_NO AND CD.CLAIM_NO = T.CLAIM_NO AND CD.BRANCH_CODE = ? AND TRUNC(T.INCEPTION_DATE) < = TO_DATE (?, 'DD/MM/YYYY')  AND D.TMAS_DEPARTMENT_ID=CD.SUB_CLASS AND   D.BRANCH_CODE = CD.BRANCH_CODE AND D.TMAS_PRODUCT_ID=? AND D.TMAS_STATUS ='Y' ORDER BY CD.CURRENCY
GET_BONUS_PREMIUM_DETAILS=SELECT C.SHORT_NAME,  R.CURRENCY_ID,R.PREMIUM_QUOTASHARE_OC, R.M_DPREMIUM_OC,  R.ADJUSTMENT_PREMIUM_OC,(nvl(R.PREMIUM_QUOTASHARE_OC,0)+ nvl(R.M_DPREMIUM_OC,0)+  nvl(R.ADJUSTMENT_PREMIUM_OC,0))PremiumOC,(CLAIMS_PAID_OC+ CLAIM_PORTFOLIO_OUT_OC+ CASH_LOSSPAID_OC- CASH_LOSS_CREDIT_OC- CLAIM_PORTFOLIOIN_OC) CLAIM_PAID_AMOUNT,(COMMISSION_QUOTASHARE_OC+COMMISSION_SURPLUS_OC)COMMISSION_PAID_OC,'0'PAID_AMOUNT_OC,CONTRACT_NO,C.CURRENCY_NAME  CURRENCY,TO_CHAR(R.TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANSACTION_MONTH_YEAR,R.SUB_CLASS,R.TRANSACTION_NO,D.TMAS_DEPARTMENT_NAME,150000 CliamOSOC,BONUS_OC   FROM   CURRENCY_MASTER C, RSK_PREMIUM_DETAILS R,TMAS_DEPARTMENT_MASTER D WHERE       C.CURRENCY_ID IN (SELECT   CURRENCY_ID    FROM   rsk_premium_details WHERE   CONTRACT_NO = ? AND LAYER_NO=NVL(?,0)) AND C.BRANCH_CODE = ? AND C.BRANCH_CODE = R.BRANCH_CODE AND C.STATUS = 'Y'  AND R.CONTRACT_NO = ?  AND LAYER_NO=NVL(?,0) AND R.CURRENCY_ID = C.CURRENCY_ID AND R.TRANSACTION_MONTH_YEAR <= TO_DATE (?, 'DD/MM/YYYY')  AND D.TMAS_DEPARTMENT_ID=R.SUB_CLASS AND   D.BRANCH_CODE = R.BRANCH_CODE AND D.TMAS_PRODUCT_ID=? AND D.TMAS_STATUS ='Y' and C.AMEND_ID =(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER CM WHERE CM.BRANCH_CODE = C.BRANCH_CODE AND CM.CURRENCY_ID =C.CURRENCY_ID AND  C.STATUS = 'Y') ORDER BY R.CURRENCY_ID
GET_BONUS_RESERVED_CLAIM_PAID=SELECT (NVL(TBLA.CLAIM_RESERVED,0)-NVL(TBLB.CALIM_PAID,0))OSLR ,TBLA.CURRENCY_ID,TBLA.CLAIM_RESERVED,TBLB.CALIM_PAID FROM  ( SELECT  SUM(NVL(LOSS_ESTIMATE_REVISED_OC,0) + NVL(SAF_OS_OC,0) + NVL(OTH_FEE_OS_OC,0))CLAIM_RESERVED,CURRENCY_ID,TCU.CL
GET_BONUS_CURRENY_DET=SELECT DISTINCT C.SHORT_NAME, C.CURRENCY_ID FROM   CURRENCY_MASTER C  WHERE C.CURRENCY_ID IN  (select to_char(CURRENCY_ID) from rsk_premium_details R where CONTRACT_NO \= ? and LAYER_NO\=nvl(?,0)   and trunc(R.TRANSACTION_MONTH_YEAR) <\= TO_DATE (?, 'DD/MM/YYYY') AND R.BRANCH_CODE\=?  union select to_char(CURRENCY) from TTRN_CLAIM_DETAILS CD where CD.CONTRACT_NO \= ? and LAYER_NO\=nvl(?,0)   and trunc(CD.CREATED_DATE) <\= TO_DATE (?, 'DD/MM/YYYY') AND CD.BRANCH_CODE\=?)   AND C.BRANCH_CODE \= ? AND C.STATUS \= 'Y' ORDER BY C.CURRENCY_ID
premium.select.mdInstallments= SELECT   INSTALMENT_NUMBER FROM   RSK_PREMIUM_DETAILS_TEMP WHERE   CONTRACT_NO = ? AND LAYER_NO = ? AND INSTALMENT_NUMBER!='RP' AND INSTALMENT_NUMBER!='AP' AND INSTALMENT_NUMBER!='RTP' AND INSTALMENT_NUMBER!='RVP' AND TRANS_STATUS!='R' ORDER BY INSTALMENT_NUMBER
premium.select.PremiumedList1=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TO_CHAR (TRA.STATEMENT_DATE, 'DD/MM/YYYY')STATEMENT_DATE,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?
premium.select.retroPremiumedList1=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE,TO_CHAR (TRA.STATEMENT_DATE, 'DD/MM/YYYY')STATEMENT_DATE,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_XL_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?
premium.select.xolLayer1= AND RSK_LAYER_NO=?
premium.select.PremiumedList2= ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO 
premium.select.xolLayer2= AND TRA.LAYER_NO\=RK.RSK_LAYER_NO 
premium.select.xolLayer3= AND RK.RSK_LAYER_NO\=? 
premium.select.PremiumedList3= ORDER BY TRA.TRANSACTION_NO DESC
premium.select.PremiumedList1_added=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?AND RSK_LAYER_NO=? ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO  AND TRA.LAYER_NO\=RK.RSK_LAYER_NO  AND RK.RSK_LAYER_NO\=? ORDER BY TRA.TRANSACTION_NO DESC
premium.select.retroPremiumedList1_added=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE,TO_CHAR (TRA.STATEMENT_DATE, 'DD/MM/YYYY')STATEMENT_DATE,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_XL_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=?AND RSK_LAYER_NO=? ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO  AND TRA.LAYER_NO\=RK.RSK_LAYER_NO  AND RK.RSK_LAYER_NO\=? ORDER BY TRA.TRANSACTION_NO DESC
XOL_PREMIUM_LIST_TEMP = SELECT REQUEST_NO,RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID=49 AND TYPE=TRA.ACCOUNT_PERIOD_QTR and STATUS='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS_TEMP TRA WHERE RK.RSK_CONTRACT_NO=? AND RK.RSK_CEDINGID=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID = PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE=? AND PERSONAL.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE = PERSONAL.BRANCH_CODE AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=? AND RSK_LAYER_NO=? ) AND TRA.CONTRACT_NO=RK.RSK_CONTRACT_NO  AND TRA.LAYER_NO=RK.RSK_LAYER_NO  AND RK.RSK_LAYER_NO=? AND TRANS_STATUS='P' ORDER BY TRA.TRANSACTION_NO DESC
allocation.status=select COUNT(*) COUNT from  ttrn_allocated_transaction where transaction_no=? AND STATUS='Y'
retro.status=select COUNT(*) COUNT from ttrn_retro_prcl trp where transaction_no\=?
retro.status1=select COUNT(*) COUNT from ttrn_retro_prcl trp where transaction_no=? AND process_id IS NOT NULL and trp.amend_id=(select max(amend_id) from ttrn_retro_prcl tr where trp.transaction_no=tr.transaction_no)
SELECT_RSK_SUBJ_PREMIUM_OC=SELECT NVL(RSK_SUBJ_PREMIUM_OC,0) RSK_SUBJ_PREMIUM_OC FROM  TTRN_RISK_PROPOSAL TRP WHERE RSK_PROPOSAL_NUMBER=(SELECT PROPOSAL_NO FROM POSITION_MASTER PM WHERE CONTRACT_NO=?   AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE   CONTRACT_NO = PM.CONTRACT_NO AND LAYER_NO=PM.LAYER_NO AND CONTRACT_STATUS=PM.CONTRACT_STATUS ) AND CONTRACT_STATUS = 'A'  AND LAYER_NO =?) AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=TRP.RSK_PROPOSAL_NUMBER)
select_Previous_premium=select nvl(sum(M_DPREMIUM_OC+ADJUSTMENT_PREMIUM_OC),0) SUM from rsk_premium_details where CONTRACT_NO = ?
premium.select.mdInstalmentList= SELECT INSTALLMENT_NO || '_'|| TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') KEY1,INSTALLMENT_NO || '\:'|| TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') VALUE,INSTALLMENT_NO FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO\=? AND LAYER_NO\=? AND ENDORSEMENT_NO\=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE CONTRACT_NO\=? AND LAYER_NO\=?) AND TRANSACTION_NO IS NULL  order by INSTALLMENT_NO
GET_GNPI_COUNT_PRE = SELECT COUNT(RS_ENDORSEMENT_TYPE) COUNT FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=? AND RSK_LAYER_NO=? AND RS_ENDORSEMENT_TYPE=?
premium.select.treatyContDet1= SELECT   RK.TREATYTYPE,RK.RSK_DEPTID,RK.RSK_SPFCID,RK.RSK_CONTRACT_NO,RK.RSK_ENDORSEMENT_NO, PFC.TMAS_PFC_NAME,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RK.RSK_PRODUCTID AND PFC.BRANCH_CODE \= SPFC.BRANCH_CODE)TMAS_SPFC_NAME, PERSONAL.COMPANY_NAME COMPANY, RK.RSK_TREATYID, PI.FIRST_NAME || ' ' || PI.LAST_NAME BROKER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE,TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,TO_CHAR(RK.RSK_MONTH,'DD/MM/YYYY') MONTH, BRANCH.TMAS_POL_BRANCH_NAME,RK.RSK_PROPOSAL_NUMBER, RK.RSK_UWYEAR, RK.RSK_LAYER_NO,RK.RSK_ORIGINAL_CURR,CM.SHORT_NAME CURRENCY_NAME,PERSONAL.ADDRESS1 || ' ' || PERSONAL.ADDRESS2 Address,RK.INWARD_BUS_TYPE,(select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=RK.RSK_DEPTID and branch_code\=RK.branch_code  and TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME FROM   TTRN_RISK_DETAILS RK,TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL, TMAS_POLICY_BRANCH BRANCH,PERSONAL_INFO PI,CURRENCY_MASTER CM  WHERE RK.RSK_CONTRACT_NO \= ?
premium.select.xolLayerNo1=AND RK.RSK_LAYER_NO\=?  
premium.select.treatyContDet2= AND PFC.TMAS_PFC_ID \= RK.RSK_PFCID AND PFC.BRANCH_CODE \= ? AND RK.BRANCH_CODE \= ? AND RK.RSK_PRODUCTID \= ? AND RK.RSK_CEDINGID \= PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE\='C' AND PERSONAL.BRANCH_CODE \= ? AND PERSONAL.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PERSONAL.CUSTOMER_ID AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND   PI.CUSTOMER_TYPE\='B' AND PI.BRANCH_CODE \= ? AND PI.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO \=?
premium.select.xolLayerNo2=AND RSK_LAYER_NO=?
premium.select.treatyContDet3= )AND RK.RSK_POLBRANCH = BRANCH.TMAS_POL_BRANCH_ID AND BRANCH.BRANCH_CODE = ? AND CM.CURRENCY_ID=RK.RSK_ORIGINAL_CURR AND CM.BRANCH_CODE=PI.BRANCH_CODE AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=CM.CURRENCY_ID AND BRANCH_CODE=CM.BRANCH_CODE )
premium.select.treatyContDet1_xolLayerNo2=SELECT   RK.TREATYTYPE,RK.RSK_DEPTID,RK.RSK_SPFCID,RK.RSK_CONTRACT_NO,RK.RSK_ENDORSEMENT_NO, PFC.TMAS_PFC_NAME,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RK.RSK_PRODUCTID AND PFC.BRANCH_CODE \= SPFC.BRANCH_CODE)TMAS_SPFC_NAME, PERSONAL.COMPANY_NAME COMPANY, RK.RSK_TREATYID, PI.FIRST_NAME || ' ' || PI.LAST_NAME BROKER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE,TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,TO_CHAR(RK.RSK_MONTH,'DD/MM/YYYY') MONTH, BRANCH.TMAS_POL_BRANCH_NAME,RK.RSK_PROPOSAL_NUMBER, RK.RSK_UWYEAR, RK.RSK_LAYER_NO,RK.RSK_ORIGINAL_CURR,CM.SHORT_NAME CURRENCY_NAME,PERSONAL.ADDRESS1 || ' ' || PERSONAL.ADDRESS2 Address,RK.INWARD_BUS_TYPE,(select TMAS_DEPARTMENT_NAME From tmas_department_master where TMAS_DEPARTMENT_ID\=RK.RSK_DEPTID and branch_code\=RK.branch_code  and TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y')  TMAS_DEPARTMENT_NAME FROM   TTRN_RISK_DETAILS RK,TMAS_PFC_MASTER PFC, PERSONAL_INFO PERSONAL, TMAS_POLICY_BRANCH BRANCH,PERSONAL_INFO PI,CURRENCY_MASTER CM  WHERE RK.RSK_CONTRACT_NO \= ? AND RK.RSK_LAYER_NO\=?  AND PFC.TMAS_PFC_ID \= RK.RSK_PFCID AND PFC.BRANCH_CODE \= ? AND RK.BRANCH_CODE \= ? AND RK.RSK_PRODUCTID \= ? AND RK.RSK_CEDINGID \= PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE\='C' AND PERSONAL.BRANCH_CODE \= ? AND PERSONAL.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PERSONAL.CUSTOMER_ID AND BRANCH_CODE \= PERSONAL.BRANCH_CODE) AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND   PI.CUSTOMER_TYPE\='B' AND PI.BRANCH_CODE \= ? AND PI.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO \=? AND RSK_LAYER_NO=?)AND RK.RSK_POLBRANCH = BRANCH.TMAS_POL_BRANCH_ID AND BRANCH.BRANCH_CODE = ? AND CM.CURRENCY_ID=RK.RSK_ORIGINAL_CURR AND CM.BRANCH_CODE=PI.BRANCH_CODE AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=CM.CURRENCY_ID AND BRANCH_CODE=CM.BRANCH_CODE )
premium.select.commissionDetails=SELECT RSK_OUR_ASS_ACQ_COST,RSK_COMM,RSK_COMM_QUOTASHARE,RSK_COMM_SURPLUS,RSK_OVERRIDER_PERC,RSK_BROKERAGE,RSK_TAX,RSK_LOSS_RESERVE,RSK_OTHER_COST,RSK_ACQUISTION_COST_OC,RSK_MANAGEMENT_EXPENSES,RSK_PROFIT_COMM, NVL(RSK_PREMIUM_RESERVE,0) RSK_PREMIUM_RESERVE FROM  TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER=?)
premium.select.treatyXOLfacProposalDetails=SELECT RSK_PREMIUM_QUOTA_SHARE,RSK_PREMIUM_SURPULS,RSK_XLCOST_OS_OC,RSK_SHARE_SIGNED,RSK_EPI_OSOF_OC,RSK_MD_PREM_OS_OC,NVL(RSK_EPI_OSOF_OC,'0')-NVL(RSK_MD_PREM_OS_OC,'0')  ADJ_PRE,NVL(D.RSK_EXCHANGE_RATE,0) RSK_EXCHANGE_RATE FROM TTRN_RISK_PROPOSAL F,TTRN_RISK_DETAILS D  WHERE F.RSK_PROPOSAL_NUMBER=? AND  F.RSK_ENDORSEMENT_NO IS NOT NULL AND   D.RSK_PROPOSAL_NUMBER=F.RSK_PROPOSAL_NUMBER AND D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD WHERE RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER) AND F.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM  TTRN_RISK_PROPOSAL  WHERE  RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO IS NOT NULL)
premium.select.xolPreList= SELECT   A.CONTRACT_NO,B.TMAS_DEPARTMENT_NAME, A.CEDING_COMPANY_ID, A.UW_YEAR,C.COMPANY_NAME,A.LAYER_NO ,(Select FIRST_NAME from personal_info pi where pi.Customer_id\=A.BROKER_ID and pi.branch_code\=A.branch_code) First_name FROM   POSITION_MASTER A,TMAS_DEPARTMENT_MASTER B, PERSONAL_INFO C WHERE A.CONTRACT_NO \= ? AND A.LAYER_NO\=? AND A.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE CONTRACT_NO\=A.CONTRACT_NO AND  LAYER_NO\=A.LAYER_NO) AND A.DEPT_ID \= B.TMAS_DEPARTMENT_ID AND B.BRANCH_CODE\=A.BRANCH_CODE AND B.TMAS_PRODUCT_ID\=A.PRODUCT_ID AND C.CUSTOMER_ID \= A.CEDING_COMPANY_ID AND C.BRANCH_CODE\=A.BRANCH_CODE AND C.CUSTOMER_TYPE\='C' AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=C.CUSTOMER_ID AND BRANCH_CODE\=C.BRANCH_CODE)
select_CEASE_STATUS =select CEASE_STATUS from position_master pm where CONTRACT_NO=? AND LAYER_NO =? and  pm.amend_id=(Select Max(Amend_id) From Position_master p where p.CONTRACT_NO=pm.CONTRACT_NO  AND p.LAYER_NO = pm.LAYER_NO) AND CONTRACT_STATUS='A'
XOL_PREMIUM_EDIT_TEMP =SELECT TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,ACCOUNT_PERIOD_QTR, ACCOUNT_PERIOD_YEAR,CURRENCY_ID,EXCHANGE_RATE,BROKERAGE_AMT_OC,TAX_AMT_OC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY'),TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY') AMENDMENT_DATE,PREMIUM_QUOTASHARE_OC,  COMMISSION_QUOTASHARE_OC,PREMIUM_SURPLUS_OC,COMMISSION_SURPLUS_OC,PREMIUM_PORTFOLIOIN_OC, CLAIM_PORTFOLIOIN_OC,PREMIUM_PORTFOLIOOUT_OC,LOSS_RESERVE_RELEASED_OC,PREMIUMRESERVE_QUOTASHARE_OC, CASH_LOSS_CREDIT_OC,LOSS_RESERVERETAINED_OC,PROFIT_COMMISSION_OC,CASH_LOSSPAID_OC,STATUS,  REMARKS,NETDUE_OC,ENTERING_MODE,RECEIPT_NO,CLAIMS_PAID_OC,SETTLEMENT_STATUS,M_DPREMIUM_OC,ADJUSTMENT_PREMIUM_OC,REC_PREMIUM_OC  ,COMMISSION,INSTALMENT_NUMBER,to_char(ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE,XL_COST_OC,CLAIM_PORTFOLIO_OUT_OC,PREMIUM_RESERVE_REALSED_OC,  OTHER_COST_OC,CEDANT_REFERENCE,TOTAL_CR_OC,TOTAL_DR_OC,INTEREST_OC,OSCLAIM_LOSSUPDATE_OC,OVERRIDER,OVERRIDER_AMT_OC,OVERRIDER_AMT_DC,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,RI_CESSION,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,SC_Comm_OC,SC_Comm_DC,BONUS_OC,BONUS_DC,PREMIUM_SUBCLASS,LPC_OC,LPC_DC,GNPI_ENDT_NO,nvl(PRD_ALLOCATED_TILL_DATE,0)PRD_ALLOCATED_TILL_DATE,nvl(LRD_ALLOCATED_TILL_DATE,0)LRD_ALLOCATED_TILL_DATE,PREMIUM_CLASS,OSBYN,SECTION_NAME,REVERSEL_STATUS,REVERSE_TRANSACTION_NO FROM RSK_PREMIUM_DETAILS_TEMP where CONTRACT_NO\=? AND REQUEST_NO\=?
premium.select.treetyXOLPremiumEdit=SELECT TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,ACCOUNT_PERIOD_QTR, ACCOUNT_PERIOD_YEAR,CURRENCY_ID,EXCHANGE_RATE,BROKERAGE_AMT_OC,TAX_AMT_OC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY'),TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY') AMENDMENT_DATE,PREMIUM_QUOTASHARE_OC,  COMMISSION_QUOTASHARE_OC,PREMIUM_SURPLUS_OC,COMMISSION_SURPLUS_OC,PREMIUM_PORTFOLIOIN_OC, CLAIM_PORTFOLIOIN_OC,PREMIUM_PORTFOLIOOUT_OC,LOSS_RESERVE_RELEASED_OC,PREMIUMRESERVE_QUOTASHARE_OC, CASH_LOSS_CREDIT_OC,LOSS_RESERVERETAINED_OC,PROFIT_COMMISSION_OC,CASH_LOSSPAID_OC,STATUS,  REMARKS,NETDUE_OC,ENTERING_MODE,RECEIPT_NO,CLAIMS_PAID_OC,SETTLEMENT_STATUS,M_DPREMIUM_OC,ADJUSTMENT_PREMIUM_OC,REC_PREMIUM_OC  ,COMMISSION,INSTALMENT_NUMBER,to_char(ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE,XL_COST_OC,CLAIM_PORTFOLIO_OUT_OC,PREMIUM_RESERVE_REALSED_OC,  OTHER_COST_OC,CEDANT_REFERENCE,TOTAL_CR_OC,TOTAL_DR_OC,INTEREST_OC,OSCLAIM_LOSSUPDATE_OC,OVERRIDER,OVERRIDER_AMT_OC,OVERRIDER_AMT_DC,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,RI_CESSION,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,SC_Comm_OC,SC_Comm_DC,BONUS_OC,BONUS_DC,PREMIUM_SUBCLASS,LPC_OC,LPC_DC,GNPI_ENDT_NO,nvl(PRD_ALLOCATED_TILL_DATE,0)PRD_ALLOCATED_TILL_DATE,nvl(LRD_ALLOCATED_TILL_DATE,0)LRD_ALLOCATED_TILL_DATE,PREMIUM_CLASS,OSBYN,SECTION_NAME,REVERSEL_STATUS,REVERSE_TRANSACTION_NO FROM RSK_PREMIUM_DETAILS where CONTRACT_NO\=? AND TRANSACTION_NO\=?
premium.select.retrotreetyXOLPremiumEdit = SELECT CONTRACT_NO,TRANSACTION_NO,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,EXCHANGE_RATE,BROKERAGE, BROKERAGE_AMT_OC, TAX, TAX_AMT_OC,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,NETDUE_OC, LAYER_NO,ENTERING_MODE,ENTRY_DATE_TIME,ACCOUNT_PERIOD_QTR,CURRENCY_ID,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE, CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,SETTLEMENT_STATUS,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,INSTALMENT_NUMBER,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (TRANSACTION_MONTH_YEAR+30, 'DD/MM/YYYY') due_date,RI_CESSION,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,PREMIUM_CLASS,REVERSE_TRANSACTION_NO,REVERSEL_STATUS  from RSK_XL_PREMIUM_DETAILS where CONTRACT_NO=? and TRANSACTION_NO=?
PREMIUM_INSERT_XOLPREMIUM_TEMP = INSERT INTO RSK_PREMIUM_DETAILS_TEMP ( CONTRACT_NO,REQUEST_NO,TRANSACTION_MONTH_YEAR ,ACCOUNT_PERIOD_QTR,ACCOUNT_PERIOD_YEAR,CURRENCY_ID ,EXCHANGE_RATE,BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME ,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,STATUS,NETDUE_OC, LAYER_NO,ENTERING_MODE,RECEIPT_NO,INSTALMENT_NUMBER, SETTLEMENT_STATUS,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,ENTRY_DATE,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,RI_CESSION,LOGIN_ID,BRANCH_CODE,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,PREMIUM_SUBCLASS,PREMIUM_CLASS,STATEMENT_DATE, PROPOSAL_NO,PRODUCT_ID,REVERSEL_STATUS,TRANS_STATUS,TRANS_TYPE) VALUES (?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?)
premium.insert.retoxolpremium=INSERT INTO RSK_XL_PREMIUM_DETAILS ( CONTRACT_NO,TRANSACTION_NO,TRANSACTION_MONTH_YEAR ,ACCOUNT_PERIOD_QTR,ACCOUNT_PERIOD_YEAR,CURRENCY_ID ,EXCHANGE_RATE,BROKERAGE,BROKERAGE_AMT_OC,TAX,TAX_AMT_OC,ENTRY_DATE_TIME ,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,STATUS,NETDUE_OC, LAYER_NO,ENTERING_MODE,RECEIPT_NO,INSTALMENT_NUMBER, SETTLEMENT_STATUS,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,ENTRY_DATE,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,RI_CESSION,LOGIN_ID,BRANCH_CODE,SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,PREMIUM_SUBCLASS,PREMIUM_CLASS,STATEMENT_DATE, PROPOSAL_NO,PRODUCT_ID,REVERSEL_STATUS) VALUES (?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?)
PRCL_DELETE = DELETE FROM TTRN_RETRO_PRCL WHERE CONTRACT_NO =? AND LAYER_NO=? AND PRODUCT_ID=?
XOL_PREMIUM_UPDATE_UPDATE_TEMP =  UPDATE RSK_PREMIUM_DETAILS_TEMP SET TRANSACTION_MONTH_YEAR\=TO_DATE(?,'DD/MM/YYYY'), CURRENCY_ID\=?  ,EXCHANGE_RATE\=?,BROKERAGE\=?,BROKERAGE_AMT_OC\=?,TAX\=?,TAX_AMT_OC\=?,ENTRY_DATE_TIME\=to_date(?,'dd/mm/yyyy'), COMMISSION\=?,M_DPREMIUM_OC\=?,ADJUSTMENT_PREMIUM_OC\=?, REC_PREMIUM_OC\=?, NETDUE_OC\=? ,ENTERING_MODE\=?,RECEIPT_NO\=?,OTHER_COST_OC\=?, BROKERAGE_AMT_DC\=?,TAX_AMT_DC\=?,M_DPREMIUM_DC\=?,ADJUSTMENT_PREMIUM_DC\=?, REC_PREMIUM_DC\=?,NETDUE_DC\=?,OTHER_COST_DC\=?,CEDANT_REFERENCE\=?,REMARKS\=?,TOTAL_CR_OC\=?,TOTAL_CR_DC\=?,TOTAL_DR_OC\=?,TOTAL_DR_DC\=?,AMENDMENT_DATE\=to_date(?,'dd/mm/yyyy'),ENTRY_DATE\=SYSDATE,MOVEMENT_YN\=NULL,WITH_HOLDING_TAX_OC\=?,WITH_HOLDING_TAX_DC\=?,RI_CESSION\=?,SUB_CLASS\=?,TDS_OC\=?,TDS_DC\=?,ST_OC\=?,ST_DC\=?,BONUS_OC\=?,BONUS_DC\=?,GNPI_ENDT_NO\=?,PREMIUM_CLASS\=?,STATEMENT_DATE\=TO_DATE(?,'DD/MM/YYYY') WHERE CONTRACT_NO\=? AND REQUEST_NO\=?
premium.update.xolUpdatePre= UPDATE RSK_PREMIUM_DETAILS SET TRANSACTION_MONTH_YEAR\=TO_DATE(?,'DD/MM/YYYY'), CURRENCY_ID\=?  ,EXCHANGE_RATE\=?,BROKERAGE\=?,BROKERAGE_AMT_OC\=?,TAX\=?,TAX_AMT_OC\=?,ENTRY_DATE_TIME\=to_date(?,'dd/mm/yyyy'), COMMISSION\=?,M_DPREMIUM_OC\=?,ADJUSTMENT_PREMIUM_OC\=?, REC_PREMIUM_OC\=?, NETDUE_OC\=? ,ENTERING_MODE\=?,RECEIPT_NO\=?,OTHER_COST_OC\=?, BROKERAGE_AMT_DC\=?,TAX_AMT_DC\=?,M_DPREMIUM_DC\=?,ADJUSTMENT_PREMIUM_DC\=?, REC_PREMIUM_DC\=?,NETDUE_DC\=?,OTHER_COST_DC\=?,CEDANT_REFERENCE\=?,REMARKS\=?,TOTAL_CR_OC\=?,TOTAL_CR_DC\=?,TOTAL_DR_OC\=?,TOTAL_DR_DC\=?,AMENDMENT_DATE\=to_date(?,'dd/mm/yyyy'),ENTRY_DATE\=SYSDATE,MOVEMENT_YN\=NULL,WITH_HOLDING_TAX_OC\=?,WITH_HOLDING_TAX_DC\=?,RI_CESSION\=?,SUB_CLASS\=?,TDS_OC\=?,TDS_DC\=?,ST_OC\=?,ST_DC\=?,BONUS_OC\=?,BONUS_DC\=?,GNPI_ENDT_NO\=?,PREMIUM_CLASS\=?,STATEMENT_DATE\=TO_DATE(?,'DD/MM/YYYY') WHERE CONTRACT_NO\=? AND TRANSACTION_NO\=?
premium.update.retroxolUpdatePre= UPDATE RSK_XL_PREMIUM_DETAILS SET TRANSACTION_MONTH_YEAR\=TO_DATE(?,'DD/MM/YYYY'), CURRENCY_ID\=?  ,EXCHANGE_RATE\=?,BROKERAGE\=?,BROKERAGE_AMT_OC\=?,TAX\=?,TAX_AMT_OC\=?,ENTRY_DATE_TIME\=to_date(?,'dd/mm/yyyy'), COMMISSION\=?,M_DPREMIUM_OC\=?,ADJUSTMENT_PREMIUM_OC\=?, REC_PREMIUM_OC\=?, NETDUE_OC\=? ,ENTERING_MODE\=?,RECEIPT_NO\=?,OTHER_COST_OC\=?, BROKERAGE_AMT_DC\=?,TAX_AMT_DC\=?,M_DPREMIUM_DC\=?,ADJUSTMENT_PREMIUM_DC\=?, REC_PREMIUM_DC\=?,NETDUE_DC\=?,OTHER_COST_DC\=?,CEDANT_REFERENCE\=?,REMARKS\=?,TOTAL_CR_OC\=?,TOTAL_CR_DC\=?,TOTAL_DR_OC\=?,TOTAL_DR_DC\=?,AMENDMENT_DATE\=to_date(?,'dd/mm/yyyy'),ENTRY_DATE\=SYSDATE,MOVEMENT_YN\=NULL,WITH_HOLDING_TAX_OC\=?,WITH_HOLDING_TAX_DC\=?,RI_CESSION\=?,SUB_CLASS\=?,TDS_OC\=?,TDS_DC\=?,ST_OC\=?,ST_DC\=?,BONUS_OC\=?,BONUS_DC\=?,GNPI_ENDT_NO\=?,PREMIUM_CLASS\=?,STATEMENT_DATE\=TO_DATE(?,'DD/MM/YYYY') WHERE CONTRACT_NO\=? AND TRANSACTION_NO\=?
FAC_TEMP_STATUS_UPDATE =UPDATE RSK_PREMIUM_DETAILS_TEMP SET TRANS_STATUS\=?,REVIEWER_ID\=?,REVIEW_DATE\=SYSDATE,TRANSACTION_NO\=? WHERE REQUEST_NO\=? AND BRANCH_CODE\=?
XOL_PREMIUM_VIEW_DETAILS_TEMP = SELECT CONTRACT_NO,TRANSACTION_NO,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,EXCHANGE_RATE,BROKERAGE, BROKERAGE_AMT_OC, TAX, TAX_AMT_OC,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,NETDUE_OC, LAYER_NO,ENTERING_MODE,ENTRY_DATE_TIME,ACCOUNT_PERIOD_QTR,CURRENCY_ID,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE, CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,SETTLEMENT_STATUS,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,INSTALMENT_NUMBER,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (TRANSACTION_MONTH_YEAR+30, 'DD/MM/YYYY') due_date,RI_CESSION,(select TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE\=? AND TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y' and TMAS_DEPARTMENT_ID\=SUB_CLASS)SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,(select TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE\=? AND TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y' and TMAS_DEPARTMENT_ID\=PREMIUM_CLASS)PREMIUM_CLASS,REVERSEL_STATUS,REVERSE_TRANSACTION_NO from RSK_PREMIUM_DETAILS_TEMP where CONTRACT_NO\=? and REQUEST_NO\=?
premium.select.XolPremiumView= SELECT CONTRACT_NO,TRANSACTION_NO,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,EXCHANGE_RATE,BROKERAGE, BROKERAGE_AMT_OC, TAX, TAX_AMT_OC,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,NETDUE_OC, LAYER_NO,ENTERING_MODE,ENTRY_DATE_TIME,ACCOUNT_PERIOD_QTR,CURRENCY_ID,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE, CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,SETTLEMENT_STATUS,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,INSTALMENT_NUMBER,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (TO_DATE(ACCOUNT_PERIOD_QTR,'DD/MM/YYYY')+30, 'DD/MM/YYYY') due_date,RI_CESSION,(select TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE\=? AND TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y' and TMAS_DEPARTMENT_ID\=SUB_CLASS)SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,(select TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE\=? AND TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y' and TMAS_DEPARTMENT_ID\=PREMIUM_CLASS)PREMIUM_CLASS,REVERSEL_STATUS,REVERSE_TRANSACTION_NO from RSK_PREMIUM_DETAILS where CONTRACT_NO\=? and TRANSACTION_NO\=?
premium.select.retroXolPremiumView= SELECT CONTRACT_NO,TRANSACTION_NO,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,EXCHANGE_RATE,BROKERAGE, BROKERAGE_AMT_OC, TAX, TAX_AMT_OC,COMMISSION,M_DPREMIUM_OC, ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC ,NETDUE_OC, LAYER_NO,ENTERING_MODE,ENTRY_DATE_TIME,ACCOUNT_PERIOD_QTR,CURRENCY_ID,OTHER_COST_OC,BROKERAGE_AMT_DC,TAX_AMT_DC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC,NETDUE_DC,OTHER_COST_DC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY') ENTRY_DATE, CEDANT_REFERENCE,REMARKS,TOTAL_CR_OC,TOTAL_CR_DC,TOTAL_DR_OC,TOTAL_DR_DC,SETTLEMENT_STATUS,TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY')AMENDMENT_DATE,INSTALMENT_NUMBER,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,TO_CHAR (TO_DATE(ACCOUNT_PERIOD_QTR,'DD/MM/YYYY')+30, 'DD/MM/YYYY') due_date,RI_CESSION,(select TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE\=? AND TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y' and TMAS_DEPARTMENT_ID\=SUB_CLASS)SUB_CLASS,TDS_OC,TDS_DC,ST_OC,ST_DC,BONUS_OC,BONUS_DC,GNPI_ENDT_NO,(select TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE\=? AND TMAS_PRODUCT_ID\=? AND TMAS_STATUS\='Y' and TMAS_DEPARTMENT_ID\=PREMIUM_CLASS)PREMIUM_CLASS,REVERSEL_STATUS,REVERSE_TRANSACTION_NO  from RSK_XL_PREMIUM_DETAILS where CONTRACT_NO\=? and TRANSACTION_NO\=?
GET_GNPI_PREMIUM=WITH E1 AS (SELECT NVL(RSK_SHARE_SIGNED,0) RSK_SHARE_SIGNED,RSK_ADJRATE FROM  TTRN_RISK_PROPOSAL R WHERE RSK_PROPOSAL_NUMBER\=(SELECT RSK_PROPOSAL_NUMBER FROM TTRN_RISK_DETAILS PM WHERE RSK_CONTRACT_NO\=? AND RSK_LAYER_NO\=? AND RSK_ORIGINAL_CURR \=? AND RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=PM.RSK_CONTRACT_NO AND RSK_LAYER_NO\=PM.RSK_LAYER_NO AND RSK_ORIGINAL_CURR\=PM.RSK_ORIGINAL_CURR)) AND RSK_LAYER_NO\=? AND BRANCH_CODE\=? AND RSK_ENDORSEMENT_NO\=( SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL P WHERE  P.RSK_PROPOSAL_NUMBER\=R.RSK_PROPOSAL_NUMBER AND P.RSK_LAYER_NO\=R.RSK_LAYER_NO AND P.BRANCH_CODE\=R.BRANCH_CODE)),E2 AS(SELECT SUM(NVL(RSK_GNPI_AS_OFF,0)) COVER_LIMIT FROM TTRN_RSK_CLASS_LIMITS RC  WHERE  RC.RSK_CONTRACT_NO\=? AND RC.RSK_LAYER_NO\=? AND RC.BRANCH_CODE\=? AND RSK_COVER_CLASS\=? AND RC.RSK_ENDORSEMENT_NO\=?) SELECT (COVER_LIMIT*RSK_SHARE_SIGNED*RSK_ADJRATE/100)/100 RSK_GNPI_AS_OFF  FROM E1,E2
GET_DEPOSIT_PREMIUM=SELECT SUM(NVL(M_DPREMIUM_OC,0)+NVL(ADJUSTMENT_PREMIUM_OC,0)) MD_PREMIUM FROM RSK_PREMIUM_DETAILS WHERE CONTRACT_NO=? AND LAYER_NO=? AND PREMIUM_CLASS=? AND CURRENCY_ID=? AND BRANCH_CODE=?
portfolio.select.ntu=SELECT   a.OFFER_NO,a.PROPOSAL_NO,substr(a.PROPOSAL_NO,4,8) prop,SUBSTR(A.PROPOSAL_NO,-5) proposal,b.TMAS_DEPARTMENT_ID,b.TMAS_DEPARTMENT_NAME,CASE WHEN E.RSK_SPFCID='ALL' THEN 'ALL' ELSE (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(E.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= E.RSK_PRODUCTID AND SPFC.BRANCH_CODE \= E.BRANCH_CODE) END TMAS_SPFC_NAME,a.CEDING_COMPANY_ID, TO_CHAR (a.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE, c.COMPANY_NAME,C1.FIRST_NAME||' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (a.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE,  TO_CHAR (a.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE, NVL(A.BASE_LAYER,A.PROPOSAL_NO)BASE_LAYER,(select distinct(contract_no) from position_master pm where pm.proposal_no=a.base_layer) contract_no,(case when a.uw_year!=0 then a.uw_year else null end) uw_year,to_char(a.uw_month,'dd/mm/yyyy') UW_MONTH,D.UNDERWRITTER,A.LAYER_NO,A.OLD_CONTRACTNO,A.AMEND_ID ,E.RSK_INSURED_NAME,A.BOUQUET_NO,NVL(A.BASE_LAYER,A.PROPOSAL_NO)BASE_LAYER_DESC FROM   PERSONAL_INFO c,PERSONAL_INFO c1, position_master A,TTRN_RISK_DETAILS E  LEFT OUTER JOIN  TMAS_DEPARTMENT_MASTER b   ON E.RSK_DEPTId = b.TMAS_DEPARTMENT_ID AND b.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE=?   AND B.TMAS_STATUS='Y' LEFT OUTER JOIN UNDERWRITTER_MASTER D ON  D.UWR_CODE=E.RSK_UNDERWRITTER AND D.BRANCH_CODE=? WHERE       A.product_id = ? AND (
portfolio.select.flagn=a.CONTRACT_STATUS = 'N'
portfolio.select.flagnull= a.CONTRACT_STATUS = 'P' OR a.CONTRACT_STATUS IS NULL
portfolio.select.ntudept= ) AND c.CUSTOMER_ID = A.CEDING_COMPANY_ID  AND C.BRANCH_CODE=? AND C.CUSTOMER_TYPE='C' AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=C.CUSTOMER_ID AND BRANCH_CODE=C.BRANCH_CODE AND CUSTOMER_TYPE=C.CUSTOMER_TYPE) AND A.PROPOSAL_NO=E.RSK_PROPOSAL_NUMBER AND A.AMEND_ID = E.RSK_ENDORSEMENT_NO AND A.DEPT_ID = E.RSK_DEPTID  AND A.PRODUCT_ID = E.RSK_PRODUCTID AND A.BRANCH_CODE=?  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO AND A.BRANCH_CODE=BRANCH_CODE )  AND A.DEPT_Id=? AND c1.CUSTOMER_ID = A.BROKER_ID AND C1.BRANCH_CODE = ? AND C1.AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE)
portfolio.select.ntuend= ) AND c.CUSTOMER_ID = A.CEDING_COMPANY_ID  AND C.BRANCH_CODE=? AND C.CUSTOMER_TYPE='C' AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=C.CUSTOMER_ID AND BRANCH_CODE=C.BRANCH_CODE AND CUSTOMER_TYPE=C.CUSTOMER_TYPE) AND A.PROPOSAL_NO=E.RSK_PROPOSAL_NUMBER AND A.AMEND_ID = E.RSK_ENDORSEMENT_NO   AND A.PRODUCT_ID = E.RSK_PRODUCTID AND A.BRANCH_CODE=?  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO AND A.BRANCH_CODE=BRANCH_CODE ) AND c1.CUSTOMER_ID = A.BROKER_ID AND C1.BRANCH_CODE = ? AND C1.AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE)
portfolio.select.perno=   AND A.PROPOSAL_NO LIKE ?
portfolio.select.conno=   AND A.CONTRACT_NO LIKE ?
portfolio.select.comname= AND UPPER(C.COMPANY_NAME) LIKE UPPER(?)  
portfolio.select.broname= AND UPPER(C1.FIRST_NAME) LIKE UPPER(?)  
portfolio.select.uyear=  AND a.UW_YEAR LIKE ?
portfolio.select_uwr_code=SELECT UWR_CODE FROM UNDERWRITTER_MASTER WHERE BRANCH_CODE=? and UPPER(UNDERWRITTER) like UPPER (?) and UWR_STATUS='Y'
portfolio.select.renewalPending=AND E.OLD_CONTRACTNO IS NOT NULL AND E.OLD_CONTRACTNO !='0'
portfolio.select.pending=AND (E.OLD_CONTRACTNO IS NULL OR E.OLD_CONTRACTNO \='0')\t
portfolio.select.orderbyprono= ORDER BY prop DESC 
portfolio.select.rejected=select  a.PROPOSAL_NO,substr(a.PROPOSAL_NO,4,8) prop,b.TMAS_DEPARTMENT_NAME,a.CEDING_COMPANY_ID, to_char(a.ACCOUNT_DATE,'dd/mm/yyyy') as ACCOUNT_DATE, c.COMPANY_NAME,C1.FIRST_NAME||' '||C1.LAST_NAME BROKER_NAME,TO_CHAR(a.INCEPTION_DATE,'dd/mm/yyyy') as INCEPTION_DATE ,TO_CHAR(a.EXPIRY_DATE,'dd/mm/yyyy') as EXPIRY_DATE,BASE_LAYER,a.UW_YEAR,to_char(a.UW_MONTH,'dd/mm/yyyy') UW_MONTH,UW.UNDERWRITTER,A.AMEND_ID,RD.RSK_INSURED_NAME from PERSONAL_INFO c,PERSONAL_INFO c1,TTRN_RISK_DETAILS RD,  UNDERWRITTER_MASTER UW,position_master a left outer join TMAS_DEPARTMENT_MASTER b on a.DEPT_Id=b.TMAS_DEPARTMENT_ID and b.TMAS_PRODUCT_ID =? AND B.BRANCH_CODE=? AND B.TMAS_STATUS='Y' WHERE PRODUCT_ID=?  AND CONTRACT_STATUS IN ('R')   AND A.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER  AND A.PRODUCT_ID=RD.RSK_PRODUCTID  AND A.AMEND_ID = RD.RSK_ENDORSEMENT_NO AND RD.RSK_UNDERWRITTER = UW.UWR_CODE AND UW.BRANCH_CODE=? AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO AND PRODUCT_ID=? AND A.BRANCH_CODE=BRANCH_CODE)  and c.CUSTOMER_ID=A.CEDING_COMPANY_ID  AND C.BRANCH_CODE=? AND  C.CUSTOMER_TYPE='C' AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=C.CUSTOMER_ID AND BRANCH_CODE=C.BRANCH_CODE AND CUSTOMER_TYPE=C.CUSTOMER_TYPE) AND c1.CUSTOMER_ID = A.BROKER_ID AND C1.BRANCH_CODE = ? AND C1.AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE)
portfolio.select.rejecteddept=AND a.DEPT_Id=?
portfolio.select.autoPending1=SELECT RD.RSK_PROPOSAL_NUMBER,PM.EDIT_MODE, I.INSTALLMENT_NO, RD.RSK_ORIGINAL_CURR, RD.RSK_UWYEAR UW_YEAR, PI.CUSTOMER_ID CEDING_ID, PIB.CUSTOMER_ID BROKER_ID, DECODE(RP.RSK_CEDRET_TYPE, 'P', 'Percentage', 'Amount') RSK_CEDRET_TYPE, RD.RSK_PREMIUM_RATE, RD.RSK_ENDORSEMENT_NO, RD.RSK_CONTRACT_NO, TPM.TMAS_PRODUCT_NAME, DM.TMAS_DEPARTMENT_ID, DM.TMAS_DEPARTMENT_NAME, PFC.TMAS_PFC_NAME, SPFC.TMAS_SPFC_NAME, PI.COMPANY_NAME COMPANY, PIB.FIRST_NAME || PIB.LAST_NAME BROKER, RD.RSK_UWYEAR, UM.UNDERWRITTER, TO_CHAR(RD.RSK_INCEPTION_DATE, 'dd/mm/yyyy') INSDATE, TO_CHAR(RD.RSK_EXPIRY_DATE, 'dd/mm/yyyy') EXPDATE, TO_CHAR(RD.RSK_ACCOUNT_DATE,'dd/mm/yyyy') ACDATE, CM.SHORT_NAME, RD.RSK_EXCHANGE_RATE, TM.TERRITORY_DESC, RD.RSK_INSURED_NAME, RD.RSK_LOCATION, RD.RSK_CITY, RP.NR, RP.RSK_CEDANT_RETENTION, RP.MAXIMUM_LIMIT_OC, RP.DEDUCTIBLE_OC, RP.SP_RETRO, RP.PML, RP.SI_PML_OC, RP.CU, RP.CU_RSN, RP.SUM_INSURED_OC, RP.GWPI_OC, RP.PML_OC, RP.TPL_OC, RP.SHARE_WRITTEN, RP.SHARE_SIGNED, RD.RSK_PROPOSAL_TYPE, RP.RSK_INTEREST, RP.SUM_INSURED_DC, RP.GWPI_DC, RP.PML_DC, RP.TPL_DC, RP.SUM_INSURED_OUR_SHARE_DC, GWPI_OUR_SHARE_DC, PML_OUR_SHARE_DC, TPL_OUR_SHARE_DC, RP.NO_OF_INSURERS, PB.TMAS_POL_BRANCH_NAME, RP.SCOPE, RP.SUM_INSURED_OUR_SHARE_OC, RP.GWPI_OUR_SHARE_OC, RP.PML_OUR_SHARE_OC, RP.TPL_OUR_SHARE_OC, MOT.TRANSPORT_DESCRIPTION , RP.VESSEL_NAME, RP.VESSEL_AGE, RP.LIMIT_PER_VESSEL_OC, RP.LIMIT_PER_VESSEL_DC, RP.LIMIT_PER_LOCATION_OC, RP.LIMIT_PER_LOCATION_DC, RP.MND_INSTALLMENTS, RP.DEDUCTIBLE_FACXOL_OC, RP.DEDUCTIBLE_FACXOL_DC, RP.DEDUCTIBLE_DC, RP.XOL_OC, RP.XOL_DC, RP.XOL_OURSHARE_OC, RP.XOL_OURSHARE_DC, RP.DEDUCTIBLE_OURSHARE_OC, RP.DEDUCTIBLE_OURSHARE_DC, RP.DEDUCTIBLE_FACXOL_OURSHARE_OC, RP.DEDUCTIBLE_FACXOL_OURSHARE_DC, CD.DETAIL_NAME TYPE_NAME, TO_CHAR(I.INSTALLMENT_DATE,'DD/MM/YYYY') INSTALLMENT_DATE , I.MND_PREMIUM_OC, RM.RSK_COMM, RM.RSK_BROKERAGE, RM.RSK_TAX, RSK_OTHER_COST, RM.RSK_ACQUISTION_COST_OC,RD.RSK_DEPTID,RD.RSK_SPFCID FROM POSITION_MASTER PM JOIN TTRN_RISK_DETAILS RD ON PM.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND PM.CONTRACT_NO = RD.RSK_CONTRACT_NO JOIN TTRN_MND_INSTALLMENTS I ON I.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND RD.RSK_CONTRACT_NO = I.CONTRACT_NO AND RD.RSK_LAYER_NO = I.LAYER_NO AND I.ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND RD.RSK_LAYER_NO = LAYER_NO) LEFT JOIN TTRN_FAC_RISK_PROPOSAL RP ON RD.RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER LEFT OUTER JOIN TTRN_RISK_COMMISSION RM ON RM.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RM.RSK_ENDORSEMENT_NO =RD.RSK_ENDORSEMENT_NO LEFT OUTER JOIN TMAS_PRODUCT_MASTER TPM ON TPM.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND TPM.BRANCH_CODE = ? AND TPM.TMAS_STATUS = '1' LEFT OUTER JOIN TMAS_PFC_MASTER PFC ON PFC.TMAS_PFC_ID = RD.RSK_PFCID AND PFC.BRANCH_CODE = ? LEFT OUTER JOIN TMAS_SPFC_MASTER SPFC ON SPFC.TMAS_SPFC_ID = RD.RSK_SPFCID AND SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE = ? LEFT OUTER JOIN PERSONAL_INFO PIB ON RD.RSK_BROKERID = PIB.CUSTOMER_ID AND PIB.BRANCH_CODE = ? LEFT OUTER JOIN PERSONAL_INFO PI ON RD.RSK_CEDINGID = PI.CUSTOMER_ID AND PI.BRANCH_CODE = ? LEFT OUTER JOIN TMAS_POLICY_BRANCH PB ON RD.RSK_POLBRANCH = PB.TMAS_POL_BRANCH_ID AND PB.BRANCH_CODE = ? LEFT OUTER JOIN CURRENCY_MASTER CM ON RD.RSK_ORIGINAL_CURR = CM.CURRENCY_ID AND CM.BRANCH_CODE = ? LEFT OUTER JOIN TERRITORY_MASTER TM ON RD.RSK_TERRITORY = TM.TERRITORY_CODE AND TM.BRANCH_CODE = ? LEFT OUTER JOIN UNDERWRITTER_MASTER UM ON RD.RSK_UNDERWRITTER = UM.UWR_CODE AND UM.BRANCH_CODE = ? LEFT OUTER JOIN TMAS_DEPARTMENT_MASTER DM ON DM.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND DM.TMAS_DEPARTMENT_ID = RD.RSK_DEPTID AND DM.BRANCH_CODE = ? AND DM.TMAS_STATUS = 'Y' LEFT OUTER JOIN TMAS_MODE_OF_TRANSPORT MOT ON MOT.MODE_TRANSPORT_ID=RP.MODE_TRANSPORT_ID AND MOT.BRANCH_CODE =? AND MOT.STATUS ='Y' LEFT OUTER JOIN CONSTANT_DETAIL CD ON CD.CATEGORY_ID ='13' AND CD.TYPE =RP.TYPE AND CD.STATUS ='Y' WHERE PIB.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PERSONAL_INFO1 WHERE PIB.CUSTOMER_ID = CUSTOMER_ID AND PIB.BRANCH_CODE = BRANCH_CODE ) AND PI.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PERSONAL_INFO2 WHERE PI.CUSTOMER_ID = CUSTOMER_ID AND PI.BRANCH_CODE = BRANCH_CODE ) AND RP.RSK_ENDORSEMENT_NO = (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER ) AND CM.AMEND_ID = (SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CM.CURRENCY_ID = CURRENCY_ID AND CM.BRANCH_CODE = BRANCH_CODE ) AND RD.RSK_ENDORSEMENT_NO = (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER ) AND I.INSTALLMENT_DATE < to_date(?,'dd/mm/yyyy') AND I.TRANSACTION_NO IS NULL  AND PM.BRANCH_CODE = ? AND RD.RSK_PRODUCTID = ? and MND_PREMIUM_OC!=0 AND NVL(PM.CEASE_STATUS,'N')!='Y' AND PM.AMEND_ID = (SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND BRANCH_CODE = ?)
portfolio.select.autoPendingNPT=SELECT RD.RSK_PROPOSAL_NUMBER,PM.EDIT_MODE, I.INSTALLMENT_NO, RD.RSK_ORIGINAL_CURR, RD.RSK_UWYEAR UW_YEAR, PI.CUSTOMER_ID CEDING_ID, PIB.CUSTOMER_ID BROKER_ID, DECODE(RP.RSK_CEDRET_TYPE, 'P', 'Percentage', 'Amount') RSK_CEDRET_TYPE, RD.RSK_PREMIUM_RATE, RD.RSK_ENDORSEMENT_NO, RD.RSK_CONTRACT_NO, TPM.TMAS_PRODUCT_NAME, DM.TMAS_DEPARTMENT_ID, DM.TMAS_DEPARTMENT_NAME, PFC.TMAS_PFC_NAME, SPFC.TMAS_SPFC_NAME, PI.COMPANY_NAME COMPANY, PIB.FIRST_NAME || PIB.LAST_NAME BROKER, RD.RSK_UWYEAR, UM.UNDERWRITTER, TO_CHAR(RD.RSK_INCEPTION_DATE, 'dd/mm/yyyy') INSDATE, TO_CHAR(RD.RSK_EXPIRY_DATE, 'dd/mm/yyyy') EXPDATE, TO_CHAR(RD.RSK_ACCOUNT_DATE,'dd/mm/yyyy') ACDATE, CM.SHORT_NAME, RD.RSK_EXCHANGE_RATE, TM.TERRITORY_DESC, RD.RSK_INSURED_NAME, RP.RSK_SHARE_SIGNED SHARE_SIGNED, PB.TMAS_POL_BRANCH_NAME, TO_CHAR(I.INSTALLMENT_DATE,'DD/MM/YYYY') INSTALLMENT_DATE , I.MND_PREMIUM_OC, RM.RSK_COMM, RM.RSK_BROKERAGE, RM.RSK_TAX, RM.RSK_OTHER_COST, RM.RSK_ACQUISTION_COST_OC, RD.RSK_LAYER_NO LAYER_NO, RD.RSK_TREATYID TREATY ,RD.RSK_DEPTID,RD.RSK_SPFCID   FROM POSITION_MASTER PM JOIN TTRN_RISK_DETAILS RD ON PM.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND PM.CONTRACT_NO = RD.RSK_CONTRACT_NO JOIN TTRN_MND_INSTALLMENTS I ON I.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND RD.RSK_CONTRACT_NO = I.CONTRACT_NO AND RD.RSK_LAYER_NO = I.LAYER_NO AND I.ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND RD.RSK_LAYER_NO = LAYER_NO) LEFT JOIN TTRN_RISK_PROPOSAL RP ON RD.RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER AND RP.RSK_LAYER_NO = RD.RSK_LAYER_NO LEFT OUTER JOIN TTRN_RISK_COMMISSION RM ON RM.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RM.RSK_ENDORSEMENT_NO =RD.RSK_ENDORSEMENT_NO LEFT OUTER JOIN TMAS_PRODUCT_MASTER TPM ON TPM.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND TPM.BRANCH_CODE = ? AND TPM.TMAS_STATUS = '1' LEFT OUTER JOIN TMAS_PFC_MASTER PFC ON PFC.TMAS_PFC_ID = RD.RSK_PFCID AND PFC.BRANCH_CODE = ? LEFT OUTER JOIN TMAS_SPFC_MASTER SPFC ON SPFC.TMAS_SPFC_ID = RD.RSK_SPFCID AND SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE = ? LEFT OUTER JOIN PERSONAL_INFO PIB ON RD.RSK_BROKERID = PIB.CUSTOMER_ID AND PIB.BRANCH_CODE = ? LEFT OUTER JOIN PERSONAL_INFO PI ON RD.RSK_CEDINGID = PI.CUSTOMER_ID AND PI.BRANCH_CODE = ? LEFT OUTER JOIN TMAS_POLICY_BRANCH PB ON RD.RSK_POLBRANCH = PB.TMAS_POL_BRANCH_ID AND PB.BRANCH_CODE = ? LEFT OUTER JOIN CURRENCY_MASTER CM ON RD.RSK_ORIGINAL_CURR = CM.CURRENCY_ID AND CM.BRANCH_CODE = ? LEFT OUTER JOIN TERRITORY_MASTER TM ON RD.RSK_TERRITORY = TM.TERRITORY_CODE AND TM.BRANCH_CODE = ? LEFT OUTER JOIN UNDERWRITTER_MASTER UM ON RD.RSK_UNDERWRITTER = UM.UWR_CODE AND UM.BRANCH_CODE = ? LEFT OUTER JOIN TMAS_DEPARTMENT_MASTER DM ON DM.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND DM.TMAS_DEPARTMENT_ID = RD.RSK_DEPTID AND DM.BRANCH_CODE = ? AND DM.TMAS_STATUS = 'Y' WHERE PIB.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PERSONAL_INFO1 WHERE PIB.CUSTOMER_ID = CUSTOMER_ID AND PIB.BRANCH_CODE = BRANCH_CODE ) AND PI.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PERSONAL_INFO2 WHERE PI.CUSTOMER_ID = CUSTOMER_ID AND PI.BRANCH_CODE = BRANCH_CODE ) AND RP.RSK_ENDORSEMENT_NO = (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER) AND CM.AMEND_ID = (SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CM.CURRENCY_ID = CURRENCY_ID AND CM.BRANCH_CODE = BRANCH_CODE ) AND RD.RSK_ENDORSEMENT_NO = (SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER = RP.RSK_PROPOSAL_NUMBER ) AND I.INSTALLMENT_DATE < to_date(?,'dd/mm/yyyy')  AND I.TRANSACTION_NO IS NULL  AND PM.BRANCH_CODE = ? AND RD.RSK_PRODUCTID = ? and MND_PREMIUM_OC!=0 AND NVL(PM.CEASE_STATUS,'N')!='Y' AND PM.AMEND_ID = (SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND BRANCH_CODE = ?)
portfolio.select.contractList1=SELECT distinct A.PRODUCT_ID,A.PROPOSAL_NO,SUBSTR(A.PROPOSAL_NO,-5) proposal,A.CONTRACT_NO,A.EDIT_MODE,(case  WHEN LENGTH (A.PROPOSAL_NO) = 10 THEN TO_NUMBER (SUBSTR (A.PROPOSAL_NO, 4, 11)) WHEN LENGTH (A.PROPOSAL_NO) >= 11 THEN TO_NUMBER (SUBSTR (A.PROPOSAL_NO, 5, 11)) else A.PROPOSAL_NO end) prop,(case  WHEN LENGTH (A.CONTRACT_NO) = 11 THEN TO_NUMBER (SUBSTR (A.CONTRACT_NO, 4, 11)) WHEN LENGTH (A.CONTRACT_NO) >= 12 THEN TO_NUMBER (SUBSTR (A.CONTRACT_NO, 5, 11)) else A.CONTRACT_NO end ) cont,B.TMAS_DEPARTMENT_NAME,B.TMAS_DEPARTMENT_ID,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE,TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,NVL(A.BASE_LAYER,A.PROPOSAL_NO)BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(A.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,A.AMEND_ID, A.CEASE_STATUS,D.RSK_INSURED_NAME,A.PROPOSAL_STATUS,A.CONTRACT_STATUS,D.RS_ENDORSEMENT_TYPE,(SELECT RENEWAL_STATUS FROM POSITION_MASTER  PM WHERE PM.PROPOSAL_NO = A.BASE_LAYER AND PM.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER MM WHERE      MM.PROPOSAL_NO = PM.PROPOSAL_NO ))OLD_STATUS,A.SECTION_NO,A.OFFER_NO,CASE WHEN D.RSK_SPFCID='ALL' THEN 'ALL' ELSE (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(D.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= D.RSK_PRODUCTID AND SPFC.BRANCH_CODE \= D.BRANCH_CODE) END TMAS_SPFC_NAME FROM   POSITION_MASTER A LEFT OUTER JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO and CONTRACT_STATUS ='A' 
portfolio.select.contractList2=AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO   LEFT OUTER JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE AND E.BRANCH_CODE = ? AND A.BRANCH_CODE = ? JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO FROM TTRN_CLAIM_DETAILS ) CD ON A.CONTRACT_NO = CD.CONTRACT_NO 
portfolio.select.contractListLayerNo2=AND A.LAYER_NO\=CD.LAYER_NO
portfolio.select.contractList3=WHERE  A.PRODUCT_ID = ?   AND A.CONTRACT_NO > 0  AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE)  AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO and PROPOSAL_NO=A.PROPOSAL_NO
portfolio.select.contractListLayerNo3=AND A.LAYER_NO=LAYER_NO
portfolio.select.contractListLayerNo1=AND A.LAYER_NO=D.RSK_LAYER_NO
portfolio.select.contractList4=AND A.BRANCH_CODE = BRANCH_CODE ) AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE)
portfolio.select.contractListDeptID=AND B.TMAS_DEPARTMENT_ID = ?
portfolio.select.renewalDue=AND (A.EXPIRY_DATE - SYSDATE)<60 AND A.RENEWAL_STATUS='1'
portfolio.select.claimYN=AND DECODE(CD.CONTRACT_NO,null,'NC','EC')=?
portfolio.select.orderbyconno= ORDER BY  cont DESC,prop ASC
GET_GNPI_COUNT = SELECT COUNT(RS_ENDORSEMENT_TYPE) COUNT FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=? AND RSK_CONTRACT_NO=? AND RS_ENDORSEMENT_TYPE=?
select_count_claim=SELECT COUNT(*) COUNT FROM TTRN_CLAIM_DETAILS WHERE CONTRACT_NO =? AND LAYER_NO=?
select_count_premium=SELECT COUNT(*) COUNT FROM  rsk_premium_details WHERE CONTRACT_NO =? AND LAYER_NO=?
select_count_CombinedClass=SELECT DECODE(COUNT(*),0,'N','Y') COUNT FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE =? AND TMAS_PRODUCT_ID=? AND  TMAS_STATUS='Y' AND CORE_COMPANY_CODE IS NOT NULL AND TMAS_DEPARTMENT_ID IN(?)
portfolio.select.contractList3History=WHERE  A.PRODUCT_ID \= ?  AND A.CONTRACT_STATUS \= 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID \= ? AND B.BRANCH_CODE \= ?   AND B.TMAS_STATUS\='Y' AND C.BRANCH_CODE \= ? AND C.CUSTOMER_TYPE \= 'C' AND C.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID \= C.CUSTOMER_ID AND BRANCH_CODE \= C.BRANCH_CODE AND CUSTOMER_TYPE \= C.CUSTOMER_TYPE) AND E.BRANCH_CODE \= ? AND A.BRANCH_CODE \= ? AND C1.BRANCH_CODE \= ? AND C1.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID \= C1.CUSTOMER_ID AND BRANCH_CODE \= C1.BRANCH_CODE AND CUSTOMER_TYPE \= C1.CUSTOMER_TYPE) 

risk.select.getMaxEndorseNo=SELECT NVL(MAX(RSK_ENDORSEMENT_NO),'0') RSK_ENDORSEMENT_NO FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?
risk.update.rskDtls1=UPDATE TTRN_RISK_DETAILS SET RSK_DEPTID\=?, RSK_PFCID\=?, RSK_SPFCID\=?, RSK_POLBRANCH\=?, RSK_CEDINGID\=?, RSK_BROKERID\=?, RSK_TREATYID\=?, RSK_MONTH\=TO_DATE(?,'DD/MM/YYYY'), RSK_UWYEAR\=?, RSK_UNDERWRITTER\=?, RSK_INCEPTION_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_EXPIRY_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_ACCOUNT_DATE\=TO_DATE(?,'DD/MM/YYYY'), RSK_ORIGINAL_CURR\=?, RSK_EXCHANGE_RATE\=?, RSK_BASIS\=?, RSK_PERIOD_OF_NOTICE\=?, RSK_RISK_COVERED\=?, RSK_TERRITORY_SCOPE\=?, RSK_TERRITORY\=?, RSK_STATUS\=?,RSK_PROPOSAL_TYPE\=?,RSK_ACCOUNTING_PERIOD\=? ,RSK_RECEIPT_STATEMENT\=? , RSK_RECEIPT_PAYEMENT\=?,MND_INSTALLMENTS\=?,RETRO_CESSIONARIES\=?,RSK_RETRO_TYPE\=?,RSK_INSURED_NAME\=?,INWARD_BUS_TYPE\=?,TREATYTYPE\=?,RSK_BUSINESS_TYPE\=?,RSK_EXCHANGE_TYPE\=?,RSK_PERILS_COVERED\=?,RSK_LOC_ISSUED\=?,RSK_UMBRELLA_XL\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=sysdate,COUNTRIES_INCLUDE\=?,COUNTRIES_EXCLUDE\=?,RSK_NO_OF_LINE\=?,RS_ENDORSEMENT_TYPE\=?,RSK_RUN_OFF_YEAR\=?,RSK_LOC_BNK_NAME\=?,RSK_LOC_CRDT_PRD\=?,RSK_LOC_CRDT_AMT\=?,RSK_LOC_BENFCRE_NAME\=?,RSK_CESSION_EXG_RATE\=?,RSK_FIXED_RATE\=?,RETENTIONYN\=? WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=? AND RSK_LAYER_NO = ? 
risk.select.getEditModeSecPageData=SELECT PR.RSK_LIMIT_OS_OC,PR.RSK_LIMIT_OS_DC,PR.RSK_EPI_OSOF_OC,PR.RSK_EPI_OSOF_DC,PR.RSK_EPI_OSOE_OC,PR.RSK_EPI_OSOE_DC,PR.RSK_XLCOST_OS_OC,PR.RSK_XLCOST_OS_DC,COM.RSK_COMM_QUOTASHARE,COM.RSK_COMM_SURPLUS,COM.RSK_OVERRIDER_PERC,COM.RSK_BROKERAGE,COM.RSK_TAX,COM.RSK_ACQUISTION_COST_OC,COM.RSK_PROFIT_COMM,COM.RSK_COMBIN_SUB_CLASS,COM.RSK_PREMIUM_RESERVE,COM.RSK_LOSS_RESERVE,COM.RSK_INTEREST,COM.RSK_CASHLOSS_LMT_OC,COM.RSK_PF_INOUT_PREM,COM.RSK_PF_INOUT_LOSS,COM.RSK_LOSSADVICE,COM.RSK_LEAD_UW,COM.RSK_LEAD_UW_SHARE,COM.RSK_ACCOUNTS,COM.RSK_EXCLUSION,COM.RSK_REMARKS,COM.RSK_UW_RECOMM,COM.RSK_GM_APPROVAL,COM.RSK_SLADSCALE_COMM,COM.RSK_LOSS_PART_CARRIDOR,PR.RSK_PREMIUM_QUOTA_SHARE,PR.RSK_PREMIUM_SURPULS,COM.RSK_OTHER_COST,COM.RSK_CREASTA_STATUS,COM.RSK_EVENT_LIMIT_OC,COM.RSK_EVENT_LIMIT_DC,COM.RSK_AGGREGATE_LIMIT_OC,COM.RSK_AGGREGATE_LIMIT_DC,COM.RSK_OCCURRENT_LIMIT_OC,COM.RSK_OCCURRENT_LIMIT_DC,COM.RSK_LEAD_UNDERWRITER_COUNTRY,COM.RSK_INCLUDE_ACQ_COST,COM.RSK_OUR_ASS_ACQ_COST,COM.RSK_OUR_ACQ_OUR_SHARE_OC,COM.RSK_LOSS_COMBIN_SUB_CLASS,COM.RSK_SLIDE_COMBIN_SUB_CLASS,COM.RSK_CRESTA_COMBIN_SUB_CLASS,COM.RSK_PRO_MANAGEMENT_EXP, COM.RSK_PRO_COMM_TYPE, COM.RSK_PRO_COMM_PER, COM.RSK_PRO_SET_UP, COM.RSK_PRO_SUP_PRO_COM, COM.RSK_PRO_LOSS_CARY_TYPE, COM.RSK_PRO_LOSS_CARY_YEAR, COM.RSK_PRO_PROFIT_CARY_TYPE, COM.RSK_PRO_PROFIT_CARY_YEAR, COM.RSK_PRO_FIRST_PFO_COM, COM.RSK_PRO_FIRST_PFO_COM_PRD, COM.RSK_PRO_SUB_PFO_COM_PRD, COM.RSK_PRO_SUB_PFO_COM, COM.RSK_PRO_SUB_SEQ_CAL, COM.RSK_PRO_NOTES,COM.RSK_COMMISSION_QS_YN,COM.RSK_NOCLAIMBONUS_PRCENT,COM.RSK_BONUS_ID,COM.RSK_COMMISSION_SUR_YN,COM.RSK_OVERRIDE_YN,COM.RSK_BROKARAGE_YN,COM.RSK_TAX_YN,COM.RSK_OTHER_COST_YN,COM.RSK_CEED_ODI_YN,COM.RSK_RATE,COM.RSK_COMMISSION_TYPE FROM TTRN_RISK_PROPOSAL PR,TTRN_RISK_COMMISSION COM WHERE PR.RSK_PROPOSAL_NUMBER \=? AND PR.RSK_PROPOSAL_NUMBER\=COM.RSK_PROPOSAL_NUMBER AND PR.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER\=?) AND COM.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_COMMISSION WHERE RSK_PROPOSAL_NUMBER\=?)
risk.select.getThirdPageData = SELECT   RC.RSK_COMMISSION_QS_YN,RC.RSK_COMMISSION_SUR_YN,RC.RSK_OVERRIDE_YN,RC.RSK_BROKARAGE_YN,RC.RSK_TAX_YN,RC.RSK_OTHER_COST_YN,RC.RSK_CEED_ODI_YN,RC.RSK_BROKERAGE,RC.RSK_INCLUDE_ACQ_COST,RC.RSK_OUR_ASS_ACQ_COST,RC.RSK_OUR_ACQ_OUR_SHARE_OC,  rc.RSK_BURNING_COST_PCT,rc.RSK_SLADSCALE_COMM,rc.RSK_LOSS_PART_CARRIDOR,  RP.  RSK_PREMIUM_QUOTA_SHARE, RP.RSK_PREMIUM_SURPULS, comm_surplus_amt,   NVL (  ( ( (  NVL (RC.RSK_OVERRIDER_PERC, 0) + NVL (RC.RSK_COMM_QUOTASHARE, 0)+ NVL (RC.RSK_COMM_SURPLUS, 0)  +  NVL (RC.RSK_BROKERAGE, 0)  + NVL  (RC.RSK_TAX, 0) + NVL (RC.RSK_OTHER_COST, 0)) / 100) * RP.  RSK_EPI_EST_OC), 0) + NVL (RC.RSK_OUR_ASS_ACQ_COST, 0) OTHER_ACQ_COST_AMT  , round((NVL (( ( (  NVL (RC.  RSK_OVERRIDER_PERC, 0) +  NVL (RC.RSK_BROKERAGE, 0) + NVL (RC.RSK_COMM_QUOTASHARE, 0)+ NVL (RC.RSK_COMM_SURPLUS, 0)  + NVL (RC.RSK_TAX, 0)  + NVL (RC.RSK_OTHER_COST, 0)) / 100) * RP.RSK_EPI_EST_OC), 0 )+ NVL (RC.RSK_OUR_ASS_ACQ_COST, 0))/(  select rsk_exchange_rate  from ttrn_risk_details trd  where RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER  and RSK_ENDORSEMENT_NO=(  Select max(RSK_ENDORSEMENT_NO)  from ttrn_risk_details td  where trd.RSK_PROPOSAL_NUMBER=td.RSK_PROPOSAL_NUMBER)),2)   OTHER_ACQ_COST_AMT_UGX  ,RC.RSK_COMBIN_SUB_CLASS,RSK_TAX,RSK_PROFIT_COMM,  RSK_RESERVE_ON_LOSS,RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,  RSK_COMM_QUOTASHARE,RSK_COMM_SURPLUS,RSK_OVERRIDER_PERC,  RSK_PREMIUM_RESERVE,RSK_LOSS_RESERVE,RSK_INTEREST,RSK_PF_INOUT_PREM,  RSK_PF_INOUT_LOSS,RSK_LOSSADVICE, round(RSK_LOSSADVICE/(  select rsk_exchange_rate  from ttrn_risk_details trd  where RSK_PROPOSAL_NUMBER=RP.RSK_PROPOSAL_NUMBER  and RSK_ENDORSEMENT_NO=(  Select max(RSK_ENDORSEMENT_NO)  from ttrn_risk_details td  where trd.RSK_PROPOSAL_NUMBER=td.RSK_PROPOSAL_NUMBER)),2)  RSK_LOSSADVICE_DC, RSK_CASHLOSS_LMT_OC, RSK_CASHLOSS_LMT_DC,  RSK_AGGREGATE_LIAB_OC,RSK_AGGREGATE_LIAB_DC, RSK_REINSTATE_NO,  RSK_REINSTATE_ADDL_PREM_OC, RSK_REINSTATE_ADDL_PREM_DC, (  SELECT   P.FIRST_NAME || ' ' || P.LAST_NAME  FROM   PERSONAL_INFO P  WHERE   P.BRANCH_CODE = ?  and CUSTOMER_ID=RSK_LEAD_UW  AND P.CUSTOMER_TYPE = 'L'  AND STATUS = 'Y'  AND P.AMEND_ID = (  SELECT   MAX (AMEND_ID)  FROM   PERSONAL_INFO  WHERE  BRANCH_CODE = P.BRANCH_CODE  AND CUSTOMER_TYPE = P.CUSTOMER_TYPE  AND STATUS = P.STATUS  AND CUSTOMER_ID = P.CUSTOMER_ID))RSK_LEAD_UW,RSK_LEAD_UW RSK_LEAD_UWID, RSK_LEAD_UW_SHARE,  RSK_ACCOUNTS, RSK_EXCLUSION,rc.RSK_REMARKS,RSK_UW_RECOMM,  RSK_GM_APPROVAL,RSK_DECISION, rc.RSK_ENTRY_DATE, rc.RSK_END_DATE,rc.  RSK_STATUS, RSK_OTHER_COST,RSK_REINSTATE_ADDL_PREM_PCT,RP.  LIMIT_PER_VESSEL_OC, RP.LIMIT_PER_VESSEL_DC, RP.LIMIT_PER_LOCATION_OC,  RP.LIMIT_PER_LOCATION_DC, RSK_PREMIUM_QUOTA_SHARE_DC,  RSK_PREMIUM_SURPLUS_DC, COMM_QS_AMT, COMM_QS_AMT_DC,  COMM_SURPLUS_AMT_DC,RC.RSK_AGGREGATE_DEDUCT_OC, RC.  RSK_AGGREGATE_DEDUCT_DC,RC.RSK_EVENT_LIMIT_OC,RC.RSK_EVENT_LIMIT_DC,RC.  RSK_AGGREGATE_LIMIT_OC,RC.RSK_AGGREGATE_LIMIT_DC,RC.RSK_REINSTATEMENT_PREMIUM,RC.  RSK_CREASTA_STATUS,RC.RSK_LEAD_UNDERWRITER_COUNTRY,RC.  RSK_OCCURRENT_LIMIT_DC,RC.RSK_LOSS_COMBIN_SUB_CLASS,RC.  RSK_SLIDE_COMBIN_SUB_CLASS,RC.RSK_CRESTA_COMBIN_SUB_CLASS,RC.  RSK_PRO_MANAGEMENT_EXP, RC.RSK_PRO_COMM_TYPE, RC.RSK_PRO_COMM_PER, RC.  RSK_PRO_SET_UP, RC.RSK_PRO_SUP_PRO_COM, RC.RSK_PRO_LOSS_CARY_TYPE, RC.  RSK_PRO_LOSS_CARY_YEAR,RC.RSK_OCCURRENT_LIMIT_OC, RC.RSK_PRO_PROFIT_CARY_TYPE, RC.  RSK_PRO_PROFIT_CARY_YEAR,RC.RSK_NOCLAIMBONUS_PRCENT,RC.RSK_BONUS_ID , RC  .RSK_PRO_FIRST_PFO_COM, RC.RSK_PRO_FIRST_PFO_COM_PRD, RC.  RSK_PRO_SUB_PFO_COM_PRD, RC.RSK_PRO_SUB_PFO_COM, RC.RSK_PRO_SUB_SEQ_CAL,  RC.RSK_PRO_NOTES,RC.RSK_RATE,RC.  RSK_COMMISSION_TYPE,(  select to_char(endorsement_date,'DD/MM/YYYY')  from position_master pm  where pm.proposal_no=RP.RSK_PROPOSAL_NUMBER  and pm.amend_id=RP.RSK_ENDORSEMENT_NO) ENDT_DATE  FROM TTRN_RISK_PROPOSAL RP LEFT OUTER JOIN (  SELECT   *  FROM   TTRN_RISK_COMMISSION  WHERE   RSK_PROPOSAL_NUMBER = ?  AND RSK_ENDORSEMENT_NO = ?) RC ON RP.RSK_PROPOSAL_NUMBER = RC.  RSK_PROPOSAL_NUMBER  WHERE   RP.RSK_PROPOSAL_NUMBER =?  AND RP.RSK_ENDORSEMENT_NO =?
adjustment.list.allocated=SELECT sno,TYPE,ADJUSTMENT_TYPE,CURRENCY_NAME,CEDINGCOMPANY,BROKERNAME, PAIDAMOUNT,status FROM TABLE (fn_adjustment_type (?)),XMLTABLE ( ('xs\:string(distinct-values(("'|| REPLACE ( (ADJUSTMENT_TYPE), ',', '","')|| '")))')) order by sno desc
adjutment.list= SELECT   * FROM   (SELECT   distinct B.TRANSACTION_NO,A.CONTRACT_NO,A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME, TO_CHAR (B.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY') AS ADATE,(NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0))  pending_amount, B.ACC_PREMIUM,NULL ACC_CLAIM,NVL (B.CHECKYN, 'N') CHECKYN,'Premium' BUSINESS_TYPE,(SELECT   COMPANY_NAME  FROM   personal_info pi WHERE   pi.customer_id = A.CEDING_COMPANY_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.CEDING_COMPANY_ID AND I.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name, (SELECT   FIRST_NAME || LAST_NAME FROM   personal_info pi  WHERE   pi.customer_id = A.BROKER_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.BROKER_ID AND I.branch_code = A.BRANCH_CODE))  broker_name,(SELECT   CURRENCY_NAME FROM   currency_master cm WHERE   cm.CURRENCY_ID = B.CURRENCY_id AND cm.branch_code = A.BRANCH_CODE and cm.amend_id=(select max(amend_id) from currency_master WHERE   CURRENCY_ID = cm.CURRENCY_id AND branch_code = cm.BRANCH_CODE)) currency_name,to_char(B.CURRENCY_ID)CURRENCY_ID,A.PROPOSAL_NO,A.DEPT_ID FROM   POSITION_MASTER A, RSK_PREMIUM_DETAILS B WHERE  B.RECEIPT_NO IS NULL AND B.CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (B.LAYER_NO, 0) AND B.SUB_CLASS=A.DEPT_ID AND A.BRANCH_CODE = ? AND (NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) !=0 AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER PM WHERE   CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (PM.LAYER_NO, 0) AND B.CURRENCY_ID = ? AND CASE WHEN '63' = ? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ?) UNION ALL SELECT   distinct CP.CLAIM_PAYMENT_NO, A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME, TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS ADATE, (NVL (CP.PAID_AMOUNT_OC, 0) - NVL (CP.ALLOCATED_TILL_DATE, 0)) pending_amount, NULL ACC_PREMIUM, CP.ACC_CLAIM, NVL (CP.CHECKYN, 'N'), 'Claim' BUSINESS_TYPE, (SELECT   COMPANY_NAME FROM   personal_info pi WHERE   pi.customer_id = A.CEDING_COMPANY_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.CEDING_COMPANY_ID AND I.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name,(SELECT   FIRST_NAME || LAST_NAME FROM   personal_info pi  WHERE   pi.customer_id = A.BROKER_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.BROKER_ID AND I.branch_code = A.BRANCH_CODE)) broker_name,(SELECT   CURRENCY_NAME FROM   currency_master cm WHERE   cm.CURRENCY_ID = c.CURRENCY AND cm.branch_code = A.BRANCH_CODE and cm.amend_id=(select max(amend_id) from currency_master WHERE   CURRENCY_ID = cm.CURRENCY_ID  AND branch_code = cm.BRANCH_CODE))  currency_name,c.CURRENCY,A.PROPOSAL_NO,A.DEPT_ID FROM   POSITION_MASTER A, TTRN_CLAIM_DETAILS C, TTRN_CLAIM_PAYMENT CP WHERE  A.CONTRACT_NO = C.CONTRACT_NO AND C.CONTRACT_NO = CP.CONTRACT_NO AND C.CLAIM_NO = CP.CLAIM_NO AND NVL (A.LAYER_NO, 0) = NVL (C.LAYER_NO, 0) AND C.SUB_CLASS=A.DEPT_ID AND A.BRANCH_CODE = ? AND (NVL (CP.PAID_AMOUNT_OC, 0)- NVL (CP.ALLOCATED_TILL_DATE, 0)) != 0 AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE   CONTRACT_NO = A.CONTRACT_NO) AND C.CURRENCY = ? AND CASE WHEN '63' = ? THEN A.CEDING_COMPANY_ID ELSE A.BROKER_ID END = ?)
adjustment.list.ind.transactionCP=SELECT   * FROM   (SELECT   distinct B.TRANSACTION_NO,A.CONTRACT_NO,A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME, TO_CHAR (B.ENTRY_DATE_TIME, 'DD/MM/YYYY') AS ADATE,(NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0))  pending_amount, B.ACC_PREMIUM,NULL ACC_CLAIM,NVL (B.CHECKYN, 'N') CHECKYN,'Premium' BUSINESS_TYPE,(SELECT   COMPANY_NAME  FROM   personal_info pi WHERE   pi.customer_id = A.CEDING_COMPANY_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.CEDING_COMPANY_ID AND I.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name, (SELECT   FIRST_NAME || LAST_NAME FROM   personal_info pi  WHERE   pi.customer_id = A.BROKER_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.BROKER_ID AND I.branch_code = A.BRANCH_CODE))  broker_name,(SELECT   CURRENCY_NAME FROM   currency_master cm WHERE   cm.CURRENCY_ID = B.CURRENCY_id AND cm.branch_code = A.BRANCH_CODE and cm.amend_id=(select max(amend_id) from currency_master WHERE   CURRENCY_ID = cm.CURRENCY_id AND branch_code = cm.BRANCH_CODE)) currency_name,to_char(B.CURRENCY_ID)CURRENCY_ID,A.PROPOSAL_NO FROM   POSITION_MASTER A, RSK_PREMIUM_DETAILS B WHERE  B.RECEIPT_NO IS NULL AND B.CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (B.LAYER_NO, 0) AND A.BRANCH_CODE = ? AND (NVL (B.NETDUE_OC, 0) - NVL (B.ALLOCATED_TILL_DATE, 0)) !=0 AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER PM WHERE   CONTRACT_NO = A.CONTRACT_NO AND NVL (A.LAYER_NO, 0) = NVL (PM.LAYER_NO, 0)) and TRANSACTION_NO in (select * from table(SPLIT_TEXT_FN(?))) UNION ALL SELECT  distinct CP.CLAIM_PAYMENT_NO, A.CONTRACT_NO, A.LAYER_NO, FN_GET_NAME ('P', A.PRODUCT_ID,A.BRANCH_CODE) PRODUCT_NAME,  TO_CHAR (CP.INCEPTION_DATE, 'DD/MM/YYYY') AS ADATE, (NVL (CP.PAID_AMOUNT_OC, 0) - NVL (CP.ALLOCATED_TILL_DATE, 0)) pending_amount, NULL ACC_PREMIUM, CP.ACC_CLAIM, NVL (CP.CHECKYN, 'N'), 'Claim' BUSINESS_TYPE, (SELECT   COMPANY_NAME FROM   personal_info pi WHERE   pi.customer_id = A.CEDING_COMPANY_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.CEDING_COMPANY_ID AND I.branch_code = A.BRANCH_CODE)) CEDING_COMPANY_name,(SELECT   FIRST_NAME || LAST_NAME FROM   personal_info pi  WHERE   pi.customer_id = A.BROKER_ID AND pi.branch_code = A.BRANCH_CODE and AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id = A.BROKER_ID AND I.branch_code = A.BRANCH_CODE)) broker_name,(SELECT   CURRENCY_NAME FROM   currency_master cm WHERE   cm.CURRENCY_ID = c.CURRENCY AND cm.branch_code = A.BRANCH_CODE and cm.amend_id=(select max(amend_id) from currency_master WHERE   CURRENCY_ID = cm.CURRENCY_ID  AND branch_code = cm.BRANCH_CODE))  currency_name,c.CURRENCY,A.PROPOSAL_NO FROM   POSITION_MASTER A, TTRN_CLAIM_DETAILS C, TTRN_CLAIM_PAYMENT CP WHERE  A.CONTRACT_NO = C.CONTRACT_NO AND C.CONTRACT_NO = CP.CONTRACT_NO AND C.CLAIM_NO = CP.CLAIM_NO AND NVL (A.LAYER_NO, 0) = NVL (C.LAYER_NO, 0) AND A.BRANCH_CODE = ? AND (NVL (CP.PAID_AMOUNT_OC, 0)- NVL (CP.ALLOCATED_TILL_DATE, 0)) != 0 AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE   CONTRACT_NO = A.CONTRACT_NO) And CLAIM_PAYMENT_NO in (select * from table(SPLIT_TEXT_FN(?)))) ORDER BY   CONTRACT_NO, TRANSACTION_NO
adjustment.payrec.list=Select  Distinct    B.Receipt_Sl_No TRANSACTION_NO, To_Char (B.Trans_Date, 'DD/MM/YYYY') As Adate, (Nvl (B.Amount, 0) - Nvl (B.Allocated_Till_Date, 0)) Pending_Amount,(Select   Company_Name From   Personal_Info Pi Where   Pi.Customer_Id \= A.Ceding_Id And Pi.Branch_Code \= A.Branch_Code and AMEND_ID \=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id \= A.Ceding_Id AND I.branch_code \= A.BRANCH_CODE)) Ceding_Company_Name, (Select   First_Name || Last_Name From   Personal_Info Pi Where   Pi.Customer_Id \= A.Broker_Id  And Pi.Branch_Code \= A.Branch_Code and AMEND_ID \=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id \= A.Broker_Id AND I.branch_code \= A.BRANCH_CODE))  Broker_Name, (Select   Currency_Name From   Currency_Master Cm Where   Cm.Currency_Id \= B.Currency_Id And Cm.Branch_Code \= A.Branch_Code And Cm.Amend_Id \=(Select   Max (Amend_Id) From   Currency_Master Where   Currency_Id \= Cm.Currency_Id And Branch_Code \= Cm.Branch_Code)) Currency_Name,B.Currency_Id,Decode(A.TRANS_TYPE,'RT','Receipt','Payment')BUSINESS_TYPE From   Ttrn_Payment_Receipt A, Ttrn_Payment_Receipt_Details B Where  A.Payment_Receipt_No\=B.Receipt_Sl_No and A.Branch_Code \= ? And (Nvl (B.Amount, 0) - Nvl (B.Allocated_Till_Date, 0)) \!\=0  And B.Currency_Id \= ? AND CASE WHEN '63' \= ? THEN A.Ceding_Id ELSE A.BROKER_ID END \= ? AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS C WHERE B.RECEIPT_SL_NO\=C.RECEIPT_SL_NO AND B.RECEIPT_NO\=C.RECEIPT_NO  AND B.CURRENCY_ID\=C.CURRENCY_ID)
adjustment.list.ind.transactionRP=Select  Distinct    B.Receipt_Sl_No TRANSACTION_NO, To_Char (B.Trans_Date, 'DD/MM/YYYY') As Adate, (Nvl (B.Amount, 0) - Nvl (B.Allocated_Till_Date, 0)) Pending_Amount,(Select   Company_Name From   Personal_Info Pi Where   Pi.Customer_Id \= A.Ceding_Id And Pi.Branch_Code \= A.Branch_Code and AMEND_ID \=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id \= A.Ceding_Id AND I.branch_code \= A.BRANCH_CODE)) Ceding_Company_Name, (Select   First_Name || Last_Name From   Personal_Info Pi Where   Pi.Customer_Id \= A.Broker_Id  And Pi.Branch_Code \= A.Branch_Code and AMEND_ID \=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO I WHERE   I.customer_id \= A.Broker_Id AND I.branch_code \= A.BRANCH_CODE))  Broker_Name, (Select   Currency_Name From   Currency_Master Cm Where   Cm.Currency_Id \= B.Currency_Id And Cm.Branch_Code \= A.Branch_Code And Cm.Amend_Id \=(Select   Max (Amend_Id) From   Currency_Master Where   Currency_Id \= Cm.Currency_Id And Branch_Code \= Cm.Branch_Code)) Currency_Name,B.Currency_Id,Decode(A.TRANS_TYPE,'RT','Receipt','Payment')BUSINESS_TYPE From   Ttrn_Payment_Receipt A, Ttrn_Payment_Receipt_Details B Where  A.Payment_Receipt_No\=B.Receipt_Sl_No and A.Branch_Code \= ? And (Nvl (B.Amount, 0) - Nvl (B.Allocated_Till_Date, 0)) \!\=0 AND B.Receipt_Sl_No in (select * from table(SPLIT_TEXT_FN(?))) and B.CURRENCY_ID\!\=0 AND B.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TTRN_PAYMENT_RECEIPT_DETAILS C WHERE B.RECEIPT_SL_NO\=C.RECEIPT_SL_NO AND B.RECEIPT_NO\=C.RECEIPT_NO  AND B.CURRENCY_ID\=C.CURRENCY_ID) order  by B.Receipt_Sl_No
adjutment.list.maxdate=Select to_char(max(Column_value),'DD/MM/YYYY') maxdate from (select TO_date(Column_value,'DD/MM/YYYY') Column_value from table(SPLIT_TEXT_FN(?)))
GET_COLUMN_HEADER=SELECT TO_CHAR(RANGE_START,'DD/MM/YYYY') ||' to ' ||TO_CHAR(RANGE_END, 'DD/MM/YYYY') RANGE FROM (SELECT  ROWNUM AS ROW_NO, ADD_MONTHS( TRUNC(TO_DATE(?,'DD/MM/YYYY')), (LEVEL-1) *12)  AS RANGE_START,ADD_MONTHS( TRUNC(TO_DATE(?,'DD/MM/YYYY')), (12)*(LEVEL) )-1  AS RANGE_END, COUNT(*) OVER() CNT FROM (SELECT DISTINCT TO_DATE(?,'DD/MM/YYYY')   FROM DUAL) CONNECT BY ADD_MONTHS( TRUNC(TO_DATE(?,'DD/MM/YYYY'), 'Y'), 12*(LEVEL) ) -1<=TO_DATE(?,'DD/MM/YYYY') ORDER BY RANGE_START)
GET_RENEWAL_STATISTICS_LIST=SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)M1,SUM(M2)M2,SUM(M3)M3,SUM(M4)M4,SUM(M5)M5,SUM(M6)M6,SUM(M7)M7,SUM(M8)M8,SUM(M9)M9,SUM(M10)M10,SUM(M11)M11,SUM(M12)M12,SUM(M13)M13,SUM(M14)M14 ,SUM(M15)M15,SUM(M16)M16,SUM(M17)M17,SUM(M18)M18,SUM(M19)M19,SUM(M20)M20,sum(AMOUNT_DC) TOTAL FROM TABLE(FN_RENEWAL_STATISTICS(?,?,?,?,?,?,?)) WHERE UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR
GET_TREATY_RESULT_UW=SELECT 'Treaty Result'ITEM,P.CNT, P.CONTRACT_NO,P.UW_YEAR, (NVL(PM1,0)-NVL(ACM1,0)-NVL(CM1,0)-NVL(COM1,0))M1,(NVL(PM2,0)-NVL(ACM2,0)-NVL(CM2,0)-NVL(COM2,0))M2,(NVL(PM3,0)-NVL(ACM3,0)-NVL(CM3,0)-NVL(COM3,0))M3,(NVL(PM4,0)-NVL(ACM4,0)-NVL(CM4,0)-NVL(COM4,0))M4,(NVL(PM5,0)-NVL(ACM5,0)-NVL(CM5,0)-NVL(COM5,0))M5,(NVL(PM6,0)-NVL(ACM6,0)-NVL(CM6,0)-NVL(COM6,0))M6,(NVL(PM7,0)-NVL(ACM7,0)-NVL(CM7,0)-NVL(COM7,0))M7,(NVL(PM8,0)-NVL(ACM8,0)-NVL(CM8,0)-NVL(COM8,0))M8,(NVL(PM9,0)-NVL(ACM9,0)-NVL(CM9,0)-NVL(COM9,0))M9,(NVL(PM10,0)-NVL(ACM10,0)-NVL(CM10,0)-NVL(COM10,0))M10,(NVL(PM11,0)-NVL(ACM11,0)-NVL(CM11,0)-NVL(COM11,0))M11,(NVL(PM12,0)-NVL(ACM12,0)-NVL(CM12,0)-NVL(COM12,0))M12,(NVL(PM13,0)-NVL(ACM13,0)-NVL(CM13,0)-NVL(COM13,0))M13,(NVL(PM14,0)-NVL(ACM14,0)-NVL(CM14,0)-NVL(COM14,0))M14,(NVL(PM15,0)-NVL(ACM15,0)-NVL(CM15,0)-NVL(COM15,0))M15,(NVL(PM16,0)-NVL(ACM16,0)-NVL(CM16,0)-NVL(COM16,0))M16,(NVL(PM17,0)-NVL(ACM17,0)-NVL(CM17,0)-NVL(COM17,0))M17,(NVL(PM18,0)-NVL(ACM18,0)-NVL(CM18,0)-NVL(COM18,0))M18,(NVL(PM19,0)-NVL(ACM19,0)-NVL(CM19,0)-NVL(COM19,0))M19,(NVL(PM20,0)-NVL(ACM20,0)-NVL(CM20,0)-NVL(COM20,0))M20, (NVL(PTOTAL,0)-NVL(ACTOTAL,0)-NVL(CTOTAL,0)-NVL(COTOTAL,0))TOTAL FROM  (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)PM1,SUM(M2)PM2,SUM(M3)PM3,SUM(M4)PM4,SUM(M5)PM5,SUM(M6)PM6,SUM(M7)PM7,SUM(M8)PM8,SUM(M9)PM9,SUM(M10)PM10,SUM(M11)PM11,SUM(M12)PM12,SUM(M13)PM13,SUM(M14)PM14 ,SUM(M15)PM15,SUM(M16)PM16,SUM(M17)PM17,SUM(M18)PM18,SUM(M19)PM19,SUM(M20)PM20,sum(AMOUNT_DC) PTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'PREMIUM'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)P  LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)ACM1,SUM(M2)ACM2,SUM(M3)ACM3,SUM(M4)ACM4,SUM(M5)ACM5,SUM(M6)ACM6,SUM(M7)ACM7,SUM(M8)ACM8,SUM(M9)ACM9,SUM(M10)ACM10,SUM(M11)ACM11,SUM(M12)ACM12,SUM(M13)ACM13,SUM(M14)ACM14 ,SUM(M15)ACM15,SUM(M16)ACM16,SUM(M17)ACM17,SUM(M18)ACM18,SUM(M19)ACM19,SUM(M20)ACM20,sum(AMOUNT_DC) ACTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'ACQCOST'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)AC on(P.UW_YEAR=AC.UW_YEAR)LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)CM1,SUM(M2)CM2,SUM(M3)CM3,SUM(M4)CM4,SUM(M5)CM5,SUM(M6)CM6,SUM(M7)CM7,SUM(M8)CM8,SUM(M9)CM9,SUM(M10)CM10,SUM(M11)CM11,SUM(M12)CM12,SUM(M13)CM13,SUM(M14)CM14 ,SUM(M15)CM15,SUM(M16)CM16,SUM(M17)CM17,SUM(M18)CM18,SUM(M19)CM19,SUM(M20)CM20,sum(AMOUNT_DC)  CTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'CLAIM'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)C   on(C.UW_YEAR=AC.UW_YEAR)LEFT OUTER JOIN  (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)COM1,SUM(M2)COM2,SUM(M3)COM3,SUM(M4)COM4,SUM(M5)COM5,SUM(M6)COM6,SUM(M7)COM7,SUM(M8)COM8,SUM(M9)COM9,SUM(M10)COM10,SUM(M11)COM11,SUM(M12)COM12,SUM(M13)COM13,SUM(M14)COM14 ,SUM(M15)COM15,SUM(M16)COM16,SUM(M17)COM17,SUM(M18)COM18,SUM(M19)COM19,SUM(M20)COM20,sum(AMOUNT_DC)  COTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'CLAIMOUTSTANDING'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)CO on(AC.UW_YEAR=CO.UW_YEAR) order by P.UW_YEAR
GET_CLAIM_RATIO_UW= SELECT 'Claims Ratio'ITEM,P.CNT, P.CONTRACT_NO,P.UW_YEAR, case when PM1>0 then ((NVL(CM1,0)+NVL(COM1,0))/(NVL(PM1,0)))*100 ELSE 99999999 end M1, case when PM2>0 then((NVL(CM2,0)+NVL(COM2,0))/(NVL(PM2,0)))*100 ELSE 99999999 end M2, case when PM3>0 then ((NVL(CM3,0)+NVL(COM3,0))/(NVL(PM3,0)))*100 ELSE 99999999 end M3, case when PM4>0 then((NVL(CM4,0)+NVL(COM4,0))/(NVL(PM4,0)))*100 ELSE 99999999 end M4,case when PM5>0 then ((NVL(CM5,0)+NVL(COM5,0))/(NVL(PM5,0)))*100 ELSE 99999999 end M5, case when PM6>0 then((NVL(CM6,0)+NVL(COM6,0))/(NVL(PM6,0)))*100 ELSE 99999999 end M6, case when PM7>0 then((NVL(CM7,0)+NVL(COM7,0))/(NVL(PM7,0)))*100 ELSE 99999999 end M7, case when PM8>0 then ((NVL(CM8,0)+NVL(COM8,0))/(NVL(PM8,0)))*100 ELSE 99999999 end M8,case when PM9>0 then ((NVL(CM9,0)+NVL(COM9,0))/(NVL(PM9,0)))*100 ELSE 99999999 end M9, case when PM10>0 then((NVL(CM10,0)+NVL(COM10,0))/(NVL(PM10,0)))*100 ELSE 99999999 end M10, case when PM11>0 then((NVL(CM11,0)+NVL(COM11,0))/(NVL(PM11,0)))*100 ELSE 99999999 end M11, case when PM12>0 then((NVL(CM12,0)+NVL(COM12,0))/(NVL(PM12,0)))*100 ELSE 99999999 end M12, case when PM13>0 then((NVL(CM13,0)+NVL(COM13,0))/(NVL(PM13,0)))*100 ELSE 99999999 end M13, case when PM14>0 then((NVL(CM14,0)+NVL(COM14,0))/(NVL(PM14,0)))*100 ELSE 99999999 end M14, case when PM15>0 then((NVL(CM15,0)+NVL(COM15,0))/(NVL(PM15,0)))*100 ELSE 99999999 end M15, case when PM16>0 then((NVL(CM16,0)+NVL(COM16,0))/(NVL(PM16,0)))*100 ELSE 99999999 end M16, case when PM17>0 then((NVL(CM17,0)+NVL(COM17,0))/(NVL(PM17,0)))*100 ELSE 99999999 end M17, case when PM18>0 then((NVL(CM18,0)+NVL(COM18,0))/(NVL(PM18,0)))*100 ELSE 99999999 end M18, case when PM19>0 then((NVL(CM19,0)+NVL(COM19,0))/(NVL(PM19,0)))*100 ELSE 99999999 end M19, case when PM20>0 then((NVL(CM20,0)+NVL(COM20,0))/(NVL(PM20,0)))*100 ELSE 99999999 end M20,case when PTOTAL>0 then((NVL(CTOTAL,0)+NVL(COTOTAL,0))/(NVL(PTOTAL,0)))*100 ELSE 99999999 end TOTAL FROM  (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)PM1,SUM(M2)PM2,SUM(M3)PM3,SUM(M4)PM4,SUM(M5)PM5,SUM(M6)PM6,SUM(M7)PM7,SUM(M8)PM8,SUM(M9)PM9,SUM(M10)PM10,SUM(M11)PM11,SUM(M12)PM12,SUM(M13)PM13,SUM(M14)PM14 ,SUM(M15)PM15,SUM(M16)PM16,SUM(M17)PM17,SUM(M18)PM18,SUM(M19)PM19,SUM(M20)PM20,sum(AMOUNT_DC) PTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'PREMIUM'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)P  LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)ACM1,SUM(M2)ACM2,SUM(M3)ACM3,SUM(M4)ACM4,SUM(M5)ACM5,SUM(M6)ACM6,SUM(M7)ACM7,SUM(M8)ACM8,SUM(M9)ACM9,SUM(M10)ACM10,SUM(M11)ACM11,SUM(M12)ACM12,SUM(M13)ACM13,SUM(M14)ACM14 ,SUM(M15)ACM15,SUM(M16)ACM16,SUM(M17)ACM17,SUM(M18)ACM18,SUM(M19)ACM19,SUM(M20)ACM20,sum(AMOUNT_DC) ACTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'ACQCOST'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)AC on(P.UW_YEAR=AC.UW_YEAR) LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)CM1,SUM(M2)CM2,SUM(M3)CM3,SUM(M4)CM4,SUM(M5)CM5,SUM(M6)CM6,SUM(M7)CM7,SUM(M8)CM8,SUM(M9)CM9,SUM(M10)CM10,SUM(M11)CM11,SUM(M12)CM12,SUM(M13)CM13,SUM(M14)CM14 ,SUM(M15)CM15,SUM(M16)CM16,SUM(M17)CM17,SUM(M18)CM18,SUM(M19)CM19,SUM(M20)CM20,sum(AMOUNT_DC) CTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'CLAIM'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)C   on(C.UW_YEAR=AC.UW_YEAR)LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)COM1,SUM(M2)COM2,SUM(M3)COM3,SUM(M4)COM4,SUM(M5)COM5,SUM(M6)COM6,SUM(M7)COM7,SUM(M8)COM8,SUM(M9)COM9,SUM(M10)COM10,SUM(M11)COM11,SUM(M12)COM12,SUM(M13)COM13,SUM(M14)COM14 ,SUM(M15)COM15,SUM(M16)COM16,SUM(M17)COM17,SUM(M18)COM18,SUM(M19)COM19,SUM(M20)COM20,sum(AMOUNT_DC) COTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?, ?, ?, ?, ?, ?, 'CLAIMOUTSTANDING'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)CO on(AC.UW_YEAR=CO.UW_YEAR) order by P.UW_YEAR
GET_COMINED_RATIO_UW= SELECT 'Combined Ratio'ITEM,P.CNT, P.CONTRACT_NO,P.UW_YEAR, case when PM1>0 then ((NVL(CM1,0)+NVL(COM1,0)+NVL(ACM1,0))/(NVL(PM1,0)))*100 ELSE 99999999 end M1, case when PM2>0 then((NVL(CM2,0)+NVL(COM2,0)+NVL(ACM2,0))/(NVL(PM2,0)))*100 ELSE 99999999 end M2, case when PM3>0 then ((NVL(CM3,0)+NVL(COM3,0)+NVL(ACM3,0))/(NVL(PM3,0)))*100 ELSE 99999999 end M3, case when PM4>0 then((NVL(CM4,0)+NVL(COM4,0)+NVL(ACM4,0))/(NVL(PM4,0)))*100 ELSE 99999999 end M4,case when PM5>0 then ((NVL(CM5,0)+NVL(COM5,0)+NVL(ACM5,0))/(NVL(PM5,0)))*100 ELSE 99999999 end M5, case when PM6>0 then((NVL(CM6,0)+NVL(COM6,0)+NVL(ACM6,0))/(NVL(PM6,0)))*100 ELSE 99999999 end M6, case when PM7>0 then((NVL(CM7,0)+NVL(COM7,0)+NVL(ACM7,0))/(NVL(PM7,0)))*100 ELSE 99999999 end M7, case when PM8>0 then ((NVL(CM8,0)+NVL(COM8,0)+NVL(ACM8,0))/(NVL(PM8,0)))*100 ELSE 99999999 end M8,case when PM9>0 then ((NVL(CM9,0)+NVL(COM9,0)+NVL(ACM9,0))/(NVL(PM9,0)))*100 ELSE 99999999 end M9, case when PM10>0 then((NVL(CM10,0)+NVL(COM10,0)+NVL(ACM10,0))/(NVL(PM10,0)))*100 ELSE 99999999 end M10, case when PM11>0 then((NVL(CM11,0)+NVL(COM11,0)+NVL(ACM11,0))/(NVL(PM11,0)))*100 ELSE 99999999 end M11, case when PM12>0 then((NVL(CM12,0)+NVL(COM12,0)+NVL(ACM12,0))/(NVL(PM12,0)))*100 ELSE 99999999 end M12, case when PM13>0 then((NVL(CM13,0)+NVL(COM13,0)+NVL(ACM13,0))/(NVL(PM13,0)))*100 ELSE 99999999 end M13, case when PM14>0 then((NVL(CM14,0)+NVL(COM14,0)+NVL(ACM14,0))/(NVL(PM14,0)))*100 ELSE 99999999 end M14, case when PM15>0 then((NVL(CM15,0)+NVL(COM15,0)+NVL(ACM15,0))/(NVL(PM15,0)))*100 ELSE 99999999 end M15, case when PM16>0 then((NVL(CM16,0)+NVL(COM16,0)+NVL(ACM16,0))/(NVL(PM16,0)))*100 ELSE 99999999 end M16, case when PM17>0 then((NVL(CM17,0)+NVL(COM17,0)+NVL(ACM17,0))/(NVL(PM17,0)))*100 ELSE 99999999 end M17, case when PM18>0 then((NVL(CM18,0)+NVL(COM18,0)+NVL(ACM18,0))/(NVL(PM18,0)))*100 ELSE 99999999 end M18, case when PM19>0 then((NVL(CM19,0)+NVL(COM19,0)+NVL(ACM19,0))/(NVL(PM19,0)))*100 ELSE 99999999 end M19, case when PM20>0 then((NVL(CM20,0)+NVL(COM20,0)+NVL(ACM20,0))/(NVL(PM20,0)))*100 ELSE 99999999 end M20,case when PTOTAL>0 then((NVL(CTOTAL,0)+NVL(COTOTAL,0)+NVL(ACTOTAL,0))/(NVL(PTOTAL,0)))*100 ELSE 99999999 end TOTAL FROM (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)PM1,SUM(M2)PM2,SUM(M3)PM3,SUM(M4)PM4,SUM(M5)PM5,SUM(M6)PM6,SUM(M7)PM7,SUM(M8)PM8,SUM(M9)PM9,SUM(M10)PM10,SUM(M11)PM11,SUM(M12)PM12,SUM(M13)PM13,SUM(M14)PM14 ,SUM(M15)PM15,SUM(M16)PM16,SUM(M17)PM17,SUM(M18)PM18,SUM(M19)PM19,SUM(M20)PM20,sum(AMOUNT_DC) PTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?,?,?,?,?,?, 'PREMIUM'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)P  LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)ACM1,SUM(M2)ACM2,SUM(M3)ACM3,SUM(M4)ACM4,SUM(M5)ACM5,SUM(M6)ACM6,SUM(M7)ACM7,SUM(M8)ACM8,SUM(M9)ACM9,SUM(M10)ACM10,SUM(M11)ACM11,SUM(M12)ACM12,SUM(M13)ACM13,SUM(M14)ACM14 ,SUM(M15)ACM15,SUM(M16)ACM16,SUM(M17)ACM17,SUM(M18)ACM18,SUM(M19)ACM19,SUM(M20)ACM20,sum(AMOUNT_DC) ACTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?,?,?,?,?,?, 'ACQCOST'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)AC on(P.UW_YEAR\=AC.UW_YEAR)  LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)CM1,SUM(M2)CM2,SUM(M3)CM3,SUM(M4)CM4,SUM(M5)CM5,SUM(M6)CM6,SUM(M7)CM7,SUM(M8)CM8,SUM(M9)CM9,SUM(M10)CM10,SUM(M11)CM11,SUM(M12)CM12,SUM(M13)CM13,SUM(M14)CM14 ,SUM(M15)CM15,SUM(M16)CM16,SUM(M17)CM17,SUM(M18)CM18,SUM(M19)CM19,SUM(M20)CM20,sum(AMOUNT_DC) CTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?,?,?,?,?,?, 'CLAIM'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)C   on(C.UW_YEAR\=AC.UW_YEAR)LEFT OUTER JOIN (SELECT ITEM,CNT, CONTRACT_NO,UW_YEAR,SUM(M1)COM1,SUM(M2)COM2,SUM(M3)COM3,SUM(M4)COM4,SUM(M5)COM5,SUM(M6)COM6,SUM(M7)COM7,SUM(M8)COM8,SUM(M9)COM9,SUM(M10)COM10,SUM(M11)COM11,SUM(M12)COM12,SUM(M13)COM13,SUM(M14)COM14 ,SUM(M15)COM15,SUM(M16)COM16,SUM(M17)COM17,SUM(M18)COM18,SUM(M19)COM19,SUM(M20)COM20,sum(AMOUNT_DC) COTOTAL FROM TABLE (FN_RENEWAL_STATISTICS (?,?,?,?,?,?, 'CLAIMOUTSTANDING'))  WHERE   UW_YEAR BETWEEN ? AND ? GROUP BY CONTRACT_NO,UW_YEAR,CNT,ITEM ORDER BY UW_YEAR DESC)CO on(AC.UW_YEAR\=CO.UW_YEAR) ORDER BY P.UW_YEAR
CLAIM_SELECT_RETRO_GETCLIMEQUERY = SELECT   (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RK.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RK.RSK_PRODUCTID AND PERSONAL.BRANCH_CODE = SPFC.BRANCH_CODE)TMAS_SPFC_NAME,RK.RSK_CONTRACT_NO,RK.RSK_ENDORSEMENT_NO,  PERSONAL.COMPANY_NAME CEDING_COMPANY,  RK.RSK_CEDINGID,   RK.RSK_PROPOSAL_NUMBER, RP.RSK_SHARE_SIGNED,  RP.RSK_LIMIT_OC,  RP.RSK_LIMIT_DC,  RP.RSK_LIMIT_OS_OC,RP.RSK_LIMIT_OS_DC,  RP.RSK_CEDANT_RETENTION,  TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INCP_DATE, TO_CHAR(RK.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') RSK_ACCOUNT_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,  RK.RSK_TREATYID,  RP.RSK_PF_COVERED,  RK.RSK_INSURED_NAME,  RK.RSK_RISK_COVERED,  PI.FIRST_NAME||' '||PI.LAST_NAME BROKER_NAME,  RK.RSK_BROKERID, RK.RSK_PROPOSAL_TYPE,RK.RSK_BASIS,(select TMAS_DEPARTMENT_NAME from TMAS_DEPARTMENT_MASTER where TMAS_DEPARTMENT_ID=RK.RSK_DEPTID AND RK.RSK_PRODUCTID=TMAS_PRODUCT_ID and Branch_code=PERSONAL.BRANCH_CODE and TMAS_STATUS='Y') TMAS_DEPARTMENT_NAME,RK.RSK_SPFCID,RK.RSK_DEPTID,RK.RSK_UWYEAR   FROM TTRN_RISK_DETAILS RK, PERSONAL_INFO PERSONAL, TTRN_RISK_PROPOSAL RP,PERSONAL_INFO PI  WHERE RK.RSK_PROPOSAL_NUMBER = ?  AND RK.RSK_PRODUCTID = ?  AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID  AND PERSONAL.BRANCH_CODE=? AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PERSONAL.CUSTOMER_ID  AND BRANCH_CODE=PERSONAL.BRANCH_CODE AND CUSTOMER_TYPE=PERSONAL.CUSTOMER_TYPE)  AND RK.RSK_BROKERID = PI.CUSTOMER_ID  AND PI.BRANCH_CODE=? AND PI.CUSTOMER_TYPE='B' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO  WHERE CUSTOMER_ID=PI.CUSTOMER_ID  AND BRANCH_CODE=PI.BRANCH_CODE AND CUSTOMER_TYPE=PI.CUSTOMER_TYPE)  AND RP.RSK_PROPOSAL_NUMBER = RK.RSK_PROPOSAL_NUMBER  AND RK.RSK_CEDINGID = PERSONAL.CUSTOMER_ID  AND RK.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_DETAILS  WHERE   RSK_PROPOSAL_NUMBER =? )  AND RP.RSK_ENDORSEMENT_NO =  (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_PROPOSAL  WHERE   RSK_PROPOSAL_NUMBER = RK.RSK_PROPOSAL_NUMBER)
UPDATE_TRANSACTION_NO_STATUS =UPDATE TTRN_DEPOSIT_RELEASE SET RL_TRANSACTION_NO\=?,TABLE_MOVE_STATUS\=? WHERE CONTRACT_NO\=? AND TEMP_REQUEST_NO\=?
UPDATE_CASHLOSS_STATUS = UPDATE TTRN_CASH_LOSS_CREDIT SET CREDITTRXNNO =? , TABLE_MOVE_STATUS=? WHERE CONTRACT_NO=? AND TEMP_REQUEST_NO=?
update.claim.payment=UPDATE TTRN_CLAIM_PAYMENT SET CASH_LOSS_SETTLED_TILLDATE\=nvl(CASH_LOSS_SETTLED_TILLDATE,0)+(SELECT SUM(NVL(CREDITAMOUNTCLD,0)) FROM TTRN_CASH_LOSS_CREDIT  WHERE CONTRACT_NO\=?  AND BRANCH_CODE\=?  AND TEMP_REQUEST_NO\=? AND TABLE_MOVE_STATUS\=?  AND  CLAIM_NO\=? AND  CLAIMPAYMENT_NO\=?) WHERE CONTRACT_NO\=? AND  CLAIM_NO\=? AND  CLAIM_PAYMENT_NO\=?
GET_REPORTING_PERIOD=SELECT SUBSTR(DATE_TYPE,1,1) QTYPE,(lpad(START_DATE,2,0) ||'/'||lpad(start_month,2,0)||'/'||  (TO_CHAR(TO_DATE(?,'DD/MM/YYYY'),'YYYY')-(END_YEAR-START_YEAR) )) startDate, (lpad(end_DATE,2,0) ||'/'||lpad(end_month,2,0) ||'/'|| TO_CHAR(TO_DATE(?,'DD/MM/YYYY'),'YYYY'))   endDate FROM  TMAS_REPORTING_PERIOD WHERE BRANCH_CODE=? AND (lpad(end_DATE,2,0) ||'/'||lpad(end_month,2,0))=TO_CHAR(TO_DATE(?,'DD/MM/YYYY'),'DD/MM')
get.count.prcl.processid=SELECT COUNT(*) COUNT  FROM TTRN_RETRO_PRCL S  WHERE AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RETRO_PRCL WHERE CONTRACT_NO= S.CONTRACT_NO AND TRANSACTION_NO=S.TRANSACTION_NO) AND   PROCESS_ID IS NULL AND TRANSACTION_MONTH_YEAR BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') AND BRANCH_CODE=? AND SOA_FREQUENCY IN(?) AND S.RETROCESSIONAIRE != 64
UPDATE_USER_STATUS=UPDATE LOGIN_MASTER SET STATUS\=? WHERE LOGIN_ID NOT IN(?) AND BRANCH_CODE\=?
GET_END_DATE_YEAR=select case to_char(trunc(to_date(?,'DD/MM/YYYY'),'Q'),'Q') when '1' then to_char(trunc(to_date(?,'DD/MM/YYYY'),'YY'),'dd/mm/yyyy') when '2' then to_char(trunc(to_date(?,'DD/MM/YYYY'),'YY'),'dd/mm/yyyy')   else to_char(trunc(to_date(?,'DD/MM/YYYY'),'YY'),'dd/mm/yyyy')  end endDate from dual

getMenuDropDownList_SubQuery = SELECT   REGEXP_SUBSTR ( MENU_IDS,'[^,]+', 1, LEVEL) AS MENU_ID FROM   (SELECT   to_char(listagg(MENU_IDS)) MENU_IDS FROM   TMAS_LOGIN_DETAILS WHERE   LOGIN_ID = ?  AND ACTIVE = '1') CONNECT BY   LEVEL <= LENGTH (MENU_IDS)  - LENGTH (REPLACE (MENU_IDS, ',', '')) + 1
user.select.finalMenuList=SELECT   MM.MENU_ID, MM.MENU_NAME, MM.MENU_URL FROM   (    SELECT   REGEXP_SUBSTR (MENU_IDS,'[^,]+',1,LEVEL) AS MENU_ID FROM   (SELECT   MENU_IDS FROM   TMAS_LOGIN_DETAILS WHERE LOGIN_ID = ? AND PROCESS_ID = ? AND ACTIVE = '1') CONNECT BY   LEVEL <= LENGTH (MENU_IDS)- LENGTH (REPLACE (MENU_IDS, ',', ''))+ 1) LD, MENU_MASTER MM WHERE   MM.MENU_ID = LD.MENU_ID AND MM.PROCESS_ID = ? AND MM.ACTIVE = '1' ORDER BY   MM.ORDER_NO
menudao.select.adminuserMenus=SELECT MM.MENU_ID, MM.MENU_NAME, MM.MENU_URL FROM ( SELECT REGEXP_SUBSTR (MENU_IDS, '[^,]+', 1, LEVEL) AS MENU_ID FROM (SELECT MENU_IDS FROM TMAS_LOGIN_DETAILS WHERE LOGIN_ID = ? AND ACTIVE = '1') CONNECT BY LEVEL <= LENGTH (MENU_IDS) - LENGTH (REPLACE (MENU_IDS, ',', '')) + 1) LD, TMAS_MENU_MASTER MM WHERE MM.MENU_ID = LD.MENU_ID AND MM.ACTIVE = '1' ORDER BY MM.ORDER_NO
menudao.select.getRigthsOfProcessId=SELECT SMM.SUB_MENU_CODE ,SMM.SUB_MENU_NAME FROM TMAS_SUB_MENU_MASTER SMM ,(SELECT REGEXP_SUBSTR(SUB_MENU_CODES,'[^,]+',1,LEVEL) AS SUB_MENU_CODES FROM (SELECT SUB_MENU_CODES FROM MENU_MASTER WHERE  MENU_ID = ? AND PROCESS_ID = ? AND ACTIVE = '1') CONNECT BY LEVEL <= LENGTH(SUB_MENU_CODES)-LENGTH(REPLACE(SUB_MENU_CODES,',',''))+1) MM , (SELECT REGEXP_SUBSTR(SUB_MENU_CODES,'[^,]+',1,LEVEL) AS SUB_MENU_CODES FROM (SELECT SUB_MENU_CODES FROM TMAS_SUB_MENU_RIGHTS WHERE  MENU_ID = ? AND PROCESS_ID = ? AND LOGIN_ID = ? AND ACTIVE = '1' ) CONNECT BY LEVEL <= LENGTH(SUB_MENU_CODES)-LENGTH(REPLACE(SUB_MENU_CODES,',',''))+1) SMR WHERE SMM.STATUS = 'Y' AND SMM.SUB_MENU_CODE = MM.SUB_MENU_CODES AND SMM.SUB_MENU_CODE = SMR.SUB_MENU_CODES
report.select.moveMentInit=SELECT   A.*  FROM  (SELECT DISTINCT MD.MOVMENT_TRANID,CD.DETAIL_NAME,MD.ACCOUNT_PERIOD_QTR,MD.ACCOUNT_PERIOD_DATE,MD.ACCOUNT_PERIOD_DATE ACCOUNT_PERIOD,MD.REPORT_TYPE,(SELECT   TMAS_PRODUCT_NAME FROM   TMAS_PRODUCT_MASTER TPM  WHERE   TPM.TMAS_PRODUCT_ID \= MD.PRODUCT_ID  AND TPM.BRANCH_CODE \= ? AND TPM.TMAS_STATUS\= 'Y') PRODUCT_NAME,(SELECT   TMAS_DEPARTMENT_NAME  FROM   TMAS_DEPARTMENT_MASTER TDM  WHERE  TDM.TMAS_DEPARTMENT_ID \= MD.DEPT_ID AND TDM.TMAS_PRODUCT_ID \= MD.PRODUCT_ID  AND TDM.BRANCH_CODE \= ? AND TDM.TMAS_STATUS\= 'Y') DEPT_NAME  FROM   TRANSACTION_MOVEMENT_DETAILS MD, CONSTANT_DETAIL CD WHERE MD.BRANCH_CODE \= ?  AND CD.CATEGORY_ID \= '12' AND CD.TYPE \= MD.ACCOUNT_PERIOD_QTR AND MD.TYPE \= 'Q' ORDER BY   1 DESC) A
report.select.clMoveMentInit=SELECT DISTINCT MOVEMENT_ID, TO_CHAR(MOVEMENT_DATE,'DD/MM/YYYY') MOVEMENT_DT,REPORT_TYPE  FROM TRANSITION_CLAIM_MOVEMENT WHERE BRANCH_CODE=? ORDER BY MOVEMENT_ID DESC
report.select.clJournalInit=SELECT A.* FROM (SELECT DISTINCT MD.MOVMENT_TRANID,CD.DETAIL_NAME,MD.ACCOUNT_PERIOD_QTR, MD.ACCOUNT_PERIOD_DATE ACCOUNT_PERIOD, MD.REPORT_TYPE FROM   TRANSACTION_MOVEMENT_DETAILS MD, CONSTANT_DETAIL CD WHERE MD.BRANCH_CODE \= ? AND CD.CATEGORY_ID \= '12' AND CD.TYPE \= MD.ACCOUNT_PERIOD_QTR AND MD.TYPE \= 'Q' AND MD.PR_CL_TYPE\='CL' ORDER BY   1 DESC) A
BOOKED_UPR_INIT = SELECT DISTINCT MOVEMENT_ID,UW_YEAR,TO_CHAR(REPORT_DATE,'DD/MM/YYYY') REPORT_DATE,DECODE(MOVEMENT_TYPE,'F','Final','Intreim') MOVEMENT_TYPE FROM BOOKED_UPR WHERE BRANCH_CODE=? ORDER BY MOVEMENT_ID
BOOKED_PREMIUM_INIT = SELECT DISTINCT MOVEMENT_ID,UW_YEAR,TO_CHAR(REPORT_DATE,'DD/MM/YYYY') REPORT_DATE,DECODE(MOVEMENT_TYPE,'F','Final','Intreim') MOVEMENT_TYPE FROM BOOKED_PREMIUM WHERE BRANCH_CODE=? ORDER BY MOVEMENT_ID
PIPELIEN_WRITTEN_INIT = SELECT DISTINCT MOVEMENT_ID,DECODE(MOVEMENT_TYPE,'F','Final','Intreim') MOVEMENT_TYPE,BRANCH_CODE,UW_YEAR,TO_CHAR(REPORT_DATE,'DD/MM/YYYY') REPORT_DATE FROM UPR_PIPELINED_WRITTEN WHERE BRANCH_CODE=? ORDER BY MOVEMENT_ID ASC
reportdao.select.getReportProductList= SELECT DISTINCT TMAS_PRODUCT_ID,TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER PM,XL_TYPE_MASTER TM  WHERE TM.PRODUCT_ID=PM.TMAS_PRODUCT_ID AND TM.TYPE_ID=? AND TM.STATUS='Y' AND PM.TMAS_STATUS='1' AND BRANCH_CODE=? AND TMAS_PRODUCT_ID!='5' ORDER BY TMAS_PRODUCT_ID
report.select.getCedingCompanyList=SELECT DISTINCT P.CUSTOMER_ID, CASE WHEN P.CUSTOMER_TYPE = 'C' THEN P.COMPANY_NAME ELSE P.FIRST_NAME || ' ' || P.LAST_NAME END NAME FROM PERSONAL_INFO P WHERE P.BRANCH_CODE=? AND P.CUSTOMER_TYPE=? AND STATUS=? AND P.CUSTOMER_ID IN(SELECT DISTINCT CEDING_COMPANY_ID FROM POSITION_MASTER WHERE BRANCH_CODE=? AND PRODUCT_ID=?)  AND P.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE BRANCH_CODE=P.BRANCH_CODE AND CUSTOMER_TYPE=P.CUSTOMER_TYPE AND STATUS=P.STATUS AND CUSTOMER_ID=P.CUSTOMER_ID) ORDER BY NAME
report.select.reportname = SELECT TYPE_NAME FROM XL_TYPE_MASTER WHERE TYPE_ID=? AND STATUS=?
report.select.getReportName= SELECT TYPE_NAME FROM XL_TYPE_MASTER WHERE  PRODUCT_ID=? AND TYPE_ID=? AND STATUS=?
reportdao.select.facgetQuoteRegisterList=SELECT RD.RSK_PROPOSAL_NUMBER,RD.RSK_UWYEAR,TO_CHAR (rd.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INC_DATE,TO_CHAR (rd.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,TO_CHAR (rd.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') ACC_DATE,DECODE(RD.RSK_SPFCID,'ALL',RD.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID \= RD.RSK_PRODUCTID AND RD.BRANCH_CODE \= SPFC.BRANCH_CODE)) TMAS_SPFC_NAME,PIB.FIRST_NAME ||' '||PIB.LAST_NAME BROKER_NAME,pi.COMPANY_NAME,rd.RSK_INSURED_NAME,f.SHARE_WRITTEN,f.SHARE_SIGNED,pm.PROPOSAL_STATUS,rd.RSK_UNDERWRITTER,PM.BRANCH_CODE  FROM    PERSONAL_INFO Pi, TTRN_RISK_DETAILS RD, TTRN_FAC_RISK_PROPOSAL F, POSITION_MASTER PM, PERSONAL_INFO PIb WHERE   PM.BRANCH_CODE \= ? AND PM.PROPOSAL_NO \= F.RSK_PROPOSAL_NUMBER AND RD.RSK_PROPOSAL_NUMBER \= F.RSK_PROPOSAL_NUMBER AND RD.RSK_PROPOSAL_NUMBER \= PM.PROPOSAL_NO AND Pi.CUSTOMER_ID \= RD.RSK_CEDINGID AND Pi.BRANCH_CODE \= PM.BRANCH_CODE AND Pi.AMEND_ID \=(SELECT   MAX (AMEND_ID)  FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= Pi.CUSTOMER_ID AND BRANCH_CODE \= Pi.BRANCH_CODE) AND RD.RSK_ENDORSEMENT_NO \=(SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE  RSK_PROPOSAL_NUMBER \=RD.RSK_PROPOSAL_NUMBER) AND PM.contract_STATUS \= 'P' AND RD.RSK_PRODUCTID \= ? AND PM.ACCOUNT_DATE BETWEEN TO_DATE (?,'DD/MM/YYYY') AND  TO_DATE (?,'DD/MM/YYYY')  and  PIb.CUSTOMER_ID \= RD.RSK_BROKERID  AND PIb.BRANCH_CODE \= pm.BRANCH_CODE  AND PIb.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PIb.CUSTOMER_ID AND BRANCH_CODE \= PIb.BRANCH_CODE)  AND F.RSK_ENDORSEMENT_NO \=(SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_FAC_RISK_PROPOSAL WHERE  RSK_PROPOSAL_NUMBER \= F.RSK_PROPOSAL_NUMBER) AND PM.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER  WHERE  PROPOSAL_NO \=PM.PROPOSAL_NO)
reportdao.select.facgetQuoteRegisterLoginId=AND PM.LOGIN_ID = ?
reportdao.select.facgetQuoteRegisterCedingId=AND RD.RSK_CEDINGID=?
reportdao.select.facgetQuoteRegisterBrokerId=AND RD.RSK_BROKERID=?
report.select.reportUWYear=AND RSK_UWYEAR=?
reportdao.select.facOrder=ORDER BY rd.RSK_PROPOSAL_NUMBER DESC
reportdao.select.xolOrTreatygetQuoteRegisterList=SELECT   RD.RSK_PROPOSAL_NUMBER,rd.RSK_UWYEAR,TO_CHAR (rd.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INC_DATE,TO_CHAR (rd.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,TO_CHAR (rd.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') ACC_DATE,decode(RD.RSK_SPFCID,'ALL',RD.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND RD.BRANCH_CODE = SPFC.BRANCH_CODE)) TMAS_SPFC_NAME,PIb.COMPANY_NAME BROKER_NAME,pi.COMPANY_NAME,rd.RSK_INSURED_NAME,f.RSK_SHARE_WRITTEN SHARE_WRITTEN,f.RSK_SHARE_SIGNED SHARE_SIGNED,cd.DETAIL_NAME,rd.RSK_UNDERWRITTER,PM.BRANCH_CODE    FROM    PERSONAL_INFO Pi, TTRN_RISK_DETAILS RD, ttrn_RISK_PROPOSAL F, POSITION_MASTER PM, CONSTANT_DETAIL CD, PERSONAL_INFO pib   WHERE PM.BRANCH_CODE = ?  AND PM.PROPOSAL_NO = F.RSK_PROPOSAL_NUMBER AND RD.RSK_PROPOSAL_NUMBER = F.RSK_PROPOSAL_NUMBER AND RD.RSK_PROPOSAL_NUMBER = PM.PROPOSAL_NO AND Pi.CUSTOMER_ID = RD.RSK_CEDINGID AND Pi.BRANCH_CODE = PM.BRANCH_CODE AND Pi.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE  CUSTOMER_ID = Pi.CUSTOMER_ID AND BRANCH_CODE = Pi.BRANCH_CODE) AND RD.RSK_ENDORSEMENT_NO =(SELECT   MAX (TRD.RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS TRD  WHERE   TRD.RSK_PROPOSAL_NUMBER =RD.RSK_PROPOSAL_NUMBER) AND F.RSK_ENDORSEMENT_NO =(SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   ttrn_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER =F.RSK_PROPOSAL_NUMBER) AND PM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PROPOSAL_NO =PM.PROPOSAL_NO) AND PM.contract_STATUS = 'P' AND RD.RSK_PRODUCTID = ? AND CD.CATEGORY_ID = 1 AND CD.TYPE = TRIM (PM.PROPOSAL_STATUS) AND PM.ACCOUNT_DATE BETWEEN TO_DATE (?,'DD/MM/YYYY') AND  TO_DATE (?,'DD/MM/YYYY') and PIb.CUSTOMER_ID = RD.RSK_BROKERID AND PIb.BRANCH_CODE = pm.BRANCH_CODE AND PIb.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO  WHERE  CUSTOMER_ID = PIb.CUSTOMER_ID AND BRANCH_CODE = PIb.BRANCH_CODE)
reportdao.select.deptNameRetroRetroxol=SELECT   RD.RSK_PROPOSAL_NUMBER,rd.RSK_UWYEAR,TO_CHAR (rd.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INC_DATE,TO_CHAR (rd.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,TO_CHAR (rd.RSK_ACCOUNT_DATE, 'DD/MM/YYYY') ACC_DATE,decode(RD.RSK_SPFCID,'ALL',RD.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND RD.BRANCH_CODE = SPFC.BRANCH_CODE)) TMAS_SPFC_NAME,PIb.COMPANY_NAME BROKER_NAME,pi.COMPANY_NAME,rd.RSK_INSURED_NAME,f.RSK_SHARE_WRITTEN SHARE_WRITTEN,f.RSK_SHARE_SIGNED SHARE_SIGNED,cd.DETAIL_NAME,rd.RSK_UNDERWRITTER,PM.BRANCH_CODE    FROM    PERSONAL_INFO Pi, TTRN_RISK_DETAILS RD, ttrn_RISK_PROPOSAL F, POSITION_MASTER PM, CONSTANT_DETAIL CD, PERSONAL_INFO pib   WHERE PM.BRANCH_CODE = ?  AND PM.PROPOSAL_NO = F.RSK_PROPOSAL_NUMBER AND RD.RSK_PROPOSAL_NUMBER = F.RSK_PROPOSAL_NUMBER AND RD.RSK_PROPOSAL_NUMBER = PM.PROPOSAL_NO AND Pi.CUSTOMER_ID = RD.RSK_CEDINGID AND Pi.BRANCH_CODE = PM.BRANCH_CODE AND Pi.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE  CUSTOMER_ID = Pi.CUSTOMER_ID AND BRANCH_CODE = Pi.BRANCH_CODE) AND RD.RSK_ENDORSEMENT_NO =(SELECT   MAX (TRD.RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS TRD  WHERE   TRD.RSK_PROPOSAL_NUMBER =RD.RSK_PROPOSAL_NUMBER) AND F.RSK_ENDORSEMENT_NO =(SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   ttrn_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER =F.RSK_PROPOSAL_NUMBER) AND PM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PROPOSAL_NO =PM.PROPOSAL_NO) AND PM.contract_STATUS = 'P' AND RD.RSK_PRODUCTID in(select distinct old_product_id from TMAS_HOMEPAGE_MASTER where branch_code=? and product_id=? and dept_id=?) AND CD.CATEGORY_ID = 1 AND CD.TYPE = TRIM (PM.PROPOSAL_STATUS) AND PM.ACCOUNT_DATE BETWEEN TO_DATE (?,'DD/MM/YYYY') AND  TO_DATE (?,'DD/MM/YYYY') and PIb.CUSTOMER_ID = RD.RSK_BROKERID AND PIb.BRANCH_CODE = pm.BRANCH_CODE AND PIb.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO  WHERE  CUSTOMER_ID = PIb.CUSTOMER_ID AND BRANCH_CODE = PIb.BRANCH_CODE)
report.select.policyRegPropotionalTreaty=SELECT /*+ PARALLEL(PT_XOL_POL_REG,4) */ PROPOSAL_NO,CREASE_STATUS,RSK_REINSTATE_NO,decode(RSK_SLADSCALE_COMM,'Y','Yes','N','No') RSK_SLADSCALE_COMM ,decode(RSK_LOSS_PART_CARRIDOR,'Y','Yes','N','No') RSK_LOSS_PART_CARRIDOR, LAYER_NO,  CONTRACT_NO,   TMAS_PFC_NAME,UNDERWRITTER,   TMAS_DEPARTMENT_NAME,   TMAS_SPFC_NAME,   RSK_UWYEAR,RSK_MAX_LMT_COVER,   TMAS_POL_BRANCH_NAME,   COMPANY_NAME,   BROKER,RSK_TREATYID,   PROPOSAL_TYPE,  INCEPTION_DATE, EXPIRY_DATE,  TO_CHAR(ACCOUNT_DATE,'DD/MM/YYYY')  ACCOUNT_DATE,   SHORT_NAME,RSK_EXCHANGE_RATE,   RSK_PERIOD_OF_NOTICE,   RSK_RISK_COVERED,RSK_TERRITORY_SCOPE,   TERRITORY_DESC,   ACCOUNTING_PERIOD,RSK_RECEIPT_STATEMENT,   RSK_RECEIPT_PAYEMENT,   RSK_SP_RETRO,RSK_NO_OF_INSURERS,   RSK_LIMIT_OC,   RSK_EPI_OFFER_OC,RSK_EPI_ESTIMATE,   RSK_EPI_EST_OC,   RSK_XLCOST_OC,   RSK_CEDRET_TYPE,RSK_CEDANT_RETENTION,   PROPOSAL_STATUS,   RSK_SHARE_WRITTEN,RSK_SHARE_SIGNED,   RSK_LIMIT_OS_OC,   RSK_LIMIT_OS_DC,RSK_EPI_OSOF_OC,   RSK_EPI_OSOF_DC,   RSK_EPI_OSOE_OC,   RSK_EPI_OSOE_DC,RSK_XLCOST_OS_OC,   RSK_XLCOST_OS_DC,   RSK_PREMIUM_QUOTA_SHARE,RSK_PREMIUM_QUOTA_SHARE_DC,RSK_PREMIUM_SURPULS,RSK_PREMIUM_SURPULS_DC,   RSK_COMM_QUOTASHARE,   RSK_COMM_SURPLUS,COMMISSION_QS_AMOUNT,   COMMISSION_SURP_AMOUNT,   RSK_OVERRIDER_PERC,RSK_BROKERAGE,   RSK_TAX,   RSK_OTHER_COST,   OTHER_ACQ_COST_AMOUNT,ACQ_COST_AMOUNT,  RSK_PROFIT_COMM,RSK_PREMIUM_RESERVE,   RSK_LOSS_RESERVE,   RSK_INTEREST,RSK_PF_INOUT_LOSS,   RSK_PF_INOUT_PREM,   RSK_LOSSADVICE,RSK_CASHLOSS_LMT_OC,   RSK_LEAD_UW,   RSK_LEAD_UW_SHARE,   RSK_EXCLUSION,RSK_REMARKS,   RSK_UW_RECOMM,   LOGIN_ID,   BROKER_ID,CEDING_COMPANY_ID,UW_YEAR,RSK_BASIS,RSK_DEDUC_OC,RSK_SUBJ_PREMIUM_OC,RSK_ADJRATE,RSK_MD_PREM_OC,MND_INSTALLMENTS,RSK_MD_PREM_OS_OC,RSK_MD_PREM_OS_DC,RSK_AGGREGATE_LIAB_OC,RSK_REINSTATE_ADDL_PREM_PCT,RSK_REINSTATE_ADDL_PREM_OC,RSK_BURNING_COST_PCT,RSK_AGGREGATE_LIAB_DC,RSK_REINSTATE_ADDL_PREM_DC,RSK_ACQUISTION_COST_OC,RSK_ACQUISTION_COST_DC,RSK_SUBJ_PREMIUM_DC,RSK_LIMIT_DC,RSK_DEDUC_DC,RSK_EPI_EST_DC,RSK_XLPREM_DC,RSK_MD_PREM_DC,RSK_PF_COVERED,RSK_EPI_OFFER_DC,RSK_XLCOST_DC,RSK_CASHLOSS_LMT_DC,LIMIT_PER_VESSEL_OC,LIMIT_PER_VESSEL_DC,LIMIT_PER_LOCATION_OC,LIMIT_PER_LOCATION_DC,TREATY_RETRO,TREATY_RETRO_PERC,COMM_QS_AMT ,COMM_SURPLUS_AMT,COMM_QS_AMT_DC,COMM_SURPLUS_AMT_DC,RSK_LOSSADVICE_DC,RSK_COMM_QUOTASHARE_DC,COMMISSION_SURP_AMOUNT_DC,OTHER_ACQ_COST_AMOUNT_DC,ENDORSEMENT_DATE,EGPNI_AS_OFFER,OURASSESSMENT,INWARD_BUS_TYPE,TREATYTYPE,RSK_EVENT_LIMIT_OC,RSK_EVENT_LIMIT_DC, RSK_AGGREGATE_LIMIT_OC, RSK_AGGREGATE_LIMIT_DC,RSK_OCCURRENT_LIMIT_OC,RSK_OCCURRENT_LIMIT_DC,RSK_TREATY_SURP_LIMIT_OC,RSK_TREATY_SURP_LIMIT_DC,RSK_TREATY_SURP_LIMIT_OS_OC,RSK_TREATY_SURP_LIMIT_OS_DC,RSK_PML,RSK_PML_PERCENT,RSK_EPI_EST_OC,RSK_CREASTA_STATUS,RSK_LOSS_PART_CARRIDOR,RSK_PRO_NOTES, RSK_LOC_ISSUED,RSK_PERILS_COVERED,RSK_LEAD_UNDERWRITER_COUNTRY,RETEN_PER,RETRO_PER,RSK_TERRITORY, COUNTRIES_INCLUDE,COUNTRIES_EXCLUDE,RSK_INCLUDE_ACQ_COST,RSK_OUR_ASS_ACQ_COST,RSK_OUR_ACQ_OUR_SHARE_OC,RSK_NO_OF_LINE,RSK_RATE,RSK_PRO_COMM_TYPE,RSK_PRO_SUP_PRO_COM	,RSK_PRO_COMM_PER, RSK_PRO_SET_UP,RSK_PRO_LOSS_CARY_TYPE,RSK_PRO_LOSS_CARY_YEAR,RSK_PRO_PROFIT_CARY_TYPE,RSK_PRO_PROFIT_CARY_YEAR,RSK_PRO_FIRST_PFO_COM,RSK_PRO_FIRST_PFO_COM_PRD,RSK_PRO_SUB_PFO_COM_PRD, RSK_PRO_SUB_PFO_COM,RSK_PRO_SUB_SEQ_CAL,RSK_PRO_NOTES,RSK_RUN_OFF_YEAR,RSK_TRTY_LMT_PML_OC,RSK_TRTY_LMT_PML_OS_OC,RSK_TRTY_LMT_PML_DC,RSK_TRTY_LMT_PML_OS_DC,RSK_TRTY_LMT_SUR_PML_OC,RSK_TRTY_LMT_SUR_PML_OS_OC,RSK_TRTY_LMT_SUR_PML_DC,RSK_TRTY_LMT_SUR_PML_OS_DC,RSK_LOC_BNK_NAME,RSK_LOC_CRDT_PRD,RSK_LOC_CRDT_AMT,RSK_LOC_BENFCRE_NAME,TYPE,RSK_COVER_LIMIT_UXL_OC,RSK_COVER_LIMIT_UXL_OS_OC,RSK_COVER_LIMIT_UXL_DC,RSK_COVER_LIMIT_UXL_OS_DC,RSK_DEDUCTABLE_UXL_OC,RSK_DEDUCTABLE_UXL_OS_OC,RSK_DEDUCTABLE_UXL_DC,RSK_DEDUCTABLE_UXL_OS_DC,RSK_MINIMUM_PREMIUM_OC,RSK_MINIMUM_PREMIUM_OS_OC,RSK_MINIMUM_PREMIUM_DC,RSK_MINIMUM_PREMIUM_OS_DC,EGPNI_AS_OFFER_DC,MND_INSTALLMENTS,RSK_AGGREGATE_DEDUCT_OC,RSK_AGGREGATE_DEDUCT_DC,RSK_PREMIUM_BASIS,RSK_MINIMUM_RATE,RSK_MAXIIMUM_RATE,RSK_BURNING_COST_LF,RSK_REINSTATEMENT_PREMIUM,RSK_BONUS_ID,RSK_NOCLAIMBONUS_PRCENT,RSK_UMBRELLA_XL FROM PT_XOL_POL_REG WHERE PRODUCT_ID=? AND ACCOUNT_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') AND BRANCH_CODE=?
report.select.policyRegFacLoginId= AND  LOGIN_ID=?
report.select.policyRegFacBrokerId= AND BROKER_ID=?
report.select.policyRegFacCedingId= AND CEDING_COMPANY_ID\=? 
report.select.policyRegFacUWYear=AND UW_YEAR=?
report.select.reportUWYear=AND RSK_UWYEAR=?
report.select.policyRegFacOrderBy= ORDER BY CONTRACT_NO
report.select.retroPolicyReport=SELECT PROPOSAL_NO,CONTRACT_NO,TMAS_PFC_NAME,UNDERWRITTER,TMAS_DEPARTMENT_NAME,TMAS_SPFC_NAME,RSK_UWYEAR,RSK_MAX_LMT_COVER,TMAS_POL_BRANCH_NAME,COMPANY_NAME,BROKER,RSK_TREATYID,PROPOSAL_TYPE,INCEPTION_DATE,EXPIRY_DATE,TO_CHAR(ACCOUNT_DATE,'DD/MM/YYYY') ACCOUNT_DATE,SHORT_NAME,RSK_EXCHANGE_RATE,RSK_PERIOD_OF_NOTICE,RSK_RISK_COVERED,RSK_TERRITORY_SCOPE,ACCOUNTING_PERIOD,RSK_RECEIPT_STATEMENT,RSK_RECEIPT_PAYEMENT,RSK_SP_RETRO,RSK_NO_OF_INSURERS,RSK_LIMIT_OC,RSK_EPI_OFFER_OC,RSK_EPI_ESTIMATE,RSK_EPI_EST_OC,RSK_XLCOST_OC,RSK_CEDRET_TYPE,RSK_CEDANT_RETENTION,PROPOSAL_STATU,RSK_SHARE_WRITTEN,RSK_SHARE_SIGNED,RSK_LIMIT_OS_OC,RSK_LIMIT_OS_DC,RSK_EPI_OSOF_OC,RSK_EPI_OSOF_DC,RSK_EPI_OSOE_OC,RSK_EPI_OSOE_DC,RSK_XLCOST_OS_OC,RSK_XLCOST_OS_DC,RSK_PREMIUM_QUOTA_SHARE,RSK_PREMIUM_SURPULS,LOGIN_ID,BROKER_ID,CEDING_COMPANY_ID,UW_YEAR,RSK_LAYER_NO,RSK_BASIS,RSK_DEDUC_OC,RSK_SUBJ_PREMIUM_OC,RSK_ADJRATE,RSK_MD_PREM_OC,MND_INSTALLMENTS,RSK_MD_PREM_OS_OC,RSK_MD_PREM_OS_DC,PRODUCT_ID,LAYER_NO,RSK_SUBJ_PREMIUM_DC,RSK_LIMIT_DC,RSK_DEDUC_DC,RSK_EPI_EST_DC,RSK_XLPREM_DC,RSK_MD_PREM_DC,RSK_PF_COVERED,RSK_EPI_OFFER_DC,RSK_XLCOST_DC,RSK_RETRO_TYPE,RETRO_CESSIONARIES,RSK_REMARKS FROM RETRO_POL_REG WHERE PRODUCT_ID in(select distinct old_product_id from TMAS_HOMEPAGE_MASTER where branch_code=? and product_id=? and dept_id=?) AND  ACCOUNT_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') and branch_code=?
report.select.premiumReport=Select * from table(FN_FAC_PREM_REG(?,?,?,?,?,?,?))
REPORT_SELECT_PTTYPREMIUMREPORT = Select * from table(FN_PTTY_PREM_REG(?,?,?,?,?,?,?))
REPORT_SELECT_NPTTYPREMIUMREPORT = Select * from table(FN_NPTTY_PREM_REG(?,?,?,?,?,?,?))
report.select.retroPermiumClaim=SELECT RETRO_CONTRACT_NO,RETRO_LAYER_NO,CONTRACT_NO,LAYER_NO,TRANSACTION_NO,TO_CHAR(TRANSACTION_DATE,'DD/MM/YYYY') TRANSACTION_DATE,CURRENCY_NAME,EXCHANGE_RATE,RETRO_PERCENTAGE,PREMIUM_AMT_DC,RETRO_PREMIUM_DC,OVER_RIDER,NET,TYPE,CLAIM_PAID_DC, RETRO_CLAIM_PAID_DC,PRODUCT_ID,BRANCH_CODE,uw_year FROM RETRO_PREMIUM_CLAIM WHERE PRODUCT_ID in(select distinct old_product_id from TMAS_HOMEPAGE_MASTER where branch_code=? and product_id=? and dept_id=?) AND trunc(TRANSACTION_DATE) BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') and branch_code=?
report.select.policyRegFacLoginId= AND  LOGIN_ID=?
report.select.policyRegFacBrokerId= AND BROKER_ID=?
report.select.policyRegFacCedingId= AND CEDING_COMPANY_ID\=? 
report.select.policyRegFacUWYear=AND UW_YEAR=?
report.select.reportUWYear=AND RSK_UWYEAR=?
report.select.policyRegFacOrderBy= ORDER BY CONTRACT_NO
report.select.premiumReportOrderBy= ORDER BY TRANSACTION_NO
GET_CLAIM_REG_REPORT = Select * from table(CLAIM_REG_OSLR_REG_RT(?,?,?,?,?,?,?))
reportdao.select.renewalDueFac=SELECT   PM.PROPOSAL_NO,PM.CONTRACT_NO,DECODE(RD.RSK_SPFCID,'ALL',RD.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND RD.BRANCH_CODE = SPFC.BRANCH_CODE))  TMAS_SPFC_NAME,(select RTRIM(XMLAGG(XMLELEMENT(E,TERRITORY_NAME,',')).EXTRACT('//text()'),',')  from TMAS_TERRITORY SPFC where SPFC.TERRITORY_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_TERRITORY,' ', '')))) AND  RD.BRANCH_CODE = SPFC.BRANCH_CODE) TERRITORY_DESC,PIB.FIRST_NAME BROKER_NAME,PI.COMPANY_NAME,RD.RSK_INSURED_NAME,RD.RSK_UWYEAR,TO_CHAR(RD.RSK_INCEPTION_DATE,'DD/MM/YYYY') INC_DATE,TO_CHAR(RD.RSK_EXPIRY_DATE,'DD/MM/YYYY')   EXP_DATE,FRP.SHARE_SIGNED FROM   POSITION_MASTER PM,TTRN_RISK_DETAILS RD,TTRN_FAC_RISK_PROPOSAL FRP,PERSONAL_INFO PI,PERSONAL_INFO PIB WHERE  PM.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER AND FRP.RSK_PROPOSAL_NUMBER = PM.PROPOSAL_NO AND RD.RSK_PRODUCTID = ? AND PM.CONTRACT_STATUS = 'A' AND PM.CONTRACT_NO > 0 AND PI.CUSTOMER_ID = RD.RSK_CEDINGID AND PI.BRANCH_CODE = ? AND PIB.CUSTOMER_ID = RD.RSK_BROKERID AND PIB.BRANCH_CODE = ?  and pm.branch_code=? AND RD.RSK_EXPIRY_DATE BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND  TO_DATE (?, 'DD/MM/YYYY') AND FRP.RSK_ENDORSEMENT_NO =(SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_FAC_RISK_PROPOSAL WHERE   RSK_PROPOSAL_NUMBER = FRP.RSK_PROPOSAL_NUMBER) AND RD.RSK_ENDORSEMENT_NO =(SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS WHERE   RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER) AND PM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE   PROPOSAL_NO = PM.PROPOSAL_NO) AND PI.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID AND BRANCH_CODE = PI.BRANCH_CODE) AND PIB.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = PIB.CUSTOMER_ID AND BRANCH_CODE = PIB.BRANCH_CODE)
reportdao.select.facgetQuoteRegisterLoginId=AND PM.LOGIN_ID = ?
reportdao.select.facgetQuoteRegisterCedingId=AND RD.RSK_CEDINGID=?
reportdao.select.facgetQuoteRegisterBrokerId=AND RD.RSK_BROKERID=?
report.select.reportUWYear=AND RSK_UWYEAR=?
report.select.policyRegFacOrderBy= ORDER BY CONTRACT_NO
reportda.select.xolRenewalDueList=SELECT rd.RSK_PROPOSAL_NUMBER,rd.RSK_UWYEAR,rd.RSK_CONTRACT_NO ,rd.RSK_LAYER_NO,DECODE(RD.RSK_SPFCID,'ALL',RD.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND RD.BRANCH_CODE = SPFC.BRANCH_CODE)) TMAS_SPFC_NAME, (select RTRIM(XMLAGG(XMLELEMENT(E,TERRITORY_NAME,',')).EXTRACT('//text()'),',')  from TMAS_TERRITORY SPFC where SPFC.TERRITORY_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_TERRITORY,' ', '')))) AND  RD.BRANCH_CODE = SPFC.BRANCH_CODE) TERRITORY_DESC ,PIb.FIRST_NAME BROKER_NAME ,pi.COMPANY_NAME ,rd.RSK_TREATYID,TO_CHAR(rd.RSK_INCEPTION_DATE,'DD/MM/YYYY') INC_DATE, TO_CHAR(rd.RSK_EXPIRY_DATE,'DD/MM/YYYY') EXP_DATE,rp.RSK_SHARE_SIGNED SHARE_SIGNED ,rp.RSK_EPI_OSOF_OC,PM.BRANCH_CODE FROM TTRN_RISK_DETAILS RD,PERSONAL_INFO PI, TTRN_RISK_PROPOSAL RP,POSITION_MASTER PM,personal_info pib WHERE   PI.CUSTOMER_ID = RD.RSK_CEDINGID AND PI.CUSTOMER_TYPE='C' AND PI.BRANCH_CODE=PM.BRANCH_CODE AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID AND CUSTOMER_TYPE=PI.CUSTOMER_TYPE AND BRANCH_CODE=PI.BRANCH_CODE) and PM.BRANCH_CODE = ? AND RP.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO=( SELECT MAX(TRP.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL TRP WHERE TRP.RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER) AND RD.RSK_ENDORSEMENT_NO=( SELECT MAX(TRD.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS  TRD WHERE TRD.RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO > 0   AND PM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=( SELECT MAX(TPM.AMEND_ID) FROM POSITION_MASTER TPM WHERE TPM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER) AND PM.CONTRACT_STATUS='A' AND RD.RSK_PRODUCTID =? AND RD.RSK_EXPIRY_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') and PIb.CUSTOMER_ID =RD.RSK_BROKERID AND PIb.BRANCH_CODE=pm.BRANCH_CODE AND PIb.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PIb.CUSTOMER_ID AND BRANCH_CODE=PIb.BRANCH_CODE)
reportda.select.retroRetroxol=SELECT rd.RSK_PROPOSAL_NUMBER,rd.RSK_UWYEAR,rd.RSK_CONTRACT_NO ,rd.RSK_LAYER_NO,DECODE(RD.RSK_SPFCID,'ALL',RD.RSK_SPFCID,(select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND RD.BRANCH_CODE = SPFC.BRANCH_CODE)) TMAS_SPFC_NAME, (select RTRIM(XMLAGG(XMLELEMENT(E,TERRITORY_NAME,',')).EXTRACT('//text()'),',')  from TMAS_TERRITORY SPFC where SPFC.TERRITORY_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_TERRITORY,' ', '')))) AND  RD.BRANCH_CODE = SPFC.BRANCH_CODE)  TERRITORY_DESC ,PIb.COMPANY_NAME BROKER_NAME ,pi.COMPANY_NAME ,rd.RSK_TREATYID,TO_CHAR(rd.RSK_INCEPTION_DATE,'DD/MM/YYYY') INC_DATE, TO_CHAR(rd.RSK_EXPIRY_DATE,'DD/MON/YYYY') EXP_DATE,rp.RSK_SHARE_SIGNED SHARE_SIGNED ,rp.RSK_EPI_OSOF_OC,PM.BRANCH_CODE FROM TTRN_RISK_DETAILS RD,PERSONAL_INFO PI, TTRN_RISK_PROPOSAL RP, POSITION_MASTER PM,personal_info pib WHERE    PI.CUSTOMER_ID = RD.RSK_CEDINGID AND PI.CUSTOMER_TYPE='C' AND PI.BRANCH_CODE=PM.BRANCH_CODE AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID AND CUSTOMER_TYPE=PI.CUSTOMER_TYPE AND BRANCH_CODE=PI.BRANCH_CODE) and PM.BRANCH_CODE = ? AND RP.RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER AND RP.RSK_ENDORSEMENT_NO=( SELECT MAX(TRP.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL TRP WHERE TRP.RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER) AND RD.RSK_ENDORSEMENT_NO=( SELECT MAX(TRD.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS  TRD WHERE TRD.RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER) AND RD.RSK_CONTRACT_NO > 0   AND PM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=( SELECT MAX(TPM.AMEND_ID) FROM POSITION_MASTER TPM WHERE TPM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER) AND PM.CONTRACT_STATUS='A' AND RD.RSK_PRODUCTID in(select distinct old_product_id from TMAS_HOMEPAGE_MASTER where branch_code=? and product_id=? and dept_id=?) AND RD.RSK_EXPIRY_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') and PIb.CUSTOMER_ID =RD.RSK_BROKERID AND PIb.BRANCH_CODE=pm.BRANCH_CODE AND PIb.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PIb.CUSTOMER_ID AND BRANCH_CODE=PIb.BRANCH_CODE)
reportdao.select.renewalOrder=ORDER BY PM.PROPOSAL_NO DESC
report.select.retroQuarRDS=SELECT CONTRACT_NO,LAYER_NO,COMPANY_NAME,BROKER_NAME,INCEPTION_DATE,INWUW_YEAR,PREMIUM_TRAN_NO,TRANSACTION_DATE,RETRO_CONTRACT_NO,RETRO_LAYER_NO, DOC_TYPE,SHORT_NAME,RETRO_PERCENTAGE,PREMIUM_QUOTASHARE_OC, PREMIUM_SURPLUS_OC,PREMIUM_PORTFOLIOIN_OC,CLAIM_PORTFOLIOIN_OC, PREMIUM_RESERVE_REALSED_OC,LOSS_RESERVE_RELEASED_OC,INTEREST_OC, CASH_LOSS_CREDIT_OC,TOTAL_CR_OC,COMMISSION_QUOTASHARE_OC, COMMISSION_SURPLUS_OC,BROKERAGE_AMT_OC,TAX_AMT_OC,OTHER_COST_OC, XL_COST_OC,PREMIUM_PORTFOLIOOUT_OC,CLAIM_PORTFOLIO_OUT_OC, PREMIUM_RESERVE_RETAINED_OC,LOSS_RESERVERETAINED_OC,CASH_LOSSPAID_OC, CLAIMS_PAID_OC,NETDUE_OC,EXCHANGE_RATE,PREMIUM_QUOTASHARE_DC, PREMIUM_SURPLUS_DC,PREMIUM_PORTFOLIOIN_DC,CLAIM_PORTFOLIOIN_DC, PREMIUM_RESERVE_REALSED_DC,LOSS_RESERVE_RELEASED_DC,INTEREST_DC, CASH_LOSS_CREDIT_DC,TOTAL_CR_DC,COMMISSION_QUOTASHARE_DC, COMMISSION_SURPLUS_DC,BROKERAGE_AMT_DC,TAX_AMT_DC,OTHER_COST_DC, XL_COST_DC,PREMIUM_PORTFOLIOOUT_DC,CLAIM_PORTFOLIO_OUT_DC, PREMIUM_RESERVE_RETAINED_DC,LOSS_RESERVERETAINED_DC,CASH_LOSSPAID_DC, CLAIMS_PAID_DC,NETDUE_DC,M_DPREMIUM_OC,ADJUSTMENT_PREMIUM_OC, REC_PREMIUM_OC,M_DPREMIUM_DC,ADJUSTMENT_PREMIUM_DC,REC_PREMIUM_DC, TRANSACTIONTYPE,SUBCLASS,INWARDTYPE,RETRO_CEDING,RETROBROKER, RETROINCEPTION,RETROEXPIRY,RETROUWY,PREMIUM_OC,COMMISSIONOC,PROFITCOMMISSIONOC, NETDUEOC,PREMIUMUGX,NETDUE_UGX, OVERRIDER_AMT_OC, OUTWARDOVERRIDER_OC, OVERRIDER_AMT_DC, PROFIT_COMMISSION_DC, OUTWAROVERRIDER_DC FROM RETRO_PREM_DETAILS_FOR_RDS WHERE  PRODUCT_ID=( SELECT DISTINCT OLD_PRODUCT_ID FROM TMAS_HOMEPAGE_MASTER WHERE BRANCH_CODE=? AND PRODUCT_ID=? AND DEPT_ID=?) AND  TO_DATE(TRANSACTION_DATE,'DD/MM/YYYY')  BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') AND BRANCH_CODE=?
report.select.policyRegFacLoginId= AND  LOGIN_ID=?
report.select.policyRegFacBrokerId= AND BROKER_ID=?
report.select.policyRegFacCedingId= AND CEDING_COMPANY_ID\=? 
report.select.policyRegFacUWYear=AND UW_YEAR=?
reportdao.select.getFacRetroList=SELECT CONTRACT_NO,   LAYER_NO,   RETRO_CONTRACT_NO,   RETRO_LAYER_NO,   RETRO_PERCENTAGE,   OWI_PREMIUM_USD,   OWI_COMMISSION,   OWI_OTHER_CHARGES,   OVER_RIDER,   NET,   ACCOUNT_DATE,   LOGIN_ID,   BROKER_ID,   CEDING_COMPANY_ID,   DEPT_ID,UW_YEAR,OVER_RIDER_PER FROM FAC_RETRO_DETAILS_FOR_RDS WHERE ACCOUNT_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') AND BRANCH_CODE=?
report.select.policyRegFacLoginId= AND  LOGIN_ID=?
report.select.policyRegFacBrokerId= AND BROKER_ID=?
report.select.policyRegFacCedingId= AND CEDING_COMPANY_ID\=? 
report.select.policyRegFacUWYear=AND UW_YEAR=?
report.select.reportUWYear=AND RSK_UWYEAR=?
report.select.policyRegFacOrderBy= ORDER BY CONTRACT_NO
reportdao.select.getFacRetroOrderBy=ORDER BY CONTRACT_NO
reportdao.select.getTreatyXOLRetroList=SELECT  CONTRACT_NO,LAYER_NO,RETRO_CONTRACT_NO,RETRO_LAYER_NO,RETRO_PERCENTAGE,OWI_PREMIUM_USD,OWI_COMMISSION_QS,OWI_COMMISSION_SURPLUS,OWI_OTHER_CHARGES,OVER_RIDER, NET, ACCOUNT_DATE, LOGIN_ID, BROKER_ID, CEDING_COMPANY_ID, PRODUCT_ID,UW_YEAR,OVER_RIDER_PER FROM PT_XOL_RETRO_DETAILS_FOR_RDS WHERE PRODUCT_ID\=? AND ACCOUNT_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') AND BRANCH_CODE\=?
GET_RETRO_RDS_REPORT=SELECT * FROM TABLE(FN_RDS_RETRO_POLICY_REPORT(?,?,?))
reportdao.select.getTransMasterList=Select * from table(FN_TRANSACTION_REPORT(?,?,?,?,?,?,?,?))
reportdao.select.getAgeingList=select  * from table(FN_DR_CR_AGEING_REPORT(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?))
reportdao.select.getMovMntSummaryList=SELECT ROWNUM, Rpt.* FROM   (SELECT TMAS_SPFC_NAME,RD.RSK_UWYEAR, SUM (PREMIUM_QUOTASHARE_DC)+ SUM (PREMIUM_SURPLUS_DC)- SUM (XL_COST_DC)+ SUM (PREMIUM_PORTFOLIOIN_DC) - SUM (PREMIUM_PORTFOLIOOUT_DC) SUMOFTOTPR_DC FROM (SELECT TRANSACTION_MONTH_YEAR, NVL (RPD.CONTRACT_NO,CD.CONTRACT_NO) CONTRACT_NO, NVL (NVL (RPD.LAYER_NO, CD.LAYER_NO),0 ) LAYER_NO, CD.CLAIM_NO, NVL (RPD.PREMIUM_QUOTASHARE_DC,0) PREMIUM_QUOTASHARE_DC, NVL (RPD.PREMIUM_SURPLUS_DC,0) PREMIUM_SURPLUS_DC,NVL (RPD.XL_COST_DC, 0) XL_COST_DC, NVL (RPD.PREMIUM_PORTFOLIOIN_DC,0) PREMIUM_PORTFOLIOIN_DC, NVL(RPD.PREMIUM_PORTFOLIOOUT_DC,0)PREMIUM_PORTFOLIOOUT_DC,NVL (RPD.COMMISSION_QUOTASHARE_DC,0)COMMISSION_QUOTASHARE_DC,NVL (RPD.COMMISSION_SURPLUS_DC,0) COMMISSION_SURPLUS_DC,NVL (RPD.BROKERAGE_AMT_DC, 0) BROKERAGE_AMT_DC, NVL (RPD.TAX_AMT_DC, 0) TAX_AMT_DC, NVL (RPD.OTHER_COST_DC, 0) OTHER_COST_DC, NVL (RPD.PROFIT_COMMISSION_DC,0) PROFIT_COMMISSION_DC, NVL (RPD.INTEREST_DC, 0) INTEREST_DC,(CASE WHEN NVL (RPD.CLAIMS_PAID_DC, 0) > 0 THEN RPD.CLAIMS_PAID_DC ELSE 0 END)+ NVL (CP.PAID_AMOUNT_DC, 0) CLAIMS_PAID_DC,CASE WHEN NVL ( RPD.CLAIMS_PAID_DC,0) < 0 THEN RPD.CLAIMS_PAID_DC ELSE 0 END CLAIM_RECOVERY_DC, NVL (RPD.CLAIM_PORTFOLIOIN_DC, 0) CLAIM_PORTFOLIOIN_DC, NVL ( RPD.CLAIM_PORTFOLIO_OUT_DC,0) CLAIM_PORTFOLIO_OUT_DC, NVL (RPD.CASH_LOSSPAID_DC, 0) CASH_LOSSPAID_DC,  NVL (RPD.CASH_LOSS_CREDIT_DC,0) CASH_LOSS_CREDIT_DC,  NVL ( RPD.PREMIUM_RESERVE_RETAINED_DC,0) PREMIUM_RESERVE_RETAINED_DC,NVL (  RPD.LOSS_RESERVE_RELEASED_DC,0) LOSS_RESERVE_RELEASED_DC, NVL ( RPD.LOSS_RESERVERETAINED_DC, 0) LOSS_RESERVERETAINED_DC, NVL ( RPD.PREMIUM_RESERVE_RELEASE_OC, 0) PREMIUM_RESERVE_RELEASE_OC, NVL (RPD.PREMIUM_RESERVE_RELEASE_DC,0) PREMIUM_RESERVE_RELEASE_DC,NVL (OVERRIDER_AMT_DC, 0) OVERRIDER_AMT_DC,NVL(M_DPREMIUM_DC,0) M_DPREMIUM_DC FROM RSK_PREMIUM_DETAILS RPD FULL OUTER JOIN TTRN_CLAIM_DETAILS CD ON CD.CONTRACT_NO = RPD.CONTRACT_NO AND CD.LAYER_NO = RPD.LAYER_NO AND CD.CURRENCY = RPD.CURRENCY_ID LEFT OUTER JOIN TTRN_CLAIM_PAYMENT CP ON CD.CLAIM_NO = CP.CLAIM_NO) PD JOIN TTRN_RISK_DETAILS RD ON RD.RSK_CONTRACT_NO = PD.CONTRACT_NO AND NVL (RD.RSK_LAYER_NO, 0) = PD.LAYER_NO JOIN POSITION_MASTER PM ON PM.PROPOSAL_NO = RD.RSK_PROPOSAL_NUMBER JOIN TMAS_SPFC_MASTER SP ON SP.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND SP.TMAS_SPFC_ID = RD.RSK_SPFCID LEFT OUTER JOIN CLAIM_UPDATION_SUBSET CU ON PD.CONTRACT_NO = CU.CONTRACT_NO AND PD.CLAIM_NO = CU.CLAIM_NO LEFT OUTER JOIN CLAIM_PAYMENT_SUBSET CP ON CP.CLAIM_NO = CU.CLAIM_NO AND CP.RESERVE_ID = CU.SL_NO WHERE SP.TMAS_STATUS = 'Y' AND SP.BRANCH_CODE = PM.BRANCH_CODE AND PM.BRANCH_CODE = ? AND RD.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO) FROM   TTRN_RISK_DETAILS  WHERE   RSK_PROPOSAL_NUMBER = RD.RSK_PROPOSAL_NUMBER) AND PM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE   PROPOSAL_NO = PM.PROPOSAL_NO) AND  pd.TRANSACTION_MONTH_YEAR BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') GROUP BY   RD.RSK_SPFCID, RD.RSK_UWYEAR,TMAS_SPFC_NAME, PM.BRANCH_CODE) Rpt
allocation.report.list = SELECT * FROM TABLE (ALLOCATION_REPORTS(?,?,?,?,?,?,?))
payrec.register.list=SELECT * FROM TABLE (PAYMENT_RECEIPT(?,?,?,?,?,?,?,?))
claim.paid.report=Select * from table(claim_paid_reports(?,?,?,?,?,?,?,?))
retro.report.list= select BRANCH_CODE, TRANSACTION_MONTH_YEAR, RETROCONTRACTNUMBER, RETROBROKERNAME, RETRO_BROKER, RETROCESSIONAIRENAME, RETROCESSIONAIRE, INWARDCONTRACTNO, LAYERNO, UWY, INWARDBUSINESS, SUBCLASS, TRANSACTIONNO, TO_CHAR(TRANSACTIONDATE,'DD/MM/YYYY') TRANSACTIONDATE, TRANSACTIONTYPE, INWARDCURRENCYNAME, INWARDEXCHANGERATE, RETROCESSION_PERCENTAGE, RETROCURRENCYNAME, RETROEXCHANGERATE, PREMIUM_IC, COMMISSION_IC, BROKERAGE_IC, INTEREST_IC, TAX_IC, INWARDOVERRIDER_IC, OTHERCOST_IC, CLAMSPAID_IC, PREMIUMRESERVERETAINED_IC, PREMIUMRESERVERELEASED_IC, LOSSRESERVERETAINED_IC, LOSSRESERVERELEASED_IC, OUTWARDOVERRIDER_IC, NETDUE_IC, PREMIUM_INR, COMMISSION_INR, BROKERAGE_INR, INTEREST_INR, TAX_INR, INWARDOVERRIDER_INR, OTHERCOST_INR, CLAMSPAID_INR, PREMIUMRESERVERETAINED_INR, PREMIUMRESERVERELEASED_INR, LOSSRESERVERETAINED_INR, LOSSRESERVERELEASED_INR, OUTWARDOVERRIDER_INR, NETDUE_INR, PREMIUM_RC, COMMISSION_RC, BROKERAGE_RC, INTEREST_RC, TAX_RC, INWARDOVERRIDER_RC, OTHERCOST_RC, CLAMSPAID_RC, PREMIUMRESERVERETAINED_RC, PREMIUMRESERVERELEASED_RC, LOSSRESERVERETAINED_RC, LOSSRESERVERELEASED_RC, OUTWARDOVERRIDER_RC, NETDUE_RC, SOAFREQUENCY,OSCLAIM_LOSS_INR,OSCLAIM_LOSS_IC,OSCLAIM_LOSS_RC, AMEND_ID,TREATY_INSURED_NAME from VW_RETRO_PRCL_REPORT where  TRANSACTION_MONTH_YEAR BETWEEN to_date(?,'DD/MM/YYYY') AND to_date(?,'DD/MM/YYYY') AND BRANCH_CODE= ?  And Decode(?,'ALL','A',RETRO_BROKER)=Decode(?,'ALL','A',?)  And Decode(?,'ALL','A',RETROCESSIONAIRE)=Decode(?,'ALL','A',?)  And Decode(?,'ALL','A',UWY)=Decode(?,'ALL','A',?)
treaty.withdraw.report.list=SELECT  *  FROM TABLE(PF_TREATY_WDL_PENDG_REP (?,?,?,?,?,?))
GET_JV_REPORT=SELECT * FROM TABLE(JOURNAL_VIEW_REPORT(?,?,?,?,?))
GET_INSTALLMENT_DUE_REPORT=SELECT * FROM TABLE(INSTALLMENT_DUE_REPORT(?,?,?,?,?,?))
PORTFOLIO_OUT_PENDING_REPORT= SELECT * FROM TABLE(FN_PORTFOLIO_OUT_PENDING(?,?))
GET_TRAIL_BALANCE_REPORT=SELECT * FROM TABLE(FN_TB_REPORT(?,?))
GET_PPTY_SOA_PENDING_REPORT=SELECT * FROM TABLE(FN_PTTY_SOA_PENDING(?,?))
GET_RENEWAL_STATISTICS_REPORT=SELECT * FROM TABLE(FN_RENEWAL_STATISTICS(?,?,?,?,?,?,?)) ORDER BY UW_YEAR
GET_UW_YEAR =SELECT UW_YEAR FROM POSITION_MASTER P WHERE P.PROPOSAL_NO\=? AND P.CONTRACT_NO \=? AND P.LAYER_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER M WHERE M.PROPOSAL_NO\=P.PROPOSAL_NO AND M.CONTRACT_NO \=P.CONTRACT_NO AND M.LAYER_NO\=P.LAYER_NO)
GET_IE_REPORT=SELECT * FROM TABLE(FN_IE_REPORT(?,?,?,?,?,?))
GET_PPTY_OSLR_CLAIM_REPORT=SELECT * FROM TABLE(FN_PTTY_OSLR_REPORT(?,?))
report.select.getCompanyInfoList=SELECT A.COMPANY_NAME,A.TELEPHONE,A.MOBILE,A.FAX,A.EMAIL,A.POBOX,A.ADDRESS1,A.ADDRESS2,A.CITY,A.COUNTRY,A.BASE_CURRENCY,A.DEST_CURRENCY,A.FINANCIAL_YEAR,A.BAND_REPORT,A.CURRENCY_DECIMAL,A.WEB_SITE FROM COMPANY_MASTER A WHERE COMPANY_CODE=? AND STATUS=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_MASTER WHERE COMPANY_CODE=A.COMPANY_CODE AND STATUS=A.STATUS)
report.select.getColumnInfoList=SELECT EXCEL_HEADER_NAME,FIELD_NAME,DATA_TYPE,SUMATIONYN,FORMULA FROM XL_DOWNLOAD_CONFIG_MASTER WHERE PRODUCT_ID=(SELECT DISTINCT OLD_PRODUCT_ID FROM TMAS_HOMEPAGE_MASTER WHERE BRANCH_CODE=? AND PRODUCT_ID=? AND DEPT_ID=? AND STATUS='Y') AND  TYPE_ID=? AND STATUS=? ORDER BY SNO
report.select.discrepancies=SELECT   MD.UW_YEAR,MD.SPC_NAME,MD.CURRENCY_NAME CURRENCY, CD.DETAIL_NAME ACCOUNT_QTR,MD.ACCOUNT_PERIOD_DATE ACCOUNT_YEAR, SUMOFTOTPR_PREV_DC PREV_AMT_DC,SUMOFTOTPR_DC AMOUNT_DC,SUMOFTOTPR_DC_DIFF PRM_DIFF,nvl(GROSS_PREMIUM_DC_PREV,0) GROSS_PREMIUM_DC_PREV,nvl(GROSS_PREMIUM_DC,0) GROSS_PREMIUM_DC,nvl(GROSS_PREMIUM_DC_DIFF,0) GROSS_PREMIUM_DC_DIFF,nvl(GROSS_ACQUISTION_COST_DC_PREV,0) GROSS_ACQUISTION_COST_DC_PREV,nvl(GROSS_ACQUISTION_COST_DC,0) GROSS_ACQUISTION_COST_DC,nvl(GROSS_ACQUISTION_COST_DC_DIFF,0) GROSS_ACQUISTION_COST_DC_DIFF,nvl(PREM_DEP_RETAINED_DC_PREV,0) PREM_DEP_RETAINED_DC_PREV,nvl(PREMIUM_DEPOSIT_RETAINED_DC,0) PREMIUM_DEPOSIT_RETAINED_DC,nvl(PREM_DEP_RETAINED_DC_DIFF,0) PREM_DEP_RETAINED_DC_DIFF,nvl(PREM_DEP_RELEASED_DC_PREV,0) PREM_DEP_RELEASED_DC_PREV,nvl(PREMIUM_DEPOSIT_RELEASED_DC,0) PREMIUM_DEPOSIT_RELEASED_DC,nvl(PREM_DEP_RELEASED_DC_DIFF,0) PREM_DEP_RELEASED_DC_DIFF,nvl(CLAIM_DEPOSIT_RETAINED_DC_PREV,0) CLAIM_DEPOSIT_RETAINED_DC_PREV,nvl(CLAIM_DEPOSIT_RETAINED_DC,0) CLAIM_DEPOSIT_RETAINED_DC,nvl(CLAIM_DEPOSIT_RETAINED_DC_DIFF,0) CLAIM_DEPOSIT_RETAINED_DC_DIFF,nvl(CLAIM_DEPOSIT_RELEASED_DC_PREV,0) CLAIM_DEPOSIT_RELEASED_DC_PREV,nvl(CLAIM_DEPOSIT_RELEASED_DC,0) CLAIM_DEPOSIT_RELEASED_DC,nvl(CLAIM_DEPOSIT_RELEASED_DC_DIFF,0) CLAIM_DEPOSIT_RELEASED_DC_DIFF,nvl( INTEREST_ON_DEPOSIT_DC_PREV,0) INTEREST_ON_DEPOSIT_DC_PREV,nvl(INTEREST_ON_DEPOSIT_DC,0) INTEREST_ON_DEPOSIT_DC,nvl(INTEREST_ON_DEPOSIT_DC_DIFF,0) INTEREST_ON_DEPOSIT_DC_DIFF, nvl(GROSS_CLAIMS_PAID_DC_PREV,0) GROSS_CLAIMS_PAID_DC_PREV,nvl(GROSS_CLAIMS_PAID_DC,0) GROSS_CLAIMS_PAID_DC,nvl(GROSS_CLAIMS_PAID_DC_DIFF,0) GROSS_CLAIMS_PAID_DC_DIFF FROM   TRANSACTION_MOVEMENT_DETAILS MD, CONSTANT_DETAIL CD WHERE       MD.ACCOUNT_PERIOD_QTR = ? AND MD.ACCOUNT_PERIOD_DATE = ? AND MD.BRANCH_CODE = ? AND CD.CATEGORY_ID = '12' AND CD.TYPE = MD.ACCOUNT_PERIOD_QTR AND MD.TYPE = 'D' AND MD.REPORT_TYPE=? AND MD.MOVMENT_TRANID=?
report.select.moveMent=SELECT sno ,UW_YEAR,SPC_NAME, CURRENCY_NAME, GROSS_PREMIUM_OC SUMOFTOTPR,GROSS_PREMIUM_DC SUMOFTOTPR_DC FROM   TRANSACTION_MOVEMENT_DETAILS WHERE ACCOUNT_PERIOD_QTR=? AND ACCOUNT_PERIOD_DATE=? AND  BRANCH_CODE = ? AND REPORT_TYPE=? AND MOVMENT_TRANID=? AND TYPE='Q' ORDER BY   1, 2
BOOKED_UPR_CRNT =  SELECT   SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR FROM   (  SELECT   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR, BRANCH_CODE, REPORT_DATE FROM BOOKED_UPR WHERE   BRANCH_CODE = ? and UW_YEAR=? and MOVEMENT_ID=? AND TRUNC (REPORT_DATE) = TO_DATE (?, 'DD/MM/YYYY') GROUP BY   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR, BRANCH_CODE, REPORT_DATE) A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID  AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE
BOOKED_PREMIUM_CRNT = SELECT   SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR FROM   (  SELECT   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR, BRANCH_CODE, REPORT_DATE FROM BOOKED_PREMIUM WHERE   BRANCH_CODE = ? and UW_YEAR=? and MOVEMENT_ID=? AND TRUNC (REPORT_DATE) = TO_DATE (?, 'DD/MM/YYYY') GROUP BY   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR, BRANCH_CODE, REPORT_DATE) A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID  AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE
BOOKED_UPR_CRNT =  SELECT   SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR FROM   (  SELECT   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR, BRANCH_CODE, REPORT_DATE FROM BOOKED_UPR WHERE   BRANCH_CODE = ? and UW_YEAR=? and MOVEMENT_ID=? AND TRUNC (REPORT_DATE) = TO_DATE (?, 'DD/MM/YYYY') GROUP BY   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR, BRANCH_CODE, REPORT_DATE) A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID  AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE
PIPELINE_WRITTEN_CRNT = SELECT SPFCID,TSM.TMAS_SPFC_NAME,PRODUCT_ID,TPM.TMAS_PRODUCT_NAME,CM.CURRENCY_NAME,CM.CURRENCY_ID,UW_YEAR FROM ( SELECT PRODUCT_ID,SPFCID,CURRENCY_ID,UW_YEAR,BRANCH_CODE FROM  UPR_PIPELINED_WRITTEN WHERE BRANCH_CODE=? and UW_YEAR=? and movement_id=? AND TRUNC (REPORT_DATE) = TO_DATE (?, 'DD/MM/YYYY') GROUP BY  PRODUCT_ID,SPFCID,CURRENCY_ID, UW_YEAR,BRANCH_CODE) A,TMAS_SPFC_MASTER TSM,TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID=TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE=? AND TSM.TMAS_PRODUCT_ID=A.PRODUCT_ID AND TPM.BRANCH_CODE=? AND TSM.BRANCH_CODE=A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID=TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID=A.CURRENCY_ID AND CM.BRANCH_CODE=A.BRANCH_CODE
JOURNAL_REPORT_PROCEDURE = UPR_PIPELINED
JOURNAL_REPORT_PIPELINE_WRITTEN = PIPELINED_WRITTEN
PINELINE_MOVEMENT_JV_CRNT_DETAILS = SELECT SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR, TO_CHAR(REPORT_DATE, 'DD/MM/YYYY') REPORT_DATE, TO_CHAR (MOVEMENT_START_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (REPORT_DATE, 'DD/MM/YYYY') EXPIRY_DATE, NVL(INWARDPIPEUNEARN_DEBIT,0) INWARDPIPEUNEARN_DEBIT, NVL(INWARDPIPEUNEARNACQCOST_CREDIT,0) INWARDPIPEUNEARNACQCOST_CREDIT, NVL(INWARDPIPEUPRB_S_CREDIT,0) INWARDPIPEUPRB_S_CREDIT, NVL(INWARDPIPEUPRB_S_DEBIT,0) INWARDPIPEUPRB_S_DEBIT FROM  (SELECT   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR,REPORT_DATE, SUM (PIPELINEPREMIUM_DC) INWARDPIPEUNEARN_DEBIT, SUM (DIFF_ACQUISTION_COST_DC) INWARDPIPEUNEARNACQCOST_CREDIT, SUM (PIPELINEPREMIUM_DC) INWARDPIPEUPRB_S_CREDIT, SUM (DIFF_ACQUISTION_COST_DC) INWARDPIPEUPRB_S_DEBIT, BRANCH_CODE, MOVEMENT_START_DATE FROM BOOKED_UPR WHERE MOVEMENT_ID=? AND BRANCH_CODE = ? AND PRODUCT_ID = ? AND SPFCID = ? AND CURRENCY_ID = ? AND UW_YEAR = ? GROUP BY   PRODUCT_ID, SPFCID, CURRENCY_ID, UW_YEAR,REPORT_DATE,BRANCH_CODE,MOVEMENT_START_DATE) A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE
BOOKED_PREMIUM_DETAILS = SELECT   SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR, TO_CHAR (REPORT_DATE, 'DD/MM/YYYY') REPORT_DATE, TO_CHAR (MOVEMENT_START_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (REPORT_DATE, 'DD/MM/YYYY') EXPIRY_DATE, GWPI_DC, PREMIUM_DC, GROSS_ACQUISTION_COST_DC, GROSS_PIPELINE_ACQUTION_COST, PREMIUM_DEPOSIT_RETAINED_DC, PREMIUM_DEPOSIT_RELEASED_DC, INTEREST_ON_DEPOSIT_DC, GROSS_CLAIMS_PAID_DC,BUSINESS_PARTNER,PIPELINED_NET_AC FROM ( SELECT PRODUCT_ID, UW_YEAR, SPFCID, CURRENCY_ID, REPORT_DATE, BRANCH_CODE, SUM (PREMIUM_DC) GWPI_DC, SUM (GROSS_PIPELINED_PREMIUM_DC) PREMIUM_DC, SUM (GROSS_ACQUISTION_COST_DC) GROSS_ACQUISTION_COST_DC, SUM (GROSS_PIPELINED_ACQUISITION_DC) GROSS_PIPELINE_ACQUTION_COST, SUM (PREMIUM_DEPOSIT_RETAINED_DC) PREMIUM_DEPOSIT_RETAINED_DC, SUM (PREMIUM_DEPOSIT_RELEASED_DC) PREMIUM_DEPOSIT_RELEASED_DC, SUM (CLAIM_DEPOSIT_RETAINED_DC) CLAIM_DEPOSIT_RETAINED_DC, SUM(CLAIM_DEPOSIT_RELEASED_DC) CLAIM_DEPOSIT_RELEASED_DC, SUM (INTEREST_ON_DEPOSIT_DC) INTEREST_ON_DEPOSIT_DC, SUM (GROSS_CLAIMS_PAID_DC) GROSS_CLAIMS_PAID_DC,(SUM(NVL(PREMIUM_DC,0))+SUM(NVL(GROSS_ACQUISTION_COST_DC,0))+SUM(NVL(PREMIUM_DEPOSIT_RETAINED_DC,0))+SUM(NVL(CLAIM_DEPOSIT_RETAINED_DC,0))+SUM(NVL(GROSS_CLAIMS_PAID_DC,0)))-(SUM(NVL(PREMIUM_DC,0))+SUM(NVL(GROSS_ACQUISTION_COST_DC,0))+SUM(NVL(PREMIUM_DEPOSIT_RELEASED_DC,0))+SUM(NVL(CLAIM_DEPOSIT_RELEASED_DC,0))+SUM(NVL(INTEREST_ON_DEPOSIT_DC,0))) BUSINESS_PARTNER,(SUM(PREMIUM_DC)-SUM (GROSS_ACQUISTION_COST_DC)) PIPELINED_NET_AC,MOVEMENT_START_DATE FROM BOOKED_PREMIUM WHERE MOVEMENT_ID=? and PRODUCT_ID = ? AND SPFCID = ? AND CURRENCY_ID = ? AND UW_YEAR = ? GROUP BY   PRODUCT_ID, UW_YEAR, SPFCID, CURRENCY_ID, REPORT_DATE, BRANCH_CODE, MOVEMENT_START_DATE) A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE
BOOKED_UPR_DETAILS = SELECT   SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR, TO_CHAR (REPORT_DATE, 'DD/MM/YYYY') REPORT_DATE, TO_CHAR (MOVEMENT_START_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (REPORT_DATE, 'DD/MM/YYYY') EXPIRY_DATE, Booked_Upr_Debit, Book_Deffe_Acqui_Cost_Credit, Inward_Booked_Upr_Bs_Credit, Inward_Book_DAcq_Bs_Debit, Pipelined_Upr_Credit, Pipelined_Acq_Cost, Inward_Pipeline_Upr_Bs_Debit, Inward_Pipe_DAcq_Cost_Credit FROM (SELECT Product_Id, Spfcid, Currency_Id, uw_year, BRANCH_CODE, REPORT_DATE, SUM (Premium_Dc) Booked_Upr_Debit, SUM (Pipelined_Acquistion_Cost_Dc) Book_Deffe_Acqui_Cost_Credit, SUM (Premium_Dc) Inward_Booked_Upr_Bs_Credit, SUM (Pipelined_Acquistion_Cost_Dc) Inward_Book_DAcq_Bs_Debit, SUM (Premium_Dc) Pipelined_Upr_Credit, SUM (Pipelined_Acquistion_Cost_Dc) Pipelined_Acq_Cost, SUM (Premium_Dc) Inward_Pipeline_Upr_Bs_Debit, SUM (Pipelined_Acquistion_Cost_Dc) Inward_Pipe_DAcq_Cost_Credit, MOVEMENT_START_DATE FROM Booked_Upr WHERE Movement_id=? AND  Branch_Code = ? AND PRODUCT_ID = ? AND SPFCID = ? AND CURRENCY_ID = ? AND UW_YEAR = ? GROUP BY   Product_Id, Spfcid, Currency_Id, uw_year, REPORT_DATE, BRANCH_CODE,MOVEMENT_START_DATE) A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE
PIPELINE_WRITTEN_DETAILS = SELECT   SPFCID, TSM.TMAS_SPFC_NAME, PRODUCT_ID, TPM.TMAS_PRODUCT_NAME, CM.CURRENCY_NAME, CM.CURRENCY_ID, UW_YEAR, TO_CHAR (REPORT_DATE, 'DD/MM/YYYY') REPORT_DATE, PIPELINED_GWPI_DC, PIPELINED_ACQUISTION_DC, PIPELINED_NETPREMIUM FROM   UPR_PIPELINED_WRITTEN A, TMAS_SPFC_MASTER TSM, TMAS_PRODUCT_MASTER TPM, CURRENCY_MASTER CM WHERE A.MOVEMENT_ID=? AND A.SPFCID = TSM.TMAS_SPFC_ID AND TSM.BRANCH_CODE = ? AND TSM.TMAS_PRODUCT_ID = A.PRODUCT_ID AND TPM.BRANCH_CODE = ? AND TSM.BRANCH_CODE = A.BRANCH_CODE AND TSM.TMAS_PRODUCT_ID = TPM.TMAS_PRODUCT_ID AND CM.CURRENCY_ID = A.CURRENCY_ID AND CM.BRANCH_CODE = A.BRANCH_CODE AND PRODUCT_ID = ? AND A.CURRENCY_ID = ? AND UW_YEAR = ? AND SPFCID = ?
report.select.viewJurnal1=SELECT   SNO,UW_YEAR, SPC_NAME,CURRENCY_NAME, GROSS_PREMIUM_OC ,GROSS_PREMIUM_DC,GROSS_ACQUISTION_COST_OC,GROSS_ACQUISTION_COST_DC,PREMIUM_DEPOSIT_RETAINED_OC ,PREMIUM_DEPOSIT_RETAINED_DC ,PREMIUM_DEPOSIT_RELEASED_OC ,PREMIUM_DEPOSIT_RELEASED_DC ,CLAIM_DEPOSIT_RETAINED_OC,CLAIM_DEPOSIT_RETAINED_DC,CLAIM_DEPOSIT_RELEASED_OC,CLAIM_DEPOSIT_RELEASED_DC,INTEREST_ON_DEPOSIT_OC  ,INTEREST_ON_DEPOSIT_DC  ,GROSS_CLAIMS_PAID_OC  ,GROSS_CLAIMS_PAID_DC  FROM   TRANSACTION_MOVEMENT_DETAILS WHERE  ACCOUNT_PERIOD_QTR = ?  AND ACCOUNT_PERIOD_DATE = ?  AND BRANCH_CODE = ?  AND TYPE = 'Q' AND  MOVMENT_TRANID=?
report.select.viewJurnal=SELECT   SNO,UW_YEAR, SPC_NAME,CURRENCY_NAME, GROSS_PREMIUM_OC ,GROSS_PREMIUM_DC,GROSS_ACQUISTION_COST_OC,GROSS_ACQUISTION_COST_DC,PREMIUM_DEPOSIT_RETAINED_OC ,PREMIUM_DEPOSIT_RETAINED_DC ,PREMIUM_DEPOSIT_RELEASED_OC ,PREMIUM_DEPOSIT_RELEASED_DC ,CLAIM_DEPOSIT_RETAINED_OC,CLAIM_DEPOSIT_RETAINED_DC,CLAIM_DEPOSIT_RELEASED_OC,CLAIM_DEPOSIT_RELEASED_DC,INTEREST_ON_DEPOSIT_OC  ,INTEREST_ON_DEPOSIT_DC  ,GROSS_CLAIMS_PAID_OC  ,GROSS_CLAIMS_PAID_DC  FROM   TRANSACTION_MOVEMENT_DETAILS WHERE  ACCOUNT_PERIOD_QTR = ?  AND ACCOUNT_PERIOD_DATE = ?  AND BRANCH_CODE = ?  AND SNO = ? AND TYPE = 'Q' AND  MOVMENT_TRANID=?
report.select.clMoveMentDtls=SELECT * FROM (SELECT UWYEAR,SPC_NAME, CURRENCY_NAME,TYPE,'FAC/XOL' PRODUCT,CONTRACT_NO,DECODE(TYPE,'PR',TRANSACTION_NO,'CL',CLAIM_NO)||''  TRAN_NO,OUTSTANDING_AMOUNT_OC, OUTSTANDING_AMOUNT_DC  FROM TRANSITION_CLAIM_MOVEMENT WHERE MOVEMENT_ID=? AND BRANCH_CODE=? AND PRODUCT_ID<>2 UNION ALL SELECT UWYEAR,SPC_NAME, CURRENCY_NAME,TYPE,'Treaty' PRODUCT,CONTRACT_NO,'' TRAN_NO,SUM(OUTSTANDING_AMOUNT_OC) OUTSTANDING_AMOUNT_OC, SUM(OUTSTANDING_AMOUNT_DC) OUTSTANDING_AMOUNT_DC  FROM TRANSITION_CLAIM_MOVEMENT WHERE MOVEMENT_ID=? AND BRANCH_CODE=? AND PRODUCT_ID='2'  GROUP BY UWYEAR,SPC_NAME, CURRENCY_NAME,TYPE,CONTRACT_NO)
report.select.journel=SELECT  ROWNUM SNO,MD.MOVMENT_TRANID,MD.ACCOUNT_PERIOD_QTR,MD.ACCOUNT_PERIOD_DATE,UW_YEAR,SPC_NAME,CURRENCY_NAME,CM.EXCHANGE_RATE, LOSS_ESTIMATE_REVISED_OC,(LOSS_ESTIMATE_REVISED_OC / CM.EXCHANGE_RATE)  LOSS_ESTIMATE_REVISED_DC,(SELECT   TMAS_PRODUCT_NAME FROM   TMAS_PRODUCT_MASTER TPM  WHERE   TPM.TMAS_PRODUCT_ID = MD.PRODUCT_ID AND TPM.BRANCH_CODE = ? AND TPM.TMAS_STATUS= 'Y' )PRODUCT_NAME,(SELECT   TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER TDM WHERE TDM.TMAS_DEPARTMENT_ID = MD.DEPT_ID  AND TDM.TMAS_PRODUCT_ID = MD.PRODUCT_ID  AND TDM.BRANCH_CODE =? AND TDM.TMAS_STATUS= 'Y')  DEPT_NAME  FROM   TRANSACTION_MOVEMENT_DETAILS MD, EXCHANGE_MASTER CM WHERE   MOVMENT_TRANID =? AND MD.CURRENCY_ID = CM.CURRENCY_ID AND CM.AMEND_ID = (SELECT MAX (AMEND_ID)  FROM CURRENCY_MASTER C WHERE C.CURRENCY_ID = CM.CURRENCY_ID  AND C.BRANCH_CODE = ?) AND MD.BRANCH_CODE = ? AND CM.BRANCH_CODE = ? AND MD.TYPE='Q' ORDER BY 1,2
report.sp.clMovementRep={CALL CLAIM_MOVEMENT_DATA(?,?,?)}
journelreport.sp.clMovementRep={CALL MOVEMENT_DATA(?,?,?,?,'CL')}
common.select.getsysDate=SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') SYSDT FROM DUAL
report.get.movementCnt=SELECT COUNT(*) COUNT FROM TRANSACTION_MOVEMENT_DETAILS WHERE BRANCH_CODE=? AND  ACCOUNT_PERIOD_QTR=? AND ACCOUNT_PERIOD_DATE=? AND TYPE='Q' AND REPORT_TYPE='F'
report.select.viewJurnalall1=SELECT ROWNUM SNO,MD.MOVMENT_TRANID,MD.ACCOUNT_PERIOD_QTR,MD.ACCOUNT_PERIOD_DATE,UW_YEAR,SPC_NAME,MD.CURRENCY_NAME,OS_LOSS_MOVEMENT_PL, (NVL (OS_LOSS_MOVEMENT_PL, 0) / CM.EXCHANGE_RATE) OS_LOSS_MOVEMENT_PL_USD,BS_MOVEMENT,(NVL (BS_MOVEMENT, 0) / CM.EXCHANGE_RATE) BS_MOVEMENT_USD,CLAIMS_PAID,(NVL (CLAIMS_PAID, 0) / CM.EXCHANGE_RATE) CLAIMS_PAID_USD,DEBTORS_CREDIT_CONTROL_AC,(NVL (DEBTORS_CREDIT_CONTROL_AC, 0) /CM.EXCHANGE_RATE) DEBTORS_CREDIT_CONTROL_AC_USD,OS_LOSS_MOVEMENT_BS,(NVL (OS_LOSS_MOVEMENT_BS, 0) / CM.EXCHANGE_RATE) OS_LOSS_MOVEMENT_BS_USD, NVL(OS_LOSS_PL_CR,0) OS_LOSS_PL_CR,(NVL (OS_LOSS_PL_CR, 0) / CM.EXCHANGE_RATE) OS_LOSS_PL_CR_USD,(SELECT   TMAS_PRODUCT_NAME FROM   TMAS_PRODUCT_MASTER TPM WHERE   TPM.TMAS_PRODUCT_ID = MD.PRODUCT_ID  AND TPM.BRANCH_CODE = ? AND TPM.TMAS_STATUS= 'Y') PRODUCT_NAME,(SELECT   TMAS_DEPARTMENT_NAME FROM   TMAS_DEPARTMENT_MASTER TDM  WHERE TDM.TMAS_DEPARTMENT_ID = MD.DEPT_ID AND TDM.TMAS_PRODUCT_ID = MD.PRODUCT_ID AND TDM.BRANCH_CODE = ? AND TDM.TMAS_STATUS= 'Y') DEPT_NAME  FROM   TRANSACTION_MOVEMENT_DETAILS MD, EXCHANGE_MASTER CM WHERE   MOVMENT_TRANID = ? AND MD.CURRENCY_ID = CM.CURRENCY_ID AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM CURRENCY_MASTER C WHERE C.CURRENCY_ID = CM.CURRENCY_ID AND C.BRANCH_CODE = ?) AND MD.BRANCH_CODE =? AND CM.BRANCH_CODE =?
report.select.viewJurnalall=SELECT   *  FROM   (SELECT   ROWNUM SNO, MD.MOVMENT_TRANID, MD.ACCOUNT_PERIOD_QTR, MD.ACCOUNT_PERIOD_DATE, UW_YEAR, SPC_NAME, MD.CURRENCY_NAME,  OS_LOSS_MOVEMENT_PL,  (NVL (OS_LOSS_MOVEMENT_PL, 0) / CM.EXCHANGE_RATE)  OS_LOSS_MOVEMENT_PL_USD,   BS_MOVEMENT, (NVL (BS_MOVEMENT, 0) /CM.EXCHANGE_RATE) BS_MOVEMENT_USD,  CLAIMS_PAID,   (NVL (CLAIMS_PAID, 0) / CM.EXCHANGE_RATE) CLAIMS_PAID_USD,   DEBTORS_CREDIT_CONTROL_AC,  (NVL (DEBTORS_CREDIT_CONTROL_AC, 0) / CM.EXCHANGE_RATE)     DEBTORS_CREDIT_CONTROL_AC_USD,  OS_LOSS_MOVEMENT_BS, (NVL (OS_LOSS_MOVEMENT_BS, 0) / CM.EXCHANGE_RATE)  OS_LOSS_MOVEMENT_BS_USD, NVL(OS_LOSS_PL_CR,0) OS_LOSS_PL_CR, (NVL (OS_LOSS_PL_CR, 0) / CM.EXCHANGE_RATE)   OS_LOSS_PL_CR_USD, (SELECT   TMAS_PRODUCT_NAME   FROM   TMAS_PRODUCT_MASTER TPM   WHERE   TPM.TMAS_PRODUCT_ID \= MD.PRODUCT_ID   AND TPM.BRANCH_CODE \= ? AND TPM.TMAS_STATUS\= 'Y')   PRODUCT_NAME, (SELECT   TMAS_DEPARTMENT_NAME   FROM   TMAS_DEPARTMENT_MASTER TDM  WHERE    TDM.TMAS_DEPARTMENT_ID \= MD.DEPT_ID   AND TDM.TMAS_PRODUCT_ID \= MD.PRODUCT_ID  AND TDM.BRANCH_CODE \= ? AND TDM.TMAS_STATUS\= 'Y')  DEPT_NAME  FROM   TRANSACTION_MOVEMENT_DETAILS MD, EXCHANGE_MASTER CM  WHERE   MOVMENT_TRANID \= ? AND MD.CURRENCY_ID \= CM.CURRENCY_ID   AND CM.AMEND_ID \=  (SELECT   MAX (AMEND_ID)   FROM   CURRENCY_MASTER C  WHERE   C.CURRENCY_ID \= CM.CURRENCY_ID   AND C.BRANCH_CODE \= ?)  AND MD.BRANCH_CODE \= ? AND MD.TYPE\='Q'  AND CM.BRANCH_CODE \= ?)  WHERE   SNO \= ?
journelreport.sp.clMovementRep={CALL MOVEMENT_DATA(?,?,?,?,'CL')}
journelreport.select.moveMentInit=SELECT   A.*  FROM  (SELECT DISTINCT MD.MOVMENT_TRANID,CD.DETAIL_NAME,MD.ACCOUNT_PERIOD_QTR,MD.ACCOUNT_PERIOD_DATE,MD.ACCOUNT_PERIOD_DATE ACCOUNT_PERIOD,MD.REPORT_TYPE,(SELECT   TMAS_PRODUCT_NAME FROM   TMAS_PRODUCT_MASTER TPM  WHERE   TPM.TMAS_PRODUCT_ID \= MD.PRODUCT_ID  AND TPM.BRANCH_CODE \= ? AND TPM.TMAS_STATUS\= 'Y') PRODUCT_NAME,(SELECT   TMAS_DEPARTMENT_NAME  FROM   TMAS_DEPARTMENT_MASTER TDM  WHERE  TDM.TMAS_DEPARTMENT_ID \= MD.DEPT_ID AND TDM.TMAS_PRODUCT_ID \= MD.PRODUCT_ID  AND TDM.BRANCH_CODE \= ? AND TDM.TMAS_STATUS\= 'Y') DEPT_NAME  FROM   TRANSACTION_MOVEMENT_DETAILS MD, CONSTANT_DETAIL CD WHERE MD.BRANCH_CODE \= ?  AND CD.CATEGORY_ID \= '12' AND CD.TYPE \= MD.ACCOUNT_PERIOD_QTR AND MD.TYPE \= 'Q' ORDER BY   1 DESC) A
full.premium.list=SELECT   * FROM   (  SELECT   DISTINCT RK.RSK_PRODUCTID,  RK.RSK_CONTRACT_NO,RK.RSK_DEPTID, (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE  CUSTOMER_TYPE \= 'C' AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id) FROM   personal_info p  WHERE   p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code)) COMPANY_NAME, (SELECT   FIRST_NAME FROM   personal_info Pi WHERE  CUSTOMER_TYPE \= 'B'  AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Broker_name, RK.RSK_PROPOSAL_NUMBER, RK.RSK_LAYER_NO, TRA.TRANSACTION_NO,  TRA.INSTALMENT_NUMBER || ' ' || TRA.ACCOUNT_PERIOD_QTR  INS_DETAIL, CASE rk.RSK_PRODUCTID WHEN 2 THEN (SELECT   DISTINCT DETAIL_NAME FROM   CONSTANT_DETAIL WHERE       CATEGORY_ID \= 49 AND TYPE \= TRA.ACCOUNT_PERIOD_QTR  AND STATUS \= 'Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR ELSE TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR END ACC_PER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE, NVL (TRA.ALLOCATED_TILL_DATE, '0') ALLOC_AMT, TRA.MOVEMENT_YN, TRA.SETTLEMENT_STATUS,  TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY') TRANSACTION_DATE,TRA.REVERSE_TRANSACTION_NO FROM   TTRN_RISK_DETAILS RK, RSK_PREMIUM_DETAILS TRA, Position_Master Pm WHERE    pm.BRANCH_CODE \= ? AND pm.amend_id \= (SELECT   MAX (amend_id)  FROM   Position_master p  WHERE   P.contract_no \= pm.Contract_no and decode(RK.RSK_PRODUCTID,'2',P.DEPT_ID,'111111')\= decode(RK.RSK_PRODUCTID,'2',PM.DEPT_ID ,'111111') ) AND TRA.CONTRACT_NO \= pm.contract_no  AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO \= RK.RSK_CONTRACT_NO AND RSK_LAYER_NO \= rk.RSK_LAYER_NO and decode(RK.RSK_PRODUCTID,'2',RSK_DEPTID,'111111')\= decode(RK.RSK_PRODUCTID,'2',rk.RSK_DEPTID,'111111')) AND TRA.CONTRACT_NO \= RK.RSK_CONTRACT_NO AND TRA.LAYER_NO \= RK.RSK_LAYER_NO and   decode(RK.RSK_PRODUCTID,'2',TRA.SUB_CLASS ,'111111')\= decode(RK.RSK_PRODUCTID,'2',rk.RSK_DEPTID,'111111') ORDER BY   TRA.TRANSACTION_NO desc)where  rownum<\=100
premium.list=SELECT   * FROM   (  SELECT   DISTINCT RK.RSK_PRODUCTID,  RK.RSK_CONTRACT_NO,RK.RSK_DEPTID, (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE  CUSTOMER_TYPE = 'C' AND pm.CEDING_COMPANY_ID = Pi.CUSTOMER_ID AND pi.branch_code = pm.branch_code AND amend_id = (SELECT   MAX (Amend_id) FROM   personal_info p  WHERE   p.CUSTOMER_TYPE = pi.CUSTOMER_TYPE  AND p.customer_id = pi.customer_id AND p.branch_code = pm.branch_code)) COMPANY_NAME, (SELECT   FIRST_NAME FROM   personal_info Pi WHERE  CUSTOMER_TYPE = 'B'  AND pm.Broker_id = Pi.CUSTOMER_ID  AND pi.branch_code = pm.branch_code  AND amend_id = (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE p.CUSTOMER_TYPE = pi.CUSTOMER_TYPE AND p.customer_id = pi.customer_id AND p.branch_code = pm.branch_code))  Broker_name, RK.RSK_PROPOSAL_NUMBER, RK.RSK_LAYER_NO, TRA.TRANSACTION_NO,  TRA.INSTALMENT_NUMBER || ' ' || TRA.ACCOUNT_PERIOD_QTR  INS_DETAIL, CASE rk.RSK_PRODUCTID WHEN 2 THEN (SELECT   DISTINCT DETAIL_NAME FROM   CONSTANT_DETAIL WHERE       CATEGORY_ID = 49 AND TYPE = TRA.ACCOUNT_PERIOD_QTR  AND STATUS = 'Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR ELSE TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR END ACC_PER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE, NVL (TRA.ALLOCATED_TILL_DATE, '0') ALLOC_AMT, TRA.MOVEMENT_YN, TRA.SETTLEMENT_STATUS,  TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY') TRANSACTION_DATE,TRA.REVERSE_TRANSACTION_NO FROM   TTRN_RISK_DETAILS RK, RSK_PREMIUM_DETAILS TRA, Position_Master Pm WHERE    pm.BRANCH_CODE = ? AND pm.amend_id = (SELECT   MAX (amend_id)  FROM   Position_master p  WHERE   P.contract_no = pm.Contract_no and decode(RK.RSK_PRODUCTID,'2',P.DEPT_ID,'111111')= decode(RK.RSK_PRODUCTID,'2',PM.DEPT_ID ,'111111') ) AND TRA.CONTRACT_NO = pm.contract_no  AND RK.RSK_ENDORSEMENT_NO = (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO = RK.RSK_CONTRACT_NO AND RSK_LAYER_NO = rk.RSK_LAYER_NO and decode(RK.RSK_PRODUCTID,'2',RSK_DEPTID,'111111')= decode(RK.RSK_PRODUCTID,'2',rk.RSK_DEPTID,'111111')) AND TRA.CONTRACT_NO = RK.RSK_CONTRACT_NO AND TRA.LAYER_NO = RK.RSK_LAYER_NO and   decode(RK.RSK_PRODUCTID,'2',TRA.SUB_CLASS ,'111111')= decode(RK.RSK_PRODUCTID,'2',rk.RSK_DEPTID,'111111') ORDER BY   TRA.TRANSACTION_NO desc)
PREMIUM_TEMP_LIST =SELECT   DISTINCT RK.RSK_PRODUCTID,  RK.RSK_CONTRACT_NO,RK.RSK_DEPTID,REQUEST_NO, (SELECT   COMPANY_NAME FROM   personal_info Pi WHERE  CUSTOMER_TYPE \= 'C' AND pm.CEDING_COMPANY_ID \= Pi.CUSTOMER_ID AND pi.branch_code \= pm.branch_code AND amend_id \= (SELECT   MAX (Amend_id) FROM   personal_info p  WHERE   p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE  AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code)) COMPANY_NAME, (SELECT   FIRST_NAME FROM   personal_info Pi WHERE  CUSTOMER_TYPE \= 'B'  AND pm.Broker_id \= Pi.CUSTOMER_ID  AND pi.branch_code \= pm.branch_code  AND amend_id \= (SELECT   MAX (Amend_id)  FROM   personal_info p WHERE p.CUSTOMER_TYPE \= pi.CUSTOMER_TYPE AND p.customer_id \= pi.customer_id AND p.branch_code \= pm.branch_code))  Broker_name, RK.RSK_PROPOSAL_NUMBER, RK.RSK_LAYER_NO, TRA.TRANSACTION_NO,  TRA.INSTALMENT_NUMBER || ' ' || TRA.ACCOUNT_PERIOD_QTR  INS_DETAIL, CASE rk.RSK_PRODUCTID WHEN 2 THEN (SELECT   DISTINCT DETAIL_NAME FROM   CONSTANT_DETAIL WHERE       CATEGORY_ID \= 49 AND TYPE \= TRA.ACCOUNT_PERIOD_QTR  AND STATUS \= 'Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR ELSE TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR END ACC_PER, TO_CHAR (RK.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE, TO_CHAR (RK.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE, NVL (TRA.ALLOCATED_TILL_DATE, '0') ALLOC_AMT, TRA.MOVEMENT_YN, TRA.SETTLEMENT_STATUS,  TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY') TRANSACTION_DATE,TRA.REVERSE_TRANSACTION_NO FROM   TTRN_RISK_DETAILS RK, RSK_PREMIUM_DETAILS_TEMP TRA, Position_Master Pm WHERE    pm.BRANCH_CODE \= ? AND pm.amend_id \= (SELECT   MAX (amend_id)  FROM   Position_master p  WHERE   P.contract_no \= pm.Contract_no and decode(RK.RSK_PRODUCTID,'2',P.DEPT_ID,'111111')\= decode(RK.RSK_PRODUCTID,'2',PM.DEPT_ID ,'111111') ) AND TRA.CONTRACT_NO \= pm.contract_no  AND RK.RSK_ENDORSEMENT_NO \= (SELECT   MAX (RSK_ENDORSEMENT_NO)  FROM   TTRN_RISK_DETAILS WHERE   RSK_CONTRACT_NO \= RK.RSK_CONTRACT_NO AND RSK_LAYER_NO \= rk.RSK_LAYER_NO and decode(RK.RSK_PRODUCTID,'2',RSK_DEPTID,'111111')\= decode(RK.RSK_PRODUCTID,'2',rk.RSK_DEPTID,'111111')) AND TRA.CONTRACT_NO \= RK.RSK_CONTRACT_NO AND TRA.LAYER_NO \= RK.RSK_LAYER_NO and   decode(RK.RSK_PRODUCTID,'2',TRA.SUB_CLASS ,'111111')\= decode(RK.RSK_PRODUCTID,'2',rk.RSK_DEPTID,'111111') AND TRANS_STATUS\='P'
contract.identifier.list=SELECT distinct A.PROPOSAL_NO,A.DEPT_ID,A.CONTRACT_NO,B.TMAS_DEPARTMENT_NAME,A.CEDING_COMPANY_ID,TO_CHAR (A.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE,B.TMAS_DEPARTMENT_NAME,C.COMPANY_NAME, C1.FIRST_NAME || ' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE,A.LAYER_NO,A.BASE_LAYER,A.OLD_CONTRACTNO AS OLD_CONTRACTNO, A.RENEWAL_STATUS AS RENEWAL_STATUS,(A.EXPIRY_DATE - SYSDATE) AS RENWALDATE,(CASE WHEN A.UW_YEAR != 0 THEN A.UW_YEAR ELSE NULL END) UW_YEAR, TO_CHAR (A.UW_MONTH, 'dd/mm/yyyy') UW_MONTH,E.UNDERWRITTER,DECODE(CD.CONTRACT_NO,NULL,'N','Y') HAS_CLAIM,CD.CLAIM_NO,CD.COUNT,A.AMEND_ID FROM   POSITION_MASTER A JOIN TMAS_DEPARTMENT_MASTER B ON A.DEPT_ID = B.TMAS_DEPARTMENT_ID JOIN PERSONAL_INFO C ON  C.CUSTOMER_ID = A.CEDING_COMPANY_ID JOIN TTRN_RISK_DETAILS D ON A.PRODUCT_ID = D.RSK_PRODUCTID AND A.CONTRACT_NO = D.RSK_CONTRACT_NO AND A.LAYER_NO=D.RSK_LAYER_NO AND A.AMEND_ID = D.RSK_ENDORSEMENT_NO AND A.DEPT_ID = D.RSK_DEPTID JOIN UNDERWRITTER_MASTER E ON D.RSK_UNDERWRITTER = E.UWR_CODE JOIN PERSONAL_INFO C1 ON  C1.CUSTOMER_ID = A.BROKER_ID LEFT OUTER JOIN ( SELECT DISTINCT CONTRACT_NO,LAYER_NO,CLAIM_NO, COUNT(CLAIM_NO) COUNT FROM   TTRN_CLAIM_DETAILS group by CONTRACT_NO, LAYER_NO ,CLAIM_NO) CD ON A.CONTRACT_NO = CD.CONTRACT_NO AND A.LAYER_NO=CD.LAYER_NO  WHERE  A.PRODUCT_ID = ?  AND A.CONTRACT_STATUS = 'A' AND A.CONTRACT_NO > 0 AND B.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE = ?   AND B.TMAS_STATUS='Y' AND C.BRANCH_CODE = ? AND C.CUSTOMER_TYPE = 'C' AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C.CUSTOMER_ID AND BRANCH_CODE = C.BRANCH_CODE AND CUSTOMER_TYPE = C.CUSTOMER_TYPE)  AND A.BRANCH_CODE = ? AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   POSITION_MASTER WHERE  PRODUCT_ID = ? AND A.CONTRACT_NO = CONTRACT_NO AND A.LAYER_NO=LAYER_NO AND A.BRANCH_CODE = BRANCH_CODE AND CONTRACT_STATUS = 'A') AND C1.BRANCH_CODE = ? AND C1.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) and D.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS RD  WHERE RD.BRANCH_CODE=D.BRANCH_CODE AND RD.RSK_PROPOSAL_NUMBER=D.RSK_PROPOSAL_NUMBER)
GET_TERRITORY_COUNTRY_LIST = SELECT distinct TC.COUNTRY_NAME,TC.COUNTRY_ID FROM COUNTRY_MASTER TC, TMAS_TERRITORY_COUNTRY_MAPPING TT WHERE TC.BRANCH_CODE IN (''{0}'') AND TT.TERRITORY_ID IN (''{1}'')  AND TT.COUNTRY_ID=TC.COUNTRY_ID AND TT.BRANCH_CODE=TC.BRANCH_CODE AND TT.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TMAS_TERRITORY_COUNTRY_MAPPING M WHERE TT.BRANCH_CODE=M.BRANCH_CODE AND  TT.TERRITORY_ID=M.TERRITORY_ID)
risk.select.getInstalmentData=SELECT INSTALLMENT_NO,TO_CHAR(INSTALLMENT_DATE,'DD/MM/YYYY') INSTALLMENT_DATE,MND_PREMIUM_OC,PAYEMENT_DUE_DAY,TRANSACTION_NO FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO=(SELECT MAX(ENDORSEMENT_NO) FROM TTRN_MND_INSTALLMENTS WHERE PROPOSAL_NO=? AND LAYER_NO=? AND ENDORSEMENT_NO IS NOT NULL ) AND ENDORSEMENT_NO IS NOT NULL ORDER BY INSTALLMENT_NO
retro.report.list= select BRANCH_CODE, TRANSACTION_MONTH_YEAR, RETROCONTRACTNUMBER, RETROBROKERNAME, RETRO_BROKER, RETROCESSIONAIRENAME, RETROCESSIONAIRE, INWARDCONTRACTNO, LAYERNO, UWY, INWARDBUSINESS, SUBCLASS, TRANSACTIONNO, TO_CHAR(TRANSACTIONDATE,'DD/MM/YYYY') TRANSACTIONDATE, TRANSACTIONTYPE, INWARDCURRENCYNAME, INWARDEXCHANGERATE, RETROCESSION_PERCENTAGE, RETROCURRENCYNAME, RETROEXCHANGERATE, PREMIUM_IC, COMMISSION_IC, BROKERAGE_IC, INTEREST_IC, TAX_IC, INWARDOVERRIDER_IC, OTHERCOST_IC, CLAMSPAID_IC, PREMIUMRESERVERETAINED_IC, PREMIUMRESERVERELEASED_IC, LOSSRESERVERETAINED_IC, LOSSRESERVERELEASED_IC, OUTWARDOVERRIDER_IC, NETDUE_IC, PREMIUM_INR, COMMISSION_INR, BROKERAGE_INR, INTEREST_INR, TAX_INR, INWARDOVERRIDER_INR, OTHERCOST_INR, CLAMSPAID_INR, PREMIUMRESERVERETAINED_INR, PREMIUMRESERVERELEASED_INR, LOSSRESERVERETAINED_INR, LOSSRESERVERELEASED_INR, OUTWARDOVERRIDER_INR, NETDUE_INR, PREMIUM_RC, COMMISSION_RC, BROKERAGE_RC, INTEREST_RC, TAX_RC, INWARDOVERRIDER_RC, OTHERCOST_RC, CLAMSPAID_RC, PREMIUMRESERVERETAINED_RC, PREMIUMRESERVERELEASED_RC, LOSSRESERVERETAINED_RC, LOSSRESERVERELEASED_RC, OUTWARDOVERRIDER_RC, NETDUE_RC, SOAFREQUENCY,OSCLAIM_LOSS_INR,OSCLAIM_LOSS_IC,OSCLAIM_LOSS_RC, AMEND_ID,TREATY_INSURED_NAME from VW_RETRO_PRCL_REPORT where  TRANSACTION_MONTH_YEAR BETWEEN to_date(?,'DD/MM/YYYY') AND to_date(?,'DD/MM/YYYY') AND BRANCH_CODE= ?  And Decode(?,'ALL','A',RETRO_BROKER)=Decode(?,'ALL','A',?)  And Decode(?,'ALL','A',RETROCESSIONAIRE)=Decode(?,'ALL','A',?)  And Decode(?,'ALL','A',UWY)=Decode(?,'ALL','A',?)
premium.select.getPremiumedList=SELECT RK.RSK_CONTRACT_NO ,PERSONAL.COMPANY_NAME,PI.FIRST_NAME ||' '||PI.LAST_NAME BROKER_NAME, RK.RSK_PROPOSAL_NUMBER,  RK.RSK_LAYER_NO,RK.RSK_DEPTID,TRA.TRANSACTION_NO,TRA.INSTALMENT_NUMBER ||' ' ||TRA.ACCOUNT_PERIOD_QTR INS_DETAIL, case rk.RSK_PRODUCTID when 2 then (SELECT DISTINCT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=49 AND TYPE\=TRA.ACCOUNT_PERIOD_QTR and STATUS\='Y') || ' ' || TRA.ACCOUNT_PERIOD_YEAR else TRA.ACCOUNT_PERIOD_QTR || ' ' || ACCOUNT_PERIOD_YEAR  end ACC_PER, TO_CHAR(TRA.ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE, TO_CHAR(TRA.STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,TO_CHAR(TRA.ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,NVL(TRA.ALLOCATED_TILL_DATE,'0') ALLOC_AMT,TRA.MOVEMENT_YN,TRA.SETTLEMENT_STATUS,TO_CHAR (TRA.TRANSACTION_MONTH_YEAR, 'DD/MM/YYYY')TRANSACTION_DATE ,TO_CHAR (TRA.STATEMENT_DATE, 'DD/MM/YYYY')STATEMENT_DATE1,TRA.REVERSE_TRANSACTION_NO FROM TTRN_RISK_DETAILS RK , PERSONAL_INFO PERSONAL,PERSONAL_INFO PI,RSK_PREMIUM_DETAILS TRA WHERE RK.RSK_CONTRACT_NO\=? AND RK.RSK_CEDINGID\=PERSONAL.CUSTOMER_ID AND RK.RSK_BROKERID \= PI.CUSTOMER_ID AND PERSONAL.BRANCH_CODE\=? AND PERSONAL.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE  CUSTOMER_ID\=PERSONAL.CUSTOMER_ID AND   BRANCH_CODE\=PERSONAL.BRANCH_CODE ) AND PI.BRANCH_CODE \= PERSONAL.BRANCH_CODE AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID AND BRANCH_CODE \= PI.BRANCH_CODE) AND RK.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO\=? ) AND TRA.CONTRACT_NO\=RK.RSK_CONTRACT_NO ORDER BY TRA.TRANSACTION_NO DESC
fac.select.firstPageDet=SELECT DE.RSK_STATUS,DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, RSK_PRODUCTID , RSK_DEPTID,RSK_PFCID,  RSK_SPFCID  , DE.RSK_CEDINGID,DE.RSK_BROKERID,  DE.RSK_TREATYID,  TO_CHAR(DE.RSK_MONTH,'dd/mm/yyyy') MONTH, DE.RSK_UWYEAR,  DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'dd/mm/yyyy') INS_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'dd/mm/yyyy') EXP_DATE,TO_CHAR(DE. RSK_ACCOUNT_DATE,'dd/mm/yyyy') AC_DATE, DE. RSK_ORIGINAL_CURR, DE. RSK_EXCHANGE_RATE,DE.RSK_TERRITORY,DE.RSK_INSURED_NAME,DE.RSK_LOCATION,DE.RSK_CITY,FAC.NR,FAC.RSK_CEDANT_RETENTION,FAC.MAXIMUM_LIMIT_OC,FAC.DEDUCTIBLE_OC,FAC.SP_RETRO,FAC.PML,FAC.SI_PML_OC,FAC.CU,FAC.CU_RSN,FAC.SUM_INSURED_OC,FAC.GWPI_OC,FAC.PML_OC,FAC.TPL_OC,FAC.SHARE_WRITTEN,FAC.SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,FAC.RSK_INTEREST,FAC.NO_OF_INSURERS,DE.RSK_PREMIUM_RATE,DE.RSK_POLBRANCH,FAC.RSK_CEDRET_TYPE,DE.OLD_CONTRACTNO,PM.RENEWAL_STATUS,PM.LOGIN_ID,FAC.DEDUCTIBLE_FACXOL_OC,FAC.XOL_OC,FAC.MND_INSTALLMENTS,FAC.MODE_TRANSPORT_ID,FAC.VESSEL_NAME,FAC.VESSEL_AGE,FAC.LIMIT_PER_VESSEL_OC,FAC.LIMIT_PER_LOCATION_OC,FAC.TYPE,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,FAC.SUM_INS_PML_OC,FAC.PBL_OC,FAC.PBL_DC,FAC.PLL_OC,PSL_OC,FAC.GWPI_PML_OC,FAC.COVER_LIMIT_PML_OC,DE.INWARD_BUS_TYPE,DE.RSK_RECEIPT_PAYEMENT,DE.RSK_LOC_ISSUED,DE.RSK_LATITUDE ,DE.RSK_LONGITUDE,DE.RSK_VESSAL_TONNAGE,DE.RS_ENDORSEMENT_TYPE,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.DATA_MAP_CONT_NO,DE.Xol_LAYER_NO FROM TTRN_RISK_DETAILS DE  ,TTRN_FAC_RISK_PROPOSAL FAC,POSITION_MASTER PM WHERE  DE.RSK_PROPOSAL_NUMBER\=? AND DE.RSK_PROPOSAL_NUMBER\=FAC.RSK_PROPOSAL_NUMBER AND  DE.RSK_ENDORSEMENT_NO IS NOT NULL AND FAC.RSK_ENDORSEMENT_NO IS NOT NULL AND  DE.RSK_ENDORSEMENT_NO \= (SELECT MAX(RSK_ENDORSEMENT_NO) FROM  TTRN_RISK_DETAILS  WHERE RSK_ENDORSEMENT_NO  IS NOT NULL AND   RSK_PROPOSAL_NUMBER\=?)  AND FAC.RSK_ENDORSEMENT_NO\=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM  TTRN_FAC_RISK_PROPOSAL  WHERE RSK_ENDORSEMENT_NO  IS NOT NULL AND   RSK_PROPOSAL_NUMBER\=?) AND PM.PROPOSAL_NO\=FAC.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID\=(SELECT   MAX (AMEND_ID) FROM POSITION_MASTER WHERE AMEND_ID IS NOT NULL AND PROPOSAL_NO \= PM.PROPOSAL_NO)
common.select.deptName=SELECT TMAS_DEPARTMENT_ID,TMAS_DEPARTMENT_NAME from TMAS_DEPARTMENT_MASTER where branch_code=?  AND TMAS_PRODUCT_ID='4' and TMAS_STATUS='H'
INSERT_RET_DETAILS=INSERT INTO TTRN_CEDENT_RET(PROPOSAL_NO,CONTRACT_NO,LAYER_NO,DEPT_ID,PRODUCT_ID,AMEND_ID,RSK_SNO,RSK_CLASS,RSK_SUBCLASS,RSK_TYPE,RSK_RETTYPE,RSK_BASISTYPE,RSK_FIRST_RET_OC,RSK_SECOND_RET_OC,RSK_RET_TL_FST_OC,RSK_RET_TL_SST_OC,RSK_RET_EL_FST_OC,RSK_RET_EL_SST_OC,LOGIN_ID,BRANCH_CODE,SYS_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate)
UPDATE_SUBCLASS_QUERY=call UPDATE_SUB(?,?)
PTTY_PREMIUM_EDIT_TEMP=SELECT TO_CHAR(TRANSACTION_MONTH_YEAR,'DD/MM/YYYY') TRANS_DATE,TO_CHAR(ACCOUNTING_PERIOD_DATE,'DD/MM/YYYY') ACCOUNTING_PERIOD_DATE,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE,ACCOUNT_PERIOD_QTR, ACCOUNT_PERIOD_YEAR,CURRENCY_ID,EXCHANGE_RATE,BROKERAGE_AMT_OC,TAX_AMT_OC,TO_CHAR(ENTRY_DATE_TIME,'DD/MM/YYYY'),TO_CHAR(AMENDMENT_DATE,'DD/MM/YYYY') AMENDMENT_DATE,PREMIUM_QUOTASHARE_OC,  COMMISSION_QUOTASHARE_OC,PREMIUM_SURPLUS_OC,COMMISSION_SURPLUS_OC,PREMIUM_PORTFOLIOIN_OC, CLAIM_PORTFOLIOIN_OC,PREMIUM_PORTFOLIOOUT_OC,LOSS_RESERVE_RELEASED_OC,PREMIUMRESERVE_QUOTASHARE_OC, CASH_LOSS_CREDIT_OC,LOSS_RESERVERETAINED_OC,PROFIT_COMMISSION_OC,CASH_LOSSPAID_OC,STATUS,ENTERING_MODE,RECEIPT_NO,CLAIMS_PAID_OC,SETTLEMENT_STATUS,M_DPREMIUM_OC,ADJUSTMENT_PREMIUM_OC,REC_PREMIUM_OC  ,COMMISSION,INSTALMENT_NUMBER,to_char(ENTRY_DATE_TIME,'DD/MM/YYYY') INS_DATE,XL_COST_OC,CLAIM_PORTFOLIO_OUT_OC,PREMIUM_RESERVE_REALSED_OC,  OTHER_COST_OC,CEDANT_REFERENCE,REMARKS,NETDUE_OC,TOTAL_CR_OC,TOTAL_DR_OC,INTEREST_OC,OSCLAIM_LOSSUPDATE_OC,OVERRIDER,OVERRIDER_AMT_OC,OVERRIDER_AMT_DC,WITH_HOLDING_TAX_OC,WITH_HOLDING_TAX_DC,RI_CESSION,SUB_CLASS,TDS_OC,TDS_DC,VAT_PREMIUM_OC,VAT_PREMIUM_DC,SC_Comm_OC,SC_Comm_DC,BONUS_OC,BONUS_DC,PREMIUM_SUBCLASS,LPC_OC,LPC_DC,GNPI_ENDT_NO,nvl(PRD_ALLOCATED_TILL_DATE,0)PRD_ALLOCATED_TILL_DATE,nvl(LRD_ALLOCATED_TILL_DATE,0)LRD_ALLOCATED_TILL_DATE,PREMIUM_CLASS,TO_CHAR(STATEMENT_DATE,'DD/MM/YYYY') STATEMENT_DATE1,OSBYN,SECTION_NAME,REVERSEL_STATUS,REVERSE_TRANSACTION_NO,BROKERAGE_VAT_OC,BROKERAGE_VAT_DC,DOCUMENT_TYPE,M1_OC, M2_OC, M3_OC FROM RSK_PREMIUM_DETAILS_TEMP where CONTRACT_NO\=? AND REQUEST_NO\=?
Select.premium.vatInfo=SELECT PROPOSAL_NO, SUM(PREMIUM_VAT) PREMIUM_VAT, SUM (BROKERAGE_AMT) BROKERAGE_AMT, SUM(BROKERAGE_VAT) BROKERAGE_VAT FROM (SELECT VAT.*, ROUND(PREMIUM_AMOUNT * (SHARE_SIGNED / TOTAL_SHARE_SIGNED),2) PREMIUM_AMT, ROUND((PREMIUM_AMOUNT * (SHARE_SIGNED / TOTAL_SHARE_SIGNED) * PREMIUM_VAT_SHARE * (VAT_RATE /100)),2) AS PREMIUM_VAT, ROUND(PREMIUM_AMOUNT * (SHARE_SIGNED / TOTAL_SHARE_SIGNED) * BIBE * (BROKERAGE / 100),2) AS BROKERAGE_AMT, ROUND(PREMIUM_AMOUNT * (SHARE_SIGNED / TOTAL_SHARE_SIGNED) * BIBE * (BROKERAGE / 100) * (VAT_RATE /100),2) AS BROKERAGE_VAT FROM (SELECT  DISTINCT PM.PROPOSAL_NO, PM.CEDING_COMPANY_ID, PM.BROKER_ID INWARD_BROKER, PM.AMEND_ID INWARD_AMEND_ID, TBM.VAT_RATE, PI.DOMICILE CEDANT_DOMICILE, PI.DOMICILE_TYPE CEDANT_DOMICILE_TYPE, TRI.REINSURER_ID, TRI.BROKER_ID RI_BROKER, TRI.BROKERAGE,PIR.DOMICILE RI_DOMICILE, PIR.DOMICILE_TYPE RI_DOMICILE_TYPE, TRI.SHARE_SIGNED, DECODE (PIR.DOMICILE||PIR.DOMICILE_TYPE,'TTV','Y','N') AS PREMIUM_VAT_APPLICABILITY, DECODE (PIR.DOMICILE||PIR.DOMICILE_TYPE,'TTV',1,0) PREMIUM_VAT_SHARE, CASE WHEN PIR.DOMICILE = 'O' THEN 'VI' ELSE 'VE' END AS BROKERAGE_VAT_APPLICABILITY, CASE WHEN PIR.DOMICILE = 'O' THEN 100/107 ELSE 1 END BIBE, ? PREMIUM_AMOUNT,  TRP.RSK_SHARE_SIGNED TOTAL_SHARE_SIGNED FROM  POSITION_MASTER PM, PERSONAL_INFO PI, TMAS_BRANCH_MASTER TBM,TTRN_RI TRI, PERSONAL_INFO PIR, TTRN_RISK_PROPOSAL TRP WHERE PM.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO = PM.PROPOSAL_NO) AND PM.BRANCH_CODE = PI.BRANCH_CODE AND PI.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID = PI.CUSTOMER_ID) AND PM.CEDING_COMPANY_ID = PI.CUSTOMER_ID AND PM.BRANCH_CODE = TBM.BRANCH_CODE AND PM.PROPOSAL_NO = TRI.PROPOSAL_NO AND PM.BRANCH_CODE = TRI.BRANCH_CODE AND PM.AMEND_ID = TRI.AMEND_ID AND PM.BRANCH_CODE = PIR.BRANCH_CODE AND PIR.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PIR1 WHERE PIR1.CUSTOMER_ID = PIR.CUSTOMER_ID) AND TRI.REINSURER_ID = PIR.CUSTOMER_ID AND PM.PROPOSAL_NO = TRP.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TRP.RSK_ENDORSEMENT_NO AND PM.BRANCH_CODE = TRP.BRANCH_CODE AND PM.PROPOSAL_NO = ? AND PM.BRANCH_CODE = ?  )VAT) GROUP BY PROPOSAL_NO
GET_EXISTING_BOUQUET= SELECT TO_CHAR (RD.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE, TO_CHAR (RD.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,(SELECT COMPANY_NAME FROM PERSONAL_INFO PERSONAL WHERE RD.RSK_CEDINGID = PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.BRANCH_CODE = PM.BRANCH_CODE)COMPANY_NAME,PM.UW_YEAR,PM.UW_YEAR_TO,RD.TREATYTYPE,PM.PRODUCT_ID, (SELECT TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER PD WHERE PD.TMAS_PRODUCT_ID=PM.PRODUCT_ID AND PD.BRANCH_CODE=PM.BRANCH_CODE)BUSINESS_TYPE,PM.PROPOSAL_NO,(SELECT DETAIL_NAME FROM  CONSTANT_DETAIL WHERE CATEGORY_ID=DECODE(PM.PRODUCT_ID,'2','43','29') AND TYPE=DECODE(PM.PRODUCT_ID,'2',RD.TREATYTYPE,RD.RSK_BUSINESS_TYPE))TREATY_TYPE,RD.RSK_TREATYID,DECODE(PM.OLD_CONTRACTNO,'','New','Renew') POLICY_STATUS,''EXISTING_SHARE,NVL(PM.BASE_LAYER,PM.PROPOSAL_NO) BASE_LAYER,PM.SECTION_NO,PM.LAYER_NO,(SELECT TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER B WHERE RD.RSK_DEPTId = b.TMAS_DEPARTMENT_ID AND b.TMAS_PRODUCT_ID = PM.PRODUCT_ID AND B.BRANCH_CODE=PM.BRANCH_CODE   AND B.TMAS_STATUS='Y')TMAS_DEPARTMENT_NAME,CASE WHEN RD.RSK_SPFCID='ALL' THEN 'ALL' ELSE (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE = RD.BRANCH_CODE) END SUB_CLASS,PM.OFFER_NO FROM POSITION_MASTER PM,TTRN_RISK_DETAILS RD WHERE BOUQUET_NO IS NOT NULL AND PM.BRANCH_CODE=? AND PM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER AND PM.BOUQUET_NO=? AND PM.contract_status='P' ORDER BY OFFER_NO, PROPOSAL_NO
GET_EXISTING_BASELAYER= SELECT TO_CHAR (RD.RSK_INCEPTION_DATE, 'DD/MM/YYYY') INS_DATE, TO_CHAR (RD.RSK_EXPIRY_DATE, 'DD/MM/YYYY') EXP_DATE,(SELECT COMPANY_NAME FROM PERSONAL_INFO PERSONAL WHERE RD.RSK_CEDINGID = PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.BRANCH_CODE = PM.BRANCH_CODE)COMPANY_NAME,PM.UW_YEAR,PM.UW_YEAR_TO,RD.TREATYTYPE,PM.PRODUCT_ID, (SELECT TMAS_PRODUCT_NAME FROM TMAS_PRODUCT_MASTER PD WHERE PD.TMAS_PRODUCT_ID=PM.PRODUCT_ID AND PD.BRANCH_CODE=PM.BRANCH_CODE)BUSINESS_TYPE,PM.PROPOSAL_NO,(SELECT DETAIL_NAME FROM  CONSTANT_DETAIL WHERE CATEGORY_ID=DECODE(PM.PRODUCT_ID,'2','43','29') AND TYPE=DECODE(PM.PRODUCT_ID,'2',RD.TREATYTYPE,RD.RSK_BUSINESS_TYPE))TREATY_TYPE,RD.RSK_TREATYID,DECODE(PM.OLD_CONTRACTNO,'','New','Renew') POLICY_STATUS,''EXISTING_SHARE,NVL(PM.BASE_LAYER,PM.PROPOSAL_NO) BASE_LAYER,PM.SECTION_NO,PM.LAYER_NO,(SELECT TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER B WHERE RD.RSK_DEPTId = b.TMAS_DEPARTMENT_ID AND b.TMAS_PRODUCT_ID = PM.PRODUCT_ID AND B.BRANCH_CODE=PM.BRANCH_CODE   AND B.TMAS_STATUS='Y')TMAS_DEPARTMENT_NAME,CASE WHEN RD.RSK_SPFCID='ALL' THEN 'ALL' ELSE (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(RD.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = RD.RSK_PRODUCTID AND SPFC.BRANCH_CODE = RD.BRANCH_CODE) END SUB_CLASS,PM.OFFER_NO FROM POSITION_MASTER PM,TTRN_RISK_DETAILS RD WHERE  PM.BRANCH_CODE=? AND PM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER AND NVL(PM.BASE_LAYER,PM.PROPOSAL_NO)=? AND PM.contract_status='P' ORDER BY PRODUCT_ID,BASE_LAYER,PROPOSAL_NO
NEW_CONTRACT_SUMMARY=SELECT DISTINCT PM.OFFER_NO,NVL(PM.BASE_LAYER,PM.PROPOSAL_NO) BASE_PROPOSAL,PM.PROPOSAL_NO,TRD.RSK_TREATYID TREATY_NAME,DECODE(PM.PRODUCT_ID,2,PM.SECTION_NO,PM.LAYER_NO) LAYER_SECTION,TRP.SNO,(SELECT CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_TYPE='R'  AND CUSTOMER_ID=TRP.REINSURER_ID AND BRANCH_CODE=TRP.BRANCH_CODE  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(SELECT CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_TYPE='B'  AND CUSTOMER_ID=TRP.BROKER_ID AND BRANCH_CODE=TRP.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,(SELECT SHORT_NAME FROM CURRENCY_MASTER CM WHERE CM.CURRENCY_ID = TRD.RSK_ORIGINAL_CURR  AND CM.BRANCH_CODE = PM.BRANCH_CODE  AND CM.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER CM1  WHERE CM.BRANCH_CODE = CM1.BRANCH_CODE AND CM.CURRENCY_ID = CM1.CURRENCY_ID)) CURRENCY,CASE WHEN PM.PRODUCT_ID = 2 THEN TR.RSK_EPI_EST_OC WHEN PM.PRODUCT_ID = 3 THEN TR.RSK_SUBJ_PREMIUM_OC END EPI_100_OC,CASE WHEN PM.PRODUCT_ID = 2 THEN TR.RSK_EPI_EST_DC WHEN PM.PRODUCT_ID = 3 THEN TR.RSK_SUBJ_PREMIUM_DC END EPI_100_DC,NVL(TRPS.NEW_STATUS,TRP.STATUS) PLACING_STATUS,NVL(TRP.SHARE_SIGNED,0) SHARE_SIGNED,NVL(TRP.BROKERAGE,0) BROKERAGE,ROUND((CASE WHEN PM.PRODUCT_ID = 2 THEN TR.RSK_EPI_EST_DC WHEN PM.PRODUCT_ID = 3 THEN TR.RSK_SUBJ_PREMIUM_DC END)*(NVL(TRP.BROKERAGE,0)/100)*(NVL(TRP.SHARE_SIGNED,0)/100),2) BROKERAGE_AMT FROM POSITION_MASTER PM,TTRN_RI_PLACEMENT TRP,TTRN_RI_PLACEMENT_STATUS TRPS,TTRN_RISK_DETAILS TRD,TTRN_RISK_PROPOSAL TR WHERE PM.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM.BRANCH_CODE = PM1.BRANCH_CODE AND PM.PROPOSAL_NO   = PM1.PROPOSAL_NO) AND PM.BRANCH_CODE = TRP.BRANCH_CODE  AND PM.PROPOSAL_NO = TRP.PROPOSAL_NO AND TRP.STATUS_NO IN (SELECT MAX(STATUS_NO) FROM TTRN_RI_PLACEMENT TRP1 WHERE TRP.PROPOSAL_NO = TRP1.PROPOSAL_NO AND TRP.SNO = TRP1.SNO AND TRP.BRANCH_CODE = TRP1.BRANCH_CODE) AND PM.PROPOSAL_NO = TRPS.PROPOSAL_NO (+)  AND TRP.SNO = TRPS.SNO (+) AND TRP.STATUS_NO = TRPS.STATUS_NO (+)  AND PM.BRANCH_CODE = TRD.BRANCH_CODE AND PM.PROPOSAL_NO = TRD.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TRD.RSK_ENDORSEMENT_NO AND PM.BRANCH_CODE = TR.BRANCH_CODE AND PM.PROPOSAL_NO = TR.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TR.RSK_ENDORSEMENT_NO AND PM.BRANCH_CODE = ? AND NVL(PM.BASE_LAYER,PM.PROPOSAL_NO)=? AND NVL(TRPS.NEW_STATUS,TRP.STATUS)='CSL' ORDER BY PM.PROPOSAL_NO, TRP.SNO
GET_REINSURER_INFO=SELECT P.SNO, P.BOUQUET_NO, P.BASE_PROPOSAL_NO, P.PROPOSAL_NO, P.CEDING_COMPANY_ID, P.REINSURER_ID, P.BROKER_ID, P.SHARE_OFFERED, P.SHARE_WRITTEN, P.SHARE_PROPOSAL_WRITTEN, P.SHARE_SIGNED, P.BROKERAGE BROKERAGE_PER, P.SHARE_PROPOSED_SIGNED, P.PLACEMENT_AMEND_ID, NVL(PS.CURRENT_STATUS,P.STATUS)CURRENT_STATUS, PS.NEW_STATUS, P.STATUS_NO FROM TTRN_RI_PLACEMENT P, TTRN_RI_PLACEMENT_STATUS PS, POSITION_MASTER PM, TTRN_RISK_DETAILS TRD, TTRN_RISK_PROPOSAL TRP WHERE P.PROPOSAL_NO = PS.PROPOSAL_NO(+) AND P.BRANCH_CODE = PS.BRANCH_CODE (+) AND P.STATUS_NO = PS.STATUS_NO (+) AND P.STATUS_NO IN (SELECT MAX(STATUS_NO) FROM TTRN_RI_PLACEMENT P1 WHERE P.PROPOSAL_NO = P1.PROPOSAL_NO AND P.SNO = P1.SNO AND P.BRANCH_CODE = P1.BRANCH_CODE) AND P.BRANCH_CODE = PM.BRANCH_CODE AND P.PROPOSAL_NO = PM.PROPOSAL_NO AND PM.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM.BRANCH_CODE = PM1.BRANCH_CODE AND PM.PROPOSAL_NO = PM1.PROPOSAL_NO) AND PM.BRANCH_CODE = TRD.BRANCH_CODE AND PM.PROPOSAL_NO = TRD.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TRD.RSK_ENDORSEMENT_NO AND PM.BRANCH_CODE = TRP.BRANCH_CODE AND PM.PROPOSAL_NO = TRP.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TRP.RSK_ENDORSEMENT_NO AND PM.AMEND_ID=P.AMEND_ID AND P.BRANCH_CODE=? AND P.PROPOSAL_NO=? ORDER BY P.PROPOSAL_NO, P.SNO
GET_REINSURER_INFO_NOTIN=SELECT * FROM (SELECT DISTINCT P.SNO,  P.REINSURER_ID,P.BROKER_ID,P.SHARE_OFFERED,NVL(M.MAIL_STATUS,'Pending')MAIL_STATUS,P.PROPOSAL_NO,P.BOUQUET_NO,P.PLACEMENT_MODE from TTRN_RI_PLACEMENT P LEFT JOIN MAIL_NOTIFICATION_DETAIL M ON(M.PROPOSAL_NO=P.PROPOSAL_NO AND M.REINSURER_ID=P.REINSURER_ID AND M.BROKER_ID=P.BROKER_ID)  WHERE P.BRANCH_CODE=? AND P.PROPOSAL_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID) ) ORDER BY SNO, BOUQUET_NO,PROPOSAL_NO
GET_PLACEMENT_BASE_LIST=SELECT P.SNO, P.BOUQUET_NO,P.BASE_PROPOSAL_NO,P.PROPOSAL_NO,(SELECT COMPANY_NAME FROM PERSONAL_INFO PERSONAL WHERE P.CEDING_COMPANY_ID = PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.BRANCH_CODE = P.BRANCH_CODE)CEDING_COMPANY_ID,P.REINSURER_ID,P.BROKER_ID,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='R'  AND CUSTOMER_ID=P.REINSURER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='B'  AND CUSTOMER_ID=P.BROKER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,TO_CHAR(SHARE_OFFERED,'99.00000000')SHARE_OFFERED,TO_CHAR(SHARE_WRITTEN,'99.00000000')SHARE_WRITTEN,TO_CHAR(SHARE_PROPOSAL_WRITTEN,'99.00000000')SHARE_PROPOSAL_WRITTEN,TO_CHAR(SHARE_SIGNED,'99.00000000')SHARE_SIGNED,TO_CHAR(BROKERAGE,'99.00000000') BROKERAGE_PER,(SELECT STATUS_NAME FROM STATUS_MASTER WHERE STATUS_CODE=P.STATUS AND BRANCH_CODE=P.BRANCH_CODE)STATUS,TO_CHAR(WRITTEN_LINE_VALIDITY,'DD/MM/YYYY')WRITTEN_LINE_VALIDITY,WRITTEN_LINE_REMARKS,TO_CHAR(SHARE_LINE_VALIDITY,'DD/MM/YYYY')SHARE_LINE_VALIDITY,SHARE_LINE_REMARKS,SHARE_PROPOSED_SIGNED,NVL(D.MAIL_STATUS,'Pending')MAIL_STATUS,(SELECT OFFER_NO FROM POSITION_MASTER WHERE PROPOSAL_NO=P.PROPOSAL_NO AND BRANCH_CODE=P.BRANCH_CODE)OFFER_NO from TTRN_RI_PLACEMENT P LEFT JOIN MAIL_NOTIFICATION_DETAIL D ON (D.PROPOSAL_NO=P.PROPOSAL_NO AND D.REINSURER_ID=P.REINSURER_ID AND D.BROKER_ID=P.BROKER_ID AND MAIL_TYPE=P.STATUS AND MAIL_RECORD_NO=(SELECT  MAX(MAIL_RECORD_NO) FROM MAIL_NOTIFICATION_DETAIL WHERE PROPOSAL_NO=P.PROPOSAL_NO AND REINSURER_ID=P.REINSURER_ID AND BROKER_ID=P.BROKER_ID AND MAIL_TYPE=P.STATUS))  WHERE P.BRANCH_CODE=? AND P.BASE_PROPOSAL_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID)
GET_PLACEMENT_BOUQUET_LIST=SELECT P.SNO, P.BOUQUET_NO,P.BASE_PROPOSAL_NO,P.PROPOSAL_NO,(SELECT COMPANY_NAME FROM PERSONAL_INFO PERSONAL WHERE P.CEDING_COMPANY_ID = PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.BRANCH_CODE = P.BRANCH_CODE)CEDING_COMPANY_ID,P.REINSURER_ID,P.BROKER_ID,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='R'  AND CUSTOMER_ID=P.REINSURER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='B'  AND CUSTOMER_ID=P.BROKER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,TO_CHAR(SHARE_OFFERED,'99.00000000')SHARE_OFFERED,TO_CHAR(SHARE_WRITTEN,'99.00000000')SHARE_WRITTEN,TO_CHAR(SHARE_PROPOSAL_WRITTEN,'99.00000000')SHARE_PROPOSAL_WRITTEN,TO_CHAR(SHARE_SIGNED,'99.00000000')SHARE_SIGNED,TO_CHAR(BROKERAGE,'99.00000000') BROKERAGE_PER,(SELECT STATUS_NAME FROM STATUS_MASTER WHERE STATUS_CODE=P.STATUS AND BRANCH_CODE=P.BRANCH_CODE)STATUS,TO_CHAR(WRITTEN_LINE_VALIDITY,'DD/MM/YYYY')WRITTEN_LINE_VALIDITY,WRITTEN_LINE_REMARKS,TO_CHAR(SHARE_LINE_VALIDITY,'DD/MM/YYYY')SHARE_LINE_VALIDITY,SHARE_LINE_REMARKS,SHARE_PROPOSED_SIGNED,NVL(D.MAIL_STATUS,'Pending')MAIL_STATUS,(SELECT OFFER_NO FROM POSITION_MASTER WHERE PROPOSAL_NO=P.PROPOSAL_NO AND BRANCH_CODE=P.BRANCH_CODE)OFFER_NO from TTRN_RI_PLACEMENT P LEFT JOIN MAIL_NOTIFICATION_DETAIL D ON (D.PROPOSAL_NO=P.PROPOSAL_NO AND D.REINSURER_ID=P.REINSURER_ID AND D.BROKER_ID=P.BROKER_ID AND MAIL_TYPE=P.STATUS AND MAIL_RECORD_NO=(SELECT  MAX(MAIL_RECORD_NO) FROM MAIL_NOTIFICATION_DETAIL WHERE PROPOSAL_NO=P.PROPOSAL_NO AND REINSURER_ID=P.REINSURER_ID AND BROKER_ID=P.BROKER_ID AND MAIL_TYPE=P.STATUS))  WHERE P.BRANCH_CODE=? AND P.BOUQUET_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID)
GET_PLACEMENT_LIST=SELECT P.SNO, P.BOUQUET_NO,P.BASE_PROPOSAL_NO,P.PROPOSAL_NO,(SELECT COMPANY_NAME FROM PERSONAL_INFO PERSONAL WHERE P.CEDING_COMPANY_ID = PERSONAL.CUSTOMER_ID AND PERSONAL.CUSTOMER_TYPE='C' AND PERSONAL.BRANCH_CODE = P.BRANCH_CODE)CEDING_COMPANY_ID,P.REINSURER_ID,P.BROKER_ID,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='R'  AND CUSTOMER_ID=P.REINSURER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='B'  AND CUSTOMER_ID=P.BROKER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,TO_CHAR(SHARE_OFFERED,'99.00000000')SHARE_OFFERED,TO_CHAR(SHARE_WRITTEN,'99.00000000')SHARE_WRITTEN,TO_CHAR(SHARE_PROPOSAL_WRITTEN,'99.00000000')SHARE_PROPOSAL_WRITTEN,TO_CHAR(SHARE_SIGNED,'99.00000000')SHARE_SIGNED,TO_CHAR(BROKERAGE,'99.00000000') BROKERAGE_PER,(SELECT STATUS_NAME FROM STATUS_MASTER WHERE STATUS_CODE=P.STATUS AND BRANCH_CODE=P.BRANCH_CODE)STATUS,TO_CHAR(WRITTEN_LINE_VALIDITY,'DD/MM/YYYY')WRITTEN_LINE_VALIDITY,WRITTEN_LINE_REMARKS,TO_CHAR(SHARE_LINE_VALIDITY,'DD/MM/YYYY')SHARE_LINE_VALIDITY,SHARE_LINE_REMARKS,SHARE_PROPOSED_SIGNED,NVL(D.MAIL_STATUS,'Pending')MAIL_STATUS,(SELECT OFFER_NO FROM POSITION_MASTER WHERE PROPOSAL_NO=P.PROPOSAL_NO AND BRANCH_CODE=P.BRANCH_CODE)OFFER_NO,P.PLACEMENT_AMEND_ID from TTRN_RI_PLACEMENT P LEFT JOIN MAIL_NOTIFICATION_DETAIL D ON (D.PROPOSAL_NO=P.PROPOSAL_NO AND D.REINSURER_ID=P.REINSURER_ID AND D.BROKER_ID=P.BROKER_ID AND MAIL_TYPE=P.STATUS  AND MAIL_RECORD_NO=(SELECT  MAX(MAIL_RECORD_NO) FROM MAIL_NOTIFICATION_DETAIL WHERE PROPOSAL_NO=P.PROPOSAL_NO AND REINSURER_ID=P.REINSURER_ID AND BROKER_ID=P.BROKER_ID AND MAIL_TYPE=P.STATUS)) WHERE P.BRANCH_CODE=? AND P.PROPOSAL_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID)
GET_PLACING_BOUQUET_LIST=SELECT  DISTINCT P.SNO, P.BOUQUET_NO,P.REINSURER_ID,P.BROKER_ID,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='R'  AND CUSTOMER_ID=P.REINSURER_ID AND BRANCH_CODE=P.BRANCH_CODE  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='B'  AND CUSTOMER_ID=P.BROKER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,P.SHARE_OFFERED,NVL(M.MAIL_STATUS,'Pending')MAIL_STATUS,(SELECT CASE WHEN COUNT(*)>0 THEN 'N' ELSE 'Y' END  FROM TTRN_RI_PLACEMENT WHERE PROPOSAL_NO=P.PROPOSAL_NO AND REINSURER_ID = P.REINSURER_ID AND BROKER_ID = P.BROKER_ID AND STATUS<>'O')OFFER_STATUS  from TTRN_RI_PLACEMENT  P LEFT JOIN MAIL_NOTIFICATION_DETAIL M ON(M.PROPOSAL_NO=P.PROPOSAL_NO AND M.REINSURER_ID=P.REINSURER_ID AND M.BROKER_ID=P.BROKER_ID)  WHERE P.BRANCH_CODE=? AND P.BOUQUET_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID) ORDER BY SNO
GET_PLACING_BASELAYER_LIST=SELECT  DISTINCT P.SNO, P.BOUQUET_NO,P.REINSURER_ID,P.BROKER_ID,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='R'  AND CUSTOMER_ID=P.REINSURER_ID AND BRANCH_CODE=P.BRANCH_CODE  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(select CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME from personal_info PI where customer_type='B'  AND CUSTOMER_ID=P.BROKER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,P.SHARE_OFFERED,NVL(M.MAIL_STATUS,'Pending')MAIL_STATUS,(SELECT CASE WHEN COUNT(*)>0 THEN 'N' ELSE 'Y' END  FROM TTRN_RI_PLACEMENT WHERE PROPOSAL_NO=P.PROPOSAL_NO AND REINSURER_ID = P.REINSURER_ID AND BROKER_ID = P.BROKER_ID AND STATUS<>'O')OFFER_STATUS  from TTRN_RI_PLACEMENT  P LEFT JOIN MAIL_NOTIFICATION_DETAIL M ON(M.PROPOSAL_NO=P.PROPOSAL_NO AND M.REINSURER_ID=P.REINSURER_ID AND M.BROKER_ID=P.BROKER_ID)  WHERE P.BRANCH_CODE=? AND P.BASE_PROPOSAL_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID) ORDER BY SNO
GET_PLACING_LIST=SELECT DISTINCT P.SNO,P.PROPOSAL_NO,P.CEDING_COMPANY_ID,P.REINSURER_ID,P.BROKER_ID,(SELECT CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_TYPE='R'  AND CUSTOMER_ID=P.REINSURER_ID AND BRANCH_CODE=P.BRANCH_CODE  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(SELECT CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_TYPE='B'  AND CUSTOMER_ID=P.BROKER_ID AND BRANCH_CODE=P.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,P.SHARE_OFFERED,P.PLACEMENT_AMEND_ID,(SELECT  STATUS_NAME FROM STATUS_MASTER WHERE STATUS_CODE=P.STATUS AND BRANCH_CODE=P.BRANCH_CODE)STATUS,NVL(M.MAIL_STATUS,'Pending')MAIL_STATUS,(SELECT CASE WHEN COUNT(*)>0 THEN 'N' ELSE 'Y' END  FROM TTRN_RI_PLACEMENT WHERE PROPOSAL_NO=P.PROPOSAL_NO AND REINSURER_ID = P.REINSURER_ID AND BROKER_ID = P.BROKER_ID AND STATUS<>'O')OFFER_STATUS  FROM TTRN_RI_PLACEMENT  P LEFT JOIN MAIL_NOTIFICATION_DETAIL M ON(M.PROPOSAL_NO=P.PROPOSAL_NO AND M.REINSURER_ID=P.REINSURER_ID AND M.BROKER_ID=P.BROKER_ID)  WHERE P.BRANCH_CODE=? AND P.PROPOSAL_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID) ORDER BY SNO
GET_CORRESPONDENT_SEQ=SELECT  CORRESPONDENT_SEQ.NEXTVAL seqval FROM DUAL
NEW_CONTRACT_PL_SUMMARY=SELECT DISTINCT PM.OFFER_NO,NVL(PM.BASE_LAYER,PM.PROPOSAL_NO) BASE_PROPOSAL,PM.PROPOSAL_NO,TRD.RSK_TREATYID TREATY_NAME,DECODE(PM.PRODUCT_ID,2,PM.SECTION_NO,PM.LAYER_NO) LAYER_SECTION,TRP.SNO,(SELECT CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_TYPE='R'  AND CUSTOMER_ID=TRP.REINSURER_ID AND BRANCH_CODE=TRP.BRANCH_CODE  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))REINSURER_NAME,(SELECT CASE WHEN PI.CUSTOMER_TYPE = 'C' THEN PI.COMPANY_NAME ELSE PI.FIRST_NAME || ' ' || PI.LAST_NAME END NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_TYPE='B'  AND CUSTOMER_ID=TRP.BROKER_ID AND BRANCH_CODE=TRP.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID))BROKER_NAME,(SELECT SHORT_NAME FROM CURRENCY_MASTER CM WHERE CM.CURRENCY_ID = TRD.RSK_ORIGINAL_CURR  AND CM.BRANCH_CODE = PM.BRANCH_CODE  AND CM.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER CM1  WHERE CM.BRANCH_CODE = CM1.BRANCH_CODE AND CM.CURRENCY_ID = CM1.CURRENCY_ID)) CURRENCY,CASE WHEN PM.PRODUCT_ID = 2 THEN TR.RSK_EPI_EST_OC WHEN PM.PRODUCT_ID = 3 THEN TR.RSK_SUBJ_PREMIUM_OC END EPI_100_OC,CASE WHEN PM.PRODUCT_ID = 2 THEN TR.RSK_EPI_EST_DC WHEN PM.PRODUCT_ID = 3 THEN TR.RSK_SUBJ_PREMIUM_DC END EPI_100_DC,NVL(TRPS.NEW_STATUS,TRP.STATUS) PLACING_STATUS,NVL(TRP.SHARE_SIGNED,0) SHARE_SIGNED,NVL(TRP.BROKERAGE,0) BROKERAGE,ROUND((CASE WHEN PM.PRODUCT_ID = 2 THEN TR.RSK_EPI_EST_DC WHEN PM.PRODUCT_ID = 3 THEN TR.RSK_SUBJ_PREMIUM_DC END)*(NVL(TRP.BROKERAGE,0)/100)*(NVL(TRP.SHARE_SIGNED,0)/100),2) BROKERAGE_AMT FROM POSITION_MASTER PM,TTRN_RI_PLACEMENT TRP,TTRN_RI_PLACEMENT_STATUS TRPS,TTRN_RISK_DETAILS TRD,TTRN_RISK_PROPOSAL TR WHERE PM.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM.BRANCH_CODE = PM1.BRANCH_CODE AND PM.PROPOSAL_NO   = PM1.PROPOSAL_NO) AND PM.BRANCH_CODE = TRP.BRANCH_CODE  AND PM.PROPOSAL_NO = TRP.PROPOSAL_NO AND TRP.STATUS_NO IN (SELECT MAX(STATUS_NO) FROM TTRN_RI_PLACEMENT TRP1 WHERE TRP.PROPOSAL_NO = TRP1.PROPOSAL_NO AND TRP.SNO = TRP1.SNO AND TRP.BRANCH_CODE = TRP1.BRANCH_CODE) AND PM.PROPOSAL_NO = TRPS.PROPOSAL_NO (+)  AND TRP.SNO = TRPS.SNO (+) AND TRP.STATUS_NO = TRPS.STATUS_NO (+)  AND PM.BRANCH_CODE = TRD.BRANCH_CODE AND PM.PROPOSAL_NO = TRD.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TRD.RSK_ENDORSEMENT_NO AND PM.BRANCH_CODE = TR.BRANCH_CODE AND PM.PROPOSAL_NO = TR.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID = TR.RSK_ENDORSEMENT_NO AND PM.BRANCH_CODE = ? AND PM.PROPOSAL_NO=?
GET_MAX_SECTION_NO_DET=SELECT NVL(MAX(SECTION_NO)+1,1)SECTION_NO from POSITION_MASTER PM WHERE NVL(BASE_LAYER,PROPOSAL_NO)=?
BONUS_MAIN_SELECT_REFERENCE = SELECT PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,LCB_FROM,LCB_TO,LCB_PERCENTAGE,USERID,BRANCH,LCB_ID,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,QUOTA_SHARE,REMARKS,FIRST_PROFIT_COMM,FPC_DURATION_TYPE,SUB__PROFIT_COMM,SPC_DURATION_TYPE,SUB_SEC_CAL,REFERENCE_NO,SCALE_MAX_PART_PERCENT,FPC_TYPE,TO_CHAR(FPC_FIXED_DATE,'DD/MM/YYYY')FPC_FIXED_DATE FROM TTRN_BONUS TT WHERE REFERENCE_NO =?  and BRANCH=? and TYPE=? AND LCB_TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.REFERENCE_NO=TB.REFERENCE_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE AND TT.LCB_TYPE= TB.LCB_TYPE) ORDER BY LCB_ID
BONUS_MAIN_SELECT = SELECT PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,LCB_FROM,LCB_TO,LCB_PERCENTAGE,USERID,BRANCH,LCB_ID,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,QUOTA_SHARE,REMARKS,FIRST_PROFIT_COMM,FPC_DURATION_TYPE,SUB__PROFIT_COMM,SPC_DURATION_TYPE,SUB_SEC_CAL,REFERENCE_NO,SCALE_MAX_PART_PERCENT,FPC_TYPE,TO_CHAR(FPC_FIXED_DATE,'DD/MM/YYYY')FPC_FIXED_DATE FROM TTRN_BONUS TT WHERE PROPOSAL_NO =?  and BRANCH=? and TYPE=? AND LCB_TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.PROPOSAL_NO=TB.PROPOSAL_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE AND TT.LCB_TYPE= TB.LCB_TYPE) ORDER BY LCB_ID
SELECT_SLIDING_SCALE_METHOD_INFO=SELECT PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,PROVISIONAL_COMMISIION,SC_METHOD_TYPE,SC_MIN_LOSS_RATIO,SC_MAX_LOSS_RATIO,SC_COMBINE_LOSS_RATIO,SC_BANDING_STEP,SC_NO_OF_DIGIT,USERID,BRANCH,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,REMARKS,REFERENCE_NO,LCB_FROM,LCB_TO,DELTA_LOSS_RATIO,LCB_PERCENTAGE FROM TTRN_BONUS TT WHERE PROPOSAL_NO =?  and BRANCH=? and TYPE=? AND LCB_TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.PROPOSAL_NO=TB.PROPOSAL_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE AND TT.LCB_TYPE= TB.LCB_TYPE) ORDER BY LCB_ID
SELECT_SLIDING_SCALE_METHOD_INFO_REF=SELECT PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,PROVISIONAL_COMMISIION,SC_METHOD_TYPE,SC_MIN_LOSS_RATIO,SC_MAX_LOSS_RATIO,SC_COMBINE_LOSS_RATIO,SC_BANDING_STEP,SC_NO_OF_DIGIT,USERID,BRANCH,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,REMARKS,REFERENCE_NO,LCB_FROM,LCB_TO,DELTA_LOSS_RATIO,LCB_PERCENTAGE FROM TTRN_BONUS TT WHERE PROPOSAL_NO =?  and BRANCH=? and TYPE=? AND LCB_TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.PROPOSAL_NO=TB.PROPOSAL_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE AND TT.LCB_TYPE= TB.LCB_TYPE) ORDER BY LCB_ID
GET_REFERENCE_NO_SEQ=SELECT  REFERENCENO_SEQ.NEXTVAL REFERENCENO FROM DUAL
INSERT_SC_METHOD_INFO=INSERT INTO TTRN_BONUS(PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,PROVISIONAL_COMMISIION,SC_METHOD_TYPE,SC_MIN_LOSS_RATIO,SC_MAX_LOSS_RATIO,SC_COMBINE_LOSS_RATIO,SC_BANDING_STEP,SC_NO_OF_DIGIT,USERID,BRANCH,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,REMARKS,REFERENCE_NO,LCB_FROM,LCB_TO,DELTA_LOSS_RATIO,LCB_PERCENTAGE)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?)
risk.select.getEditModeData= SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID , DE.RSK_POLBRANCH, DE.RSK_CEDINGID, DE.RSK_BROKERID, DE.RSK_TREATYID, TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_PERIOD_OF_NOTICE, DE. RSK_RISK_COVERED, DE. RSK_TERRITORY_SCOPE, DE.RSK_TERRITORY,DE.RSK_ENTRY_DATE, DE. RSK_END_DATE, DE. RSK_STATUS, DE.RSK_REMARKS,PR.RSK_LIMIT_OC,PR.RSK_EPI_OFFER_OC,PR.RSK_EPI_ESTIMATE,PR.RSK_EPI_EST_OC,PR.RSK_XLCOST_OC,PR.RSK_CEDANT_RETENTION,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.RSK_RECEIPT_STATEMENT,DE.RSK_RECEIPT_PAYEMENT,DE.RETRO_CESSIONARIES,PR.RSK_CEDRET_TYPE,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,PR.RSK_MAX_LMT_COVER,DE.RSK_RETRO_TYPE,DE.RSK_INSURED_NAME,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,DE.INWARD_BUS_TYPE,DE.TREATYTYPE,PR.RSK_TREATY_SURP_LIMIT_OC,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,PR.RSK_TREATY_SURP_LIMIT_DC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RSK_NO_OF_LINE,PR.RSK_PML,PR.RSK_PML_PERCENT,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED, DE.RS_ENDORSEMENT_TYPE,DE.RSK_RUN_OFF_YEAR,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.BASE_LAYER,DE.RSK_CESSION_EXG_RATE,DE.RSK_FIXED_RATE,PM.RSK_DUMMY_CONTRACT,DE.RETENTIONYN,PM.DATA_MAP_CONT_NO,PM.Bouquet_Mode_YN,PM.Bouquet_No,PM.UW_YEAR_TO,PR.RISK_DET_YN,PR.BROKER_DET_YN,PR.COVER_DET_YN,PR.PREMIUM_DET_YN,PR.ACQCOST_DET_YN,PR.COMM_DET_YN,PR.DEPOSIT_DET_YN,PR.LOSS_DET_YN,PR.DOC_DET_YN,PR.PAYMENT_PARTNER,PM.SECTION_NO,PR.QUOTESHARE_PERCENT,DE.RSK_ACCOUNT_PERIOD_NOTICE,DE.RSK_STATEMENT_CONFIRM,PM.OFFER_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM
risk.select.getEditModeContCond=WHERE DE.RSK_CONTRACT_NO=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(B.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL B, TTRN_RISK_DETAILS A WHERE A.RSK_CONTRACT_NO=? AND A.RSK_PROPOSAL_NUMBER=B.RSK_PROPOSAL_NUMBER ) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeData1 = SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID , DE.RSK_POLBRANCH, DE.RSK_CEDINGID, DE.RSK_BROKERID, DE.RSK_TREATYID, TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_PERIOD_OF_NOTICE, DE. RSK_RISK_COVERED, DE. RSK_TERRITORY_SCOPE, DE.RSK_TERRITORY,DE.RSK_ENTRY_DATE, DE. RSK_END_DATE, DE. RSK_STATUS, DE.RSK_REMARKS,PR.RSK_LIMIT_OC,PR.RSK_EPI_OFFER_OC,PR.RSK_EPI_ESTIMATE,PR.RSK_EPI_EST_OC,PR.RSK_XLCOST_OC,PR.RSK_CEDANT_RETENTION,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.RSK_RECEIPT_STATEMENT,DE.RSK_RECEIPT_PAYEMENT,DE.RETRO_CESSIONARIES,PR.RSK_CEDRET_TYPE,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,PR.RSK_MAX_LMT_COVER,DE.RSK_RETRO_TYPE,DE.RSK_INSURED_NAME,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,DE.INWARD_BUS_TYPE,DE.TREATYTYPE,PR.RSK_TREATY_SURP_LIMIT_OC,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,PR.RSK_TREATY_SURP_LIMIT_DC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RSK_NO_OF_LINE,PR.RSK_PML,PR.RSK_PML_PERCENT,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED, DE.RS_ENDORSEMENT_TYPE,DE.RSK_RUN_OFF_YEAR,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.BASE_LAYER,DE.RSK_CESSION_EXG_RATE,DE.RSK_FIXED_RATE,PM.RSK_DUMMY_CONTRACT,DE.RETENTIONYN,PM.DATA_MAP_CONT_NO,PM.Bouquet_Mode_YN,PM.Bouquet_No,PM.UW_YEAR_TO,PR.RISK_DET_YN,PR.BROKER_DET_YN,PR.COVER_DET_YN,PR.PREMIUM_DET_YN,PR.ACQCOST_DET_YN,PR.COMM_DET_YN,PR.DEPOSIT_DET_YN,PR.LOSS_DET_YN,PR.DOC_DET_YN,PR.PAYMENT_PARTNER,PM.SECTION_NO,PR.QUOTESHARE_PERCENT,DE.RSK_ACCOUNT_PERIOD_NOTICE,DE.RSK_STATEMENT_CONFIRM,PM.OFFER_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM WHERE DE.RSK_CONTRACT_NO=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_CONTRACT_NO=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(B.RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL B, TTRN_RISK_DETAILS A WHERE A.RSK_CONTRACT_NO=? AND A.RSK_PROPOSAL_NUMBER=B.RSK_PROPOSAL_NUMBER ) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeProCond=WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getEditModeData2 = SELECT DE.RSK_PROPOSAL_NUMBER, DE.RSK_ENDORSEMENT_NO, DE.RSK_CONTRACT_NO, DE.RSK_LAYER_NO,RSK_PRODUCTID,RSK_DEPTID,RSK_PFCID, RSK_SPFCID , DE.RSK_POLBRANCH, DE.RSK_CEDINGID, DE.RSK_BROKERID, DE.RSK_TREATYID, TO_CHAR(DE.RSK_MONTH,'DD/MM/YYYY') RSK_MONTH, DE.RSK_UWYEAR, DE.RSK_UNDERWRITTER,TO_CHAR(DE.RSK_INCEPTION_DATE,'DD/MM/YYYY') RSK_INCEPTION_DATE,TO_CHAR(DE.RSK_EXPIRY_DATE,'DD/MM/YYYY') RSK_EXPIRY_DATE,TO_CHAR(DE.RSK_ACCOUNT_DATE,'DD/MM/YYYY') RSK_ACCOUNT_DATE, DE.RSK_ORIGINAL_CURR, DE.RSK_EXCHANGE_RATE,DE.RSK_BASIS, DE.RSK_PERIOD_OF_NOTICE, DE. RSK_RISK_COVERED, DE. RSK_TERRITORY_SCOPE, DE.RSK_TERRITORY,DE.RSK_ENTRY_DATE, DE. RSK_END_DATE, DE. RSK_STATUS, DE.RSK_REMARKS,PR.RSK_LIMIT_OC,PR.RSK_EPI_OFFER_OC,PR.RSK_EPI_ESTIMATE,PR.RSK_EPI_EST_OC,PR.RSK_XLCOST_OC,PR.RSK_CEDANT_RETENTION,PR.RSK_SHARE_WRITTEN,PR.RSK_SHARE_SIGNED,DE.RSK_PROPOSAL_TYPE,DE.RSK_ACCOUNTING_PERIOD,DE.RSK_RECEIPT_STATEMENT,DE.RSK_RECEIPT_PAYEMENT,DE.RETRO_CESSIONARIES,PR.RSK_CEDRET_TYPE,PR.RSK_SP_RETRO,PR.RSK_NO_OF_INSURERS,PR.RSK_MAX_LMT_COVER,DE.RSK_RETRO_TYPE,DE.RSK_INSURED_NAME,DE.OLD_CONTRACTNO,PM.LOGIN_ID,PR.LIMIT_PER_VESSEL_OC,PR.LIMIT_PER_VESSEL_DC,PR.LIMIT_PER_LOCATION_OC,PR.LIMIT_PER_LOCATION_DC,DE.INWARD_BUS_TYPE,DE.TREATYTYPE,PR.RSK_TREATY_SURP_LIMIT_OC,PR.RSK_TRTY_LMT_PML_OC,PR.RSK_TRTY_LMT_SUR_PML_OC,PR.RSK_TRTY_LMT_OURASS_PML_OC,PR.RSK_TREATY_SURP_LIMIT_DC,DE.COUNTRIES_INCLUDE,DE.COUNTRIES_EXCLUDE,DE.RSK_NO_OF_LINE,PR.RSK_PML,PR.RSK_PML_PERCENT,DE.RSK_PERILS_COVERED,DE.RSK_LOC_ISSUED, DE.RS_ENDORSEMENT_TYPE,DE.RSK_RUN_OFF_YEAR,DE.RSK_LOC_BNK_NAME,DE.RSK_LOC_CRDT_PRD,DE.RSK_LOC_CRDT_AMT,DE.RSK_LOC_BENFCRE_NAME,PM.BASE_LAYER,DE.RSK_CESSION_EXG_RATE,DE.RSK_FIXED_RATE,PM.RSK_DUMMY_CONTRACT,DE.RETENTIONYN,PM.DATA_MAP_CONT_NO,PM.Bouquet_Mode_YN,PM.Bouquet_No,PM.UW_YEAR_TO,PR.RISK_DET_YN,PR.BROKER_DET_YN,PR.COVER_DET_YN,PR.PREMIUM_DET_YN,PR.ACQCOST_DET_YN,PR.COMM_DET_YN,PR.DEPOSIT_DET_YN,PR.LOSS_DET_YN,PR.DOC_DET_YN,PR.PAYMENT_PARTNER,PM.SECTION_NO,PR.QUOTESHARE_PERCENT,DE.RSK_ACCOUNT_PERIOD_NOTICE,DE.RSK_STATEMENT_CONFIRM,PM.OFFER_NO FROM TTRN_RISK_DETAILS DE,TTRN_RISK_PROPOSAL PR,POSITION_MASTER PM WHERE DE.RSK_PROPOSAL_NUMBER=? AND DE.RSK_PROPOSAL_NUMBER=PR.RSK_PROPOSAL_NUMBER AND DE.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=?) AND PR.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER=?) AND PM.PROPOSAL_NO=DE.RSK_PROPOSAL_NUMBER AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getSectionDupcheckByProNo=SELECT SECTION_NO FROM POSITION_MASTER PM WHERE  SECTION_NO=? AND PROPOSAL_NO!=? AND NVL(BASE_LAYER,PROPOSAL_NO)=?  AND contract_status='P' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getSectionDupcheckByBaseLayer=SELECT SECTION_NO  FROM POSITION_MASTER WHERE  SECTION_NO=? AND NVL(BASE_LAYER,PROPOSAL_NO)=? AND contract_status='P'
risk.select.getSectionDupcheckByBaseLayer=SELECT SECTION_NO  FROM POSITION_MASTER WHERE  SECTION_NO=? AND NVL(BASE_LAYER,PROPOSAL_NO)=? AND contract_status='P'
risk.select.chechProposalStatus=SELECT B.RSK_STATUS,A.RSK_SHARE_SIGNED,B.RSK_CONTRACT_NO FROM TTRN_RISK_PROPOSAL A, TTRN_RISK_DETAILS B WHERE A.RSK_PROPOSAL_NUMBER = B.RSK_PROPOSAL_NUMBER AND A.RSK_PROPOSAL_NUMBER =? AND A.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER =? ) AND B.RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER =? )
GET_BASE_LAYER_DETAILS=SELECT PROPOSAL_NO,BASE_LAYER,CONTRACT_NO,CONTRACT_STATUS FROM POSITION_MASTER PM WHERE PRODUCT_ID=? AND BRANCH_CODE=? AND PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
GET_BASE_LAYER_DETAILS=SELECT PROPOSAL_NO,BASE_LAYER,CONTRACT_NO,CONTRACT_STATUS FROM POSITION_MASTER PM WHERE PRODUCT_ID=? AND BRANCH_CODE=? AND PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.update.contNo=UPDATE TTRN_RISK_DETAILS SET RSK_CONTRACT_NO=? WHERE RSK_PROPOSAL_NUMBER=?
risk.update.homeContNo=UPDATE POSITION_MASTER SET CONTRACT_NO\=?,PROPOSAL_STATUS\=?,CONTRACT_STATUS\=? WHERE PROPOSAL_NO\=?
risk.update.mndInstallments=UPDATE TTRN_MND_INSTALLMENTS SET  CONTRACT_NO\=? where PROPOSAL_NO\=?
risk.update.homeContNo=UPDATE POSITION_MASTER SET CONTRACT_NO\=?,PROPOSAL_STATUS\=?,CONTRACT_STATUS\=? WHERE PROPOSAL_NO\=? 
risk.select.endo=SELECT  MAX(RSK_ENDORSEMENT_NO) RSK_ENDORSEMENT_NO FROM TTRN_RISK_PROPOSAL WHERE RSK_PROPOSAL_NUMBER \=? 
risk.update.pro24ContSecPage=UPDATE TTRN_RISK_PROPOSAL SET RSK_LIMIT_OS_OC =?,RSK_LIMIT_OS_DC=?,RSK_EPI_OSOF_OC=?,RSK_EPI_OSOF_DC=?,RSK_EPI_OSOE_OC=?,RSK_EPI_OSOE_DC=?,RSK_XLCOST_OS_OC=?,RSK_XLCOST_OS_DC=?,RSK_PREMIUM_QUOTA_SHARE=?,RSK_PREMIUM_SURPULS=?,RSK_PREMIUM_QUOTA_SHARE_DC=?,RSK_PREMIUM_SURPLUS_DC=?,COMM_QS_AMT=?,COMM_SURPLUS_AMT=?,COMM_QS_AMT_DC=?,COMM_SURPLUS_AMT_DC=?  WHERE  RSK_ENDORSEMENT_NO=? AND RSK_PROPOSAL_NUMBER =?
risk.update.pro2SecComm=UPDATE TTRN_RISK_COMMISSION SET RSK_BROKERAGE\=?,RSK_TAX\=?,RSK_PROFIT_COMM\=?,RSK_ACQUISTION_COST_OC\=?,RSK_ACQUISTION_COST_DC\=?,RSK_COMM_QUOTASHARE\=?,RSK_COMM_SURPLUS\=?,RSK_OVERRIDER_PERC\=?,RSK_PREMIUM_RESERVE\=?,RSK_LOSS_RESERVE\=?,RSK_INTEREST\=?,RSK_PF_INOUT_PREM\=?,RSK_PF_INOUT_LOSS\=?,RSK_LOSSADVICE\=?,RSK_CASHLOSS_LMT_OC\=?,RSK_CASHLOSS_LMT_DC\=?,RSK_LEAD_UW\=?,RSK_LEAD_UW_SHARE\=?,RSK_ACCOUNTS\=?,RSK_EXCLUSION\=?,RSK_REMARKS\=?,RSK_UW_RECOMM\=?,RSK_GM_APPROVAL\=?,RSK_OTHER_COST\=?,RSK_CREASTA_STATUS\=?,RSK_EVENT_LIMIT_OC\=?,RSK_EVENT_LIMIT_DC\=?,RSK_AGGREGATE_LIMIT_OC\=?,RSK_AGGREGATE_LIMIT_DC\=?,RSK_OCCURRENT_LIMIT_OC\=?,RSK_OCCURRENT_LIMIT_DC\=?,RSK_SLADSCALE_COMM\=?,RSK_LOSS_PART_CARRIDOR\=?,RSK_COMBIN_SUB_CLASS\=?,SUB_CLASS\=?,LOGIN_ID\=?,BRANCH_CODE\=?,SYS_DATE\=SYSDATE,RSK_LEAD_UNDERWRITER_COUNTRY\=?,RSK_INCLUDE_ACQ_COST\=?,RSK_OUR_ASS_ACQ_COST\=?,RSK_OUR_ACQ_OUR_SHARE_OC\=?,RSK_LOSS_COMBIN_SUB_CLASS\=?,RSK_SLIDE_COMBIN_SUB_CLASS\=?,RSK_CRESTA_COMBIN_SUB_CLASS\=?,RSK_PRO_MANAGEMENT_EXP\=?, RSK_PRO_COMM_TYPE\=?, RSK_PRO_COMM_PER\=?, RSK_PRO_SET_UP\=?, RSK_PRO_SUP_PRO_COM\=?, RSK_PRO_LOSS_CARY_TYPE\=?, RSK_PRO_LOSS_CARY_YEAR\=?, RSK_PRO_PROFIT_CARY_TYPE\=?, RSK_PRO_PROFIT_CARY_YEAR\=?, RSK_PRO_FIRST_PFO_COM\=?, RSK_PRO_FIRST_PFO_COM_PRD\=?, RSK_PRO_SUB_PFO_COM_PRD\=?, RSK_PRO_SUB_PFO_COM\=?, RSK_PRO_SUB_SEQ_CAL\=?, RSK_PRO_NOTES\=?,RSK_DOC_STATUS\=?,RSK_RATE\=?,RSK_PREMIUM_RES_TYPE=?,FPC_TYPE=?,FPC_FIXED_DATE=TO_DATE(?,'DD/MM/YYYY'),RSK_PORTFOLIO_TYPE=? WHERE RSK_PROPOSAL_NUMBER\=? AND RSK_ENDORSEMENT_NO\=?
INSERT_RI_DETAILS=INSERT INTO TTRN_RI(RI_NO,STATUS_NO,SNO,BOUQUET_NO,BASE_PROPOSAL_NO,PROPOSAL_NO,CONTRACT_NO,SUB_CONTRACT_NO,LAYER_NO,SECTION_NO,AMEND_ID,REINSURER_ID,BROKER_ID,SHARE_OFFERED,SHARE_WRITTEN,SHARE_PROPOSAL_WRITTEN,SHARE_SIGNED,SHARE_PROPOSED_SIGNED,BROKERAGE,CURRENT_STATUS,NEW_STATUS,APPROVE_STATUS,USER_ID,BRANCH_CODE,SYS_DATE)VALUES(NVL((SELECT MAX(RI_NO+1) FROM TTRN_RI),1),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
UPDATE_RI_CONTRACT=UPDATE TTRN_RI_PLACEMENT P SET CONTRACT_NO=?,AMEND_ID=? WHERE PROPOSAL_NO=? AND REINSURER_ID=? AND BROKER_ID=? AND BRANCH_CODE=? AND STATUS_NO=?
UPDATE_MAIL_CONTRACT=UPDATE MAIL_NOTIFICATION_DETAIL SET CONTRACT_NO=? WHERE PROPOSAL_NO=? AND REINSURER_ID=? AND BROKER_ID=? AND BRANCH_CODE=? AND STATUS_NO=?
UPDATE_SHARE_SHIGN=UPDATE TTRN_RISK_PROPOSAL TRP SET RSK_SHARE_SIGNED=(SELECT SUM(SHARE_SIGNED) FROM TTRN_RI WHERE PROPOSAL_NO=TRP.RSK_PROPOSAL_NUMBER) WHERE RSK_PROPOSAL_NUMBER=?
risk.select.getLayerDupcheckByProNo=SELECT LAYER_NO FROM POSITION_MASTER PM WHERE  LAYER_NO=? AND PROPOSAL_NO!=? AND NVL(BASE_LAYER,PROPOSAL_NO)=?  AND contract_status='P' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO)
risk.select.getLayerDupcheckByBaseLayer=SELECT LAYER_NO  FROM POSITION_MASTER WHERE  LAYER_NO=? AND NVL(BASE_LAYER,PROPOSAL_NO)=? AND contract_status='P'
risk.select.getLayerDupcheckByBaseLayer=SELECT LAYER_NO  FROM POSITION_MASTER WHERE  LAYER_NO=? AND NVL(BASE_LAYER,PROPOSAL_NO)=? AND contract_status='P'
REINSTATEMENT_MAIN_SELECT_A_REFERENCE = SELECT REINSTATEMENT,REINST_NO,REINST_TYPE,AMOUNT_PERCENT,MIN_AMOUNT_PERCENT,MIN_TIME_PERCENT FROM TTRN_RIP T WHERE REFERENCE_NO=? AND BRANCH_CODE=? AND SECTION_TYPE='A' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TTRN_RIP TRA WHERE TRA.REFERENCE_NO=T.REFERENCE_NO AND TRA.BRANCH_CODE=T.BRANCH_CODE) ORDER BY REINST_NO
REINSTATEMENT_COUNT_MAIN_REFERENCE = SELECT COUNT(REINST_NO) COUNT FROM TTRN_RIP WHERE REFERENCE_NO=? AND BRANCH_CODE=? AND AMEND_ID=?

REINSTATEMENT_MAIN_DELETE_REF =DELETE FROM TTRN_RIP WHERE REFERENCE_NO=? AND BRANCH_CODE=?
BONUS_COUNT_MAIN_REFERENCE = SELECT count(LCB_FROM) COUNT FROM TTRN_BONUS WHERE REFERENCE_NO \=?  and BRANCH\=?  AND TYPE\=? and ENDORSEMENT_NO\=? and LAYERNO \=?
BONUS_MAIN_SELECT_REFERENCE = SELECT PROPOSAL_NO,CONTRACT_NO,PRODUCT_ID,LCB_TYPE,LCB_FROM,LCB_TO,LCB_PERCENTAGE,USERID,BRANCH,LCB_ID,TYPE,ENDORSEMENT_NO,SUB_CLASS,SYS_DATE,LAYERNO,QUOTA_SHARE,REMARKS,FIRST_PROFIT_COMM,FPC_DURATION_TYPE,SUB__PROFIT_COMM,SPC_DURATION_TYPE,SUB_SEC_CAL,REFERENCE_NO,SCALE_MAX_PART_PERCENT,FPC_TYPE,TO_CHAR(FPC_FIXED_DATE,'DD/MM/YYYY')FPC_FIXED_DATE FROM TTRN_BONUS TT WHERE REFERENCE_NO =?  and BRANCH=? and TYPE=? AND LCB_TYPE=? AND ENDORSEMENT_NO = (SELECT MAX(ENDORSEMENT_NO) FROM TTRN_BONUS TB WHERE TT.REFERENCE_NO=TB.REFERENCE_NO AND TT.BRANCH=TB.BRANCH AND TT.TYPE= TB.TYPE AND TT.LCB_TYPE= TB.LCB_TYPE) ORDER BY LCB_ID
GET_LAYER_CONTRACT_INFO=SELECT OFFER_NO,LAYER_NO,PROPOSAL_NO,CEDING_COMPANY_ID,NVL(BASE_LAYER,PROPOSAL_NO)BASE_LAYER,CONTRACT_NO,DEPT_ID,PRODUCT_ID,SECTION_NO,(SELECT TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER B WHERE RD.RSK_DEPTId = b.TMAS_DEPARTMENT_ID AND b.TMAS_PRODUCT_ID = PM.PRODUCT_ID AND B.BRANCH_CODE=PM.BRANCH_CODE   AND B.TMAS_STATUS='Y')TMAS_DEPARTMENT_NAME,(SELECT DETAIL_NAME FROM  CONSTANT_DETAIL WHERE CATEGORY_ID=DECODE(PM.PRODUCT_ID,'2','43','29') AND TYPE=DECODE(PM.PRODUCT_ID,'2',RD.TREATYTYPE,RD.RSK_BUSINESS_TYPE))TREATY_TYPE,RD.RSK_TREATYID FROM POSITION_MASTER PM,TTRN_RISK_DETAILS RD WHERE  PM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER AND (PROPOSAL_NO=? OR BASE_LAYER=?)  AND contract_status in('A') AND  AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO AND BRANCH_CODE=PM.BRANCH_CODE) AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER AND BRANCH_CODE=RD.BRANCH_CODE) ORDER BY PRODUCT_ID,BASE_LAYER,PROPOSAL_NO
GET_LAYER_INFO=SELECT OFFER_NO,LAYER_NO,PROPOSAL_NO,CEDING_COMPANY_ID,NVL(BASE_LAYER,PROPOSAL_NO)BASE_LAYER,CONTRACT_NO,DEPT_ID,PRODUCT_ID,SECTION_NO,(SELECT TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER B WHERE RD.RSK_DEPTId = b.TMAS_DEPARTMENT_ID AND b.TMAS_PRODUCT_ID = PM.PRODUCT_ID AND B.BRANCH_CODE=PM.BRANCH_CODE   AND B.TMAS_STATUS='Y')TMAS_DEPARTMENT_NAME,(SELECT DETAIL_NAME FROM  CONSTANT_DETAIL WHERE CATEGORY_ID=DECODE(PM.PRODUCT_ID,'2','43','29') AND TYPE=DECODE(PM.PRODUCT_ID,'2',RD.TREATYTYPE,RD.RSK_BUSINESS_TYPE))TREATY_TYPE,RD.RSK_TREATYID FROM POSITION_MASTER PM,TTRN_RISK_DETAILS RD WHERE  PM.PROPOSAL_NO=RD.RSK_PROPOSAL_NUMBER AND (PROPOSAL_NO=? OR BASE_LAYER=?)  AND contract_status in('P') AND  AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=PM.PROPOSAL_NO AND BRANCH_CODE=PM.BRANCH_CODE) AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS WHERE RSK_PROPOSAL_NUMBER=RD.RSK_PROPOSAL_NUMBER AND BRANCH_CODE=RD.BRANCH_CODE) ORDER BY PRODUCT_ID,BASE_LAYER,PROPOSAL_NO
CANCEL_OLD_PROPOSAL =UPDATE POSITION_MASTER pm SET RENEWAL_STATUS\='1' WHERE PROPOSAL_NO\=?   and amend_id\=(select max(amend_id) from position_master p where p.PROPOSAL_NO\=pm.PROPOSAL_NO )
CANCEL_PROPOSAL = UPDATE POSITION_MASTER pm SET CONTRACT_STATUS\='C' , EDIT_MODE\='N'  WHERE PROPOSAL_NO\=?   and amend_id\=(select max(amend_id) from position_master p where p.PROPOSAL_NO\=pm.PROPOSAL_NO )
common.select.getDepartmentList=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? ORDER BY  TMAS_DEPARTMENT_NAME ASC
UPDATE_SUB_LAYER_INFO=UPDATE POSITION_MASTER TK SET(CEDING_COMPANY_ID,INCEPTION_DATE,EXPIRY_DATE,UW_YEAR,UW_YEAR_TO)=(SELECT CEDING_COMPANY_ID,INCEPTION_DATE,EXPIRY_DATE,UW_YEAR,UW_YEAR_TO FROM POSITION_MASTER TRC WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER  WHERE PROPOSAL_NO=TRC.PROPOSAL_NO))  WHERE PROPOSAL_NO IN (SELECT DISTINCT PROPOSAL_NO FROM POSITION_MASTER WHERE BASE_LAYER=? ) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER  WHERE PROPOSAL_NO=TK.PROPOSAL_NO)
UPDATE_SUB_LAYER_INFO=UPDATE POSITION_MASTER TK SET(CEDING_COMPANY_ID,INCEPTION_DATE,EXPIRY_DATE,UW_YEAR,UW_YEAR_TO)=(SELECT CEDING_COMPANY_ID,INCEPTION_DATE,EXPIRY_DATE,UW_YEAR,UW_YEAR_TO FROM POSITION_MASTER TRC WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER  WHERE PROPOSAL_NO=TRC.PROPOSAL_NO))  WHERE PROPOSAL_NO IN (SELECT DISTINCT PROPOSAL_NO FROM POSITION_MASTER WHERE BASE_LAYER=? ) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER  WHERE PROPOSAL_NO=TK.PROPOSAL_NO)
UPDATE_SUB_LAYER_RISK=UPDATE TTRN_RISK_DETAILS TK SET (RSK_CEDINGID,RSK_INCEPTION_DATE, RSK_EXPIRY_DATE,RSK_UWYEAR)=(SELECT RSK_CEDINGID,RSK_INCEPTION_DATE, RSK_EXPIRY_DATE,RSK_UWYEAR FROM TTRN_RISK_DETAILS TRC WHERE RSK_PROPOSAL_NUMBER=? AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS  WHERE RSK_PROPOSAL_NUMBER=TRC.RSK_PROPOSAL_NUMBER)) WHERE RSK_PROPOSAL_NUMBER IN (SELECT DISTINCT PROPOSAL_NO FROM POSITION_MASTER WHERE BASE_LAYER=? ) AND RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) FROM TTRN_RISK_DETAILS  WHERE RSK_PROPOSAL_NUMBER=TK.RSK_PROPOSAL_NUMBER)
common.select.getDepartmentList=SELECT DISTINCT TMAS_DEPARTMENT_ID ,TMAS_DEPARTMENT_NAME FROM TMAS_DEPARTMENT_MASTER WHERE BRANCH_CODE=? AND TMAS_PRODUCT_ID=? AND TMAS_STATUS=? ORDER BY  TMAS_DEPARTMENT_NAME ASC
GET_COMPANY_INFO=SELECT COMPANY_CODE,COMPANY_NAME,EMAIL,ADDRESS1,COUNTRY,WEB_SITE,MOBILE,HEADER_LOGO,MAIN_LOGO FROM COMPANY_MASTER WHERE COMPANY_CODE IN(SELECT COMPANY_CODE FROM TMAS_BRANCH_MASTER WHERE BRANCH_CODE=? AND STATUS='Y')
GET_NEW_CONTRACT_LIST=SELECT   a.OFFER_NO,a.PROPOSAL_NO,substr(a.PROPOSAL_NO,4,8) prop,SUBSTR(A.PROPOSAL_NO,-5) proposal,b.TMAS_DEPARTMENT_ID,b.TMAS_DEPARTMENT_NAME,CASE WHEN E.RSK_SPFCID='ALL' THEN 'ALL' ELSE (select RTRIM(XMLAGG(XMLELEMENT(E,TMAS_SPFC_NAME,',')).EXTRACT('//text()'),',')  from TMAS_SPFC_MASTER SPFC where SPFC.TMAS_SPFC_ID in(select * from table(SPLIT_TEXT_FN(replace(E.RSK_SPFCID,' ', '')))) AND  SPFC.TMAS_PRODUCT_ID = E.RSK_PRODUCTID AND SPFC.BRANCH_CODE = E.BRANCH_CODE) END TMAS_SPFC_NAME,a.CEDING_COMPANY_ID, TO_CHAR (a.ACCOUNT_DATE, 'dd/mm/yyyy') AS ACCOUNT_DATE, c.COMPANY_NAME,C1.FIRST_NAME||' '||C1.LAST_NAME BROKER_NAME,TO_CHAR (a.INCEPTION_DATE, 'dd/mm/yyyy') AS INCEPTION_DATE,  TO_CHAR (a.EXPIRY_DATE, 'dd/mm/yyyy') AS EXPIRY_DATE, NVL(A.BASE_LAYER,A.PROPOSAL_NO)BASE_LAYER, A.contract_no,(case when a.uw_year!=0 then a.uw_year else null end) uw_year,to_char(a.uw_month,'dd/mm/yyyy') UW_MONTH,D.UNDERWRITTER,A.LAYER_NO,A.OLD_CONTRACTNO,A.AMEND_ID ,E.RSK_INSURED_NAME,A.Bouquet_No,NVL(A.BASE_LAYER,A.PROPOSAL_NO)BASE_LAYER_DESC,A.SECTION_NO FROM   PERSONAL_INFO c,PERSONAL_INFO c1, position_master A,TTRN_RISK_DETAILS E  LEFT OUTER JOIN  TMAS_DEPARTMENT_MASTER b   ON E.RSK_DEPTId = b.TMAS_DEPARTMENT_ID AND b.TMAS_PRODUCT_ID = ? AND B.BRANCH_CODE=?   AND B.TMAS_STATUS='Y' LEFT OUTER JOIN UNDERWRITTER_MASTER D ON  D.UWR_CODE=E.RSK_UNDERWRITTER AND D.BRANCH_CODE=?  WHERE       A.product_id = ? AND ( a.CONTRACT_STATUS = 'P' OR a.CONTRACT_STATUS IS NULL ) AND c.CUSTOMER_ID = A.CEDING_COMPANY_ID  AND C.BRANCH_CODE=? AND C.CUSTOMER_TYPE='C' AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=C.CUSTOMER_ID AND BRANCH_CODE=C.BRANCH_CODE AND CUSTOMER_TYPE=C.CUSTOMER_TYPE) AND A.PROPOSAL_NO=E.RSK_PROPOSAL_NUMBER AND A.AMEND_ID = E.RSK_ENDORSEMENT_NO   AND A.PRODUCT_ID = E.RSK_PRODUCTID AND A.BRANCH_CODE=?  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO AND A.BRANCH_CODE=BRANCH_CODE ) AND c1.CUSTOMER_ID = A.BROKER_ID AND C1.BRANCH_CODE = ? AND C1.AMEND_ID =(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = C1.CUSTOMER_ID AND BRANCH_CODE = C1.BRANCH_CODE AND CUSTOMER_TYPE = C1.CUSTOMER_TYPE) AND (E.OLD_CONTRACTNO IS NULL OR E.OLD_CONTRACTNO ='0')  AND A.PROPOSAL_NO=(SELECT DISTINCT PROPOSAL_NO FROM TTRN_RI_PLACEMENT TRP WHERE PROPOSAL_NO=A.PROPOSAL_NO AND STATUS='CSL' AND TRP.STATUS_NO IN (SELECT MAX(STATUS_NO) FROM TTRN_RI_PLACEMENT TRP1 WHERE TRP.PROPOSAL_NO = TRP1.PROPOSAL_NO AND TRP.SNO = TRP1.SNO AND TRP.BRANCH_CODE = TRP1.BRANCH_CODE))
GET_CLAIM_AUTH_MULTIPLE =  SELECT  'MULTIPLE' PAYMENT_TYPE, CLAIM_NO, 'MULTIPLE' CLAIM_PAYMENT_NO, COMPANY_NAME, BROKER_NAME, INSURED_NAME, 'MULTIPLE' DATE_OF_LOSS , LOSS_DETAILS, SUM(LOSS_ESTIMATE_OC) LOSS_ESTIMATE_OC, AVG(SHARE_SIGNED) SHARE_SIGNED, SUM(LOSS_ESTIMATE_OS_OC) LOSS_ESTIMATE_OS_OC, CONTRACT_NO, RSK_INSURED_NAME, SUM(REINSPREMIUM_OURSHARE_OC) REINSPREMIUM_OURSHARE_OC, SUM(PAID_AMOUNT_OC) PAID_AMOUNT_OC, OSLR, CURRENCY FROM(SELECT DISTINCT 'MULTIPLE' CLAIM_NO, TCP.CLAIM_PAYMENT_NO AS CLAIM_PAYMENT_NO, PIC.COMPANY_NAME, PIB.FIRST_NAME || ' ' ||PIB.LAST_NAME BROKER_NAME, 'MULTIPLE' INSURED_NAME, 'MULTIPLE' DATE_OF_LOSS, 'MULTIPLE' LOSS_DETAILS, TCD.LOSS_ESTIMATE_OC, CASE WHEN PM.PRODUCT_ID = 1 THEN TFRP.SHARE_SIGNED ELSE TRP.RSK_SHARE_SIGNED END AS SHARE_SIGNED, TCD.LOSS_ESTIMATE_OS_OC, TCD.CONTRACT_NO, TRD.RSK_INSURED_NAME, NVL(TCP.REINSPREMIUM_OURSHARE_OC,0)REINSPREMIUM_OURSHARE_OC, NVL(TCP.PAID_AMOUNT_OC,0)PAID_AMOUNT_OC , 'MULTIPLE' OSLR, CM.SHORT_NAME CURRENCY FROM TTRN_CLAIM_DETAILS TCD, TTRN_CLAIM_PAYMENT TCP, TTRN_CLAIM_UPDATION TCU, PERSONAL_INFO PIC, PERSONAL_INFO PIB, POSITION_MASTER PM, TTRN_FAC_RISK_PROPOSAL TFRP, TTRN_RISK_PROPOSAL TRP, TTRN_RISK_DETAILS TRD, CURRENCY_MASTER CM, TMAS_DEPARTMENT_MASTER TDM WHERE TCD.BRANCH_CODE = TCP.BRANCH_CODE AND TCD.BRANCH_CODE = TCU.BRANCH_CODE AND TCD.BRANCH_CODE = PIC.BRANCH_CODE AND TCD.BRANCH_CODE = PIB.BRANCH_CODE AND TCD.BRANCH_CODE = PM.BRANCH_CODE AND TCD.BRANCH_CODE = TFRP.BRANCH_CODE(+) AND TCD.BRANCH_CODE = TRP.BRANCH_CODE(+) AND TCD.BRANCH_CODE = TRD.BRANCH_CODE AND TCD.BRANCH_CODE = CM.BRANCH_CODE AND TCD.BRANCH_CODE = TDM.BRANCH_CODE AND PM.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO = PM.PROPOSAL_NO) AND PM.AMEND_ID = TFRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID = TRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID = TRD.RSK_ENDORSEMENT_NO AND PM.PROPOSAL_NO = TCD.PROPOSAL_NO AND PM.PROPOSAL_NO = TFRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO = TRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO = TRD.RSK_PROPOSAL_NUMBER AND PIB.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIB1 WHERE PIB1.CUSTOMER_ID = PIB.CUSTOMER_ID) AND PIB.CUSTOMER_TYPE = 'B' AND PIB.CUSTOMER_ID = PM.BROKER_ID AND PIC.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIC1 WHERE PIC1.CUSTOMER_ID = PIC.CUSTOMER_ID) AND PIC.CUSTOMER_TYPE = 'C' AND PIC.CUSTOMER_ID = PM.CEDING_COMPANY_ID AND TCD.BRANCH_CODE = TCP.BRANCH_CODE AND TCD.CLAIM_NO = TCP.CLAIM_NO AND TCD.CURRENCY = CM.CURRENCY_ID AND TCD.BRANCH_CODE = TCU.BRANCH_CODE AND TCD.CLAIM_NO = TCU.CLAIM_NO AND TCU.SL_NO IN (SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION TCU1 WHERE TCU1.CLAIM_NO = TCU.CLAIM_NO ) AND TDM.TMAS_STATUS = 'Y' AND TDM.TMAS_PRODUCT_ID = PM.PRODUCT_ID AND TDM.TMAS_DEPARTMENT_ID = PM.DEPT_ID AND TCD.PROPOSAL_NO = ? AND TCD.CONTRACT_NO = ? AND TCD.LAYER_NO = ? AND TCD.CURRENCY = ? AND TCD.BRANCH_CODE = ?
GET_CLAIM_AUTH_SINGLE = SELECT DISTINCT TCD.CLAIM_NO, TCP.CLAIM_PAYMENT_NO, PIC.COMPANY_NAME, PIB.FIRST_NAME || ' ' ||PIB.LAST_NAME BROKER_NAME, TCD.INSURED_NAME, TO_CHAR(TCD.DATE_OF_LOSS , 'DD/MM/YYYY')DATE_OF_LOSS , TCD.LOSS_DETAILS, TCD.LOSS_ESTIMATE_OC, TCP.PAYMENT_TYPE, TFRP.SHARE_SIGNED, nvl(TCD.LOSS_ESTIMATE_OS_OC,0)LOSS_ESTIMATE_OS_OC, TCD.CONTRACT_NO, TRD.RSK_INSURED_NAME, nvl(TCP.REINSPREMIUM_OURSHARE_OC , 0)REINSPREMIUM_OURSHARE_OC, nvl(TCP.PAID_AMOUNT_OC,0)PAID_AMOUNT_OC, nvl(TCU.LOSS_ESTIMATE_REVISED_OC - NVL((SELECT SUM(TCP1.PAID_AMOUNT_OC) FROM TTRN_CLAIM_PAYMENT TCP1 WHERE TCP1.SL_NO \= TCU.SL_NO AND TCP1.CLAIM_NO \= TCU.CLAIM_NO GROUP BY TCP1.CLAIM_PAYMENT_NO),0), 0)OSLR, CM.SHORT_NAME CURRENCY FROM TTRN_CLAIM_DETAILS TCD, TTRN_CLAIM_PAYMENT TCP, TTRN_CLAIM_UPDATION TCU, PERSONAL_INFO PIC, PERSONAL_INFO PIB, POSITION_MASTER PM, TTRN_FAC_RISK_PROPOSAL TFRP, TTRN_RISK_DETAILS TRD, CURRENCY_MASTER CM WHERE TCD.BRANCH_CODE \= TCP.BRANCH_CODE AND TCD.BRANCH_CODE \= TCU.BRANCH_CODE AND TCD.BRANCH_CODE \= PIC.BRANCH_CODE AND TCD.BRANCH_CODE \= PIB.BRANCH_CODE AND TCD.BRANCH_CODE \= PM.BRANCH_CODE AND TCD.BRANCH_CODE \= TFRP.BRANCH_CODE AND TCD.BRANCH_CODE \= TRD.BRANCH_CODE AND TCD.BRANCH_CODE \= CM.BRANCH_CODE AND PM.AMEND_ID IN(SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO \= PM.PROPOSAL_NO) AND PM.AMEND_ID \= TFRP.RSK_ENDORSEMENT_NO AND PM.AMEND_ID \= TRD.RSK_ENDORSEMENT_NO AND PM.PROPOSAL_NO \= TCD.PROPOSAL_NO AND PM.PROPOSAL_NO \= TFRP.RSK_PROPOSAL_NUMBER AND PM.PROPOSAL_NO \= TRD.RSK_PROPOSAL_NUMBER AND PIB.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIB1 WHERE PIB1.CUSTOMER_ID \= PIB.CUSTOMER_ID ) AND PIB.CUSTOMER_TYPE \= 'B' AND PIB.CUSTOMER_ID \= PM.BROKER_ID AND PIC.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIC1 WHERE PIC1.CUSTOMER_ID \= PIC.CUSTOMER_ID ) AND PIC.CUSTOMER_TYPE \= 'C' AND PIC.CUSTOMER_ID \= PM.CEDING_COMPANY_ID AND TCD.BRANCH_CODE \= TCP.BRANCH_CODE AND TCD.CLAIM_NO \= TCP.CLAIM_NO AND TCD.CURRENCY \= CM.CURRENCY_ID AND TCD.BRANCH_CODE \= TCU.BRANCH_CODE AND TCD.CLAIM_NO \= TCU.CLAIM_NO AND TCU.SL_NO IN (SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION TCU1 WHERE TCU1.CLAIM_NO \= TCU.CLAIM_NO ) AND TCD.PROPOSAL_NO \= ? AND TCD.CONTRACT_NO \= ? AND TCD.LAYER_NO \= ? AND TCD.CURRENCY \= ? AND TCD.BRANCH_CODE \= ? AND TCP.CLAIM_PAYMENT_NO IN (?)
GET_CLAIM_AUTH_MULTIPLE_GRID = SELECT DISTINCT PIC.COMPANY_NAME, TCD.INSURED_NAME, TCD.CONTRACT_NO, TCP.PAYMENT_REQUEST_NO REFERENCE, CM.SHORT_NAME CURRENCY, TDM.TMAS_DEPARTMENT_NAME CLASS, TCD.LOSS_DETAILS, TO_CHAR(TCD.DATE_OF_LOSS , 'DD/MM/YYYY')DATE_OF_LOSS, TCD.LOSS_ESTIMATE_OC, CASE WHEN PM.PRODUCT_ID \= 1 THEN TFRP.SHARE_SIGNED ELSE TRP.RSK_SHARE_SIGNED END AS SHARE_SIGNED, TCD.LOSS_ESTIMATE_OS_OC, TCP.PAYMENT_TYPE, TCP.CLAIM_NO, TCP.CLAIM_PAYMENT_NO AS CLAIM_PAYMENT_NO FROM TTRN_CLAIM_DETAILS TCD, TTRN_CLAIM_PAYMENT TCP, TTRN_CLAIM_UPDATION TCU, PERSONAL_INFO PIC, PERSONAL_INFO PIB, POSITION_MASTER PM, TTRN_FAC_RISK_PROPOSAL TFRP, TTRN_RISK_PROPOSAL TRP, TTRN_RISK_DETAILS TRD, CURRENCY_MASTER CM, TMAS_DEPARTMENT_MASTER TDM WHERE TCD.BRANCH_CODE \= TCP.BRANCH_CODE AND TCD.BRANCH_CODE \= TCU.BRANCH_CODE AND TCD.BRANCH_CODE \= PIC.BRANCH_CODE AND TCD.BRANCH_CODE \= PIB.BRANCH_CODE AND TCD.BRANCH_CODE \= PM.BRANCH_CODE AND TCD.BRANCH_CODE \= TFRP.BRANCH_CODE(+) AND TCD.BRANCH_CODE \= TRP.BRANCH_CODE (+) AND TCD.BRANCH_CODE \= TRD.BRANCH_CODE AND TCD.BRANCH_CODE \= CM.BRANCH_CODE AND TCD.BRANCH_CODE \= TDM.BRANCH_CODE AND PM.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO \= PM.PROPOSAL_NO) AND PM.AMEND_ID \= TFRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID \= TRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID \= TRD.RSK_ENDORSEMENT_NO AND PM.PROPOSAL_NO \= TCD.PROPOSAL_NO AND PM.PROPOSAL_NO \= TFRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO \= TRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO \= TRD.RSK_PROPOSAL_NUMBER AND PIB.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIB1 WHERE PIB1.CUSTOMER_ID \= PIB.CUSTOMER_ID ) AND PIB.CUSTOMER_TYPE \= 'B' AND PIB.CUSTOMER_ID \= PM.BROKER_ID AND PIC.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIC1 WHERE PIC1.CUSTOMER_ID \= PIC.CUSTOMER_ID ) AND PIC.CUSTOMER_TYPE \= 'C' AND PIC.CUSTOMER_ID \= PM.CEDING_COMPANY_ID AND TCD.BRANCH_CODE \= TCP.BRANCH_CODE AND TCD.CLAIM_NO \= TCP.CLAIM_NO AND TCD.CURRENCY \= CM.CURRENCY_ID AND TCD.BRANCH_CODE \= TCU.BRANCH_CODE AND TCD.CLAIM_NO \= TCU.CLAIM_NO AND TCU.SL_NO IN (SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION TCU1 WHERE TCU1.CLAIM_NO \= TCU.CLAIM_NO ) AND TDM.TMAS_STATUS \= 'Y' AND TDM.TMAS_PRODUCT_ID \= PM.PRODUCT_ID AND TDM.TMAS_DEPARTMENT_ID \= PM.DEPT_ID AND TCD.PROPOSAL_NO \= ? AND TCD.CONTRACT_NO \= ? AND TCD.LAYER_NO \= ? AND TCD.CURRENCY \= ? AND TCD.BRANCH_CODE \= ? 
GET_CLAIM_AUTH_MULTIPLE1 = SELECT  'MULTIPLE' PAYMENT_TYPE, CLAIM_NO, 'MULTIPLE' CLAIM_PAYMENT_NO, COMPANY_NAME, BROKER_NAME, INSURED_NAME, 'MULTIPLE' DATE_OF_LOSS , LOSS_DETAILS, SUM(LOSS_ESTIMATE_OC) LOSS_ESTIMATE_OC, AVG(SHARE_SIGNED) SHARE_SIGNED, SUM(LOSS_ESTIMATE_OS_OC) LOSS_ESTIMATE_OS_OC, CONTRACT_NO, RSK_INSURED_NAME, SUM(REINSPREMIUM_OURSHARE_OC) REINSPREMIUM_OURSHARE_OC, SUM(PAID_AMOUNT_OC) PAID_AMOUNT_OC, OSLR, CURRENCY FROM(SELECT DISTINCT 'MULTIPLE' CLAIM_NO, TCP.CLAIM_PAYMENT_NO AS CLAIM_PAYMENT_NO, PIC.COMPANY_NAME, PIB.FIRST_NAME || ' ' ||PIB.LAST_NAME BROKER_NAME, 'MULTIPLE' INSURED_NAME, 'MULTIPLE' DATE_OF_LOSS, 'MULTIPLE' LOSS_DETAILS, TCD.LOSS_ESTIMATE_OC, CASE WHEN PM.PRODUCT_ID = 1 THEN TFRP.SHARE_SIGNED ELSE TRP.RSK_SHARE_SIGNED END AS SHARE_SIGNED, TCD.LOSS_ESTIMATE_OS_OC, TCD.CONTRACT_NO, TRD.RSK_INSURED_NAME, NVL(TCP.REINSPREMIUM_OURSHARE_OC,0)REINSPREMIUM_OURSHARE_OC, NVL(TCP.PAID_AMOUNT_OC,0)PAID_AMOUNT_OC , 'MULTIPLE' OSLR, CM.SHORT_NAME CURRENCY FROM TTRN_CLAIM_DETAILS TCD, TTRN_CLAIM_PAYMENT TCP, TTRN_CLAIM_UPDATION TCU, PERSONAL_INFO PIC, PERSONAL_INFO PIB, POSITION_MASTER PM, TTRN_FAC_RISK_PROPOSAL TFRP, TTRN_RISK_PROPOSAL TRP, TTRN_RISK_DETAILS TRD, CURRENCY_MASTER CM, TMAS_DEPARTMENT_MASTER TDM WHERE TCD.BRANCH_CODE = TCP.BRANCH_CODE AND TCD.BRANCH_CODE = TCU.BRANCH_CODE AND TCD.BRANCH_CODE = PIC.BRANCH_CODE AND TCD.BRANCH_CODE = PIB.BRANCH_CODE AND TCD.BRANCH_CODE = PM.BRANCH_CODE AND TCD.BRANCH_CODE = TFRP.BRANCH_CODE(+) AND TCD.BRANCH_CODE = TRP.BRANCH_CODE(+) AND TCD.BRANCH_CODE = TRD.BRANCH_CODE AND TCD.BRANCH_CODE = CM.BRANCH_CODE AND TCD.BRANCH_CODE = TDM.BRANCH_CODE AND PM.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO = PM.PROPOSAL_NO) AND PM.AMEND_ID = TFRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID = TRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID = TRD.RSK_ENDORSEMENT_NO AND PM.PROPOSAL_NO = TCD.PROPOSAL_NO AND PM.PROPOSAL_NO = TFRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO = TRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO = TRD.RSK_PROPOSAL_NUMBER AND PIB.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIB1 WHERE PIB1.CUSTOMER_ID = PIB.CUSTOMER_ID) AND PIB.CUSTOMER_TYPE = 'B' AND PIB.CUSTOMER_ID = PM.BROKER_ID AND PIC.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIC1 WHERE PIC1.CUSTOMER_ID = PIC.CUSTOMER_ID) AND PIC.CUSTOMER_TYPE = 'C' AND PIC.CUSTOMER_ID = PM.CEDING_COMPANY_ID AND TCD.BRANCH_CODE = TCP.BRANCH_CODE AND TCD.CLAIM_NO = TCP.CLAIM_NO AND TCD.CURRENCY = CM.CURRENCY_ID AND TCD.BRANCH_CODE = TCU.BRANCH_CODE AND TCD.CLAIM_NO = TCU.CLAIM_NO AND TCU.SL_NO IN (SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION TCU1 WHERE TCU1.CLAIM_NO = TCU.CLAIM_NO ) AND TDM.TMAS_STATUS = 'Y' AND TDM.TMAS_PRODUCT_ID = PM.PRODUCT_ID AND TDM.TMAS_DEPARTMENT_ID = PM.DEPT_ID AND TCD.PROPOSAL_NO = ? AND TCD.CONTRACT_NO = ? AND TCD.LAYER_NO = ? AND TCD.CURRENCY = ? AND TCD.BRANCH_CODE = ? AND TCP.CLAIM_PAYMENT_NO IN (?) ) GROUP BY CLAIM_NO, COMPANY_NAME, BROKER_NAME, INSURED_NAME, DATE_OF_LOSS, LOSS_DETAILS, CONTRACT_NO, RSK_INSURED_NAME, OSLR, CURRENCY
GET_CLAIM_AUTH_MULTIPLE_GRID1 = SELECT DISTINCT PIC.COMPANY_NAME, TCD.INSURED_NAME, TCD.CONTRACT_NO, TCP.PAYMENT_REQUEST_NO REFERENCE, CM.SHORT_NAME CURRENCY, TDM.TMAS_DEPARTMENT_NAME CLASS, TCD.LOSS_DETAILS, TO_CHAR(TCD.DATE_OF_LOSS , 'DD/MM/YYYY')DATE_OF_LOSS, TCD.LOSS_ESTIMATE_OC, CASE WHEN PM.PRODUCT_ID \= 1 THEN TFRP.SHARE_SIGNED ELSE TRP.RSK_SHARE_SIGNED END AS SHARE_SIGNED, TCD.LOSS_ESTIMATE_OS_OC, TCP.PAYMENT_TYPE, TCP.CLAIM_NO, TCP.CLAIM_PAYMENT_NO AS CLAIM_PAYMENT_NO FROM TTRN_CLAIM_DETAILS TCD, TTRN_CLAIM_PAYMENT TCP, TTRN_CLAIM_UPDATION TCU, PERSONAL_INFO PIC, PERSONAL_INFO PIB, POSITION_MASTER PM, TTRN_FAC_RISK_PROPOSAL TFRP, TTRN_RISK_PROPOSAL TRP, TTRN_RISK_DETAILS TRD, CURRENCY_MASTER CM, TMAS_DEPARTMENT_MASTER TDM WHERE TCD.BRANCH_CODE \= TCP.BRANCH_CODE AND TCD.BRANCH_CODE \= TCU.BRANCH_CODE AND TCD.BRANCH_CODE \= PIC.BRANCH_CODE AND TCD.BRANCH_CODE \= PIB.BRANCH_CODE AND TCD.BRANCH_CODE \= PM.BRANCH_CODE AND TCD.BRANCH_CODE \= TFRP.BRANCH_CODE(+) AND TCD.BRANCH_CODE \= TRP.BRANCH_CODE (+) AND TCD.BRANCH_CODE \= TRD.BRANCH_CODE AND TCD.BRANCH_CODE \= CM.BRANCH_CODE AND TCD.BRANCH_CODE \= TDM.BRANCH_CODE AND PM.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.PROPOSAL_NO \= PM.PROPOSAL_NO) AND PM.AMEND_ID \= TFRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID \= TRP.RSK_ENDORSEMENT_NO (+) AND PM.AMEND_ID \= TRD.RSK_ENDORSEMENT_NO AND PM.PROPOSAL_NO \= TCD.PROPOSAL_NO AND PM.PROPOSAL_NO \= TFRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO \= TRP.RSK_PROPOSAL_NUMBER (+) AND PM.PROPOSAL_NO \= TRD.RSK_PROPOSAL_NUMBER AND PIB.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIB1 WHERE PIB1.CUSTOMER_ID \= PIB.CUSTOMER_ID ) AND PIB.CUSTOMER_TYPE \= 'B' AND PIB.CUSTOMER_ID \= PM.BROKER_ID AND PIC.AMEND_ID IN (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PIC1 WHERE PIC1.CUSTOMER_ID \= PIC.CUSTOMER_ID ) AND PIC.CUSTOMER_TYPE \= 'C' AND PIC.CUSTOMER_ID \= PM.CEDING_COMPANY_ID AND TCD.BRANCH_CODE \= TCP.BRANCH_CODE AND TCD.CLAIM_NO \= TCP.CLAIM_NO AND TCD.CURRENCY \= CM.CURRENCY_ID AND TCD.BRANCH_CODE \= TCU.BRANCH_CODE AND TCD.CLAIM_NO \= TCU.CLAIM_NO AND TCU.SL_NO IN (SELECT MAX(SL_NO) FROM TTRN_CLAIM_UPDATION TCU1 WHERE TCU1.CLAIM_NO \= TCU.CLAIM_NO ) AND TDM.TMAS_STATUS \= 'Y' AND TDM.TMAS_PRODUCT_ID \= PM.PRODUCT_ID AND TDM.TMAS_DEPARTMENT_ID \= PM.DEPT_ID AND TCD.PROPOSAL_NO \= ? AND TCD.CONTRACT_NO \= ? AND TCD.LAYER_NO \= ? AND TCD.CURRENCY \= ? AND TCD.BRANCH_CODE \= ? AND TCP.CLAIM_PAYMENT_NO IN (?)
GET_CLASS_LIMIT_DETAILS=SELECT RSK_PROPOSAL_NUMBER,RSK_ENDORSEMENT_NO,RSK_CONTRACT_NO,RSK_LAYER_NO,RSK_PRODUCTID,RSK_COVER_CLASS,RSK_COVER_LIMT,RSK_COVER_LIMT_PERCENTAGE,RSK_DEDUCTABLE_LIMT,RSK_DEDUCTABLE_PERCENTAGE,ENTRY_DATE,BRANCH_CODE,STATUS,RSK_EGNPI_AS_OFF,RSK_GNPI_AS_OFF,RSK_NET_MAX_RETENT_PERCENT FROM TTRN_RSK_CLASS_LIMITS TRCL where RSK_PROPOSAL_NUMBER=? and RSK_LAYER_NO=? and RSK_ENDORSEMENT_NO=(SELECT MAX(RSK_ENDORSEMENT_NO) from TTRN_RSK_CLASS_LIMITS where  RSK_PROPOSAL_NUMBER=TRCL.RSK_PROPOSAL_NUMBER) order by RSK_SNO
GET_MAX_LAYER_NO=SELECT MAX(LAYER_NO)LAYER_NO FROM POSITION_MASTER  WHERE NVL(BASE_LAYER,PROPOSAL_NO)=?
GET_REINSURER_INFO_BOUQUET_NOTIN=SELECT DISTINCT P.SNO, P.REINSURER_ID,P.BROKER_ID,P.SHARE_OFFERED,NVL(M.MAIL_STATUS,'Pending')MAIL_STATUS,P.BOUQUET_NO,P.PLACEMENT_MODE from TTRN_RI_PLACEMENT P LEFT JOIN MAIL_NOTIFICATION_DETAIL M ON(M.PROPOSAL_NO=P.PROPOSAL_NO AND M.REINSURER_ID=P.REINSURER_ID AND M.BROKER_ID=P.BROKER_ID)  WHERE P.BRANCH_CODE=? AND P.BOUQUET_NO=? AND P.PLACEMENT_AMEND_ID=(SELECT MAX(PLACEMENT_AMEND_ID) FROM TTRN_RI_PLACEMENT WHERE P.BRANCH_CODE=BRANCH_CODE AND P.PROPOSAL_NO=PROPOSAL_NO AND P.REINSURER_ID=REINSURER_ID AND P.BROKER_ID=BROKER_ID) ORDER BY P.SNO, P.BOUQUET_NO